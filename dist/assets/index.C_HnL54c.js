var e=Object.defineProperty,t=(t,n,a)=>((t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a)(t,"symbol"!=typeof n?n+"":n,a);import{r as n,z as a,y as s,A as r,C as o,D as i,U as l,j as c,E as d,F as u,G as m,H as p,I as g,J as f,K as x,L as h,M as v,N as b,O as y,R as _,P as j,Q as w,S as N,T as C,V as k,W as S,X as T,Y as R,Z as I,a0 as E,a1 as P,a2 as L,a3 as M,a4 as A,a5 as O,a6 as D,a7 as F,a8 as z,a9 as U,aa as V,ab as B,ac as $,ad as H,ae as G,af as K,ag as W,ah as Q,ai as q,aj as Z,ak as Y,al as J,am as X,an as ee,ao as te,ap as ne,aq as ae,ar as se,as as re,at as oe,au as ie,av as le,aw as ce,ax as de,ay as ue,az as me,aA as pe,aB as ge,aC as fe,aD as xe,aE as he,aF as ve,aG as be,aH as ye,aI as _e,aJ as je,aK as we,aL as Ne,aM as Ce,aN as ke,aO as Se,aP as Te,aQ as Re,aR as Ie,aS as Ee,aT as Pe,aU as Le,aV as Me,aW as Ae,aX as Oe,aY as De,aZ as Fe,a_ as ze,a$ as Ue,b0 as Ve,b1 as Be,b2 as $e,b3 as He,b4 as Ge,b5 as Ke,b6 as We,b7 as Qe,b8 as qe,b9 as Ze,ba as Ye,bb as Je,bc as Xe,bd as et,be as tt,bf as nt,bg as at,bh as st,bi as rt,bj as ot,bk as it,bl as lt,bm as ct,bn as dt,bo as ut,bp as mt,bq as pt,br as gt,bs as ft,bt as xt,bu as ht,bv as vt,bw as bt,bx as yt,by as _t,bz as jt,bA as wt,bB as Nt,bC as Ct,bD as kt,bE as St,bF as Tt,bG as Rt,bH as It,bI as Et,bJ as Pt,bK as Lt,bL as Mt,bM as At,bN as Ot,bO as Dt,bP as Ft,bQ as zt,bR as Ut,bS as Vt,bT as Bt,bU as $t,bV as Ht,bW as Gt,bX as Kt,bY as Wt,bZ as Qt,b_ as qt,b$ as Zt,c0 as Yt,c1 as Jt,c2 as Xt,c3 as en,c4 as tn,c5 as nn,c6 as an,c7 as sn,c8 as rn,c9 as on,ca as ln,cb as cn,cc as dn,cd as un,ce as mn,cf as pn,cg as gn,ch as fn,ci as xn,cj as hn,ck as vn,cl as bn,cm as yn,cn as _n,co as jn,cp as wn,cq as Nn,cr as Cn,cs as kn,ct as Sn,cu as Tn,cv as Rn,cw as In,cx as En,cy as Pn,cz as Ln,cA as Mn,cB as An,cC as On,cD as Dn,cE as Fn,cF as zn,cG as Un,cH as Vn,cI as Bn,cJ as $n,cK as Hn,cL as Gn,cM as Kn,cN as Wn,cO as Qn,cP as qn,cQ as Zn,cR as Yn,cS as Jn,cT as Xn,cU as ea,cV as ta,cW as na,cX as aa,cY as sa,cZ as ra,c_ as oa,c$ as ia,d0 as la,d1 as ca,d2 as da,d3 as ua,d4 as ma,d5 as pa,d6 as ga,d7 as fa,d8 as xa,d9 as ha,da as va,db as ba,dc as ya,dd as _a}from"./vendor.hMS1TUfa.js";import"./locales.CqY0yuiD.js";import{$ as ja,a as wa,b as Na,c as Ca,d as ka,e as Sa,f as Ta,g as Ra,h as Ia,i as Ea,j as Pa,k as La,S as Ma,l as Aa,P as Oa,C as Da,I as Fa,m as za,n as Ua,R as Va,L as Ba,o as $a,p as Ha,T as Ga,G as Ka,q as Wa,r as Qa,s as qa,t as Za,u as Ya,v as Ja,w as Xa,x as es,y as ts,z as ns,A as as,B as ss,D as rs,E as os,F as is,H as ls,J as cs,K as ds,M as us,N as ms,O as ps,Q as gs,U as fs,V as xs,W as hs,X as vs,Y as bs,Z as ys,_ as _s,a0 as js,a1 as ws,a2 as Ns,a3 as Cs,a4 as ks,a5 as Ss,a6 as Ts,a7 as Rs,a8 as Is,a9 as Es,aa as Ps,ab as Ls,ac as Ms,ad as As,ae as Os,af as Ds,ag as Fs,ah as zs,ai as Us,aj as Vs,ak as Bs,al as $s,am as Hs,an as Gs,ao as Ks,ap as Ws,aq as Qs,ar as qs,as as Zs,at as Ys,au as Js,av as Xs,aw as er,ax as tr}from"./radix-ui.I0vu8icV.js";import{u as nr,a as ar,b as sr,c as rr,d as or,f as ir,g as lr,e as cr,h as dr,i as ur,j as mr,Q as pr,k as gr,l as fr,R as xr}from"./tanstack-vendor.Bvc4qzcA.js";import{A as hr,m as vr}from"./framer-motion.1qcvTu4T.js";import{M as br,U as yr,K as _r,X as jr,G as wr,V as Nr,P as Cr,$ as kr,j as Sr,W as Tr,C as Rr,I as Ir,w as Er,T as Pr,Z as Lr,c as Mr,f as Ar,a as Or}from"./headlessui.CpN7zKej.js";import"./markdown_highlight.CfUfDHeH.js";import"./markdown_large.DH79QO1b.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class Dr{constructor(e){t(this,"mediaSource",new MediaSource),t(this,"audioChunks",[]),t(this,"sourceBuffer"),this.mediaSource.addEventListener("sourceopen",(async()=>{this.sourceBuffer=this.mediaSource.addSourceBuffer(e),this.sourceBuffer.addEventListener("updateend",(()=>{this.tryAppendNextChunk()}))}))}tryAppendNextChunk(){null!=this.sourceBuffer&&!this.sourceBuffer.updating&&this.audioChunks.length>0&&this.sourceBuffer.appendBuffer(this.audioChunks.shift())}addBase64Data(e){this.addData(Uint8Array.from(atob(e),(e=>e.charCodeAt(0))).buffer)}addData(e){this.audioChunks.push(e),this.tryAppendNextChunk()}close(){"open"===this.mediaSource.readyState&&this.mediaSource.endOfStream()}get mediaSourceUrl(){return URL.createObjectURL(this.mediaSource)}}const Fr=7e3;var zr=(e=>(e.SIMPLE="simple",e.ADVANCED="advanced",e))(zr||{}),Ur=(e=>(e.browser="browser",e.edge="edge",e.external="external",e))(Ur||{});const Vr="prompt-textarea",Br="global-audio";var $r=(e=>(e.landing="landing",e.menuItem="menu-item",e.nav="nav",e.message="message",e))($r||{}),Hr=(e=>(e.builder="builder",e.actions="actions",e.model="model",e))(Hr||{});const Gr=450;var Kr=(e=>(e.Top="top",e.Right="right",e.Bottom="bottom",e.Left="left",e))(Kr||{}),Wr=(e=>(e.INFO="info",e.SUCCESS="success",e.WARNING="warning",e.ERROR="error",e))(Wr||{});function Qr(e){const t={};for(const n of e)t[n.file_id]=n;return t}function qr(e){const t={};for(const n of e)t[n.id]=n;return t}function Zr(e){return e.reduce(((e,t)=>(e[t.pluginKey]=t,e)),{})}const Yr=e=>e?{list:e,map:Zr(e)}:{list:[],map:{}};function Jr(e,t){return e.map((e=>"string"==typeof e?null==t?void 0:t[e]:e)).filter((e=>void 0!==e))}function Xr(e){try{JSON.parse(e)}catch(Bg){return!1}return!0}function eo(e){try{return JSON.stringify(JSON.parse(e),null,2)}catch(Bg){return e}}var to,no,ao,so,ro,oo,io,lo,co,uo,mo=function(){return mo=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},mo.apply(this,arguments)};function po(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n}function go(e,t,n,a){return new(n||(n=Promise))((function(t,s){function r(e){try{i(a.next(e))}catch(t){s(t)}}function o(e){try{i(a.throw(e))}catch(t){s(t)}}function i(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}i((a=a.apply(e,[])).next())}))}function fo(e,t){var n,a,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=i(0),o.throw=i(1),o.return=i(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(r=0)),r;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(l){i=[6,l],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function xo(e,t,n){if(n||2===arguments.length)for(var a,s=0,r=t.length;s<r;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError,(uo=to||(to={})).TEXT="text",uo.THINK="think",uo.TEXT_DELTA="text_delta",uo.TOOL_CALL="tool_call",uo.IMAGE_FILE="image_file",uo.IMAGE_URL="image_url",uo.ERROR="error",function(e){e.TOOL_CALLS="tool_calls",e.MESSAGE_CREATION="message_creation"}(no||(no={})),function(e){e.FUNCTION="function",e.RETRIEVAL="retrieval",e.FILE_SEARCH="file_search",e.CODE_INTERPRETER="code_interpreter",e.TOOL_CALL="tool_call"}(ao||(ao={})),function(e){e.execute_code="execute_code",e.code_interpreter="code_interpreter",e.file_search="file_search",e.retrieval="retrieval",e.function="function"}(so||(so={})),function(e){e.code_interpreter="code_interpreter",e.execute_code="execute_code",e.file_search="file_search"}(ro||(ro={})),function(e){e.FILE_CITATION="file_citation",e.FILE_PATH="file_path"}(oo||(oo={})),function(e){e.IN_PROGRESS="in_progress",e.CANCELLED="cancelled",e.FAILED="failed",e.COMPLETED="completed",e.EXPIRED="expired"}(io||(io={})),function(e){e.TEXT="text",e.IMAGE_FILE="image_file"}(lo||(lo={})),function(e){e.QUEUED="queued",e.IN_PROGRESS="in_progress",e.REQUIRES_ACTION="requires_action",e.CANCELLING="cancelling",e.CANCELLED="cancelled",e.FAILED="failed",e.COMPLETED="completed",e.EXPIRED="expired"}(co||(co={}));var ho,vo,bo,yo,_o="_action_";!function(e){e.ServiceHttp="service_http",e.OAuth="oauth",e.None="none"}(ho||(ho={})),function(e){e.Bearer="bearer",e.Basic="basic",e.Custom="custom"}(vo||(vo={})),function(e){e.DefaultPost="default_post",e.BasicAuthHeader="basic_auth_header"}(bo||(bo={})),function(e){e.Vision="vision",e.FineTune="fine-tune",e.FineTuneResults="fine-tune-results",e.Assistants="assistants",e.AssistantsOutput="assistants_output"}(yo||(yo={}));var jo,wo,No,Co,ko,So,To={order:"desc",limit:100};!function(e){e.ThreadCreated="thread.created",e.ThreadRunCreated="thread.run.created",e.ThreadRunQueued="thread.run.queued",e.ThreadRunInProgress="thread.run.in_progress",e.ThreadRunRequiresAction="thread.run.requires_action",e.ThreadRunCompleted="thread.run.completed",e.ThreadRunFailed="thread.run.failed",e.ThreadRunCancelling="thread.run.cancelling",e.ThreadRunCancelled="thread.run.cancelled",e.ThreadRunExpired="thread.run.expired",e.ThreadRunStepCreated="thread.run.step.created",e.ThreadRunStepInProgress="thread.run.step.in_progress",e.ThreadRunStepCompleted="thread.run.step.completed",e.ThreadRunStepFailed="thread.run.step.failed",e.ThreadRunStepCancelled="thread.run.step.cancelled",e.ThreadRunStepExpired="thread.run.step.expired",e.ThreadRunStepDelta="thread.run.step.delta",e.ThreadMessageCreated="thread.message.created",e.ThreadMessageInProgress="thread.message.in_progress",e.ThreadMessageCompleted="thread.message.completed",e.ThreadMessageIncomplete="thread.message.incomplete",e.ThreadMessageDelta="thread.message.delta",e.ErrorEvent="error"}(jo||(jo={})),a.string().uuid(),function(e){e.OVERRIDE_AUTH="override_auth",e.USER_PROVIDED="user_provided",e.SYSTEM_DEFINED="system_defined"}(So||(So={}));var Ro,Io=a.nativeEnum(So);!function(e){e.azureOpenAI="azureOpenAI",e.openAI="openAI",e.google="google",e.anthropic="anthropic",e.assistants="assistants",e.azureAssistants="azureAssistants",e.agents="agents",e.custom="custom",e.bedrock="bedrock",e.chatGPTBrowser="chatGPTBrowser",e.gptPlugins="gptPlugins"}(Ro||(Ro={}));var Eo,Po=new Set([Ro.agents,Ro.openAI,Ro.bedrock,Ro.azureOpenAI,Ro.anthropic,Ro.custom,Ro.google]);!function(e){e.AI21="ai21",e.Amazon="amazon",e.Anthropic="anthropic",e.Cohere="cohere",e.Meta="meta",e.MistralAI="mistral",e.StabilityAI="stability"}(Eo||(Eo={}));var Lo,Mo,Ao=function(e,t){var n=e,a=function(e,t){if(e===Ro.bedrock){var n=t.split("."),a=[n[0],n[1]].find((function(e){return Object.values(Eo).includes(e)}));return null!=a?a:n[0]}return t}(n,t);return["".concat(n,"-").concat(a),n]},Oo=function(e){var t=null!=e?e:"";return!!t&&t.toLowerCase().endsWith(Ro.assistants)},Do=function(e){var t=null!=e?e:"";return!!t&&t===Ro.agents},Fo=function(e,t){return!!Po.has(e)||null!=t&&Po.has(t)};!function(e){e.low="low",e.auto="auto",e.high="high"}(Lo||(Lo={})),function(e){e.low="low",e.medium="medium",e.high="high"}(Mo||(Mo={}));var zo,Uo=((wo={})[Lo.low]=0,wo[Lo.auto]=1,wo[Lo.high]=2,wo),Vo={0:Lo.low,1:Lo.auto,2:Lo.high},Bo=a.nativeEnum(Lo),$o=a.nativeEnum(Mo),Ho={assistant:"",id:"",name:"",description:"",instructions:"",conversation_starters:[],model:"",functions:[],code_interpreter:!1,image_vision:!1,retrieval:!1,append_current_datetime:!1},Go=((No={agent:{},id:"",name:"",description:"",instructions:"",model:"",model_parameters:{},tools:[],provider:{},projectIds:[],artifacts:"",isCollaborative:!1})[so.execute_code]=!1,No[so.file_search]=!1,No),Ko=((Co={type:so.function})[so.function]={name:"image_vision",description:"Get detailed text descriptions for all current image attachments.",parameters:{type:"object",properties:{},required:[]}},Co),Wo=function(e){var t,n;return"function"===e.type&&(null===(t=e.function)||void 0===t?void 0:t.name)===(null===(n=Ko.function)||void 0===n?void 0:n.name)},Qo={model:{default:"gpt-4o"},temperature:{min:0,max:2,step:.01,default:1},top_p:{min:0,max:1,step:.01,default:1},presence_penalty:{min:0,max:2,step:.01,default:0},frequency_penalty:{min:0,max:2,step:.01,default:0},resendFiles:{default:!0},maxContextTokens:{default:void 0},max_tokens:{default:void 0},imageDetail:{default:Lo.auto,min:0,max:2,step:1}},qo={model:{default:"gemini-1.5-flash-latest"},maxOutputTokens:{min:1,max:8192,step:1,default:8192},temperature:{min:0,max:2,step:.01,default:1},topP:{min:0,max:1,step:.01,default:.95},topK:{min:1,max:40,step:1,default:40}},Zo=4096,Yo={model:{default:"claude-3-5-sonnet-latest"},temperature:{min:0,max:1,step:.01,default:1},promptCache:{default:!0},thinking:{default:!0},thinkingBudget:{min:1024,step:100,max:2e5,default:2e3},maxOutputTokens:{min:1,max:128e3,step:1,default:8192,reset:function(e){return/claude-3[-.]5-sonnet/.test(e)||/claude-3[-.]7/.test(e)?8192:4096},set:function(e,t){return!/claude-3[-.]5-sonnet/.test(t)&&!/claude-3[-.]7/.test(t)&&e>Zo?Zo:e}},topP:{min:0,max:1,step:.01,default:.7},topK:{min:1,max:40,step:1,default:5},resendFiles:{default:!0},maxContextTokens:{default:void 0},legacy:{maxOutputTokens:{min:1,max:Zo,step:1,default:Zo}}},Jo={model:{default:"gpt-3.5-turbo-test"},temperature:{min:0,max:1,step:.01,default:1},top_p:{min:0,max:1,step:.01,default:1},presence_penalty:{min:0,max:2,step:.01,default:0},frequency_penalty:{min:0,max:2,step:.01,default:0},resendFiles:{default:!0},maxContextTokens:{default:void 0},max_tokens:{default:void 0},imageDetail:{default:Lo.auto}},Xo=((ko={})[Ro.openAI]=Qo,ko[Ro.google]=qo,ko[Ro.anthropic]=Yo,ko[Ro.agents]=Jo,ko[Ro.bedrock]=Jo,ko),ei=Xo[Ro.google],ti=a.nativeEnum(Ro),ni=a.union([ti,a.string()]),ai=a.object({authField:a.string(),label:a.string(),description:a.string()}),si=a.object({name:a.string(),pluginKey:a.string(),description:a.string(),icon:a.string().optional(),authConfig:a.array(ai).optional(),authenticated:a.boolean().optional(),isButton:a.boolean().optional(),toolkit:a.boolean().optional()}),ri=a.object({input:a.object({content:a.string()}),output:a.object({content:a.string()})});!function(e){e.functions="functions",e.classic="classic"}(zo||(zo={}));var oi={default:0},ii=(zo.functions,zo.functions,zo.classic,{default:!0});a.nativeEnum(zo);var li=a.object({agent:a.string().default(zo.functions),skipCompletion:a.boolean().default(ii.default),model:a.string(),temperature:a.number().default(oi.default)}),ci=a.object({messageId:a.string(),endpoint:a.string().optional(),clientId:a.string().nullable().optional(),conversationId:a.string().nullable(),parentMessageId:a.string().nullable(),responseMessageId:a.string().nullable().optional(),overrideParentMessageId:a.string().nullable().optional(),bg:a.string().nullable().optional(),model:a.string().nullable().optional(),title:a.string().nullable().or(a.literal("New Chat")).default("New Chat"),sender:a.string().optional(),text:a.string(),generation:a.string().nullable().optional(),isCreatedByUser:a.boolean(),error:a.boolean().optional(),clientTimestamp:a.string().optional(),createdAt:a.string().optional().default((function(){return(new Date).toISOString()})),updatedAt:a.string().optional().default((function(){return(new Date).toISOString()})),current:a.boolean().optional(),unfinished:a.boolean().optional(),searchResult:a.boolean().optional(),finish_reason:a.string().optional(),thread_id:a.string().optional(),iconURL:a.string().nullable().optional()}),di=a.union([a.number(),a.string()]).transform((function(e){return"string"==typeof e?""===e.trim()?void 0:parseFloat(e):e})),ui=a.lazy((function(){return a.union([a.null(),a.boolean(),a.number(),a.string(),a.array(a.lazy((function(){return ui}))),a.record(a.lazy((function(){return ui})))])})),mi=a.object({conversationId:a.string().nullable(),endpoint:ti.nullable(),endpointType:ti.nullable().optional(),isArchived:a.boolean().optional(),title:a.string().nullable().or(a.literal("New Chat")).default("New Chat"),user:a.string().optional(),messages:a.array(a.string()).optional(),tools:a.union([a.array(si),a.array(a.string())]).optional(),modelLabel:a.string().nullable().optional(),userLabel:a.string().optional(),model:a.string().nullable().optional(),promptPrefix:a.string().nullable().optional(),temperature:a.number().optional(),topP:a.number().optional(),topK:a.number().optional(),top_p:a.number().optional(),frequency_penalty:a.number().optional(),presence_penalty:a.number().optional(),parentMessageId:a.string().optional(),maxOutputTokens:di.optional(),maxContextTokens:di.optional(),max_tokens:di.optional(),promptCache:a.boolean().optional(),system:a.string().optional(),thinking:a.boolean().optional(),thinkingBudget:di.optional(),artifacts:a.string().optional(),context:a.string().nullable().optional(),examples:a.array(ri).optional(),tags:a.array(a.string()).optional(),createdAt:a.string(),updatedAt:a.string(),resendFiles:a.boolean().optional(),file_ids:a.array(a.string()).optional(),imageDetail:Bo.optional(),reasoning_effort:$o.optional(),assistant_id:a.string().optional(),agent_id:a.string().optional(),region:a.string().optional(),maxTokens:di.optional(),additionalModelRequestFields:ui.optional(),instructions:a.string().optional(),additional_instructions:a.string().optional(),append_current_datetime:a.boolean().optional(),presetOverride:a.record(a.unknown()).optional(),stop:a.array(a.string()).optional(),greeting:a.string().optional(),spec:a.string().nullable().optional(),iconURL:a.string().nullable().optional(),expiredAt:a.string().nullable().optional(),resendImages:a.boolean().optional(),agentOptions:li.nullable().optional(),chatGptLabel:a.string().nullable().optional()}),pi=mi.omit({conversationId:!0,createdAt:!0,updatedAt:!0,title:!0}).merge(a.object({conversationId:a.string().nullable().optional(),presetId:a.string().nullable().optional(),title:a.string().nullable().optional(),defaultPreset:a.boolean().optional(),order:a.number().optional(),endpoint:ni.nullable()})),gi=mi.merge(a.object({endpoint:ni.nullable()})),fi=mi.pick({maxContextTokens:!0,resendFiles:!0,imageDetail:!0,promptPrefix:!0,model:!0,temperature:!0,presence_penalty:!0,frequency_penalty:!0,stop:!0,top_p:!0,max_tokens:!0,topP:!0,topK:!0,maxOutputTokens:!0,promptCache:!0,thinking:!0,thinkingBudget:!0,region:!0,maxTokens:!0,agent_id:!0,assistant_id:!0,append_current_datetime:!0,instructions:!0}).merge(a.object({endpoint:ni.nullable()}));a.object({conversationId:a.string(),shareId:a.string(),messages:a.array(a.string()),isPublic:a.boolean(),title:a.string(),createdAt:a.string(),updatedAt:a.string()}),a.object({_id:a.string(),user:a.string(),tag:a.string(),description:a.string().optional(),createdAt:a.string(),updatedAt:a.string(),count:a.number(),position:a.number()});var xi=mi.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,artifacts:!0,topP:!0,topK:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){return bi(e)})).catch((function(){return{}}));a.object({maxOutputTokens:di.optional(),temperature:di.optional(),topP:di.optional(),topK:di.optional(),presencePenalty:di.optional(),frequencyPenalty:di.optional(),stopSequences:a.array(a.string()).optional()}).strip().optional();var hi=mi.pick({model:!0}).transform((function(e){var t;return mo(mo({},e),{model:null!==(t=e.model)&&void 0!==t?t:"text-davinci-002-render-sha"})})).catch((function(){return{model:"text-davinci-002-render-sha"}})),vi=mi.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,artifacts:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t,n,a,s,r,o,i,l,c,d,u,m,p,g,f=mo(mo({},e),{model:null!==(t=e.model)&&void 0!==t?t:"gpt-3.5-turbo",chatGptLabel:null!==(a=null!==(n=e.chatGptLabel)&&void 0!==n?n:e.modelLabel)&&void 0!==a?a:null,promptPrefix:null!==(s=e.promptPrefix)&&void 0!==s?s:null,temperature:null!==(r=e.temperature)&&void 0!==r?r:.8,top_p:null!==(o=e.top_p)&&void 0!==o?o:1,presence_penalty:null!==(i=e.presence_penalty)&&void 0!==i?i:0,frequency_penalty:null!==(l=e.frequency_penalty)&&void 0!==l?l:0,tools:null!==(c=e.tools)&&void 0!==c?c:[],agentOptions:null!==(d=e.agentOptions)&&void 0!==d?d:{agent:zo.functions,skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0},iconURL:null!==(u=e.iconURL)&&void 0!==u?u:void 0,greeting:null!==(m=e.greeting)&&void 0!==m?m:void 0,spec:null!==(p=e.spec)&&void 0!==p?p:void 0,maxContextTokens:null!==(g=e.maxContextTokens)&&void 0!==g?g:void 0});return null!=e.modelLabel&&""!==e.modelLabel&&(f.modelLabel=null),f})).catch((function(){return{model:"gpt-3.5-turbo",chatGptLabel:null,promptPrefix:null,temperature:.8,top_p:1,presence_penalty:0,frequency_penalty:0,tools:[],agentOptions:{agent:zo.functions,skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0},iconURL:void 0,greeting:void 0,spec:void 0,maxContextTokens:void 0}}));function bi(e,t){var n=mo({},e);return Object.keys(n).forEach((function(e){null==n[e]&&delete n[e]})),n}var yi,_i,ji,wi=mi.pick({model:!0,assistant_id:!0,instructions:!0,artifacts:!0,promptPrefix:!0,iconURL:!0,greeting:!0,spec:!0,append_current_datetime:!0}).transform((function(e){var t,n,a,s,r,o,i,l;return mo(mo({},e),{model:null!==(t=e.model)&&void 0!==t?t:Qo.model.default,assistant_id:null!==(n=e.assistant_id)&&void 0!==n?n:void 0,instructions:null!==(a=e.instructions)&&void 0!==a?a:void 0,promptPrefix:null!==(s=e.promptPrefix)&&void 0!==s?s:null,iconURL:null!==(r=e.iconURL)&&void 0!==r?r:void 0,greeting:null!==(o=e.greeting)&&void 0!==o?o:void 0,spec:null!==(i=e.spec)&&void 0!==i?i:void 0,append_current_datetime:null!==(l=e.append_current_datetime)&&void 0!==l&&l})})).catch((function(){return{model:Qo.model.default,assistant_id:void 0,instructions:void 0,promptPrefix:null,iconURL:void 0,greeting:void 0,spec:void 0,append_current_datetime:!1}})),Ni=mi.pick({model:!0,assistant_id:!0,instructions:!0,promptPrefix:!0,artifacts:!0,iconURL:!0,greeting:!0,spec:!0}).transform((function(e){return bi(e)})).catch((function(){return{}}));mi.pick({model:!0,modelLabel:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendFiles:!0,imageDetail:!0,agent_id:!0,instructions:!0,promptPrefix:!0,iconURL:!0,greeting:!0,maxContextTokens:!0}).transform((function(e){var t,n,a,s,r,o,i,l,c,d,u,m,p;return mo(mo({},e),{model:null!==(t=e.model)&&void 0!==t?t:Jo.model.default,modelLabel:null!==(n=e.modelLabel)&&void 0!==n?n:null,temperature:null!==(a=e.temperature)&&void 0!==a?a:1,top_p:null!==(s=e.top_p)&&void 0!==s?s:1,presence_penalty:null!==(r=e.presence_penalty)&&void 0!==r?r:0,frequency_penalty:null!==(o=e.frequency_penalty)&&void 0!==o?o:0,resendFiles:"boolean"==typeof e.resendFiles?e.resendFiles:Jo.resendFiles.default,imageDetail:null!==(i=e.imageDetail)&&void 0!==i?i:Lo.auto,agent_id:null!==(l=e.agent_id)&&void 0!==l?l:void 0,instructions:null!==(c=e.instructions)&&void 0!==c?c:void 0,promptPrefix:null!==(d=e.promptPrefix)&&void 0!==d?d:null,iconURL:null!==(u=e.iconURL)&&void 0!==u?u:void 0,greeting:null!==(m=e.greeting)&&void 0!==m?m:void 0,maxContextTokens:null!==(p=e.maxContextTokens)&&void 0!==p?p:void 0})})).catch((function(){return{model:Jo.model.default,modelLabel:null,temperature:1,top_p:1,presence_penalty:0,frequency_penalty:0,resendFiles:Jo.resendFiles.default,imageDetail:Lo.auto,agent_id:void 0,instructions:void 0,promptPrefix:null,iconURL:void 0,greeting:void 0,maxContextTokens:void 0}}));var Ci=mi.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendFiles:!0,artifacts:!0,imageDetail:!0,stop:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0,max_tokens:!0,reasoning_effort:!0}).transform((function(e){return bi(e)})).catch((function(){return{}})),ki=mi.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,artifacts:!0,topP:!0,topK:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t=mo({},e);return t.temperature===ei.temperature.default&&delete t.temperature,t.maxOutputTokens===ei.maxOutputTokens.default&&delete t.maxOutputTokens,t.topP===ei.topP.default&&delete t.topP,t.topK===ei.topK.default&&delete t.topK,bi(t)})).catch((function(){return{}})),Si=mi.pick({model:!0,modelLabel:!0,promptPrefix:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0,resendFiles:!0,promptCache:!0,thinking:!0,thinkingBudget:!0,artifacts:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){return bi(e)})).catch((function(){return{}})),Ti=mi.pick({model:!0}).transform((function(e){return bi(mo({},e))})).catch((function(){return{}})),Ri=mi.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t,n=mo({},e);return null===n.modelLabel&&delete n.modelLabel,null===n.chatGptLabel&&delete n.chatGptLabel,null===n.promptPrefix&&delete n.promptPrefix,.8===n.temperature&&delete n.temperature,1===n.top_p&&delete n.top_p,0===n.presence_penalty&&delete n.presence_penalty,0===n.frequency_penalty&&delete n.frequency_penalty,0===(null===(t=n.tools)||void 0===t?void 0:t.length)&&delete n.tools,n.agentOptions&&n.agentOptions.agent===zo.functions&&!0===n.agentOptions.skipCompletion&&"gpt-3.5-turbo"===n.agentOptions.model&&0===n.agentOptions.temperature&&delete n.agentOptions,bi(n)})).catch((function(){return{}}));a.object({bannerId:a.string(),message:a.string(),displayFrom:a.string(),displayTo:a.string(),createdAt:a.string(),updatedAt:a.string(),isPublic:a.boolean()});var Ii=mi.pick({spec:!0,iconURL:!0,greeting:!0,agent_id:!0,resendFiles:!0,instructions:!0,additional_instructions:!0}).transform((function(e){return bi(e)})).catch((function(){return{}})),Ei=mi.pick({modelLabel:!0,promptPrefix:!0,resendFiles:!0,iconURL:!0,greeting:!0,spec:!0,maxOutputTokens:!0,maxContextTokens:!0,artifacts:!0,region:!0,system:!0,model:!0,maxTokens:!0,temperature:!0,topP:!0,stop:!0,topK:!0,additionalModelRequestFields:!0}).transform((function(e){return bi(e)})).catch((function(){return{}}));mi.pick({modelLabel:!0,promptPrefix:!0,resendFiles:!0,iconURL:!0,greeting:!0,spec:!0,artifacts:!0,maxOutputTokens:!0,maxContextTokens:!0,region:!0,model:!0,maxTokens:!0,temperature:!0,topP:!0,stop:!0,topK:!0,additionalModelRequestFields:!0}).catchall(a.any()).transform((function(e){var t=["modelLabel","promptPrefix","resendFiles","iconURL","greeting","spec","maxOutputTokens","artifacts","additionalModelRequestFields","region","model","maxTokens","temperature","topP","stop"],n={},a=e;return Object.entries(a).forEach((function(e){var s=e[0],r=e[1];t.includes(s)||("topK"===s?n.top_k=r:n[s]=r,delete a[s])})),Object.keys(n).length>0&&(a.additionalModelRequestFields=mo(mo({},a.additionalModelRequestFields||{}),n)),void 0!==a.maxOutputTokens?a.maxTokens=a.maxOutputTokens:void 0!==a.maxTokens&&(a.maxOutputTokens=a.maxTokens),bi(a)})).catch((function(){return{}}));var Pi=a.object({name:a.string(),label:a.string(),preset:pi,order:a.number().optional(),default:a.boolean().optional(),description:a.string().optional(),showIconInMenu:a.boolean().optional(),showIconInHeader:a.boolean().optional(),iconURL:a.union([a.string(),ti]).optional(),authType:Io.optional()}),Li=a.object({enforce:a.boolean().default(!1),prioritize:a.boolean().default(!0),list:a.array(Pi).min(1)}),Mi=((yi={})[Ro.openAI]=!0,yi[Ro.google]=!0,yi[Ro.assistants]=!0,yi[Ro.azureAssistants]=!0,yi[Ro.agents]=!0,yi[Ro.azureOpenAI]=!0,yi[Ro.anthropic]=!0,yi[Ro.custom]=!0,yi[Ro.bedrock]=!0,yi),Ai=["application/vnd.ms-excel","application/msexcel","application/x-msexcel","application/x-ms-excel","application/x-excel","application/x-dos_ms_excel","application/xls","application/x-xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];xo(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","text/vtt","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip","image/svg","image/svg+xml"],Ai,!0),xo(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip"],Ai,!0);var Oi=/\.(jpg|jpeg|png|gif|webp)$/i,Di=/^application\/(vnd\.ms-excel|msexcel|x-msexcel|x-ms-excel|x-excel|x-dos_ms_excel|xls|x-xls|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet)$/,Fi=[/^(text\/(x-c|x-csharp|x-c\+\+|x-java|html|markdown|x-php|x-python|x-script\.python|x-ruby|x-tex|plain|css|vtt|javascript|csv))$/,Di,/^(application\/(epub\+zip|csv|json|pdf|x-tar|typescript|vnd\.openxmlformats-officedocument\.(wordprocessingml\.document|presentationml\.presentation|spreadsheetml\.sheet)|xml|zip))$/,/^image\/(jpeg|gif|png|webp)$/,/^image\/(svg|svg\+xml)$/],zi={c:"text/x-c",cs:"text/x-csharp",cpp:"text/x-c++",md:"text/markdown",php:"text/x-php",py:"text/x-python",rb:"text/x-ruby",tex:"text/x-tex",js:"text/javascript",sh:"application/x-sh",ts:"application/typescript",tar:"application/x-tar",zip:"application/zip",yml:"application/x-yaml",yaml:"application/x-yaml",log:"text/plain"},Ui=[/^(text\/(x-c|x-c\+\+|html|x-java|markdown|x-php|x-python|x-script\.python|x-ruby|x-tex|plain|vtt|xml))$/,/^(application\/(json|pdf|vnd\.openxmlformats-officedocument\.(wordprocessingml\.document|presentationml\.presentation)))$/],Vi=1048576,Bi=function(e){return e*Vi},$i=Bi(512),Hi={fileLimit:10,fileSizeLimit:$i,totalSizeLimit:$i,supportedMimeTypes:Fi,disabled:!1},Gi={endpoints:(_i={},_i[Ro.assistants]=Hi,_i[Ro.azureAssistants]=Hi,_i[Ro.agents]=Hi,_i.default={fileLimit:10,fileSizeLimit:$i,totalSizeLimit:$i,supportedMimeTypes:Fi,disabled:!1},_i),serverFileSizeLimit:$i,avatarSizeLimit:Bi(2),checkType:function(e,t){return void 0===t&&(t=Fi),t.some((function(t){return t.test(e)}))}},Ki=a.array(a.any()).optional().refine((function(e){return!e||e.every((function(e){return e instanceof RegExp||"string"==typeof e}))}),{message:"Each mimeType must be a string or a RegExp object."}),Wi=a.object({disabled:a.boolean().optional(),fileLimit:a.number().min(0).optional(),fileSizeLimit:a.number().min(0).optional(),totalSizeLimit:a.number().min(0).optional(),supportedMimeTypes:Ki.optional()}),Qi=a.object({endpoints:a.record(Wi).optional(),serverFileSizeLimit:a.number().min(0).optional(),avatarSizeLimit:a.number().min(0).optional()}),qi=function(e){return e.reduce((function(e,t){try{var n=new RegExp(t);e.push(n)}catch(a){console.error('Invalid regex pattern "'.concat(t,'" skipped.'))}return e}),[])};function Zi(e){var t=Gi;if(!e)return t;if(void 0!==e.serverFileSizeLimit&&(t.serverFileSizeLimit=Bi(e.serverFileSizeLimit)),void 0!==e.avatarSizeLimit&&(t.avatarSizeLimit=Bi(e.avatarSizeLimit)),!e.endpoints)return t;var n=function(n){var a=e.endpoints[n];t.endpoints[n]||(t.endpoints[n]={});var s=t.endpoints[n];if(!0===a.disabled)return s.disabled=!0,s.fileLimit=0,s.fileSizeLimit=0,s.totalSizeLimit=0,s.supportedMimeTypes=[],"continue";void 0!==a.fileSizeLimit&&(s.fileSizeLimit=Bi(a.fileSizeLimit)),void 0!==a.totalSizeLimit&&(s.totalSizeLimit=Bi(a.totalSizeLimit)),["fileLimit"].forEach((function(e){void 0!==a[e]&&(s[e]=a[e])})),a.supportedMimeTypes&&(s.supportedMimeTypes=qi(a.supportedMimeTypes))};for(var a in e.endpoints)n(a);return t}!function(e){e.local="local",e.firebase="firebase",e.azure="azure",e.openai="openai",e.s3="s3",e.vectordb="vectordb",e.execute_code="execute_code"}(ji||(ji={}));var Yi,Ji=function(e){return e===ji.openai||e===ji.azure};!function(e){e.avatar="avatar",e.unknown="unknown",e.agents="agents",e.assistants="assistants",e.execute_code="execute_code",e.image_generation="image_generation",e.assistants_output="assistants_output",e.message_attachment="message_attachment",e.filename="filename",e.updatedAt="updatedAt",e.source="source",e.filterSource="filterSource",e.context="context",e.bytes="bytes"}(Yi||(Yi={}));var Xi,el,tl,nl,al,sl,rl,ol,il,ll=a.object({iconPath:a.string().optional()}),cl=ll.extend({type:a.literal("stdio").optional(),command:a.string(),args:a.array(a.string()),env:a.record(a.string(),a.string()).optional(),stderr:a.any().optional()}),dl=ll.extend({type:a.literal("websocket").optional(),url:a.string().url().refine((function(e){var t=new URL(e).protocol;return"ws:"===t||"wss:"===t}),{message:"WebSocket URL must start with ws:// or wss://"})}),ul=ll.extend({type:a.literal("sse").optional(),url:a.string().url().refine((function(e){var t=new URL(e).protocol;return"ws:"!==t&&"wss:"!==t}),{message:"SSE URL must not start with ws:// or wss://"})}),ml=a.union([cl,dl,ul]),pl=a.record(a.string(),ml),gl=new Set(["conversationId","title","iconURL","greeting","endpoint","endpointType","createdAt","updatedAt","expiredAt","messages","isArchived","tags","user","__v","_id","tools","model","files"]);!function(e){e.default="default",e.advanced="advanced"}(il||(il={}));var fl=a.nativeEnum(ji);var xl,hl,vl=a.object({deploymentName:a.string().optional(),version:a.string().optional(),assistants:a.boolean().optional()}).or(a.boolean()),bl=a.object({apiKey:a.string(),serverless:a.boolean().optional(),instanceName:a.string().optional(),deploymentName:a.string().optional(),assistants:a.boolean().optional(),addParams:a.record(a.any()).optional(),dropParams:a.array(a.string()).optional(),forcePrompt:a.boolean().optional(),version:a.string().optional(),baseURL:a.string().optional(),additionalHeaders:a.record(a.any()).optional()}),yl=a.object({group:a.string(),models:a.record(a.string(),vl)}).required().and(bl),_l=a.array(yl).min(1);!function(e){e.code_interpreter="code_interpreter",e.image_vision="image_vision",e.retrieval="retrieval",e.actions="actions",e.tools="tools"}(xl||(xl={})),function(e){e.hide_sequential_outputs="hide_sequential_outputs",e.end_after_tools="end_after_tools",e.execute_code="execute_code",e.file_search="file_search",e.artifacts="artifacts",e.actions="actions",e.tools="tools"}(hl||(hl={}));var jl,wl=((Xi={})[Ro.assistants]=2,Xi[Ro.azureAssistants]=1,Xi),Nl=a.object({streamRate:a.number().optional(),baseURL:a.string().optional(),titlePrompt:a.string().optional(),titleModel:a.string().optional()});Nl.merge(a.object({availableRegions:a.array(a.string()).optional()}));var Cl=Nl.merge(a.object({disableBuilder:a.boolean().optional(),pollIntervalMs:a.number().optional(),timeoutMs:a.number().optional(),version:a.union([a.string(),a.number()]).default(2),supportedIds:a.array(a.string()).min(1).optional(),excludedIds:a.array(a.string()).min(1).optional(),privateAssistants:a.boolean().optional(),retrievalModels:a.array(a.string()).min(1).optional().default(["gpt-4o","o1-preview-2024-09-12","o1-preview","o1-mini-2024-09-12","o1-mini","chatgpt-4o-latest","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini","gpt-4o-mini-2024-07-18","gpt-4-turbo-preview","gpt-3.5-turbo-0125","gpt-4-0125-preview","gpt-4-1106-preview","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-4-turbo","gpt-4-0125","gpt-4-1106"]),capabilities:a.array(a.nativeEnum(xl)).optional().default([xl.code_interpreter,xl.image_vision,xl.retrieval,xl.actions,xl.tools]),apiKey:a.string().optional(),models:a.object({default:a.array(a.string()).min(1),fetch:a.boolean().optional(),userIdQuery:a.boolean().optional()}).optional(),titleConvo:a.boolean().optional(),titleMethod:a.union([a.literal("completion"),a.literal("functions")]).optional(),headers:a.record(a.any()).optional()})),kl=Nl.merge(a.object({recursionLimit:a.number().optional(),disableBuilder:a.boolean().optional(),capabilities:a.array(a.nativeEnum(hl)).optional().default([hl.execute_code,hl.file_search,hl.artifacts,hl.actions,hl.tools])})),Sl=Nl.merge(a.object({name:a.string().refine((function(e){return!ti.safeParse(e).success}),{message:"Value cannot be one of the default endpoint (EModelEndpoint) values: ".concat(Object.values(Ro).join(", "))}),apiKey:a.string(),baseURL:a.string(),models:a.object({default:a.array(a.string()).min(1),fetch:a.boolean().optional(),userIdQuery:a.boolean().optional()}),titleConvo:a.boolean().optional(),titleMethod:a.union([a.literal("completion"),a.literal("functions")]).optional(),summarize:a.boolean().optional(),summaryModel:a.string().optional(),forcePrompt:a.boolean().optional(),modelDisplayLabel:a.string().optional(),headers:a.record(a.any()).optional(),addParams:a.record(a.any()).optional(),dropParams:a.array(a.string()).optional(),customOrder:a.number().optional(),directEndpoint:a.boolean().optional(),titleMessageRole:a.string().optional()})),Tl=a.object({groups:_l,plugins:a.boolean().optional(),assistants:a.boolean().optional()}).and(Sl.pick({streamRate:!0,titleConvo:!0,titleMethod:!0,titleModel:!0,summarize:!0,summaryModel:!0,customOrder:!0}).partial()),Rl=a.object({url:a.string().optional(),apiKey:a.string(),model:a.string(),voices:a.array(a.string())}),Il=a.object({instanceName:a.string(),apiKey:a.string(),deploymentName:a.string(),apiVersion:a.string(),model:a.string(),voices:a.array(a.string())}),El=a.object({url:a.string().optional(),websocketUrl:a.string().optional(),apiKey:a.string(),model:a.string(),voices:a.array(a.string()),voice_settings:a.object({similarity_boost:a.number().optional(),stability:a.number().optional(),style:a.number().optional(),use_speaker_boost:a.boolean().optional()}).optional(),pronunciation_dictionary_locators:a.array(a.string()).optional()}),Pl=a.object({url:a.string(),apiKey:a.string().optional(),voices:a.array(a.string()),backend:a.string()}),Ll=a.object({openai:Rl.optional(),azureOpenAI:Il.optional(),elevenlabs:El.optional(),localai:Pl.optional()}),Ml=a.object({url:a.string().optional(),apiKey:a.string(),model:a.string()}),Al=a.object({instanceName:a.string(),apiKey:a.string(),deploymentName:a.string(),apiVersion:a.string()}),Ol=a.object({openai:Ml.optional(),azureOpenAI:Al.optional()}),Dl=a.object({conversationMode:a.boolean().optional(),advancedMode:a.boolean().optional(),speechToText:a.boolean().optional().or(a.object({engineSTT:a.string().optional(),languageSTT:a.string().optional(),autoTranscribeAudio:a.boolean().optional(),decibelValue:a.number().optional(),autoSendText:a.number().optional()})).optional(),textToSpeech:a.boolean().optional().or(a.object({engineTTS:a.string().optional(),voice:a.string().optional(),languageTTS:a.string().optional(),automaticPlayback:a.boolean().optional(),playbackRate:a.number().optional(),cacheTTS:a.boolean().optional()})).optional()}).optional();!function(e){e.FILE_UPLOAD="FILE_UPLOAD",e.IMPORT="IMPORT",e.TTS="TTS",e.STT="STT"}(jl||(jl={}));var Fl,zl=a.object({fileUploads:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),conversationsImport:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),tts:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),stt:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional()});!function(e){e.PNG="png",e.WEBP="webp",e.JPEG="jpeg"}(Fl||(Fl={}));var Ul,Vl,Bl=a.object({externalUrl:a.string().optional(),openNewTab:a.boolean().optional(),modalAcceptance:a.boolean().optional(),modalTitle:a.string().optional(),modalContent:a.string().or(a.array(a.string())).optional()}),$l=a.object({privacyPolicy:a.object({externalUrl:a.string().optional(),openNewTab:a.boolean().optional()}).optional(),termsOfService:Bl.optional(),customWelcome:a.string().optional(),endpointsMenu:a.boolean().optional(),modelSelect:a.boolean().optional(),parameters:a.boolean().optional(),sidePanel:a.boolean().optional(),multiConvo:a.boolean().optional(),bookmarks:a.boolean().optional(),presets:a.boolean().optional(),prompts:a.boolean().optional(),agents:a.boolean().optional(),temporaryChat:a.boolean().optional(),runCode:a.boolean().optional()}).default({endpointsMenu:!0,modelSelect:!0,parameters:!0,sidePanel:!0,presets:!0,multiConvo:!0,bookmarks:!0,prompts:!0,agents:!0,temporaryChat:!0,runCode:!0}),Hl=a.object({version:a.string(),cache:a.boolean().default(!0),secureImageLinks:a.boolean().optional(),imageOutputType:a.nativeEnum(Fl).default(Fl.PNG),includedTools:a.array(a.string()).optional(),filteredTools:a.array(a.string()).optional(),mcpServers:pl.optional(),interface:$l,fileStrategy:fl.default(ji.local),actions:a.object({allowedDomains:a.array(a.string()).optional()}).optional(),registration:a.object({socialLogins:a.array(a.string()).optional(),allowedDomains:a.array(a.string()).optional()}).default({socialLogins:["google","facebook","openid","github","discord"]}),speech:a.object({tts:Ll.optional(),stt:Ol.optional(),speechTab:Dl.optional()}).optional(),rateLimits:zl.optional(),fileConfig:Qi.optional(),modelSpecs:Li.optional(),endpoints:a.object((el={all:Nl.optional()},el[Ro.openAI]=Nl.optional(),el[Ro.google]=Nl.optional(),el[Ro.anthropic]=Nl.optional(),el[Ro.gptPlugins]=Nl.optional(),el[Ro.azureOpenAI]=Tl.optional(),el[Ro.azureAssistants]=Cl.optional(),el[Ro.assistants]=Cl.optional(),el[Ro.agents]=kl.optional(),el[Ro.custom]=a.array(Sl.partial()).optional(),el[Ro.bedrock]=Nl.optional(),el)).strict().refine((function(e){return Object.keys(e).length>0}),{message:"At least one `endpoints` field must be provided."}).optional()}),Gl=function(){return e=Hl.shape,t=Object.entries(e).map((function(e){var t=e[0],n=e[1];return n instanceof a.ZodDefault?[t,n._def.defaultValue()]:[t,void 0]})),Object.fromEntries(t);var e,t};!function(e){e.anyscale="anyscale",e.apipie="apipie",e.cohere="cohere",e.fireworks="fireworks",e.deepseek="deepseek",e.groq="groq",e.huggingface="huggingface",e.mistral="mistral",e.mlx="mlx",e.ollama="ollama",e.openrouter="openrouter",e.perplexity="perplexity",e.shuttleai="shuttleai",e["together.ai"]="together.ai",e.unify="unify",e.xai="xai"}(Ul||(Ul={})),(Vl||(Vl={})).openrouter="openrouter";var Kl,Wl=[Ro.openAI,Ro.assistants,Ro.azureAssistants,Ro.azureOpenAI,Ro.agents,Ro.chatGPTBrowser,Ro.gptPlugins,Ro.google,Ro.anthropic,Ro.custom,Ro.bedrock],Ql=((tl={})[Ro.openAI]="OpenAI",tl[Ro.assistants]="Assistants",tl[Ro.agents]="Agents",tl[Ro.azureAssistants]="Azure Assistants",tl[Ro.azureOpenAI]="Azure OpenAI",tl[Ro.chatGPTBrowser]="ChatGPT",tl[Ro.gptPlugins]="Plugins",tl[Ro.google]="Google",tl[Ro.anthropic]="Anthropic",tl[Ro.custom]="Custom",tl[Ro.bedrock]="AWS Bedrock",tl[Ul.ollama]="Ollama",tl[Ul.deepseek]="DeepSeek",tl[Ul.xai]="xAI",tl),ql=["gpt-4o-mini","gpt-4o","gpt-3.5-turbo","gpt-3.5-turbo-0125","gpt-4-turbo","gpt-4-turbo-2024-04-09","gpt-4-0125-preview","gpt-4-turbo-preview","gpt-4-1106-preview","gpt-3.5-turbo-1106","gpt-3.5-turbo-16k-0613","gpt-3.5-turbo-16k","gpt-4","gpt-4-0314","gpt-4-32k-0314","gpt-4-0613","gpt-3.5-turbo-0613"],Zl=((nl={})[Ro.azureAssistants]=ql,nl[Ro.assistants]=xo(["chatgpt-4o-latest"],ql,!0),nl[Ro.agents]=ql,nl[Ro.google]=["gemini-2.0-flash-001","gemini-2.0-flash-exp","gemini-2.0-flash-lite","gemini-2.0-pro-exp-02-05","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro-001","gemini-1.5-pro-002","gemini-1.0-pro-001"],nl[Ro.anthropic]=["claude-3-7-sonnet-latest","claude-3-7-sonnet-20250219","claude-3-5-haiku-20241022","claude-3-5-sonnet-20241022","claude-3-5-sonnet-20240620","claude-3-5-sonnet-latest","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307","claude-2.1","claude-2","claude-1.2","claude-1","claude-1-100k","claude-instant-1","claude-instant-1-100k"],nl[Ro.openAI]=xo(xo(["chatgpt-4o-latest"],ql,!0),["gpt-4-vision-preview","gpt-3.5-turbo-instruct-0914","gpt-3.5-turbo-instruct"],!1),nl[Ro.bedrock]=["anthropic.claude-3-5-sonnet-20241022-v2:0","anthropic.claude-3-5-sonnet-20240620-v1:0","anthropic.claude-3-5-haiku-20241022-v1:0","anthropic.claude-3-haiku-20240307-v1:0","anthropic.claude-3-opus-20240229-v1:0","anthropic.claude-3-sonnet-20240229-v1:0","anthropic.claude-v2","anthropic.claude-v2:1","anthropic.claude-instant-v1","cohere.command-r-v1:0","cohere.command-r-plus-v1:0","meta.llama2-13b-chat-v1","meta.llama2-70b-chat-v1","meta.llama3-8b-instruct-v1:0","meta.llama3-70b-instruct-v1:0","meta.llama3-1-8b-instruct-v1:0","meta.llama3-1-70b-instruct-v1:0","meta.llama3-1-405b-instruct-v1:0","mistral.mistral-7b-instruct-v0:2","mistral.mixtral-8x7b-instruct-v0:1","mistral.mistral-large-2402-v1:0","mistral.mistral-large-2407-v1:0","mistral.mistral-small-2402-v1:0","ai21.jamba-instruct-v1:0","amazon.titan-text-lite-v1","amazon.titan-text-express-v1","amazon.titan-text-premier-v1:0"],nl),Yl=Zl[Ro.openAI];(al={initial:[]})[Ro.openAI]=Yl,al[Ro.assistants]=Yl.filter((function(e){return/gpt-4|gpt-3\\.5/i.test(e)&&!/vision|instruct/i.test(e)})),al[Ro.agents]=Yl,al[Ro.gptPlugins]=Yl,al[Ro.azureOpenAI]=Yl,al[Ro.chatGPTBrowser]=["text-davinci-002-render-sha"],al[Ro.google]=Zl[Ro.google],al[Ro.anthropic]=Zl[Ro.anthropic],al[Ro.bedrock]=Zl[Ro.bedrock];var Jl=((sl={})[Ro.openAI]="/api/ask/".concat(Ro.openAI),sl[Ro.google]="/api/ask/".concat(Ro.google),sl[Ro.custom]="/api/ask/".concat(Ro.custom),sl[Ro.anthropic]="/api/ask/".concat(Ro.anthropic),sl[Ro.gptPlugins]="/api/ask/".concat(Ro.gptPlugins),sl[Ro.azureOpenAI]="/api/ask/".concat(Ro.azureOpenAI),sl[Ro.chatGPTBrowser]="/api/ask/".concat(Ro.chatGPTBrowser),sl[Ro.azureAssistants]="/api/assistants/v1/chat",sl[Ro.assistants]="/api/assistants/v2/chat",sl[Ro.agents]="/api/".concat(Ro.agents,"/chat"),sl[Ro.bedrock]="/api/".concat(Ro.bedrock,"/chat"),sl),Xl=new Set([Ro.gptPlugins,Ro.anthropic,Ro.google,Ro.openAI,Ro.azureOpenAI,Ro.custom,Ro.agents,Ro.bedrock]);(rl={})[Ro.custom]=!0,rl[Ro.openAI]=!0,rl[Ro.anthropic]=!0,rl[Ro.gptPlugins]=!0,rl[Ro.assistants]=!0,rl[Ro.agents]=!0,rl[Ro.azureAssistants]=!0,rl[Ro.azureOpenAI]=!0,rl[Ro.bedrock]=!0,function(e){e.generative="generative",e.agents="agents"}(Kl||(Kl={}));var ec,tc,nc,ac,sc,rc,oc,ic,lc,cc,dc,uc,mc,pc,gc,fc,xc,hc=new Set(["dalle","dall-e","stable-diffusion"]);!function(e){e.PROMPT_GROUPS="promptGroups",e.SHARED_LINKS="sharedLinks"}(ec||(ec={})),function(e){e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.THIRTY_MINUTES=18e5]="THIRTY_MINUTES",e[e.TEN_MINUTES=6e5]="TEN_MINUTES",e[e.FIVE_MINUTES=3e5]="FIVE_MINUTES",e[e.TWO_MINUTES=12e4]="TWO_MINUTES",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.THIRTY_SECONDS=3e4]="THIRTY_SECONDS"}(tc||(tc={})),function(e){e.CONFIG_STORE="configStore",e.ROLES="roles",e.PLUGINS="plugins",e.GEN_TITLE="genTitle",e.TOOLS="tools",e.MODELS_CONFIG="modelsConfig",e.MODEL_QUERIES="modelQueries",e.STARTUP_CONFIG="startupConfig",e.ENDPOINT_CONFIG="endpointsConfig",e.TOKEN_CONFIG="tokenConfig",e.CUSTOM_CONFIG="customConfig",e.ABORT_KEYS="abortKeys",e.OVERRIDE_CONFIG="overrideConfig",e.BANS="bans",e.ENCODED_DOMAINS="encoded_domains",e.AUDIO_RUNS="audioRuns",e.MESSAGES="messages",e.FLOWS="flows"}(nc||(nc={})),function(e){e.FILE_UPLOAD_LIMIT="file_upload_limit",e.ILLEGAL_MODEL_REQUEST="illegal_model_request",e.TOKEN_BALANCE="token_balance",e.BAN="ban",e.TTS_LIMIT="tts_limit",e.STT_LIMIT="stt_limit",e.RESET_PASSWORD_LIMIT="reset_password_limit",e.VERIFY_EMAIL_LIMIT="verify_email_limit",e.CONVO_ACCESS="convo_access",e.TOOL_CALL_LIMIT="tool_call_limit"}(ac||(ac={})),function(e){e.NO_USER_KEY="no_user_key",e.EXPIRED_USER_KEY="expired_user_key",e.INVALID_USER_KEY="invalid_user_key",e.NO_BASE_URL="no_base_url",e.MODERATION="moderation",e.INPUT_LENGTH="INPUT_LENGTH",e.INVALID_REQUEST="invalid_request_error",e.INVALID_ACTION="invalid_action_error",e.NO_SYSTEM_MESSAGES="no_system_messages",e.GOOGLE_ERROR="google_error"}(sc||(sc={})),function(e){e.GOOGLE_SERVICE_KEY="GOOGLE_SERVICE_KEY",e.GOOGLE_API_KEY="GOOGLE_API_KEY"}(rc||(rc={})),function(e){e[e.LOW=85]="LOW",e[e.HIGH=170]="HIGH",e[e.ADDITIONAL=85]="ADDITIONAL"}(oc||(oc={})),function(e){e.GENERAL="general",e.CHAT="chat",e.SPEECH="speech",e.BETA="beta",e.DATA="data",e.ACCOUNT="account",e.COMMANDS="commands"}(ic||(ic={})),function(e){e.OPENAI="openai",e.AZURE_OPENAI="azureOpenAI"}(lc||(lc={})),function(e){e.OPENAI="openai",e.AZURE_OPENAI="azureOpenAI",e.ELEVENLABS="elevenlabs",e.LOCALAI="localai"}(cc||(cc={})),function(e){e.VERSION="v0.7.7-rc1",e.CONFIG_VERSION="1.2.1",e.NO_PARENT="00000000-0000-0000-0000-000000000000",e.NEW_CONVO="new",e.SEARCH="search",e[e.ENCODED_DOMAIN_LENGTH=10]="ENCODED_DOMAIN_LENGTH",e.CURRENT_MODEL="current_model",e.COMMON_DIVIDER="__",e[e.COMMANDS_MAX_LENGTH=56]="COMMANDS_MAX_LENGTH",e[e.DEFAULT_STREAM_RATE=1]="DEFAULT_STREAM_RATE",e.SAVED_TAG="Saved",e[e.MAX_CONVO_STARTERS=4]="MAX_CONVO_STARTERS",e.GLOBAL_PROJECT_NAME="instance",e.mcp_delimiter="_mcp_"}(dc||(dc={})),function(e){e.APP_TITLE="appTitle",e.LAST_CONVO_SETUP="lastConversationSetup",e.LAST_MODEL="lastSelectedModel",e.LAST_TOOLS="lastSelectedTools",e.LAST_SPEC="lastSelectedSpec",e.FILES_TO_DELETE="filesToDelete",e.ASST_ID_PREFIX="assistant_id__",e.AGENT_ID_PREFIX="agent_id__",e.FORK_SETTING="forkSetting",e.REMEMBER_FORK_OPTION="rememberDefaultFork",e.FORK_SPLIT_AT_TARGET="splitAtTarget",e.TEXT_DRAFT="textDraft_",e.FILES_DRAFT="filesDraft_",e.LAST_PROMPT_CATEGORY="lastPromptCategory",e.ENABLE_USER_MSG_MARKDOWN="enableUserMsgMarkdown",e.SHOW_ANALYSIS_CODE="showAnalysisCode"}(uc||(uc={})),function(e){e.DIRECT_PATH="directPath",e.INCLUDE_BRANCHES="includeBranches",e.TARGET_LEVEL="targetLevel",e.DEFAULT="default"}(mc||(mc={})),function(e){e.API_URL="https://api.cohere.ai/v1",e.ROLE_USER="USER",e.ROLE_SYSTEM="SYSTEM",e.ROLE_CHATBOT="CHATBOT",e.TITLE_MESSAGE="TITLE:"}(pc||(pc={})),function(e){e.ALL="sys__all__sys",e.MY_PROMPTS="sys__my__prompts__sys",e.NO_CATEGORY="sys__no__category__sys",e.SHARED_PROMPTS="sys__shared__prompts__sys"}(gc||(gc={})),(ol={})[Ro.openAI]=Ro.openAI,ol[Ro.bedrock]=Ro.bedrock,ol[Ro.anthropic]=Ro.anthropic,ol[Ro.azureOpenAI]=Ro.azureOpenAI;var vc=((fc={})[Ro.openAI]=Ci,fc[Ro.azureOpenAI]=Ci,fc[Ro.custom]=Ci,fc[Ro.google]=xi,fc[Ro.anthropic]=Si,fc[Ro.chatGPTBrowser]=hi,fc[Ro.gptPlugins]=vi,fc[Ro.assistants]=wi,fc[Ro.azureAssistants]=wi,fc[Ro.agents]=Ii,fc[Ro.bedrock]=Ei,fc);function bc(e){for(var t,n=0,a=e;n<a.length;n++){var s=a[n];if(s){t=s;break}}return t}function yc(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a&&""!==a.trim())return a}}var _c,jc=function(e){var t,n,a=e.endpoint,s=e.endpointType,r=e.conversation,o=e.possibleValues,i=vc[a];if(!i&&!s)throw new Error("Unknown endpoint: ".concat(a));!i&&s&&(i=vc[s]);var l=null==i?void 0:i.parse(r),c=null!=o?o:{},d=c.models,u=c.secondaryModels;return d&&l&&(l.model=null!==(t=bc(d))&&void 0!==t?t:l.model),u&&(null==l?void 0:l.agentOptions)&&(l.agentOptions.model=null!==(n=bc(u))&&void 0!==n?n:l.agentOptions.model),l},wc=function(e){var t,n=e.model,a=e.endpoint,s=e.endpointType,r=e.modelDisplayLabel,o=e.chatGptLabel,i=e.modelLabel,l=null!=n?n:"",c=null!=r?r:"",d=null!=o?o:"",u=null!=i?i:"";return[Ro.openAI,Ro.bedrock,Ro.gptPlugins,Ro.azureOpenAI,Ro.chatGPTBrowser].includes(a)?d||u||(l&&/\bo1\b/i.test(l)?"o1":l&&/\bo3\b/i.test(l)?"o3":l&&l.includes("gpt-3")?"GPT-3.5":l&&l.includes("gpt-4o")?"GPT-4o":l&&l.includes("gpt-4")?"GPT-4":l&&l.includes("mistral")?"Mistral":null!==(t=Ql[a])&&void 0!==t?t:"ChatGPT"):a===Ro.anthropic?u||"Claude":a===Ro.bedrock?u||Ql[a]:a===Ro.google?u||(l&&(l.includes("gemini")||l.includes("learnlm"))?"Gemini":l&&l.includes("code")?"Codey":"PaLM2"):a===Ro.custom||s===Ro.custom?u||d||(l&&l.includes("mistral")?"Mistral":l&&l.includes("gpt-3")?"GPT-3.5":l&&l.includes("gpt-4o")?"GPT-4o":l&&l.includes("gpt-4")?"GPT-4":c||"AI"):""},Nc=((xc={})[Ro.openAI]=Ci,xc[Ro.azureOpenAI]=Ci,xc[Ro.custom]=Ci,xc[Ro.assistants]=Ni,xc[Ro.azureAssistants]=Ni,xc[Ro.agents]=Ii,xc[Ro.google]=ki,xc[Ro.bedrock]=Ei,xc[Ro.anthropic]=Si,xc[Ro.chatGPTBrowser]=Ti,xc[Ro.gptPlugins]=Ri,xc),Cc=function(e){var t,n=e.endpoint,a=e.endpointType,s=e.conversation,r=e.possibleValues;if(!n)throw new Error("undefined endpoint: ".concat(n));var o=Nc[n];if(!o&&!a)throw new Error("Unknown endpoint: ".concat(n));if(!o&&a&&(o=Nc[a]),!o)throw new Error("Unknown endpointType: ".concat(a));var i=o.parse(s),l=(null!=r?r:{}).models;return l&&i&&(i.model=null!==(t=bc(l))&&void 0!==t?t:i.model),i};function kc(e){for(var t="",n=0,a=e;n<a.length;n++){var s=a[n];if(s.type===to.TEXT){var r="string"==typeof s.text?s.text:s.text.value;t.length>0&&r.length>0&&" "!==t[t.length-1]&&" "!==r[0]&&(t+=" "),t+=r}}return t}!function(e){e.DEFAULT="default",e.SHADCNUI="shadcnui",e.CUSTOM="custom"}(_c||(_c={}));var Sc,Tc,Rc,Ic,Ec,Pc,Lc,Mc,Ac,Oc,Dc,Fc,zc,Uc,Vc,Bc,$c,Hc,Gc,Kc,Wc,Qc,qc,Zc,Yc,Jc={utils:'\nimport { type ClassValue, clsx } from "clsx"\nimport { twMerge } from "tailwind-merge"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n',accordian:'import * as React from "react"\nimport * as AccordionPrimitive from "@radix-ui/react-accordion"\nimport { ChevronDown } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn("border-b", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = "AccordionItem"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className="flex">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"\n    {...props}\n  >\n    <div className={cn("pb-4 pt-0", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n',alertDialog:'import * as React from "react"\nimport * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"\n\nimport { cn } from "../../lib/utils"\nimport { buttonVariants } from "./button"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-gray-800 dark:bg-gray-950",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      "flex flex-col space-y-2 text-center sm:text-left",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = "AlertDialogHeader"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = "AlertDialogFooter"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn("text-lg font-semibold", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn("text-sm text-gray-500 dark:text-gray-400", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: "outline" }),\n      "mt-2 sm:mt-0",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n',alert:'import * as React from "react"\nimport { cva, type VariantProps } from "class-variance-authority"\n\nimport { cn } from "../../lib/utils"\n\nconst alertVariants = cva(\n  "relative w-full rounded-lg border border-gray-200 p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-gray-950 dark:border-gray-800 dark:[&>svg]:text-gray-50",\n  {\n    variants: {\n      variant: {\n        default: "bg-white text-gray-950 dark:bg-gray-950 dark:text-gray-50",\n        destructive:\n          "border-red-500/50 text-red-500 dark:border-red-500 [&>svg]:text-red-500 dark:border-red-900/50 dark:text-red-900 dark:dark:border-red-900 dark:[&>svg]:text-red-900",\n      },\n    },\n    defaultVariants: {\n      variant: "default",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role="alert"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = "Alert"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn("mb-1 font-medium leading-none tracking-tight", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = "AlertTitle"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn("text-sm [&_p]:leading-relaxed", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = "AlertDescription"\n\nexport { Alert, AlertTitle, AlertDescription }\n\n',avatar:'import * as React from "react"\nimport * as AvatarPrimitive from "@radix-ui/react-avatar"\n\nimport { cn } from "../../lib/utils"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn("aspect-square h-full w-full", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      "flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n\n',badge:'import * as React from "react"\nimport { cva, type VariantProps } from "class-variance-authority"\n\nimport { cn } from "../../lib/utils"\n\nconst badgeVariants = cva(\n  "inline-flex items-center rounded-full border border-gray-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 dark:border-gray-800 dark:focus:ring-gray-300",\n  {\n    variants: {\n      variant: {\n        default:\n          "border-transparent bg-gray-900 text-gray-50 hover:bg-gray-900/80 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/80",\n        secondary:\n          "border-transparent bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",\n        destructive:\n          "border-transparent bg-red-500 text-gray-50 hover:bg-red-500/80 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/80",\n        outline: "text-gray-950 dark:text-gray-50",\n      },\n    },\n    defaultVariants: {\n      variant: "default",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n\n',breadcrumb:'import * as React from "react"\nimport { Slot } from "@radix-ui/react-slot"\nimport { ChevronRight, MoreHorizontal } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<"nav"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />)\nBreadcrumb.displayName = "Breadcrumb"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<"ol">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      "flex flex-wrap items-center gap-1.5 break-words text-sm text-gray-500 sm:gap-2.5 dark:text-gray-400",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = "BreadcrumbList"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<"li">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn("inline-flex items-center gap-1.5", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = "BreadcrumbItem"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<"a"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : "a"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn("transition-colors hover:text-gray-950 dark:hover:text-gray-50", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = "BreadcrumbLink"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<"span">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role="link"\n    aria-disabled="true"\n    aria-current="page"\n    className={cn("font-normal text-gray-950 dark:text-gray-50", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = "BreadcrumbPage"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<"li">) => (\n  <li\n    role="presentation"\n    aria-hidden="true"\n    className={cn("[&>svg]:size-3.5", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = "BreadcrumbSeparator"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<"span">) => (\n  <span\n    role="presentation"\n    aria-hidden="true"\n    className={cn("flex h-9 w-9 items-center justify-center", className)}\n    {...props}\n  >\n    <MoreHorizontal className="h-4 w-4" />\n    <span className="sr-only">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = "BreadcrumbElipssis"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n\n',button:'import * as React from "react"\nimport { Slot } from "@radix-ui/react-slot"\nimport { cva, type VariantProps } from "class-variance-authority"\n\nimport { cn } from \'../../lib/utils\';\n\nconst buttonVariants = cva(\n  "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300",\n  {\n    variants: {\n      variant: {\n        default: "bg-gray-900 text-gray-50 hover:bg-gray-900/90 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90",\n        destructive:\n          "bg-red-500 text-gray-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/90",\n        outline:\n          "border border-gray-200 bg-white hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50",\n        secondary:\n          "bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",\n        ghost: "hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-50",\n        link: "text-gray-900 underline-offset-4 hover:underline dark:text-gray-50",\n      },\n      size: {\n        default: "h-10 px-4 py-2",\n        sm: "h-9 rounded-md px-3",\n        lg: "h-11 rounded-md px-8",\n        icon: "h-10 w-10",\n      },\n    },\n    defaultVariants: {\n      variant: "default",\n      size: "default",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : "button"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = "Button"\n\nexport { Button, buttonVariants }\n',calendar:'import * as React from "react"\nimport { ChevronLeft, ChevronRight } from "lucide-react"\nimport { DayPicker } from "react-day-picker"\n\nimport { cn } from "../../lib/utils"\nimport { buttonVariants } from "./button"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn("p-3", className)}\n      classNames={{\n        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",\n        month: "space-y-4",\n        caption: "flex justify-center pt-1 relative items-center",\n        caption_label: "text-sm font-medium",\n        nav: "space-x-1 flex items-center",\n        nav_button: cn(\n          buttonVariants({ variant: "outline" }),\n          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"\n        ),\n        nav_button_previous: "absolute left-1",\n        nav_button_next: "absolute right-1",\n        table: "w-full border-collapse space-y-1",\n        head_row: "flex",\n        head_cell:\n          "text-gray-500 rounded-md w-9 font-normal text-[0.8rem] dark:text-gray-400",\n        row: "flex w-full mt-2",\n        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-gray-100/50 [&:has([aria-selected])]:bg-gray-100 first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20 dark:[&:has([aria-selected].day-outside)]:bg-gray-800/50 dark:[&:has([aria-selected])]:bg-gray-800",\n        day: cn(\n          buttonVariants({ variant: "ghost" }),\n          "h-9 w-9 p-0 font-normal aria-selected:opacity-100"\n        ),\n        day_range_end: "day-range-end",\n        day_selected:\n          "bg-gray-900 text-gray-50 hover:bg-gray-900 hover:text-gray-50 focus:bg-gray-900 focus:text-gray-50 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50 dark:hover:text-gray-900 dark:focus:bg-gray-50 dark:focus:text-gray-900",\n        day_today: "bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-gray-50",\n        day_outside:\n          "day-outside text-gray-500 opacity-50 aria-selected:bg-gray-100/50 aria-selected:text-gray-500 aria-selected:opacity-30 dark:text-gray-400 dark:aria-selected:bg-gray-800/50 dark:aria-selected:text-gray-400",\n        day_disabled: "text-gray-500 opacity-50 dark:text-gray-400",\n        day_range_middle:\n          "aria-selected:bg-gray-100 aria-selected:text-gray-900 dark:aria-selected:bg-gray-800 dark:aria-selected:text-gray-50",\n        day_hidden: "invisible",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ ...props }) => <ChevronLeft className="h-4 w-4" />,\n        IconRight: ({ ...props }) => <ChevronRight className="h-4 w-4" />,\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = "Calendar"\n\nexport { Calendar }\n\n',card:'import * as React from \'react\';\n\nimport { cn } from \'../../lib/utils\';\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      "rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = "Card"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn("flex flex-col space-y-1.5 p-6", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = "CardHeader"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      "text-2xl font-semibold leading-none tracking-tight",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = "CardTitle"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn("text-sm text-gray-500 dark:text-gray-400", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = "CardDescription"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />\n))\nCardContent.displayName = "CardContent"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn("flex items-center p-6 pt-0", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = "CardFooter"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n',carousel:'import * as React from "react"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from "embla-carousel-react"\nimport { ArrowLeft, ArrowRight } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\nimport { Button } from "./button"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: "horizontal" | "vertical"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error("useCarousel must be used within a <Carousel />")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = "horizontal",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === "horizontal" ? "x" : "y",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === "ArrowLeft") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === "ArrowRight") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on("reInit", onSelect)\n      api.on("select", onSelect)\n\n      return () => {\n        api?.off("select", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn("relative", className)}\n          role="region"\n          aria-roledescription="carousel"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = "Carousel"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className="overflow-hidden">\n      <div\n        ref={ref}\n        className={cn(\n          "flex",\n          orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = "CarouselContent"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role="group"\n      aria-roledescription="slide"\n      className={cn(\n        "min-w-0 shrink-0 grow-0 basis-full",\n        orientation === "horizontal" ? "pl-4" : "pt-4",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = "CarouselItem"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = "outline", size = "icon", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        "absolute  h-8 w-8 rounded-full",\n        orientation === "horizontal"\n          ? "-left-12 top-1/2 -translate-y-1/2"\n          : "-top-12 left-1/2 -translate-x-1/2 rotate-90",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className="h-4 w-4" />\n      <span className="sr-only">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = "CarouselPrevious"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = "outline", size = "icon", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        "absolute h-8 w-8 rounded-full",\n        orientation === "horizontal"\n          ? "-right-12 top-1/2 -translate-y-1/2"\n          : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className="h-4 w-4" />\n      <span className="sr-only">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = "CarouselNext"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n\n',checkbox:'import * as React from "react"\nimport * as CheckboxPrimitive from "@radix-ui/react-checkbox"\nimport { Check } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      "peer h-4 w-4 shrink-0 rounded-sm border border-gray-200 dark:border-gray-900 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-gray-900 data-[state=checked]:text-gray-50  dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300 dark:data-[state=checked]:bg-gray-50 dark:data-[state=checked]:text-gray-900",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn("flex items-center justify-center text-current")}\n    >\n      <Check className="h-4 w-4" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n\n',collapsible:'import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n\n',dialog:'import * as React from "react"\nimport * as DialogPrimitive from "@radix-ui/react-dialog"\nimport { X } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-gray-800 dark:bg-gray-950",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100 data-[state=open]:text-gray-500 dark:ring-offset-gray-950 dark:focus:ring-gray-300 dark:data-[state=open]:bg-gray-800 dark:data-[state=open]:text-gray-400">\n        <X className="h-4 w-4" />\n        <span className="sr-only">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      "flex flex-col space-y-1.5 text-center sm:text-left",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = "DialogHeader"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = "DialogFooter"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      "text-lg font-semibold leading-none tracking-tight",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn("text-sm text-gray-500 dark:text-gray-400", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n\n',drawer:'import * as React from "react"\nimport { Drawer as DrawerPrimitive } from "vaul"\n\nimport { cn } from "../../lib/utils"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = "Drawer"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn("fixed inset-0 z-50 bg-black/80", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-950",\n        className\n      )}\n      {...props}\n    >\n      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-gray-100 dark:bg-gray-800" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = "DrawerContent"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = "DrawerHeader"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn("mt-auto flex flex-col gap-2 p-4", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = "DrawerFooter"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      "text-lg font-semibold leading-none tracking-tight",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn("text-sm text-gray-500 dark:text-gray-400", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n\n',dropdownMenu:'import * as React from "react"\nimport * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"\nimport { Check, ChevronRight, Circle } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-gray-100 data-[state=open]:bg-gray-100 dark:focus:bg-gray-800 dark:data-[state=open]:bg-gray-800",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className="ml-auto h-4 w-4" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      "z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        "z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className="h-4 w-4" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      className\n    )}\n    {...props}\n  >\n    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className="h-2 w-2 fill-current" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      "px-2 py-1.5 text-sm font-semibold",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn("-mx-1 my-1 h-px bg-gray-100 dark:bg-gray-800", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn("ml-auto text-xs tracking-widest opacity-60", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = "DropdownMenuShortcut"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n\n',input:'import * as React from "react"\nimport { cn } from "../../lib/utils"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          "flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:ring-offset-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = "Input"\n\nexport { Input }\n',label:"import * as React from 'react';\nimport * as LabelPrimitive from '@radix-ui/react-label';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '../../lib/utils';\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n",menuBar:'\nimport * as React from "react"\nimport * as MenubarPrimitive from "@radix-ui/react-menubar"\nimport { Check, ChevronRight, Circle } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst MenubarMenu = MenubarPrimitive.Menu\n\nconst MenubarGroup = MenubarPrimitive.Group\n\nconst MenubarPortal = MenubarPrimitive.Portal\n\nconst MenubarSub = MenubarPrimitive.Sub\n\nconst MenubarRadioGroup = MenubarPrimitive.RadioGroup\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      "flex h-10 items-center space-x-1 rounded-md border border-gray-200 bg-white p-1 dark:border-gray-800 dark:bg-gray-950",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-gray-100 focus:text-gray-900 data-[state=open]:bg-gray-100 data-[state=open]:text-gray-900 dark:focus:bg-gray-800 dark:focus:text-gray-50 dark:data-[state=open]:bg-gray-800 dark:data-[state=open]:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[state=open]:bg-gray-100 data-[state=open]:text-gray-900 dark:focus:bg-gray-800 dark:focus:text-gray-50 dark:data-[state=open]:bg-gray-800 dark:data-[state=open]:text-gray-50",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className="ml-auto h-4 w-4" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      "z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = "start", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          "z-50 min-w-[12rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className="h-4 w-4" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      className\n    )}\n    {...props}\n  >\n    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className="h-2 w-2 fill-current" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      "px-2 py-1.5 text-sm font-semibold",\n      inset && "pl-8",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn("-mx-1 my-1 h-px bg-gray-100 dark:bg-gray-800", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        "ml-auto text-xs tracking-widest text-gray-500 dark:text-gray-400",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = "MenubarShortcut"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n\n',navigationMenu:'import * as React from "react"\nimport * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu"\nimport { cva } from "class-variance-authority"\nimport { ChevronDown } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      "relative z-10 flex max-w-max flex-1 items-center justify-center",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      "group flex flex-1 list-none items-center justify-center space-x-1",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-white px-4 py-2 text-sm font-medium transition-colors hover:bg-gray-100 hover:text-gray-900 focus:bg-gray-100 focus:text-gray-900 focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-gray-100/50 data-[state=open]:bg-gray-100/50 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50 dark:focus:bg-gray-800 dark:focus:text-gray-50 dark:data-[active]:bg-gray-800/50 dark:data-[state=open]:bg-gray-800/50"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), "group", className)}\n    {...props}\n  >\n    {children}{""}\n    <ChevronDown\n      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"\n      aria-hidden="true"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn("absolute left-0 top-full flex justify-center")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border border-gray-200 bg-white text-gray-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)] dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",\n      className\n    )}\n    {...props}\n  >\n    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-gray-200 shadow-md dark:bg-gray-800" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n\n',pagination:'import * as React from "react"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\nimport { ButtonProps, buttonVariants } from "./button"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (\n  <nav\n    role="navigation"\n    aria-label="pagination"\n    className={cn("mx-auto flex w-full justify-center", className)}\n    {...props}\n  />\n)\nPagination.displayName = "Pagination"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<"ul">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn("flex flex-row items-center gap-1", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = "PaginationContent"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<"li">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn("", className)} {...props} />\n))\nPaginationItem.displayName = "PaginationItem"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, "size"> &\n  React.ComponentProps<"a">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = "icon",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? "page" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? "outline" : "ghost",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = "PaginationLink"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label="Go to previous page"\n    size="default"\n    className={cn("gap-1 pl-2.5", className)}\n    {...props}\n  >\n    <ChevronLeft className="h-4 w-4" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = "PaginationPrevious"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label="Go to next page"\n    size="default"\n    className={cn("gap-1 pr-2.5", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className="h-4 w-4" />\n  </PaginationLink>\n)\nPaginationNext.displayName = "PaginationNext"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<"span">) => (\n  <span\n    aria-hidden\n    className={cn("flex h-9 w-9 items-center justify-center", className)}\n    {...props}\n  >\n    <MoreHorizontal className="h-4 w-4" />\n    <span className="sr-only">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = "PaginationEllipsis"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n\n',popover:'import * as React from "react"\nimport * as PopoverPrimitive from "@radix-ui/react-popover"\n\nimport { cn } from "../../lib/utils"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        "z-50 w-72 rounded-md border border-gray-200 bg-white p-4 text-gray-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n\n',progress:'import * as React from "react"\nimport * as ProgressPrimitive from "@radix-ui/react-progress"\n\nimport { cn } from "../../lib/utils"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      "relative h-4 w-full overflow-hidden rounded-full bg-gray-100 dark:bg-gray-800",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className="h-full w-full flex-1 bg-gray-900 transition-all dark:bg-gray-50"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n',radioGroup:'import * as React from "react"\nimport * as RadioGroupPrimitive from "@radix-ui/react-radio-group"\nimport { Circle } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn("grid gap-2", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        "aspect-square h-4 w-4 rounded-full border border-gray-200 dark:border-gray-900 text-gray-900 ring-offset-white focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50  dark:text-gray-50 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">\n        <Circle className="h-2.5 w-2.5 fill-current text-current" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n\n',select:'import * as React from "react"\nimport * as SelectPrimitive from "@radix-ui/react-select"\nimport { Check, ChevronDown, ChevronUp } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      "flex h-10 w-full items-center justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 dark:border-gray-800 dark:bg-gray-950 dark:ring-offset-gray-950 dark:placeholder:text-gray-400 dark:focus:ring-gray-300",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className="h-4 w-4 opacity-50" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      "flex cursor-default items-center justify-center py-1",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className="h-4 w-4" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      "flex cursor-default items-center justify-center py-1",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className="h-4 w-4" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = "popper", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n        position === "popper" &&\n          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          "p-1",\n          position === "popper" &&\n            "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800 dark:focus:text-gray-50",\n      className\n    )}\n    {...props}\n  >\n    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">\n      <SelectPrimitive.ItemIndicator>\n        <Check className="h-4 w-4" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn("-mx-1 my-1 h-px bg-gray-100 dark:bg-gray-800", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n\n',separator:'import * as React from "react"\nimport * as SeparatorPrimitive from "@radix-ui/react-separator"\n\nimport { cn } from "../../lib/utils"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = "horizontal", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        "shrink-0 bg-gray-200 dark:bg-gray-800",\n        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n\n',skeleton:'import { cn } from "../../lib/utils"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn("animate-pulse rounded-md bg-gray-100 dark:bg-gray-800", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n',slider:'import * as React from "react"\nimport * as SliderPrimitive from "@radix-ui/react-slider"\n\nimport { cn } from "../../lib/utils"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      "relative flex w-full touch-none select-none items-center",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-gray-100 dark:bg-gray-800">\n      <SliderPrimitive.Range className="absolute h-full bg-gray-900 dark:bg-gray-50" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-gray-900 bg-white ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:border-gray-50 dark:bg-gray-950 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n\n',switchComponent:'import * as React from "react"\nimport * as SwitchPrimitives from "@radix-ui/react-switch"\n\nimport { cn } from "../../lib/utils"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-gray-900 data-[state=unchecked]:bg-gray-200 dark:focus-visible:ring-gray-300 dark:focus-visible:ring-offset-gray-950 dark:data-[state=checked]:bg-gray-50 dark:data-[state=unchecked]:bg-gray-800",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        "pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0 dark:bg-gray-950"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n\n',table:'import * as React from "react"\n\nimport { cn } from "../../lib/utils"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className="relative w-full overflow-auto">\n    <table\n      ref={ref}\n      className={cn("w-full caption-bottom text-sm", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = "Table"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />\n))\nTableHeader.displayName = "TableHeader"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn("[&_tr:last-child]:border-0", className)}\n    {...props}\n  />\n))\nTableBody.displayName = "TableBody"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      "border-t bg-gray-100/50 font-medium [&>tr]:last:border-b-0 dark:bg-gray-800/50",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = "TableFooter"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      "border-b transition-colors hover:bg-gray-100/50 data-[state=selected]:bg-gray-100 dark:hover:bg-gray-800/50 dark:data-[state=selected]:bg-gray-800",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = "TableRow"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      "h-12 px-4 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0 dark:text-gray-400",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = "TableHead"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}\n    {...props}\n  />\n))\nTableCell.displayName = "TableCell"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn("mt-4 text-sm text-gray-500 dark:text-gray-400", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = "TableCaption"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n\n',tabs:'import * as React from "react"\nimport * as TabsPrimitive from "@radix-ui/react-tabs"\n\nimport { cn } from "../../lib/utils"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      "inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500 dark:bg-gray-800 dark:text-gray-400",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-950 data-[state=active]:shadow-sm dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300 dark:data-[state=active]:bg-gray-950 dark:data-[state=active]:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      "mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 dark:ring-offset-gray-950 dark:focus-visible:ring-gray-300",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n\n',textarea:'import * as React from "react"\n\nimport { cn } from "../../lib/utils"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          "flex min-h-[80px] w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:ring-offset-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = "Textarea"\n\nexport { Textarea }\n\n',toast:'import * as React from "react"\nimport * as ToastPrimitives from "@radix-ui/react-toast"\nimport { cva, type VariantProps } from "class-variance-authority"\nimport { X } from "lucide-react"\n\nimport { cn } from "../../lib/utils"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border border-gray-200 p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full dark:border-gray-800",\n  {\n    variants: {\n      variant: {\n        default: "border bg-white text-gray-950 dark:bg-gray-950 dark:text-gray-50",\n        destructive:\n          "destructive group border-red-500 bg-red-500 text-gray-50 dark:border-red-900 dark:bg-red-900 dark:text-gray-50",\n      },\n    },\n    defaultVariants: {\n      variant: "default",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border border-gray-200 bg-transparent px-3 text-sm font-medium ring-offset-white transition-colors hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-gray-100/40 group-[.destructive]:hover:border-red-500/30 group-[.destructive]:hover:bg-red-500 group-[.destructive]:hover:text-gray-50 group-[.destructive]:focus:ring-red-500 dark:border-gray-800 dark:ring-offset-gray-950 dark:hover:bg-gray-800 dark:focus:ring-gray-300 dark:group-[.destructive]:border-gray-800/40 dark:group-[.destructive]:hover:border-red-900/30 dark:group-[.destructive]:hover:bg-red-900 dark:group-[.destructive]:hover:text-gray-50 dark:group-[.destructive]:focus:ring-red-900",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      "absolute right-2 top-2 rounded-md p-1 text-gray-950/50 opacity-0 transition-opacity hover:text-gray-950 focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600 dark:text-gray-50/50 dark:hover:text-gray-50",\n      className\n    )}\n    toast-close=""\n    {...props}\n  >\n    <X className="h-4 w-4" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn("text-sm font-semibold", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn("text-sm opacity-90", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n\n',toaster:'import {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from "./toast"\nimport { useToast } from "./use-toast"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className="grid gap-1">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n\n',toggleGroup:'import * as React from "react"\nimport * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group"\nimport { type VariantProps } from "class-variance-authority"\n\nimport { cn } from "../../lib/utils"\nimport { toggleVariants } from "./toggle"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: "default",\n  variant: "default",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn("flex items-center justify-center gap-1", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n\n',toggle:'import * as React from "react"\nimport * as TogglePrimitive from "@radix-ui/react-toggle"\nimport { cva, type VariantProps } from "class-variance-authority"\n\nimport { cn } from "../../lib/utils"\n\nconst toggleVariants = cva(\n  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors hover:bg-gray-100 hover:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-gray-100 data-[state=on]:text-gray-900 dark:ring-offset-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-400 dark:focus-visible:ring-gray-300 dark:data-[state=on]:bg-gray-800 dark:data-[state=on]:text-gray-50",\n  {\n    variants: {\n      variant: {\n        default: "bg-transparent",\n        outline:\n          "border border-gray-200 bg-transparent hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-50",\n      },\n      size: {\n        default: "h-10 px-3",\n        sm: "h-9 px-2.5",\n        lg: "h-11 px-5",\n      },\n    },\n    defaultVariants: {\n      variant: "default",\n      size: "default",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n\n',tooltip:'import * as React from "react"\nimport * as TooltipPrimitive from "@radix-ui/react-tooltip"\n\nimport { cn } from "../../lib/utils"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      "z-50 overflow-hidden rounded-md border border-gray-200 bg-white px-3 py-1.5 text-sm text-gray-950 shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-50",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n\n',useToast:'import * as React from "react"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from "./toast"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: "ADD_TOAST",\n  UPDATE_TOAST: "UPDATE_TOAST",\n  DISMISS_TOAST: "DISMISS_TOAST",\n  REMOVE_TOAST: "REMOVE_TOAST",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType["ADD_TOAST"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType["UPDATE_TOAST"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType["DISMISS_TOAST"]\n      toastId?: ToasterToast["id"]\n    }\n  | {\n      type: ActionType["REMOVE_TOAST"]\n      toastId?: ToasterToast["id"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: "REMOVE_TOAST",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case "ADD_TOAST":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case "UPDATE_TOAST":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case "DISMISS_TOAST": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I\'ll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case "REMOVE_TOAST":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, "id">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: "UPDATE_TOAST",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })\n\n  dispatch({\n    type: "ADD_TOAST",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),\n  }\n}\n\nexport { useToast, toast }\n'};!function(e){e.Input="input",e.Textarea="textarea",e.Slider="slider",e.Checkbox="checkbox",e.Switch="switch",e.Dropdown="dropdown",e.Combobox="combobox",e.Tags="tags"}(Sc||(Sc={})),function(e){e.Number="number",e.Boolean="boolean",e.String="string",e.Enum="enum",e.Array="array"}(Tc||(Tc={})),function(e){e.Conversation="conversation",e.Model="model",e.Custom="custom"}(Rc||(Rc={})),function(e){e.ADMIN="ADMIN",e.USER="USER"}(qc||(qc={})),function(e){e.PROMPTS="PROMPTS",e.BOOKMARKS="BOOKMARKS",e.AGENTS="AGENTS",e.MULTI_CONVO="MULTI_CONVO",e.TEMPORARY_CHAT="TEMPORARY_CHAT",e.RUN_CODE="RUN_CODE"}(Zc||(Zc={})),function(e){e.SHARED_GLOBAL="SHARED_GLOBAL",e.USE="USE",e.CREATE="CREATE",e.UPDATE="UPDATE",e.READ="READ",e.READ_AUTHOR="READ_AUTHOR",e.SHARE="SHARE"}(Yc||(Yc={}));var Xc,ed,td=a.object(((Ic={})[Yc.SHARED_GLOBAL]=a.boolean().default(!1),Ic[Yc.USE]=a.boolean().default(!0),Ic[Yc.CREATE]=a.boolean().default(!0),Ic)),nd=a.object(((Ec={})[Yc.USE]=a.boolean().default(!0),Ec)),ad=a.object(((Pc={})[Yc.SHARED_GLOBAL]=a.boolean().default(!1),Pc[Yc.USE]=a.boolean().default(!0),Pc[Yc.CREATE]=a.boolean().default(!0),Pc)),sd=a.object(((Lc={})[Yc.USE]=a.boolean().default(!0),Lc)),rd=a.object(((Mc={})[Yc.USE]=a.boolean().default(!0),Mc)),od=a.object(((Ac={})[Yc.USE]=a.boolean().default(!0),Ac)),id=a.object(((Oc={name:a.string()})[Zc.PROMPTS]=td,Oc[Zc.BOOKMARKS]=nd,Oc[Zc.AGENTS]=ad,Oc[Zc.MULTI_CONVO]=sd,Oc[Zc.TEMPORARY_CHAT]=rd,Oc[Zc.RUN_CODE]=od,Oc)),ld=a.object(((Dc={})[qc.ADMIN]=id.extend(((Fc={name:a.literal(qc.ADMIN)})[Zc.PROMPTS]=td.extend(((zc={})[Yc.SHARED_GLOBAL]=a.boolean().default(!0),zc[Yc.USE]=a.boolean().default(!0),zc[Yc.CREATE]=a.boolean().default(!0),zc)),Fc[Zc.BOOKMARKS]=nd.extend(((Uc={})[Yc.USE]=a.boolean().default(!0),Uc)),Fc[Zc.AGENTS]=ad.extend(((Vc={})[Yc.SHARED_GLOBAL]=a.boolean().default(!0),Vc[Yc.USE]=a.boolean().default(!0),Vc[Yc.CREATE]=a.boolean().default(!0),Vc)),Fc[Zc.MULTI_CONVO]=sd.extend(((Bc={})[Yc.USE]=a.boolean().default(!0),Bc)),Fc[Zc.TEMPORARY_CHAT]=rd.extend((($c={})[Yc.USE]=a.boolean().default(!0),$c)),Fc[Zc.RUN_CODE]=od.extend(((Hc={})[Yc.USE]=a.boolean().default(!0),Hc)),Fc)),Dc[qc.USER]=id.extend(((Gc={name:a.literal(qc.USER)})[Zc.PROMPTS]=td,Gc[Zc.BOOKMARKS]=nd,Gc[Zc.AGENTS]=ad,Gc[Zc.MULTI_CONVO]=sd,Gc[Zc.TEMPORARY_CHAT]=rd,Gc[Zc.RUN_CODE]=od,Gc)),Dc)).parse(((Kc={})[qc.ADMIN]=((Wc={name:qc.ADMIN})[Zc.PROMPTS]={},Wc[Zc.BOOKMARKS]={},Wc[Zc.AGENTS]={},Wc[Zc.MULTI_CONVO]={},Wc[Zc.TEMPORARY_CHAT]={},Wc[Zc.RUN_CODE]={},Wc),Kc[qc.USER]=((Qc={name:qc.USER})[Zc.PROMPTS]={},Qc[Zc.BOOKMARKS]={},Qc[Zc.AGENTS]={},Qc[Zc.MULTI_CONVO]={},Qc[Zc.TEMPORARY_CHAT]={},Qc[Zc.RUN_CODE]={},Qc),Kc));function cd(e){s.defaults.headers.common.Authorization="Bearer "+e}!function(e){e.messages="messages",e.sharedMessages="sharedMessages",e.sharedLinks="sharedLinks",e.allConversations="allConversations",e.archivedConversations="archivedConversations",e.searchConversations="searchConversations",e.conversation="conversation",e.searchEnabled="searchEnabled",e.user="user",e.name="name",e.models="models",e.balance="balance",e.endpoints="endpoints",e.presets="presets",e.searchResults="searchResults",e.tokenCount="tokenCount",e.availablePlugins="availablePlugins",e.startupConfig="startupConfig",e.assistants="assistants",e.assistant="assistant",e.agents="agents",e.agent="agent",e.endpointsConfigOverride="endpointsConfigOverride",e.files="files",e.fileConfig="fileConfig",e.tools="tools",e.toolAuth="toolAuth",e.toolCalls="toolCalls",e.agentTools="agentTools",e.actions="actions",e.assistantDocs="assistantDocs",e.agentDocs="agentDocs",e.fileDownload="fileDownload",e.voices="voices",e.customConfigSpeech="customConfigSpeech",e.prompts="prompts",e.prompt="prompt",e.promptGroups="promptGroups",e.allPromptGroups="allPromptGroups",e.promptGroup="promptGroup",e.categories="categories",e.randomPrompts="randomPrompts",e.roles="roles",e.conversationTags="conversationTags",e.health="health",e.userTerms="userTerms",e.banner="banner"}(Xc||(Xc={})),function(e){e.fileUpload="fileUpload",e.fileDelete="fileDelete",e.updatePreset="updatePreset",e.deletePreset="deletePreset",e.loginUser="loginUser",e.logoutUser="logoutUser",e.refreshToken="refreshToken",e.avatarUpload="avatarUpload",e.speechToText="speechToText",e.textToSpeech="textToSpeech",e.assistantAvatarUpload="assistantAvatarUpload",e.agentAvatarUpload="agentAvatarUpload",e.updateAction="updateAction",e.updateAgentAction="updateAgentAction",e.deleteAction="deleteAction",e.deleteAgentAction="deleteAgentAction",e.deleteUser="deleteUser",e.updateRole="updateRole",e.enableTwoFactor="enableTwoFactor",e.verifyTwoFactor="verifyTwoFactor"}(ed||(ed={}));var dd=function(e,t){return"/api/messages/".concat(e).concat(null!=t&&t?"/".concat(t):"")},ud="/api/share",md=function(e){return"".concat(ud,"/").concat(e)},pd=function(e,t,n,a,s,r){return"".concat(ud,"?pageSize=").concat(e,"&isPublic=").concat(t,"&sortBy=").concat(n,"&sortDirection=").concat(a).concat(s?"&search=".concat(s):"").concat(r?"&cursor=".concat(r):"")},gd="/api/keys",fd="/api/convos",xd=function(e,t,n){return"".concat(fd,"?pageNumber=").concat(e).concat(!0===t?"&isArchived=true":"").concat(null==n?void 0:n.map((function(e){return"&tags=".concat(e)})).join(""))},hd=function(){return"".concat(fd,"/update")},vd=function(){return"".concat(fd,"/clear")},bd=function(e,t){return"/api/search?q=".concat(e,"&pageNumber=").concat(t)},yd=function(e){var t=e.path,n=void 0===t?"":t,a=e.options,s=e.version,r=e.endpoint,o=!0===e.isAvatar?"".concat(jd(),"/assistants"):"/api/assistants/v".concat(s);if(n&&""!==n&&(o+="/".concat(n)),r&&(a=mo(mo({},null!=a?a:{}),{endpoint:r})),a&&Object.keys(a).length>0){var i=new URLSearchParams(a).toString();o+="?".concat(i)}return o},_d=function(e){var t=e.path,n=void 0===t?"":t,a=e.options,s="/api/agents";if(n&&""!==n&&(s+="/".concat(n)),a&&Object.keys(a).length>0){var r=new URLSearchParams(a).toString();s+="?".concat(r)}return s},jd=function(){return"".concat("/api/files","/images")},wd=function(){return"".concat("/api/files","/speech")},Nd=function(){return"".concat(wd(),"/tts")},Cd=function(e){return"".concat("/api/prompts","/groups/").concat(e)},kd=function(e){return"".concat("/api/prompts","/").concat(e)},Sd=function(){return"/api/prompts"},Td=Cd,Rd=Cd,Id=function(e){return"".concat("/api/roles","/").concat(e.toLowerCase())},Ed=function(e){return"/api/tags".concat(null!=e&&e?"/".concat(encodeURIComponent(e)):"")};function Pd(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.post(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))}var Ld=!1,Md=[],Ad=function(e){return Pd("/api/auth/refresh".concat(!0===e?"?retry=true":""))},Od=function(e){cd(e),window.dispatchEvent(new CustomEvent("tokenUpdated",{detail:e}))},Dd=function(e,t){void 0===t&&(t=null),Md.forEach((function(n){e?n.reject(e):n.resolve(t)})),Md=[]};s.interceptors.response.use((function(e){return e}),(function(e){return go(void 0,0,void 0,(function(){var t,n,a,r,o,i,l,c,d;return fo(this,(function(u){switch(u.label){case 0:if(t=e.config,!e.response)return[2,Promise.reject(e)];if(!0===(null===(i=t.url)||void 0===i?void 0:i.includes("/api/auth/2fa")))return[2,Promise.reject(e)];if(!0===(null===(l=t.url)||void 0===l?void 0:l.includes("/api/auth/logout")))return[2,Promise.reject(e)];if(401!==e.response.status||t._retry)return[3,13];if(console.warn("401 error, refreshing token"),t._retry=!0,!Ld)return[3,5];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,new Promise((function(e,t){Md.push({resolve:e,reject:t})}))];case 2:return r=u.sent(),t.headers.Authorization="Bearer "+r,[4,s(t)];case 3:return[2,u.sent()];case 4:return n=u.sent(),[2,Promise.reject(n)];case 5:Ld=!0,u.label=6;case 6:return u.trys.push([6,11,12,13]),[4,Ad(!0===(null===(c=t.url)||void 0===c?void 0:c.includes("api/auth/refresh")))];case 7:return a=u.sent(),(r=null!==(d=null==a?void 0:a.token)&&void 0!==d?d:"")?(t.headers.Authorization="Bearer "+r,Od(r),Dd(null,r),[4,s(t)]):[3,9];case 8:return[2,u.sent()];case 9:window.location.href.includes("share/")?console.log("Refresh token failed from shared link, attempting request to ".concat(t.url)):window.location.href="/login",u.label=10;case 10:return[3,13];case 11:return o=u.sent(),Dd(o,null),[2,Promise.reject(o)];case 12:return Ld=!1,[7];case 13:return[2,Promise.reject(e)]}}))}))}));var Fd={get:function(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.get(e,mo({},t))];case 1:return[2,n.sent().data]}}))}))},getResponse:function(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.get(e,mo({},t))];case 1:return[2,n.sent()]}}))}))},post:Pd,postMultiPart:function(e,t,n){return go(this,0,void 0,(function(){return fo(this,(function(a){switch(a.label){case 0:return[4,s.post(e,t,mo(mo({},n),{headers:{"Content-Type":"multipart/form-data"}}))];case 1:return[2,a.sent().data]}}))}))},postTTS:function(e,t,n){return go(this,0,void 0,(function(){return fo(this,(function(a){switch(a.label){case 0:return[4,s.post(e,t,mo(mo({},n),{headers:{"Content-Type":"multipart/form-data"},responseType:"arraybuffer"}))];case 1:return[2,a.sent().data]}}))}))},put:function(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.put(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},delete:function(e){return go(this,0,void 0,(function(){return fo(this,(function(t){switch(t.label){case 0:return[4,s.delete(e)];case 1:return[2,t.sent().data]}}))}))},deleteWithOptions:function(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.delete(e,mo({},t))];case 1:return[2,n.sent().data]}}))}))},patch:function(e,t){return go(this,0,void 0,(function(){return fo(this,(function(n){switch(n.label){case 0:return[4,s.patch(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},refreshToken:Ad,dispatchTokenUpdatedEvent:Od},zd=Object.freeze({__proto__:null,abortRequestWithMessage:function(e,t,n){return Fd.post("/api/ask/".concat(e,"/abort"),{arg:{abortKey:t,message:n}})},acceptTerms:function(){return Fd.post("/api/user/terms/accept")},addTagToConversation:function(e,t){return Fd.put((n=e,"".concat(Ed(),"/convo/").concat(n)),t);var n},archiveConversation:function(e){return Fd.post(hd(),{arg:e})},callTool:function(e){var t=e.toolId,n=e.toolParams;return Fd.post(_d({path:"tools/".concat(t,"/call")}),n)},clearAllConversations:function(){return Fd.post(vd(),{arg:{}})},confirmTwoFactor:function(e){return Fd.post("/api/auth/2fa/confirm",e)},createAgent:function(e){var t=po(e,[]);return Fd.post(_d({}),t)},createAssistant:function(e){var t=e.version,n=po(e,["version"]);return Fd.post(yd({version:t}),n)},createConversationTag:function(e){return Fd.post(Ed(),e)},createPreset:function(e){return Fd.post("/api/presets",e)},createPrompt:function(e){return Fd.post(Sd(),e)},createSharedLink:function(e){return Fd.post((t=e,"".concat(ud,"/").concat(t)));var t},deleteAction:function(e){var t=e.assistant_id,n=e.action_id,a=e.model,s=e.version,r=e.endpoint;return go(void 0,0,void 0,(function(){return fo(this,(function(e){return[2,Fd.delete(yd({path:"actions/".concat(t,"/").concat(n,"/").concat(a),version:s,endpoint:r}))]}))}))},deleteAgent:function(e){var t=e.agent_id;return Fd.delete(_d({path:t}))},deleteAgentAction:function(e){var t=e.agent_id,n=e.action_id;return go(void 0,0,void 0,(function(){return fo(this,(function(e){return[2,Fd.delete(_d({path:"actions/".concat(t,"/").concat(n)}))]}))}))},deleteAssistant:function(e){var t=e.assistant_id,n=e.model,a=e.endpoint,s=e.version;return Fd.delete(yd({path:t,options:{model:n,endpoint:a},version:s}))},deleteConversation:function(e){return Fd.post(vd(),{arg:e})},deleteConversationTag:function(e){return Fd.delete(Ed(e))},deleteFiles:function(e){return go(void 0,0,void 0,(function(){return fo(this,(function(t){return[2,Fd.deleteWithOptions("/api/files",{data:e})]}))}))},deletePreset:function(e){return Fd.post("/api/presets/delete",e)},deletePrompt:function(e){return Fd.delete((n=(t=e)._id,a=t.groupId,"".concat("/api/prompts","/").concat(n,"?groupId=").concat(a)));var t,n,a},deletePromptGroup:function(e){return Fd.delete(Rd(e))},deleteSharedLink:function(e){return Fd.delete(md(e))},deleteUser:function(){return Fd.delete("/api/user/delete")},disableTwoFactor:function(){return Fd.post("/api/auth/2fa/disable")},duplicateAgent:function(e){var t=e.agent_id;return Fd.post(_d({path:"".concat(t,"/duplicate")}))},duplicateConversation:function(e){return Fd.post("".concat(fd,"/duplicate"),e)},editArtifact:function(e){return go(void 0,0,void 0,(function(){var t=e.messageId,n=po(e,["messageId"]);return fo(this,(function(e){return[2,Fd.post("/api/messages/artifact/".concat(t),n)]}))}))},enableTwoFactor:function(){return Fd.get("/api/auth/2fa/enable")},forkConversation:function(e){return Fd.post("".concat(fd,"/fork"),e)},genTitle:function(e){return Fd.post("".concat(fd,"/gen_title"),e)},getAIEndpoints:function(){return Fd.get("/api/endpoints")},getActions:function(){return Fd.get(_d({path:"actions"}))},getAgentById:function(e){var t=e.agent_id;return Fd.get(_d({path:t}))},getAllPromptGroups:function(){return Fd.get("".concat("/api/prompts","/all"))},getAssistantById:function(e){var t=e.endpoint,n=e.assistant_id,a=e.version;return Fd.get(yd({path:n,endpoint:t,version:a}))},getAssistantDocs:function(e){var t=e.endpoint,n=e.version;return Oo(t)?Fd.get(yd({path:"documents",version:n,options:{endpoint:t},endpoint:t})):Promise.resolve([])},getAvailableAgentTools:function(){return Fd.get(_d({path:"tools"}))},getAvailablePlugins:function(){return Fd.get("/api/plugins")},getAvailableTools:function(e,t){var n="";return n=Oo(e)?yd({path:"tools",endpoint:e,version:null!=t?t:wl[e]}):_d({path:"tools"}),Fd.get(n)},getBanner:function(){return Fd.get("/api/banner")},getCategories:function(){return Fd.get("/api/categories")},getCodeOutputDownload:function(e){return go(void 0,0,void 0,(function(){return fo(this,(function(t){return[2,Fd.getResponse(e,{responseType:"blob",headers:{Accept:"application/octet-stream"}})]}))}))},getConversationById:function(e){return Fd.get((t=e,"".concat(fd,"/").concat(t)));var t},getConversationTags:function(){return Fd.get(Ed())},getConversations:function(e){return Fd.get(xd(e))},getCustomConfigSpeech:function(){return Fd.get("".concat(wd(),"/config/get"))},getEndpointsConfigOverride:function(){return Fd.get("/api/endpoints/config/override")},getFileConfig:function(){return Fd.get("".concat("/api/files","/config"))},getFileDownload:function(e,t){return go(void 0,0,void 0,(function(){return fo(this,(function(n){return[2,Fd.getResponse("".concat("/api/files","/download/").concat(e,"/").concat(t),{responseType:"blob",headers:{Accept:"application/octet-stream"}})]}))}))},getFiles:function(){return Fd.get("/api/files")},getLoginGoogle:function(){return Fd.get("/api/auth/google")},getMessagesByConvoId:function(e){return"new"===e?Promise.resolve([]):Fd.get(dd(e))},getModels:function(){return go(void 0,0,void 0,(function(){return fo(this,(function(e){return[2,Fd.get("/api/models")]}))}))},getPresets:function(){return Fd.get("/api/presets")},getPrompt:function(e){return Fd.get(kd(e))},getPromptGroup:function(e){return Fd.get(Cd(e))},getPromptGroups:function(e){return Fd.get(function(e){var t="".concat("/api/prompts","/groups");if(Object.keys(e).length>0){var n=new URLSearchParams(e).toString();t+="?".concat(n)}return t}(e))},getPrompts:function(e){return Fd.get(function(e){var t="/api/prompts";if(Object.keys(e).length>0){var n=new URLSearchParams(e).toString();t+="?".concat(n)}return t}(e))},getRandomPrompts:function(e){return Fd.get((t=e.limit,n=e.skip,"".concat("/api/prompts","/random?limit=").concat(t,"&skip=").concat(n)));var t,n},getRole:function(e){return Fd.get(Id(e))},getSearchEnabled:function(){return Fd.get("/api/search/enable")},getSharedLink:function(e){return Fd.get((t=e,"".concat(ud,"/link/").concat(t)));var t},getSharedMessages:function(e){return Fd.get(md(e))},getStartupConfig:function(){return Fd.get("/api/config")},getToolCalls:function(e){return Fd.get(_d({path:"tools/calls",options:e}))},getUser:function(){return Fd.get("/api/user")},getUserBalance:function(){return Fd.get("/api/balance")},getUserTerms:function(){return Fd.get("/api/user/terms")},getVerifyAgentToolAuth:function(e){return Fd.get(_d({path:"tools/".concat(e.toolId,"/auth")}))},getVoices:function(){return Fd.get("".concat(Nd(),"/voices"))},healthCheck:function(){return Fd.get("/health")},importConversationsFile:function(e){return Fd.postMultiPart("".concat(fd,"/import"),e)},listAgents:function(e){return Fd.get(_d({options:e}))},listAssistants:function(e,t){return Fd.get(yd({version:t,options:e}))},listConversations:function(e){var t,n,a=(null!==(t=null==e?void 0:e.pageNumber)&&void 0!==t?t:"1")||"1",s=null!==(n=null==e?void 0:e.isArchived)&&void 0!==n&&n,r=(null==e?void 0:e.tags)||[];return Fd.get(xd(a,s,r))},listConversationsByQuery:function(e){var t,n,a=(null!==(t=null==e?void 0:e.pageNumber)&&void 0!==t?t:"1")||"1",s=null!==(n=null==e?void 0:e.searchQuery)&&void 0!==n?n:"";return""!==s?Fd.get(bd(s,a)):Fd.get(xd(a))},listSharedLinks:function(e){return go(void 0,0,void 0,(function(){var t,n,a,s,r,o;return fo(this,(function(i){return t=e.pageSize,n=e.isPublic,a=e.sortBy,s=e.sortDirection,r=e.search,o=e.cursor,[2,Fd.get(pd(t,n,a,s,r,o))]}))}))},login:function(e){return Fd.post("/api/auth/login",e)},logout:function(){return Fd.post("/api/auth/logout")},makePromptProduction:function(e){return Fd.patch("".concat(kd(e),"/tags/production"))},rebuildConversationTags:function(){return Fd.post(Ed("rebuild"))},regenerateBackupCodes:function(){return Fd.post("/api/auth/2fa/backup/regenerate")},register:function(e){return Fd.post("/api/auth/register",e)},requestPasswordReset:function(e){return Fd.post("/api/auth/requestPasswordReset",e)},resendVerificationEmail:function(e){return Fd.post("/api/user/verify/resend",e)},resetPassword:function(e){return Fd.post("/api/auth/resetPassword",e)},revokeAllUserKeys:function(){return Fd.delete("".concat(gd,"?all=true"))},revokeUserKey:function(e){return Fd.delete((t=e,"".concat(gd,"/").concat(t)));var t},searchConversations:function(e,t){return go(void 0,0,void 0,(function(){return fo(this,(function(n){return[2,Fd.get(bd(e,t))]}))}))},speechToText:function(e){return Fd.postMultiPart("".concat(wd(),"/stt"),e)},textToSpeech:function(e){return Fd.postTTS("".concat(Nd(),"/manual"),e)},updateAction:function(e){var t=e.assistant_id,n=e.version,a=po(e,["assistant_id","version"]);return Fd.post(yd({path:"actions/".concat(t),version:n}),a)},updateAgent:function(e){var t=e.agent_id,n=e.data;return Fd.patch(_d({path:t}),n)},updateAgentAction:function(e){var t=e.agent_id,n=po(e,["agent_id"]);return Fd.post(_d({path:"actions/".concat(t)}),n)},updateAgentPermissions:function(e){return Fd.put((t=e.roleName,"".concat(Id(t),"/agents")),e.updates);var t},updateAssistant:function(e){var t=e.assistant_id,n=e.data,a=e.version;return Fd.patch(yd({path:t,version:a}),n)},updateConversation:function(e){return Fd.post(hd(),{arg:e})},updateConversationTag:function(e,t){return Fd.put(Ed(e),t)},updateMessage:function(e){var t=e.conversationId,n=e.messageId,a=e.text;if(!t)throw new Error("conversationId is required");return Fd.put(dd(t,n),{text:a})},updateMessageContent:function(e){var t=e.conversationId,n=e.messageId,a=e.index,s=e.text;if(!t)throw new Error("conversationId is required");return Fd.put(dd(t,n),{text:s,index:a})},updatePreset:function(e){return Fd.post("/api/presets",e)},updatePromptGroup:function(e){return Fd.patch(Td(e.id),e.payload)},updatePromptLabels:function(e){return Fd.patch((t=e.id,"".concat(kd(t),"/labels")),e.payload);var t},updatePromptPermissions:function(e){return Fd.put((t=e.roleName,"".concat(Id(t),"/prompts")),e.updates);var t},updateSharedLink:function(e){return Fd.patch((t=e,"".concat(ud,"/").concat(t)));var t},updateTokenCount:function(e){return Fd.post("/api/tokenizer",{arg:e})},updateUserKey:function(e){if(!e.value)throw new Error("value is required");return Fd.put(gd,e)},updateUserPlugins:function(e){return Fd.post("/api/user/plugins",e)},uploadAgentAvatar:function(e){return Fd.postMultiPart("".concat(jd(),"/agents/").concat(e.agent_id,"/avatar"),e.formData)},uploadAssistantAvatar:function(e){return Fd.postMultiPart(yd({isAvatar:!0,path:"".concat(e.assistant_id,"/avatar"),options:{model:e.model,endpoint:e.endpoint},version:e.version}),e.formData)},uploadAvatar:function(e){return Fd.postMultiPart("".concat(jd(),"/avatar"),e)},uploadFile:function(e,t){var n=t?{signal:t}:void 0;return Fd.postMultiPart("/api/files",e,n)},uploadImage:function(e,t){var n=t?{signal:t}:void 0;return Fd.postMultiPart(jd(),e,n)},userKeyQuery:function(e){return Fd.get((t=e,"".concat(gd,"?name=").concat(t)));var t},verifyEmail:function(e){return Fd.post("/api/user/verify",e)},verifyTwoFactor:function(e){return Fd.post("/api/auth/2fa/verify",e)},verifyTwoFactorTemp:function(e){return Fd.post("/api/auth/2fa/verify-temp",e)}});var Ud={string:function(e){if(e.enum)return a.enum(e.enum);var t=a.string();return void 0!==e.minLength&&(t=t.min(e.minLength)),void 0!==e.maxLength&&(t=t.max(e.maxLength)),t},number:function(e){var t=a.number();return void 0!==e.minimum&&(t=t.min(e.minimum)),void 0!==e.maximum&&(t=t.max(e.maximum)),t},integer:function(e){return Ud.number(e).int()},boolean:function(){return a.boolean()},array:function(e){if(e.items){var t=Vd(e.items);return t?a.array(t):a.array(a.unknown())}return a.array(a.unknown())},object:function(e){var t={};return e.properties&&Object.entries(e.properties).forEach((function(n){var s=n[0],r=n[1],o=Vd(r);t[s]=o||a.unknown(),e.required&&e.required.includes(s)?t[s]=t[s].describe(r.description||""):t[s]=t[s].optional().describe(r.description||"")})),a.object(t)}};function Vd(e){if("object"!==e.type||0!==Object.keys(e.properties||{}).length)return(Ud[e.type]||function(){return a.unknown()})(e)}var Bd=function(){function e(e,t,n,a){this.name=e,this.description=t,this.parameters=n,this.strict=null!=a&&a}return e.prototype.toObjectTool=function(){var e=mo(mo({},this.parameters),{additionalProperties:!this.strict&&void 0});return{type:so.function,function:mo({name:this.name,description:this.description,parameters:e},this.strict?{strict:this.strict}:{})}},e}(),$d=function(e,t,n,a,s,r){this.domain=e,this.basePath=t,this.method=n,this.operation=a,this.isConsequential=s,this.contentType=r},Hd=function(){function e(e){this.config=e,this.authHeaders={},this.path=e.basePath}return e.prototype.setParams=function(e){this.operationHash=function(e){return r.createHash("sha1").update(e).digest("hex")}(JSON.stringify(e)),this.params=Object.assign({},e);for(var t=0,n=Object.entries(e);t<n.length;t++){var a=n[t],s=a[0],o=a[1],i="{".concat(s,"}");this.path.includes(i)&&(this.path=this.path.replace(i,encodeURIComponent(o)),delete this.params[s])}return this},e.prototype.setAuth=function(e){return go(this,0,void 0,(function(){var t,n,a,s,r,o,l,c,d,u,m,p,g,f,x,h,v,b;return fo(this,(function(y){if(!e.auth)return[2,this];if(t=e.auth,n=t.type,a=t.authorization_type,s=t.custom_auth_header,r=t.authorization_url,o=t.client_url,l=t.scope,c=t.token_exchange_method,d=e.api_key,u=e.oauth_client_id,m=e.oauth_client_secret,p=e.oauth_token_expires_at,g=e.oauth_access_token,f=void 0===g?"":g,x=null!=d&&d.length>0&&n===ho.ServiceHttp,h=!!(null!=u&&u&&null!=m&&m&&n===ho.OAuth&&null!=r&&r&&null!=o&&o&&null!=l&&l&&c),x&&a===vo.Basic)v=i.Buffer.from(d).toString("base64"),this.authHeaders.Authorization="Basic ".concat(v);else if(x&&a===vo.Bearer)this.authHeaders.Authorization="Bearer ".concat(d);else if(x&&a===vo.Custom&&null!=s&&s)this.authHeaders[s]=d;else if(h){if(b=new Date,!f)throw new Error("No access token found. Please log in first.");if(p&&b>=new Date(p))throw new Error("Access token is expired. Please re-login.");this.authToken=f,this.authHeaders.Authorization="Bearer ".concat(this.authToken)}return[2,this]}))}))},e.prototype.execute=function(){return go(this,0,void 0,(function(){var e,t,n,a;return fo(this,(function(r){if(e=function(e,t){var n=e.replace(/\/$/,""),a=t.replace(/^\//,""),s="".concat(n,"/").concat(a);return new l(s).toString()}(this.config.domain,this.path),t=mo(mo({},this.authHeaders),{"Content-Type":this.config.contentType}),n=this.config.method.toLowerCase(),a=s.create(),"get"===n)return[2,a.get(e,{headers:t,params:this.params})];if("post"===n)return[2,a.post(e,this.params,{headers:t})];if("put"===n)return[2,a.put(e,this.params,{headers:t})];if("delete"===n)return[2,a.delete(e,{headers:t,data:this.params})];if("patch"===n)return[2,a.patch(e,this.params,{headers:t})];throw new Error("Unsupported HTTP method: ".concat(n))}))}))},e.prototype.getConfig=function(){return this.config},e}(),Gd=function(){function e(e,t,n,a,s,r){this.config=new $d(e,t,n,a,s,r)}return Object.defineProperty(e.prototype,"domain",{get:function(){return this.config.domain},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.config.basePath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this.config.method},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"operation",{get:function(){return this.config.operation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConsequential",{get:function(){return this.config.isConsequential},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentType",{get:function(){return this.config.contentType},enumerable:!1,configurable:!0}),e.prototype.createExecutor=function(){return new Hd(this.config)},e.prototype.setParams=function(e){var t=this.createExecutor();return t.setParams(e),t},e.prototype.setAuth=function(e){return go(this,0,void 0,(function(){return fo(this,(function(t){return[2,this.createExecutor().setAuth(e)]}))}))},e.prototype.execute=function(){return go(this,0,void 0,(function(){return fo(this,(function(e){return[2,this.createExecutor().execute()]}))}))},e}();function Kd(e,t){var n;if("$ref"in e&&t){var a=e.$ref.replace(/^#\/components\/schemas\//,""),s=null===(n=t.schemas)||void 0===n?void 0:n[a];if(!s)throw new Error("Reference ".concat(e.$ref," not found"));return Kd(s,t)}return e}function Wd(e){return e.replace(/[^a-zA-Z0-9_-]/g,"")}function Qd(e,t){var n,a,s,r,o,i,l;void 0===t&&(t=!1);for(var c=[],d={},u={},m=null!==(r=null===(s=null===(a=e.servers)||void 0===a?void 0:a[0])||void 0===s?void 0:s.url)&&void 0!==r?r:"",p=0,g=Object.entries(e.paths);p<g.length;p++)for(var f=g[p],x=f[0],h=f[1],v=0,b=Object.entries(h);v<b.length;v++){var y=b[v],_=y[0],j=y[1],w="".concat(_,"_").concat(x),N=j.operationId||Wd(w),C=j.summary||j.description||"",k=null!==(o=j["x-strict"])&&void 0!==o&&o,S={type:"object",properties:{},required:[]};if(j.parameters)for(var T=0,R=j.parameters;T<R.length;T++){var I=R[T],E=Kd(mo({},I.schema),e.components);S.properties[I.name]=E,!0===I.required&&S.required.push(I.name)}if(j.requestBody){var P=j.requestBody.content,L=Object.keys(null!=P?P:{})[0];E=Kd(A=null===(i=null==P?void 0:P[L])||void 0===i?void 0:i.schema,e.components),S.properties=mo(mo({},S.properties),E.properties),E.required&&(n=S.required).push.apply(n,E.required)}var M=new Bd(N,C,S,k);c.push(M);var A,O=new Gd(m,x,_,N,!(null===(l=j["x-openai-isConsequential"])||void 0===l||!l),j.requestBody?"application/json":"");d[N]=O,t&&Object.keys(S.properties).length>0&&(A=Vd(S))&&(u[N]=A)}return{functionSignatures:c,requestBuilders:d,zodSchemas:u}}function qd(e){var t;try{var n=void 0;try{n=JSON.parse(e)}catch(C){n=o(e)}if(!n.servers||!Array.isArray(n.servers)||0===n.servers.length)return{status:!1,message:"Could not find a valid URL in `servers`"};if(!n.servers[0].url)return{status:!1,message:"Could not find a valid URL in `servers`"};var a=n.paths;if(!a||"object"!=typeof a||0===Object.keys(a).length)return{status:!1,message:"No paths found in the OpenAPI spec."};for(var s=(null===(t=n.components)||void 0===t?void 0:t.schemas)||{},r=[],i=0,l=Object.entries(a);i<l.length;i++)for(var c=l[i],d=c[0],u=c[1],m=0,p=Object.entries(u);m<p.length;m++){var g=p[m],f=g[0],x=g[1],h=x.responses;if("object"==typeof x&&h)for(var v=0,b=Object.entries(h);v<b.length;v++){var y=b[v],_=y[0],j=y[1].content;if(j&&j["application/json"]&&j["application/json"].schema){var w=j["application/json"].schema;if("$ref"in w&&"string"==typeof w.$ref){var N=w.$ref.split("/").pop();N&&!s[N]&&r.push("In context=('paths', '".concat(d,"', '").concat(f,"', '").concat(_,"', 'response', 'content', 'application/json', 'schema'), reference to unknown component ").concat(N,"; using empty schema"))}}}}return{status:!0,message:r.join("\n")||"OpenAPI spec is valid.",spec:n}}catch(k){return console.error(k),{status:!1,message:"Error parsing OpenAPI spec."}}}function Zd(){return c.jsxs(c.Fragment,{children:[c.jsx("path",{d:"M21.333 23L26.333 18L21.333 13",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M14.667 13L9.66699 18L14.667 23",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})]})}const Yd=["text/x-"],Jd={paths:function(){return c.jsxs(c.Fragment,{children:[c.jsx("path",{d:"M19.6663 9.66663H12.9997C12.5576 9.66663 12.1337 9.84222 11.8212 10.1548C11.5086 10.4673 11.333 10.8913 11.333 11.3333V24.6666C11.333 25.1087 11.5086 25.5326 11.8212 25.8451C12.1337 26.1577 12.5576 26.3333 12.9997 26.3333H22.9997C23.4417 26.3333 23.8656 26.1577 24.1782 25.8451C24.4907 25.5326 24.6663 25.1087 24.6663 24.6666V14.6666L19.6663 9.66663Z",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M19.667 9.66663V14.6666H24.667",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M21.3337 18.8334H14.667",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M21.3337 22.1666H14.667",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M16.3337 15.5H15.5003H14.667",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})]})},fill:"#FF5588",title:"Document"},Xd={paths:function(){return c.jsx(c.Fragment,{children:c.jsx("path",{d:"M15.5 10.5H12.1667C11.2462 10.5 10.5 11.2462 10.5 12.1667V13.5V18M15.5 10.5H23.8333C24.7538 10.5 25.5 11.2462 25.5 12.1667V13.5V18M15.5 10.5V25.5M15.5 25.5H18H23.8333C24.7538 25.5 25.5 24.7538 25.5 23.8333V18M15.5 25.5H12.1667C11.2462 25.5 10.5 24.7538 10.5 23.8333V18M10.5 18H25.5",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})},fill:"#10A37F",title:"Spreadsheet"},eu={file:{paths:function(){return c.jsxs(c.Fragment,{children:[c.jsx("path",{d:"M18.833 9.66663H12.9997C12.5576 9.66663 12.1337 9.84222 11.8212 10.1548C11.5086 10.4673 11.333 10.8913 11.333 11.3333V24.6666C11.333 25.1087 11.5086 25.5326 11.8212 25.8451C12.1337 26.1577 12.5576 26.3333 12.9997 26.3333H22.9997C23.4417 26.3333 23.8656 26.1577 24.1782 25.8451C24.4907 25.5326 24.6663 25.1087 24.6663 24.6666V15.5L18.833 9.66663Z",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M18.833 9.66663V15.5H24.6663",stroke:"white",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})]})},fill:"#0000FF",title:"File"},text:Jd,csv:Xd,"application/pdf":Jd,pdf:Jd,"text/x-":{paths:Zd,fill:"#FF6E3C",title:"Code"},artifact:{paths:Zd,fill:"#2D305C",title:"Code"}},tu=(e="")=>{if(eu[e])return eu[e];if(Di.test(e))return Xd;const t=Yd.find((t=>e.includes(t)));if(t&&eu[t])return eu[t];const n=e.split("/")[0]||"text";return eu[n]?eu[n]:eu.file};function nu(e,t=!1){if(!e)return"";const n=new Date(e);if(t)return n.toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"2-digit"});return`${n.getDate()} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()]} ${n.getFullYear()}`}function au(e,t){const n=e.getQueryData([Xc.files]);if(!n)return void console.warn("No current files found in cache, skipped updating file query cache");n.findIndex((e=>e.file_id===t.file_id))>-1?console.warn("File already exists in cache, skipped updating file query cache"):e.setQueryData([Xc.files],[{...t},...n])}function su(e,t=2){if(0===e)return 0;const n=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(n))}const{checkType:ru}=Gi;const ou=e=>{const t=document.documentElement;switch(e.split("-")[1]){case"xs":t.style.setProperty("--markdown-font-size","0.75rem");break;case"sm":t.style.setProperty("--markdown-font-size","0.875rem");break;case"base":t.style.setProperty("--markdown-font-size","1rem");break;case"lg":t.style.setProperty("--markdown-font-size","1.125rem");break;case"xl":t.style.setProperty("--markdown-font-size","1.25rem")}},iu=()=>{if("undefined"!=typeof window&&window.localStorage){const e=window.localStorage.getItem("color-theme");if("string"==typeof e)return e;if(window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}return"light"},lu=e=>t=>{t?"string"!=typeof t?t.value&&e(t.value+""):e(t):e("")},cu=e=>({label:Ql[e]??e,value:e}),du=({agent:e,fileMap:t,instanceProjectId:n})=>{var a,s,r,o,i,l,u,m,p;const g=(null!=n&&(null==(a=null==e?void 0:e.projectIds)?void 0:a.includes(n)))??!1,f={...e??{},label:(null==e?void 0:e.name)??"",value:(null==e?void 0:e.id)??"",icon:g?c.jsx(d,{className:"icon-md text-green-400"}):null,knowledge_files:(null==(r=null==(s=null==e?void 0:e.tool_resources)?void 0:s.file_search)?void 0:r.file_ids)?[]:void 0,code_files:(null==(i=null==(o=null==e?void 0:e.tool_resources)?void 0:o.execute_code)?void 0:i.file_ids)?[]:void 0};if(!t)return f;const x=({file_id:e,tool_resource:n,list:a})=>{const s=t[e],r=n===ro.file_search?ji.vectordb:(null==s?void 0:s.source)??ji.local;s?null==a||a.push([e,{file_id:s.file_id,type:s.type,filepath:s.filepath,filename:s.filename,width:s.width,height:s.height,size:s.bytes,preview:s.filepath,progress:1,source:r}]):null==a||a.push([e,{file_id:e,type:"",filename:"",size:1,progress:1,filepath:Ro.agents,source:r}])};return f.knowledge_files&&(null==(u=null==(l=null==e?void 0:e.tool_resources)?void 0:l.file_search)?void 0:u.file_ids)&&e.tool_resources.file_search.file_ids.forEach((e=>x({file_id:e,list:f.knowledge_files,tool_resource:ro.file_search}))),f.code_files&&(null==(p=null==(m=null==e?void 0:e.tool_resources)?void 0:m.execute_code)?void 0:p.file_ids)&&e.tool_resources.execute_code.file_ids.forEach((e=>x({file_id:e,list:f.code_files,tool_resource:ro.execute_code}))),f},uu=(e,t,n,a)=>{const s=JSON.parse(JSON.stringify(e)),{pageIndex:r,index:o}=mu(e,a);return-1!==r&&-1!==o?pu(e,t,n,a):(s.pages[0][t].unshift({...n,updatedAt:(new Date).toISOString()}),s)};function mu(e,t){for(let n=0;n<e.pages.length;n++){const a=t(e.pages[n]);if(-1!==a)return{pageIndex:n,index:a}}return{pageIndex:-1,index:-1}}const pu=(e,t,n,a)=>{const s=JSON.parse(JSON.stringify(e)),{pageIndex:r,index:o}=mu(e,a);return-1!==r&&-1!==o&&(s.pages[r][t].splice(o,1),s.pages[0][t].unshift({...n,updatedAt:(new Date).toISOString()})),s},gu=(e,t,n)=>{const a=JSON.parse(JSON.stringify(e)),{pageIndex:s,index:r}=mu(a,n);return-1!==s&&-1!==r&&a.pages[s][t].splice(r,1),a},fu=(e,t,n,a)=>{const s=JSON.parse(JSON.stringify(e)),r=s.pages.length;if(0===r)return s;const o=s.pageParams;let i=s.pages.flatMap((e=>e[t]));if(0===i.length)return s;const l=Array.from({length:r},((e,a)=>({...s.pages[a],[t]:i.slice(a*n,(a+1)*n)}))).filter((e=>e[t].length>0));return{pageParams:o.slice(0,l.length),pages:l}};const xu={today:"com_ui_date_today",yesterday:"com_ui_date_yesterday",previous7Days:"com_ui_date_previous_7_days",previous30Days:"com_ui_date_previous_30_days",january:"com_ui_date_january",february:"com_ui_date_february",march:"com_ui_date_march",april:"com_ui_date_april",may:"com_ui_date_may",june:"com_ui_date_june",july:"com_ui_date_july",august:"com_ui_date_august",september:"com_ui_date_september",october:"com_ui_date_october",november:"com_ui_date_november",december:"com_ui_date_december"},hu=new Map([["december",11],["november",10],["october",9],["september",8],["august",7],["july",6],["june",5],["may",4],["april",3],["march",2],["february",1],["january",0]]),vu=Object.fromEntries(Object.entries(xu).map((([e,t])=>[t,e]))),bu=new Set([xu.today,xu.yesterday,xu.previous7Days,xu.previous30Days]),yu=e=>{if(!Array.isArray(e))return[];const t=new Set,n=new Map,a=new Date(Date.now());e.forEach((e=>{if(!e||t.has(e.conversationId))return;let s;t.add(e.conversationId),s=e.updatedAt?u(e.updatedAt):a;const r=(e=>{const t=new Date(Date.now());if(m(e))return xu.today;if(p(e,{start:g(f(t,1)),end:t}))return xu.yesterday;if(p(e,{start:f(t,7),end:t}))return xu.previous7Days;if(p(e,{start:f(t,30),end:t}))return xu.previous30Days;if(p(e,{start:x(t),end:t})){const t=h(e,"MMMM").toLowerCase();return xu[t]}return" "+v(e).toString()})(s);n.has(r)||n.set(r,[]),n.get(r).push(e)}));const s=new Map;bu.forEach((e=>{n.has(e)&&s.set(e,n.get(e))}));return Array.from(n.keys()).filter((e=>!bu.has(e))).sort(((e,t)=>{const[n,a]=[parseInt(e.trim()),parseInt(t.trim())];if(n!==a)return a-n;const[s,r]=[vu[e],vu[t]];return(hu.get(r)??-1)-(hu.get(s)??-1)})).forEach((e=>{s.set(e,n.get(e))})),s.forEach((e=>{e.sort(((e,t)=>new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()))})),Array.from(s,(([e,t])=>[e,t]))},_u=(e,t)=>uu(e,"conversations",t,(e=>e.conversations.findIndex((e=>e.conversationId===t.conversationId))));function ju(e,t){return mu(e,(e=>e.conversations.findIndex((e=>e.conversationId===t.conversationId))))}const wu=(e,t)=>pu(e,"conversations",t,(e=>e.conversations.findIndex((e=>e.conversationId===t.conversationId)))),Nu=(e,t,n=!1)=>{const a=JSON.parse(JSON.stringify(e)),{pageIndex:s,index:r}=ju(a,t);if(-1!==s&&-1!==r){const e=a.pages[s].conversations[r];if(n){const n={...e,...t};a.pages[s].conversations[r]=n}else{const n={...e,...t,updatedAt:(new Date).toISOString()};a.pages[s].conversations.splice(r,1),a.pages[0].conversations.unshift(n)}}return a},Cu=(e,t)=>gu(e,"conversations",(e=>e.conversations.findIndex((e=>e.conversationId===t)))),ku=(e,t)=>{if(e&&t)for(const n of e.pages){const e=n.conversations.find((e=>e.conversationId===t));if(e)return e}};const Su=(e,t)=>{const{endpoint:n,title:a,model:s,tools:r,promptPrefix:o,chatGptLabel:i,modelLabel:l}=e,c=s??"";let d="",u="";const m=[Ro.azureOpenAI,Ro.openAI,Ro.custom],p=[Ro.google,Ro.anthropic];return null!=n&&n&&m.includes(n)?u=i??"":null!=n&&n&&p.includes(n)&&(u=l??""),u&&null!=a&&a&&u.toLowerCase().includes(a.toLowerCase())?(d=u+": ",u=""):null!=a&&a&&"New Chat"!==a.trim()&&(d=a+": "),!0===t?`${c}${u?` | ${u}`:""}${null!=o&&o?` | ${o}`:""}${r?` | ${r.map((e=>"string"==typeof e?e:e.pluginKey)).join(", ")}`:""}`:`${d}${c}${u?` (${u})`:""}`.trim()},Tu=(e,t)=>{const n={...e};return n.tools&&n.tools.length>0&&(n.tools=n.tools.filter((e=>{let n;return"string"==typeof e?n=e:({pluginKey:n}=e),!!t[n]})).map((e=>"string"==typeof e?e:e.pluginKey))),n};function Ru({text:e,user:t}){if(!e)return e;const n=h(new Date,"yyyy-MM-dd");if(e=e.replace(/{{current_date}}/gi,n),!t)return e;const a=t.name;return e=e.replace(/{{current_user}}/gi,a)}const Iu=e=>/{{(?!current_date|current_user)[^{}]{1,}}}/gi.test(e),Eu=e=>`{{${e}}}`;function Pu(e,t){if(e.focus(),window.getSelection()&&document.queryCommandSupported("insertText"))document.execCommand("insertText",!1,t);else{console.warn("insertTextAtCursor: document.execCommand is not supported");const n=e.selectionStart,a=e.selectionEnd,s=e.value.substring(0,n),r=e.value.substring(a);e.value=s+t+r,e.selectionStart=e.selectionEnd=n+t.length;const o=new Event("input",{bubbles:!0});e.dispatchEvent(o)}}const Lu=e=>{e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)};function Mu(e,t){e.value.endsWith(t)&&(e.value=e.value.slice(0,-1),e.setSelectionRange(e.value.length,e.value.length),e.dispatchEvent(new Event("input",{bubbles:!0}))),e.focus()}const Au=e=>!!e&&e.scrollHeight>e.clientHeight,Ou=(e,t)=>{if(!e)return"";if(e.text)return e.text;if(e.content&&e.content.length>0)for(let n=e.content.length-1;n>=0;n--){const a=e.content[n];if(a&&a.type!==to.TEXT)continue;const s=("string"==typeof(null==a?void 0:a.text)?a.text:null==a?void 0:a.text.value)??"";if(s.length>0)return!0===t?`${s}-${n}`:s}return""},Du=e=>e?e.text?e.text:e.content&&e.content.length>0?e.content.filter((e=>e.type===to.TEXT)).map((e=>("string"==typeof e.text?e.text:e.text.value)||"")).filter((e=>e.length>0)).join("\n"):"":"",Fu=(e,t)=>{if(!e)return"";const n=Ou(e,!0);return`${e.messageId??""}${dc.COMMON_DIVIDER}${a=n,"string"!=typeof a||0===a.length?"0":`${a.length}${a.slice(-10)}`}${dc.COMMON_DIVIDER}${e.conversationId??t}`;var a},zu=e=>{const t=document.getElementById("messages-end");t&&(t.scrollIntoView({behavior:"instant"}),e&&e())},Uu=["python","javascript","java","go","bash","c","cpp","csharp","css","diff","graphql","json","kotlin","less","lua","makefile","markdown","objectivec","perl","php","php-template","plaintext","python-repl","r","ruby","rust","scss","shell","sql","swift","typescript","vbnet","wasm","xml","yaml"],Vu={c:"c",cpp:"cpp","c++":"cpp",cplusplus:"cpp",d:"d",f90:"f90",fortran:"f90",fortran90:"f90",go:"go",golang:"go",java:"java",js:"js",javascript:"js",node:"js",nodejs:"js",php:"php",py:"py",python:"py",python3:"py",rs:"rs",rust:"rs",ts:"ts",typescript:"ts"};const Bu=e=>{const t={};if(!e)return t;for(const n of Object.keys(e))t[n]=!!e[n];return t},$u=(e,t)=>{var n,a;const s=new Set(Wl),r=[];for(const o in t)(e[o]||(null==(n=t[o])?void 0:n.type)&&s.has(null==(a=t[o])?void 0:a.type))&&r.push(o);return r};function Hu(e,t,n){if(!e||null==t)return;const a=e[t];return a?a[n]:void 0}function Gu(e){const t=Bu(e);return $u(t,e).sort(((t,n)=>{var a,s;return((null==(a=null==e?void 0:e[t])?void 0:a.order)??0)-((null==(s=null==e?void 0:e[n])?void 0:s.order)??0)}))}const Ku=uc.LAST_CONVO_SETUP+"_0";function Wu(e){const{conversation:t,newEndpoint:n,endpointsConfig:a,modularChat:s=!1}=e,r=null==t?void 0:t.endpoint,o={...t,endpoint:n,conversationId:"new"},i=Oo(n)&&Oo(r)&&r===n,l=(null==t?void 0:t.conversationId)??"",c=!(!l||"new"===l),d=Hu(a,r,"type")??r,u=Hu(a,n,"type")??n,m=Xl.has(r??""),p=Xl.has(d??""),g=m||p||i,f=Xl.has(n??""),x=Xl.has(u??"");return{template:o,shouldSwitch:r===n||s||i,isExistingConversation:c,isCurrentModular:g,newEndpointType:u,isNewModular:f||x||i}}function Qu(e){const t=null==e?void 0:e.find((e=>e.default)),n=localStorage.getItem(uc.LAST_SPEC),a=null==e?void 0:e.find((e=>e.name===n));return t||a||(null==e?void 0:e[0])}function qu(e){return e.iconURL??e.preset.iconURL??e.preset.endpoint??""}function Zu({endpointsConfig:e,iconURL:t,endpoint:n}){return((null==e?void 0:e[t??""])?t??n:n)??""}function Yu({endpoint:e,endpointType:t,endpointsConfig:n,endpointIconURL:a}){const s=t??Hu(n,e,"type")??"",r=a??Hu(n,e,"iconURL")??"";return r&&null!=Ro[r]?r:s?"unknown":e??"unknown"}const Ju=({endpoint:e,assistant_id:t,agent_id:n,agentsMap:a,assistantMap:s})=>{var r;const o=Do(e),i=Oo(e);if(o){return{entity:null==a?void 0:a[n??""],isAgent:o,isAssistant:i}}if(i){return{entity:null==(r=null==s?void 0:s[e??""])?void 0:r[t??""],isAgent:o,isAssistant:i}}return{entity:null,isAgent:o,isAssistant:i}};function Xu(){const e={lastSelectedModel:localStorage.getItem(uc.LAST_MODEL)??"",lastSelectedTools:localStorage.getItem(uc.LAST_TOOLS)??"",lastConversationSetup:localStorage.getItem(uc.LAST_CONVO_SETUP+"_0")??""};return{lastSelectedModel:e.lastSelectedModel?JSON.parse(e.lastSelectedModel):{},lastSelectedTools:e.lastSelectedTools?JSON.parse(e.lastSelectedTools):[],lastConversationSetup:e.lastConversationSetup?JSON.parse(e.lastConversationSetup):{}}}const em=(e,t)=>gu(e,ec.PROMPT_GROUPS,(e=>e.promptGroups.findIndex((e=>e._id===t)))),tm=(e,t,n)=>((e,t,n,a,s)=>{const r=JSON.parse(JSON.stringify(e)),{pageIndex:o,index:i}=mu(r,(e=>e[n].findIndex((e=>e[a]===t[a]))));if(-1!==o&&-1!==i){const e={...r.pages[o][n].splice(i,1)[0],...t,updatedAt:(new Date).toISOString()};s&&s(e),r.pages[0][n].unshift(e)}return r})(e,t,ec.PROMPT_GROUPS,"_id",n),nm=(e,t)=>((e,t,n)=>{const{pageIndex:a,index:s}=mu(e,(e=>e[t].findIndex(n)));if(-1!==a&&-1!==s)return e.pages[a][t][s]})(e,ec.PROMPT_GROUPS,t),am=(e,t)=>{!function({queryClient:e,queryKey:t,searchProperty:n,updateData:a,searchValue:s}){e.setQueryData(t,(e=>e?e.map((e=>e[n]===s?{...e,...a}:e)):e))}({queryClient:e,queryKey:[Xc.allPromptGroups],searchProperty:"_id",updateData:t,searchValue:t._id})},sm=(e,t)=>{!function(e,t,n,a){e.setQueryData(t,(e=>e?e.filter((e=>e[n]!==a)):e))}(e,[Xc.allPromptGroups],"_id",t)};function rm(...e){return b(y(e))}const om={log:(...e)=>{},dir:(...e)=>{},warn:(...e)=>{},info:(...e)=>{},error:(...e)=>{},debug:(...e)=>{}};function im({messages:e,fileMap:t}){if(null===e)return null;const n={},a=[],s={};return e.forEach((e=>{const r=e.parentMessageId??"";s[r]=(s[r]||0)+1;const o={...e,children:[],depth:0,siblingIndex:s[r]-1};e.files&&t&&(o.files=e.files.map((e=>t[e.file_id??""]??e))),n[e.messageId]=o;const i=n[r];i?(i.children.push(o),o.depth=i.depth+1):a.push(o)})),a}const lm=e=>{const t="com_auth_error_login";if(!e)return t;switch(!0){case e.includes("429"):return"com_auth_error_login_rl";case e.includes("403"):return"com_auth_error_login_ban";case e.includes("500"):return"com_auth_error_login_server";case e.includes("422"):return"com_auth_error_login_unverified";default:return t}},cm=({preset:e})=>{const{endpoint:t,endpointType:n}=e??{};if(null==t||""===t)return console.error(`Unknown endpoint ${t}`,e),{endpoint:null,presetId:(null==e?void 0:e.presetId)??null,title:(null==e?void 0:e.title)??"New Preset"};const{presetOverride:a={},...s}=e??{},r={...s,...a},o=jc({endpoint:t,endpointType:n,conversation:r});return{presetId:(null==e?void 0:e.presetId)??null,...o,endpoint:t,endpointType:n,title:(null==e?void 0:e.title)??"New Preset"}},dm=({models:e,conversation:t,endpoint:n=null,lastConversationSetup:a})=>{var s;const{lastSelectedModel:r,lastSelectedTools:o}=Xu(),i=(null==a?void 0:a.endpointType)??t.endpointType;if(!n)return{...t,endpointType:i,endpoint:n};const l=e,c=(null==a?void 0:a.model)??(null==r?void 0:r[n])??"",d=n===Ro.gptPlugins?(null==(s=null==a?void 0:a.agentOptions)?void 0:s.model)??(null==r?void 0:r.secondaryModel)??null:null;let u,m;u=l.includes(c)?[c,...l]:[...l],m=null!=d&&""!==d&&l.includes(d)?[d,...l]:[...l];const p=jc({endpoint:n,endpointType:i,conversation:a,possibleValues:{models:u,secondaryModels:m}}),g={...t,...p,endpointType:i,endpoint:n},f=(null==p?void 0:p.assistant_id)??"",x=(null==a?void 0:a.assistant_id)??"";Oo(n)&&!x&&f&&(g.assistant_id=f);const h=(null==p?void 0:p.agent_id)??"",v=(null==a?void 0:a.agent_id)??"";return Do(n)&&!v&&h&&(g.agent_id=h),g.tools=(null==a?void 0:a.tools)??o??g.tools,g},um=({convoSetup:e,endpointsConfig:t})=>((e,t)=>{let{endpoint:n=""}=e||{};return n=n??"",n&&(null==t?void 0:t[n])?n:(n&&console.warn(`Illegal target endpoint ${n} ${t}`),null)})(e,t)||(e=>{try{const{lastConversationSetup:t}=Xu(),{endpoint:n}=t??{endpoint:null},a=Object.values(e??{}).every((e=>!e));return a&&n||a&&n||n&&null!=(null==e?void 0:e[n])?n:null}catch(t){return console.error(t),null}})(t)||(e=>Gu(e).find((t=>Object.hasOwn(e??{},t))))(t),mm="",pm="focus:outline-none focus:ring-0 focus:ring-opacity-0 focus:ring-offset-0",gm="transition-colors rounded-md min-w-[75px] border font-normal bg-white hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-700 dark:bg-gray-800 text-black dark:text-gray-600 focus:outline-none data-[state=open]:bg-gray-50 dark:data-[state=open]:bg-gray-700",fm="rounded-md border border-gray-200 focus:border-gray-400 focus:bg-gray-50 bg-transparent text-sm shadow-[0_0_10px_rgba(0,0,0,0.05)] outline-none focus-within:placeholder:text-text-primary focus:placeholder:text-text-primary placeholder:text-text-secondary focus:outline-none focus:ring-gray-400 focus:ring-opacity-20 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:focus:bg-gray-600 dark:focus:border-gray-600 dark:text-gray-50 dark:shadow-[0_0_15px_rgba(0,0,0,0.10)] dark:focus:outline-none",xm="p-0 shadow-none text-right pr-1 h-8 border-transparent hover:bg-gray-800/10 dark:hover:bg-white/10 dark:focus:bg-white/10 transition-colors",hm=e=>{const t=document.createRange();t.selectNodeContents(e.target);const n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))},vm=e=>"string"==typeof e?e:_.isValidElement(e)?vm(e.props.children):Array.isArray(e)?e.map(vm).join(""):"",bm=e=>{const t=e.reduce(((e,t)=>e+t),0);if(Math.abs(t-100)<.01)return e.map((e=>Number(e.toFixed(2))));const n=100/t,a=e.map((e=>Number((e*n).toFixed(2)))),s=a.reduce(((t,n,a)=>a===e.length-1?t:t+n),0);return a[a.length-1]=Number((100-s).toFixed(2)),a},ym=j({key:"artifactsState",default:null,effects:[({onSet:e,node:t})=>{e((async e=>{om.log("artifacts","Recoil Effect: Setting artifactsState",{key:t.key,newValue:e})}))}]}),_m=j({key:"currentArtifactId",default:null,effects:[({onSet:e,node:t})=>{e((async e=>{om.log("artifacts","Recoil Effect: Setting currentArtifactId",{key:t.key,newValue:e})}))}]}),jm=j({key:"artifactsVisible",default:!0,effects:[({onSet:e,node:t})=>{e((async e=>{om.log("artifacts","Recoil Effect: Setting artifactsVisible",{key:t.key,newValue:e})}))}]}),wm=Object.freeze(Object.defineProperty({__proto__:null,artifactsState:ym,artifactsVisible:jm,currentArtifactId:_m},Symbol.toStringTag,{value:"Module"})),Nm=n.createContext({}),Cm=({children:e})=>{const t=n.useRef(!1);return c.jsx(Nm.Provider,{value:t,children:e})},km=j({key:"latestMessageKeys",default:[]}),Sm=j({key:"submissionKeys",default:[]}),Tm=w({key:"latestMessageByIndex",default:null,effects:[({onSet:e,node:t})=>{e((async e=>{const n=Number(t.key.split(dc.COMMON_DIVIDER)[1]);om.log("Recoil Effect: Setting latestMessage",{key:n,newValue:e})}))}]}),Rm=w({key:"submissionByIndex",default:null}),Im=N({key:"latestMessageKeysSelector",get:({get:e})=>e(Mm).filter((t=>null!==e(Tm(t)))),set:({set:e},t)=>{om.log("setting latestMessageKeys",{newKeys:t}),e(km,t)}}),Em=N({key:"submissionKeysSelector",get:({get:e})=>e(Mm).filter((t=>null!==e(Rm(t)))),set:({set:e},t)=>{om.log("setting submissionKeysAtom",t),e(Sm,t)}}),Pm=w({key:"conversationByIndex",default:null,effects:[({onSet:e,node:t})=>{e((async e=>{const n=Number(t.key.split("__")[1]);om.log("conversation","Setting conversation:",{index:n,newValue:e}),null!=(null==e?void 0:e.assistant_id)&&e.assistant_id&&localStorage.setItem(`${uc.ASST_ID_PREFIX}${n}${e.endpoint}`,e.assistant_id),null!=(null==e?void 0:e.agent_id)&&e.agent_id&&localStorage.setItem(`${uc.AGENT_ID_PREFIX}${n}`,e.agent_id),null!=(null==e?void 0:e.spec)&&e.spec&&localStorage.setItem(uc.LAST_SPEC,e.spec),(null==e?void 0:e.tools)&&Array.isArray(e.tools)&&localStorage.setItem(uc.LAST_TOOLS,JSON.stringify(e.tools.filter((e=>!!e)))),e&&(!function(e){if(!e)return;const{endpoint:t,model:n,agentOptions:a}=e;if(!t)return;const s=JSON.parse(localStorage.getItem(uc.LAST_MODEL)??"{}");s[t]=n,t===Ro.gptPlugins&&(s.secondaryModel=(null==a?void 0:a.model)??n??""),localStorage.setItem(uc.LAST_MODEL,JSON.stringify(s))}(e),localStorage.setItem(`${uc.LAST_CONVO_SETUP}_${n}`,JSON.stringify(e)))}))}]}),Lm=w({key:"filesByIndex",default:new Map}),Mm=j({key:"conversationKeys",default:[]}),Am=N({key:"allConversationsSelector",get:({get:e})=>e(Mm).map((t=>e(Pm(t)))).map((e=>null==e?void 0:e.conversationId))}),Om=w({key:"presetByIndex",default:null}),Dm=w({key:"textByIndex",default:""}),Fm=w({key:"showStopButtonByIndex",default:!1}),zm=w({key:"abortScrollByIndex",default:!1,effects:[({onSet:e,node:t})=>{e((async e=>{const n=Number(t.key.split(dc.COMMON_DIVIDER)[1]);om.log("message_scrolling","Recoil Effect: Setting abortScrollByIndex",{key:n,newValue:e})}))}]}),Um=w({key:"isSubmittingByIndex",default:!1,effects:[({onSet:e,node:t})=>{e((async e=>{const n=Number(t.key.split(dc.COMMON_DIVIDER)[1]);om.log("message_stream","Recoil Effect: Setting isSubmittingByIndex",{key:n,newValue:e})}))}]}),Vm=w({key:"optionSettingsByIndex",default:{}}),Bm=w({key:"showAgentSettingsByIndex",default:!1}),$m=w({key:"showPopoverByIndex",default:!1}),Hm=w({key:"activePromptByIndex",default:void 0}),Gm=w({key:"showMentionPopoverByIndex",default:!1}),Km=w({key:"showPlusPopoverByIndex",default:!1}),Wm=w({key:"showPromptsPopoverByIndex",default:!1}),Qm=w({key:"globalAudioURLByIndex",default:null}),qm=w({key:"globalAudioisFetchingByIndex",default:!1}),Zm=w({key:"globalAudioisPlayingByIndex",default:!1}),Ym=w({key:"activeRunByIndex",default:null}),Jm=w({key:"audioRunByIndex",default:null}),Xm=w({key:"messagesSiblingIdx",default:0});const ep=C({key:"conversationByKeySelector",get:e=>({get:t})=>t(Pm(e))});const tp=C({key:"updateConversationSelector",get:()=>()=>null,set:e=>({set:t,get:n},a)=>{if(a instanceof k)return;n(Mm).forEach((n=>{t(Pm(n),(t=>t&&t.conversationId===e?{...t,...a}:t))}))}}),np={conversationKeysAtom:Mm,conversationByIndex:Pm,filesByIndex:Lm,presetByIndex:Om,submissionByIndex:Rm,textByIndex:Dm,showStopButtonByIndex:Fm,abortScrollFamily:zm,isSubmittingFamily:Um,optionSettingsFamily:Vm,showAgentSettingsFamily:Bm,showPopoverFamily:$m,latestMessageFamily:Tm,messagesSiblingIdxFamily:Xm,allConversationsSelector:Am,conversationByKeySelector:ep,useClearConvoState:function(){return S((({reset:e,snapshot:t})=>async n=>{const a=await t.getPromise(Mm);for(const s of a){if(!0===n&&0==s)continue;e(Pm(s));await t.getPromise(Pm(s))&&e(Tm(s))}e(Mm)}),[])},useCreateConversationAtom:function(e){const t=n.useContext(Nm),[a,s]=T(Mm),r=R(Pm(e)),o=I(Pm(e));return n.useEffect((()=>{a.includes(e)||s([...a,e])}),[e,a,s]),{hasSetConversation:t,conversation:o,setConversation:r}},showMentionPopoverFamily:Gm,globalAudioURLFamily:Qm,activeRunFamily:Ym,audioRunFamily:Jm,globalAudioPlayingFamily:Zm,globalAudioFetchingFamily:qm,showPlusPopoverFamily:Km,activePromptByIndex:Hm,useClearSubmissionState:function(){return S((({reset:e,set:t,snapshot:n})=>async a=>{const s=await n.getPromise(Em);om.log("submissionKeys",s);for(const t of s)!0===a&&0==t||(om.log("resetting submission",t),e(Rm(t)));t(Em,[])}),[])},useClearLatestMessages:function(e){return S((({reset:t,set:n,snapshot:a})=>async s=>{const r=await a.getPromise(Im);om.log("[clearAllLatestMessages] latestMessageKeys",r),null!=e&&e&&om.log(`[clearAllLatestMessages] context: ${e}`);for(const e of r)!0===s&&0==e||(om.log(`[clearAllLatestMessages] resetting latest message; key: ${e}`),t(Tm(e)));n(Im,[])}),[])},showPromptsPopoverFamily:Wm,updateConversationSelector:tp},ap={[Ro.azureOpenAI]:null,[Ro.azureAssistants]:null,[Ro.assistants]:null,[Ro.agents]:null,[Ro.openAI]:null,[Ro.chatGPTBrowser]:null,[Ro.gptPlugins]:null,[Ro.google]:null,[Ro.anthropic]:null,[Ro.custom]:null},sp=j({key:"endpointsConfig",default:ap}),rp=j({key:"endpointsQueryEnabled",default:!0}),op=N({key:"plugins",get:({get:e})=>{var t;return(null==(t=(e(sp)||{}).gptPlugins)?void 0:t.plugins)||{}}}),ip=N({key:"endpointsFilter",get:({get:e})=>{const t=e(sp)||{},n={};for(const a of Object.keys(t))n[a]=!!t[a];return n}}),lp={plugins:op,endpointsConfig:sp,endpointsFilter:ip,defaultConfig:ap,endpointsQueryEnabled:rp},cp={user:j({key:"user",default:void 0}),availableTools:j({key:"availableTools",default:{}})},dp={text:j({key:"text",default:""})},up={toastState:j({key:"toastState",default:{open:!1,message:"",severity:Wr.SUCCESS,showIcon:!0}})},mp={submission:j({key:"submission",default:null}),isSubmitting:j({key:"isSubmitting",default:!1})},pp={isSearchEnabled:j({key:"isSearchEnabled",default:null}),searchQuery:j({key:"searchQuery",default:""}),isSearching:j({key:"isSearching",default:!1})},gp={defaultPreset:j({key:"defaultPreset",default:null}),presetModalVisible:j({key:"presetModalVisible",default:!1})};function fp(e,t){return j({key:e,default:t,effects_UNSTABLE:[({setSelf:n,onSet:a})=>{const s=localStorage.getItem(e);if(null!==s)try{n(JSON.parse(s))}catch(Bg){console.error(`Error parsing localStorage key "${e}", \`savedValue\`: defaultValue, error:`,Bg),localStorage.setItem(e,JSON.stringify(t)),n(t)}a((t=>{localStorage.setItem(e,JSON.stringify(t))}))}]})}const xp={...{promptsName:j({key:"promptsName",default:""}),promptsCategory:j({key:"promptsCategory",default:""}),promptsPageNumber:j({key:"promptsPageNumber",default:1}),promptsPageSize:j({key:"promptsPageSize",default:10})},...{autoSendPrompts:fp("autoSendPrompts",!0),alwaysMakeProd:fp("alwaysMakeProd",!0),promptsEditorMode:fp("promptsEditorMode",zr.SIMPLE)}},hp={lang:fp("lang",(()=>{const e=navigator.language||navigator.languages[0];return E.get("lang")||localStorage.getItem("lang")||e})())},vp={...{abortScroll:j({key:"abortScroll",default:!1}),showFiles:j({key:"showFiles",default:!1}),optionSettings:j({key:"optionSettings",default:{}}),showPluginStoreDialog:j({key:"showPluginStoreDialog",default:!1}),showAgentSettings:j({key:"showAgentSettings",default:!1}),currentSettingsView:j({key:"currentSettingsView",default:il.default}),showPopover:j({key:"showPopover",default:!1})},...{autoScroll:fp("autoScroll",!1),hideSidePanel:fp("hideSidePanel",!1),fontSize:fp("fontSize","text-base"),enableUserMsgMarkdown:fp(uc.ENABLE_USER_MSG_MARKDOWN,!0),enterToSend:fp("enterToSend",!0),maximizeChatSpace:fp("maximizeChatSpace",!1),chatDirection:fp("chatDirection","LTR"),showCode:fp(uc.SHOW_ANALYSIS_CODE,!0),saveDrafts:fp("saveDrafts",!0),showScrollButton:fp("showScrollButton",!0),forkSetting:fp("forkSetting",""),splitAtTarget:fp("splitAtTarget",!1),rememberDefaultFork:fp(uc.REMEMBER_FORK_OPTION,!1),showThinking:fp("showThinking",!1),modularChat:fp("modularChat",!0),LaTeXParsing:fp("LaTeXParsing",!0),codeArtifacts:fp("codeArtifacts",!1),includeShadcnui:fp("includeShadcnui",!1),customPromptMode:fp("customPromptMode",!1),atCommand:fp("atCommand",!0),plusCommand:fp("plusCommand",!0),slashCommand:fp("slashCommand",!0),conversationMode:fp("conversationMode",!1),advancedMode:fp("advancedMode",!1),speechToText:fp("speechToText",!0),engineSTT:fp("engineSTT","browser"),languageSTT:fp("languageSTT",""),autoTranscribeAudio:fp("autoTranscribeAudio",!1),decibelValue:fp("decibelValue",-45),autoSendText:fp("autoSendText",-1),textToSpeech:fp("textToSpeech",!0),engineTTS:fp("engineTTS","browser"),voice:fp("voice",void 0),cloudBrowserVoices:fp("cloudBrowserVoices",!1),languageTTS:fp("languageTTS",""),automaticPlayback:fp("automaticPlayback",!1),playbackRate:fp("playbackRate",null),cacheTTS:fp("cacheTTS",!0),UsernameDisplay:fp("UsernameDisplay",!0)}},bp={hideBannerHint:fp("hideBannerHint",[]),messageAttachmentsMap:j({key:"messageAttachmentsMap",default:{}}),queriesEnabled:j({key:"queriesEnabled",default:!0})},yp={isTemporary:fp("isTemporary",!1)},_p={...wm,...np,...lp,...cp,...dp,...up,...mp,...pp,...xp,...gp,...hp,...vp,...bp,...yp};function jp(e=0){const t=R(_p.audioRunFamily(e)),a=R(_p.activeRunFamily(e)),s=R(_p.globalAudioPlayingFamily(e)),r=R(_p.globalAudioFetchingFamily(e)),[o,i]=T(_p.globalAudioURLFamily(e));return{pauseGlobalAudio:n.useCallback((()=>{if(null!=o&&""!==o){const e=document.getElementById(Br);e&&(console.log("Pausing global audio",o),e.pause(),s(!1)),URL.revokeObjectURL(o),r(!1),i(null),a(null),t(null)}}),[t,a,o,i,s,r])}}function wp(){const e=_p.useClearConvoState(),t=_p.useClearSubmissionState(),n=_p.useClearLatestMessages();return S((({reset:a,snapshot:s})=>async r=>{await t(r),await e(r),await n(r);const o=await s.getPromise(_p.conversationKeysAtom);for(const e of o)!0===r&&0===e||(a(_p.filesByIndex(e)),a(_p.presetByIndex(e)),a(_p.textByIndex(e)),a(_p.showStopButtonByIndex(e)),a(_p.abortScrollFamily(e)),a(_p.isSubmittingFamily(e)),a(_p.optionSettingsFamily(e)),a(_p.showAgentSettingsFamily(e)),a(_p.showPopoverFamily(e)),a(_p.showMentionPopoverFamily(e)),a(_p.showPlusPopoverFamily(e)),a(_p.showPromptsPopoverFamily(e)),a(_p.activePromptByIndex(e)),a(_p.globalAudioURLFamily(e)),a(_p.globalAudioFetchingFamily(e)),a(_p.globalAudioPlayingFamily(e)),a(_p.activeRunFamily(e)),a(_p.audioRunFamily(e)),a(_p.messagesSiblingIdxFamily(e.toString())));!function(e){Object.keys(localStorage).forEach((t=>{!0===e&&t.endsWith("0")||(t.startsWith(uc.ASST_ID_PREFIX)||t.startsWith(uc.AGENT_ID_PREFIX)||t.startsWith(uc.LAST_CONVO_SETUP)||t===uc.LAST_SPEC||t===uc.LAST_TOOLS||t===uc.LAST_MODEL||t===uc.FILES_TO_DELETE)&&localStorage.removeItem(t)}))}(r)}),[])}const Np=()=>{const e=ar().getQueryData([Xc.endpoints]),t=!!(null==e?void 0:e[Ro.agents]);return nr([Xc.tools],(()=>zd.getAvailableAgentTools()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,enabled:t})},Cp=(e=To,t)=>{const n=ar().getQueryData([Xc.endpoints]),a=!!(null==n?void 0:n[Ro.agents]);return nr([Xc.agents,e],(()=>zd.listAgents(e)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...t,enabled:void 0!==(null==t?void 0:t.enabled)?t.enabled&&a:a})},kp=(e,t)=>nr([Xc.agent,e],(()=>zd.getAgentById({agent_id:e})),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...t}),Sp=e=>{const t=ar();return sr((e=>zd.createAgent(e)),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.agents,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=[n,...JSON.parse(JSON.stringify(i.data))];return t.setQueryData([Xc.agents,To],{...i,data:l}),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)}})},Tp=e=>{const t=ar();return sr((({agent_id:e,data:t})=>zd.updateAgent({data:t,agent_id:e})),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.agents,To]);return i?(t.setQueryData([Xc.agents,To],{...i,data:i.data.map((e=>e.id===a.agent_id?n:e))}),t.setQueryData([Xc.agent,a.agent_id],n),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)):null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s)}})},Rp=e=>{const t=ar();return sr((({agent_id:e})=>zd.deleteAgent({agent_id:e})),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.agents,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=i.data.filter((e=>e.id!==a.agent_id));return t.setQueryData([Xc.agents,To],{...i,data:l}),t.removeQueries([Xc.agent,a.agent_id]),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,l)}})},Ip=e=>{const t=ar();return sr((e=>zd.duplicateAgent(e)),{onMutate:null==e?void 0:e.onMutate,onError:null==e?void 0:e.onError,onSuccess:({agent:n,actions:a},s,r)=>{var o;const i=t.getQueryData([Xc.agents,To]);if(i){const e=[n,...i.data];t.setQueryData([Xc.agents,To],{...i,data:e})}const l=t.getQueryData([Xc.actions])||[];return t.setQueryData([Xc.actions],l.concat(a)),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,{agent:n,actions:a},s,r)}})},Ep=e=>sr([ed.agentAvatarUpload],{mutationFn:({postCreation:e,...t})=>zd.uploadAgentAvatar(t),...e||{}}),Pp=e=>{const t=ar();return sr([ed.updateAgentAction],{mutationFn:e=>zd.updateAgentAction(e),onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.agents,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=n[0];return t.setQueryData([Xc.agents,To],{...i,data:i.data.map((e=>e.id===a.agent_id?l:e))}),t.setQueryData([Xc.actions],(e=>null==e?void 0:e.map((e=>e.action_id===a.action_id?n[1]:e)).concat(null!=a.action_id&&a.action_id?[]:[n[1]]))),t.setQueryData([Xc.agent,a.agent_id],l),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)}})},Lp=e=>{const t=ar();return sr([ed.deleteAgentAction],{mutationFn:e=>zd.deleteAgentAction({...e}),onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r;let o="";return t.setQueryData([Xc.actions],(e=>null==e?void 0:e.filter((e=>(o=e.metadata.domain,e.action_id!==a.action_id))))),t.setQueryData([Xc.agents,To],(e=>e?{...e,data:e.data.map((e=>{var t;return e.id===a.agent_id?{...e,tools:null==(t=e.tools)?void 0:t.filter((e=>!e.includes(o??"")))}:e}))}:e)),t.setQueryData([Xc.agent,a.agent_id],(e=>{var t;return e?{...e,tools:null==(t=e.tools)?void 0:t.filter((e=>!e.includes(o??"")))}:e})),null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s)}})},Mp=e=>{const t=I(_p.queriesEnabled);return nr([Xc.endpoints],(()=>zd.getAIEndpoints()),{staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})},Ap=e=>{const t=I(_p.queriesEnabled);return nr([Xc.startupConfig],(()=>zd.getStartupConfig()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})},Op=e=>{const t=I(_p.queriesEnabled);return nr([Xc.files],(()=>zd.getFiles()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})},Dp=e=>nr([Xc.fileConfig],(()=>zd.getFileConfig()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e}),Fp=e=>{const t=ar(),{onSuccess:n,...a}=e||{};return sr([ed.fileDelete],{mutationFn:e=>zd.deleteFiles(e),...a,onSuccess:(e,a,s)=>{t.setQueryData([Xc.files],(e=>{const{files:t}=a,n=t.reduce(((e,t)=>(e.set(t.file_id,t),e)),new Map);return(e??[]).filter((e=>!n.has(e.file_id)))})),null==n||n(e,a,s),null!=a.agent_id&&a.agent_id&&t.refetchQueries([Xc.agent,a.agent_id])}})},zp=e=>{const t=I(_p.queriesEnabled);return nr([Xc.balance],(()=>zd.getUserBalance()),{refetchOnWindowFocus:!0,refetchOnReconnect:!0,refetchOnMount:!0,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})},Up=e=>{const t=I(_p.queriesEnabled);return nr([Xc.searchEnabled],(()=>zd.getSearchEnabled()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})},Vp=(e,t)=>nr([Xc.toolAuth,e.toolId],(()=>zd.getVerifyAgentToolAuth(e)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t}),Bp=(e,t)=>{const{conversationId:n=""}=e;return nr([Xc.toolCalls,n],(()=>zd.getToolCalls(e)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,enabled:n.length>0&&n!==dc.NEW_CONVO&&n!==dc.SEARCH,...t})},$p=e=>nr([Xc.presets],(()=>zd.getPresets()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e}),Hp=(e,t)=>rr([Xc.searchConversations,e],(({pageParam:t="1"})=>zd.listConversationsByQuery({...e,pageNumber:t})),{getNextPageParam:e=>{const t=Number(e.pageNumber);return t<Number(e.pages)?t+1:void 0},refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t}),Gp=(e,t)=>{const n=I(_p.queriesEnabled);return rr(!0===(null==e?void 0:e.isArchived)?[Xc.archivedConversations]:[Xc.allConversations],(({pageParam:t=""})=>zd.listConversations({...e,pageNumber:null==t?void 0:t.toString(),isArchived:(null==e?void 0:e.isArchived)??!1,tags:(null==e?void 0:e.tags)||[]})),{getNextPageParam:e=>{const t=Number(e.pageNumber);return t<Number(e.pages)?t+1:void 0},refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t,enabled:!0===((null==t?void 0:t.enabled)??!0)&&n})},Kp=(e,t)=>{const{pageSize:n,isPublic:a,search:s,sortBy:r,sortDirection:o}=e;return rr({queryKey:[Xc.sharedLinks,{pageSize:n,isPublic:a,search:s,sortBy:r,sortDirection:o}],queryFn:({pageParam:e})=>zd.listSharedLinks({cursor:null==e?void 0:e.toString(),pageSize:n,isPublic:a,search:s,sortBy:r,sortDirection:o}),getNextPageParam:e=>e.nextCursor??void 0,keepPreviousData:!0,staleTime:3e5,cacheTime:18e5,...t})},Wp=e=>nr([Xc.conversationTags],(()=>zd.getConversationTags()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e}),Qp=e=>{var t,n;const a=ar(),s=a.getQueryData([Xc.endpoints]),r=a.getQueryData([Xc.name,e]),o=!!!(null==(t=null==s?void 0:s[e])?void 0:t.userProvide)||!!(null==r?void 0:r.expiresAt),i=!!(null==s?void 0:s[e])&&o,l=(null==(n=null==s?void 0:s[e])?void 0:n.version)??wl[e];return nr([Xc.tools],(()=>zd.getAvailableTools(e,l)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,enabled:i})},qp=(e,t=To,n)=>{var a,s;const r=ar(),o=r.getQueryData([Xc.endpoints]),i=r.getQueryData([Xc.name,e]),l=!!!(null==(a=null==o?void 0:o[e])?void 0:a.userProvide)||!!(null==i?void 0:i.expiresAt),c=!!(null==o?void 0:o[e])&&l,d=(null==(s=null==o?void 0:o[e])?void 0:s.version)??wl[e];return nr([Xc.assistants,e,t],(()=>zd.listAssistants({...t,endpoint:e},d)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...n,enabled:void 0!==(null==n?void 0:n.enabled)?n.enabled&&c:c})},Zp=(e,t)=>{var n;const a=ar(),s=a.getQueryData([Xc.endpoints]),r=a.getQueryData([Xc.name,e]),o=!!!(null==(n=null==s?void 0:s[e])?void 0:n.userProvide)||!!(null==r?void 0:r.expiresAt),i=!!(null==s?void 0:s[e])&&o||e===Ro.agents;return nr([Xc.actions],(()=>zd.getActions()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t,enabled:i})},Yp=(e,t)=>{var n,a;const s=ar(),r=s.getQueryData([Xc.endpoints]),o=s.getQueryData([Xc.name,e]),i=!!!(null==(n=null==r?void 0:r[e])?void 0:n.userProvide)||!!(null==o?void 0:o.expiresAt),l=!!(null==r?void 0:r[e])&&i,c=(null==(a=null==r?void 0:r[e])?void 0:a.version)??wl[e];return nr([Xc.assistantDocs,e],(()=>zd.getAssistantDocs({endpoint:e,version:c})),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t,enabled:void 0!==(null==t?void 0:t.enabled)?t.enabled&&l:l})},Jp=(e,t)=>{const{name:n,pageSize:a,category:s,...r}=e||{};return rr([Xc.promptGroups,n,s,a],(({pageParam:e="1"})=>zd.getPromptGroups({...r,name:n,category:s||"",pageNumber:null==e?void 0:e.toString(),pageSize:(a||10).toString()})),{getNextPageParam:e=>{const t=Number(e.pageNumber);return t<Number(e.pages)?t+1:void 0},refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t})},Xp=()=>{const e=ar();return{updateTagsInConversation:(t,n)=>{const a=e.getQueryData([Xc.conversation,t]);if(!a)return;const s={...a,tags:n};e.setQueryData([Xc.conversation,t],s),e.setQueryData([Xc.allConversations],(e=>e?Nu(e,{conversationId:a.conversationId,tags:s.tags},!0):e))},replaceTagsInAllConversations:(t,n)=>{const a=e.getQueryData([Xc.allConversations]),s=[],r=JSON.parse(JSON.stringify(a));for(let e=0;e<r.pages.length;e++){const a=r.pages[e];a.conversations=a.conversations.map((e=>{var a;return e.conversationId&&(null==(a=e.tags)?void 0:a.includes(t))&&(s.push(e.conversationId),e.tags=e.tags.map((e=>e===t?n:e))),e}))}e.setQueryData([Xc.allConversations],r);for(let o=0;o<s.length;o++){const a=s[o],r=e.getQueryData([Xc.conversation,a]);if(r&&r.tags){const s={...r,tags:r.tags.map((e=>e===t?n:e))};e.setQueryData([Xc.conversation,a],s)}}}}},eg=()=>{const e=ar();return sr((e=>zd.genTitle(e)),{onSuccess:(t,n)=>{e.setQueryData([Xc.conversation,n.conversationId],(e=>e?{...e,title:t.title}:e)),e.setQueryData([Xc.allConversations],(e=>e?Nu(e,{conversationId:n.conversationId,title:t.title}):e)),document.title=t.title}})},tg=e=>{const t=ar(),{refetch:n}=Gp(),{refetch:a}=Gp({pageNumber:"1",isArchived:!0});return sr((e=>zd.archiveConversation(e)),{onSuccess:(s,r)=>{const o=!0===r.isArchived;if(o?t.setQueryData([Xc.conversation,e],null):t.setQueryData([Xc.conversation,e],s),t.setQueryData([Xc.allConversations],(t=>{if(!t)return t;const n=t.pages[0].pageSize;return fu(o?Cu(t,e):_u(t,s),"conversations",n)})),o){const e=t.getQueryData([Xc.allConversations]);n({refetchPage:(t,n)=>n===((null==e?void 0:e.pages.length)??1)-1})}if(t.setQueryData([Xc.archivedConversations],(t=>{if(!t)return t;const n=t.pages[0].pageSize;return fu(o?_u(t,s):Cu(t,e),"conversations",n)})),!o){const e=t.getQueryData([Xc.archivedConversations]);a({refetchPage:(t,n)=>n===((null==e?void 0:e.pages.length)??1)-1})}}})},ng=e=>{const t=ar(),{onSuccess:n,...a}={};return sr((e=>zd.archiveConversation(e)),{onSuccess:(e,a)=>{const{conversationId:s}=a,r=!0===a.isArchived;r?t.setQueryData([Xc.conversation,s],null):t.setQueryData([Xc.conversation,s],e),t.setQueryData([Xc.allConversations],(t=>{if(!t)return t;const n=t.pages[0].pageSize;return fu(r?Cu(t,s):_u(t,e),"conversations",n)})),t.setQueryData([Xc.archivedConversations],(t=>{if(!t)return t;const n=t.pages[0].pageSize;return fu(r?_u(t,e):Cu(t,s),"conversations",n)})),null==n||n(e,a)},...a})},ag=e=>{const t=ar(),{onSuccess:n,...a}=e||{};return sr((({conversationId:e})=>{if(!e)throw new Error("Conversation ID is required");return zd.createSharedLink(e)}),{onSuccess:(e,a,s)=>{t.setQueryData([Xc.sharedLinks,e.conversationId],e),null==n||n(e,a,s)},...a})},sg=e=>{const t=ar(),{onSuccess:n,...a}=e||{};return sr((({shareId:e})=>{if(!e)throw new Error("Share ID is required");return zd.updateSharedLink(e)}),{onSuccess:(e,a,s)=>{t.setQueryData([Xc.sharedLinks,e.conversationId],e),null==n||n(e,a,s)},...a})},rg=e=>{const t=ar(),{onSuccess:n}=e||{};return sr((e=>zd.deleteSharedLink(e.shareId)),{onMutate:async e=>{await t.cancelQueries({queryKey:[Xc.sharedLinks],exact:!1});const n=new Map;return t.getQueryCache().findAll([Xc.sharedLinks]).forEach((a=>{const s=t.getQueryData(a.queryKey);n.set(a.queryKey,s),t.setQueryData(a.queryKey,(t=>{if(!(null==t?void 0:t.pages))return t;const n=t.pages.map((t=>({...t,links:t.links.filter((t=>t.shareId!==e.shareId))}))).filter((e=>e.links.length>0));return{...t,pages:n}}))})),{previousQueries:n}},onError:(e,n,a)=>{(null==a?void 0:a.previousQueries)&&a.previousQueries.forEach(((e,n)=>{t.setQueryData(n,e)}))},onSettled:()=>{t.invalidateQueries({queryKey:[Xc.sharedLinks],exact:!1})},onSuccess:(e,a)=>{n&&n(e,a),t.refetchQueries({queryKey:[Xc.sharedLinks],exact:!0})}})},og=({context:e,tag:t,options:n})=>{const a=ar(),{onSuccess:s,...r}=n||{},{updateTagsInConversation:o,replaceTagsInAllConversations:i}=Xp();return sr((e=>null!=t?zd.updateConversationTag(t,e):zd.createConversationTag(e)),{onSuccess:(...n)=>{((n,s)=>{if(a.setQueryData([Xc.conversationTags],(a=>{if(!a)return[{count:1,position:0,tag:dc.SAVED_TAG,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}];if(void 0===t||!t.length){const t=a.findIndex((e=>e.tag===n.tag));if(-1!==t){om.log("tag_mutation",`"Created" tag exists, updating from ${e}`,a,n);const s=[...a];return s[t]={...s[t],...n},s.sort(((e,t)=>e.position-t.position))}return om.log("tag_mutation",`"Created" tag is new, adding from ${e}`,a,n),[...a,n].sort(((e,t)=>e.position-t.position))}return om.log("tag_mutation",`Updating tag from ${e}`,a,n),((e,t,n,a)=>{if(0===e.length)return[n];const s=e.find((e=>e.tag===a));if(!s)return[e[0],n,...e.slice(1)].map(((e,t)=>({...e,position:t})));const r=s.position,o=n.position,i=e.filter((e=>e.tag!==a));if(void 0===o||r===o)return e.map((e=>e.tag===a?n:e));const l=[...i.slice(0,o),n,...i.slice(o)];if(o>r)for(let c=r;c<o;c++)l[c].position=c;else for(let c=o+1;c<l.length;c++)l[c].position=c;return l})(a,0,n,t)})),!0===s.addToConversation&&null!=s.conversationId&&n.tag){const t=a.getQueryData([Xc.conversation,s.conversationId]);if(!t)return;om.log("tag_mutation",`\`updateTagsInConversation\` Update from ${e}`,t),o(s.conversationId,[...t.tags||[],n.tag])}null!=t&&i(t,n.tag)})(...n),null==s||s(...n)},...r})},ig=e=>{const t=ar(),n=(()=>{const e=ar();return t=>{const n=e.getQueryData([Xc.allConversations]),a=[],s=JSON.parse(JSON.stringify(n));for(let e=0;e<s.pages.length;e++){const n=s.pages[e];n.conversations=n.conversations.map((e=>{var n;return null!=e.conversationId&&e.conversationId&&!0===(null==(n=e.tags)?void 0:n.includes(t))&&(a.push(e.conversationId),e.tags=e.tags.filter((e=>e!==t))),e}))}e.setQueryData([Xc.allConversations],s);for(let r=0;r<a.length;r++){const n=a[r],s=e.getQueryData([Xc.conversation,n]);s&&s.tags&&(s.tags=s.tags.filter((e=>e!==t)),e.setQueryData([Xc.conversation,n],s))}}})(),{onSuccess:a,...s}=e||{};return sr((e=>zd.deleteConversationTag(e)),{onSuccess:(e,s,r)=>{t.setQueryData([Xc.conversationTags],(e=>e?e.filter((e=>e.tag!==s)):e)),n(s),null==a||a(e,s,r)},...s})},lg=e=>{const t=ar(),{refetch:n}=Gp(),{onSuccess:a,...s}=e||{};return sr((e=>zd.deleteConversation(e)),{onSuccess:(e,s,r)=>{const o=s.conversationId??"";if(!o)return;const i=e=>e?fu(Cu(e,o),"conversations",Number(e.pages[0].pageSize)):e;t.setQueryData([Xc.conversation,o],null),t.setQueryData([Xc.allConversations],i),t.setQueryData([Xc.archivedConversations],i);const l=t.getQueryData([Xc.allConversations]);n({refetchPage:(e,t)=>t===((null==l?void 0:l.pages.length)??1)-1}),null==a||a(e,s,r)},...s})},cg=e=>{const t=ar(),{onSuccess:n,...a}=e||{};return sr((e=>zd.forkConversation(e)),{onSuccess:(e,a,s)=>{a.conversationId&&(t.setQueryData([Xc.conversation,e.conversation.conversationId],e.conversation),t.setQueryData([Xc.allConversations],(t=>t?_u(t,e.conversation):t)),t.setQueryData([Xc.messages,e.conversation.conversationId],e.messages),null==n||n(e,a,s))},...a})},dg=e=>{const t=ar(),{onSuccess:n,onError:a,onMutate:s}=e||{};return sr({mutationFn:e=>zd.importConversationsFile(e),onSuccess:(e,a,s)=>{t.invalidateQueries([Xc.allConversations]),n&&n(e,a,s)},onError:(e,t,n)=>{a&&a(e,t,n)},onMutate:s})},ug=e=>sr([ed.avatarUpload],{mutationFn:e=>zd.uploadAvatar(e),...e||{}}),mg=e=>{const t=ar();return sr((e=>zd.createAssistant(e)),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.assistants,a.endpoint,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=[n,...JSON.parse(JSON.stringify(i.data))];return t.setQueryData([Xc.assistants,a.endpoint,To],{...i,data:l}),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)}})},pg=e=>{const t=ar();return sr((({assistant_id:e,data:n})=>{const{endpoint:a}=n,s=t.getQueryData([Xc.endpoints]),r=null==s?void 0:s[a],o=(null==r?void 0:r.version)??wl[a];return zd.updateAssistant({data:n,version:o,assistant_id:e})}),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.assistants,a.data.endpoint,To]);return i?(t.setQueryData([Xc.assistantDocs,a.data.endpoint],(e=>e?e.map((e=>e.assistant_id===a.assistant_id?{...e,conversation_starters:n.conversation_starters,append_current_datetime:a.data.append_current_datetime}:e)):e)),t.setQueryData([Xc.assistants,a.data.endpoint,To],{...i,data:i.data.map((e=>e.id===a.assistant_id?n:e))}),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)):null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s)}})},gg=e=>{const t=ar();return sr((({assistant_id:e,model:n,endpoint:a})=>{var s;const r=t.getQueryData([Xc.endpoints]),o=(null==(s=null==r?void 0:r[a])?void 0:s.version)??wl[a];return zd.deleteAssistant({assistant_id:e,model:n,version:o,endpoint:a})}),{onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.assistants,a.endpoint,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=i.data.filter((e=>e.id!==a.assistant_id));return t.setQueryData([Xc.assistants,a.endpoint,To],{...i,data:l}),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,l)}})},fg=e=>sr([ed.assistantAvatarUpload],{mutationFn:({postCreation:e,...t})=>zd.uploadAssistantAvatar(t),...e||{}}),xg=e=>{const t=ar();return sr([ed.updateAction],{mutationFn:e=>zd.updateAction(e),onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r,o;const i=t.getQueryData([Xc.assistants,a.endpoint,To]);if(!i)return null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s);const l=n[1];return t.setQueryData([Xc.assistants,a.endpoint,To],{...i,data:i.data.map((e=>e.id===a.assistant_id?l:e))}),t.setQueryData([Xc.actions],(e=>null==e?void 0:e.map((e=>e.action_id===a.action_id?n[2]:e)).concat(null!=a.action_id&&a.action_id?[]:[n[2]]))),null==(o=null==e?void 0:e.onSuccess)?void 0:o.call(e,n,a,s)}})},hg=e=>{const t=ar();return sr([ed.deleteAction],{mutationFn:e=>{var n;const{endpoint:a}=e,s=t.getQueryData([Xc.endpoints]),r=(null==(n=null==s?void 0:s[a])?void 0:n.version)??wl[a];return zd.deleteAction({...e,version:r})},onMutate:t=>{var n;return null==(n=null==e?void 0:e.onMutate)?void 0:n.call(e,t)},onError:(t,n,a)=>{var s;return null==(s=null==e?void 0:e.onError)?void 0:s.call(e,t,n,a)},onSuccess:(n,a,s)=>{var r;let o="";return t.setQueryData([Xc.actions],(e=>null==e?void 0:e.filter((e=>(o=e.metadata.domain,e.action_id!==a.action_id))))),t.setQueryData([Xc.assistants,a.endpoint,To],(e=>e?{...e,data:e.data.map((e=>e.id===a.assistant_id?{...e,tools:(e.tools??[]).filter((e=>{var t;return!(null==(t=e.function)?void 0:t.name.includes(o??""))}))}:e))}:e)),null==(r=null==e?void 0:e.onSuccess)?void 0:r.call(e,n,a,s)}})},vg=e=>sr({mutationFn:e=>zd.resendVerificationEmail(e),...e||{}}),bg=e=>{const{onMutate:t,onError:n,onSuccess:a}=e||{},s=ar(),r=I(_p.promptsName),o=I(_p.promptsPageSize),i=I(_p.promptsCategory);return sr({mutationFn:e=>zd.updatePromptGroup(e),onMutate:e=>{const n=s.getQueryData([Xc.promptGroup,e.id]),a=n?structuredClone(n):void 0,l=s.getQueryData([Xc.promptGroups,r,i,o]),c=l?structuredClone(l):void 0;let d=e.payload;if(d.removeProjectIds&&(null==a?void 0:a.projectIds)&&(d=structuredClone(d),d.projectIds=a.projectIds.filter((e=>{var t;return!(null==(t=d.removeProjectIds)?void 0:t.includes(e))})),delete d.removeProjectIds),l){const t=tm(l,{_id:e.id,...d},(t=>s.setQueryData([Xc.promptGroup,e.id],t)));s.setQueryData([Xc.promptGroups,r,i,o],t)}return t&&t(e),{group:a,previousListData:c}},onError:(e,t,a)=>{(null==a?void 0:a.group)&&s.setQueryData([Xc.promptGroups,t.id],a.group),(null==a?void 0:a.previousListData)&&s.setQueryData([Xc.promptGroups,r,i,o],a.previousListData),n&&n(e,t,a)},onSuccess:(e,t,n)=>{am(s,{_id:t.id,...e}),a&&a(e,t,n)}})},yg=e=>{const t=ar(),{onSuccess:n,...a}=e||{},s=I(_p.promptsName),r=I(_p.promptsPageSize),o=I(_p.promptsCategory);return sr({mutationFn:e=>zd.createPrompt(e),...a,onSuccess:(e,a,i)=>{const{prompt:l,group:c}=e;t.setQueryData([Xc.prompts,a.prompt.groupId],(e=>[l,...e??[]])),c&&(t.setQueryData([Xc.promptGroups,s,o,r],(e=>e?((e,t)=>uu(e,ec.PROMPT_GROUPS,t,(e=>e.promptGroups.findIndex((e=>e._id===t._id)))))(e,c):e)),((e,t)=>{!function(e,t,n){e.setQueryData(t,(e=>e?[...e,n]:[n]))}(e,[Xc.allPromptGroups],t)})(t,c)),n&&n(e,a,i)}})},_g=(e,t)=>nr([Xc.roles,e],(()=>zd.getRole(e)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...t});function jg(e=100){const[t,a]=T(_p.toastState),s=n.useRef(null),r=n.useRef(null);n.useEffect((()=>()=>{null!==s.current&&clearTimeout(s.current),null!==r.current&&clearTimeout(r.current)}),[]);return{toast:t,onOpenChange:e=>a({...t,open:e}),showToast:({message:t,severity:n=Wr.SUCCESS,showIcon:o=!0,duration:i=3e3,status:l})=>{null!==s.current&&clearTimeout(s.current),null!==r.current&&clearTimeout(r.current),s.current=window.setTimeout((()=>{a({open:!0,message:t,severity:l??n,showIcon:o}),r.current=window.setTimeout((()=>{a((e=>({...e,open:!1})))}),i)}),e)}}}const wg=n.createContext({showToast:()=>({})});function Ng(){return n.useContext(wg)}function Cg({children:e}){const{showToast:t}=jg();return c.jsx(wg.Provider,{value:{showToast:t},children:e})}function kg(){const e=I(_p.lang),{t:t,i18n:a}=L();return n.useEffect((()=>{a.language!==e&&a.changeLanguage(e)}),[e,a]),(e,n)=>t(e,n)}function Sg({setIsSpeaking:e,audioRef:t,messageId:a,isLast:s,index:r=0}){const o=kg(),{showToast:i}=Ng(),l=I(_p.voice),c=I(_p.cacheTTS),d=I(_p.playbackRate),[u,m]=n.useState(!1),p=n.useRef(null),g=I(_p.globalAudioFetchingFamily(r)),f=I(_p.globalAudioPlayingFamily(r)),x=e=>{const t=document.createElement("a");t.href=e,t.download="audio.mp3",t.click(),m(!1)},{mutate:h}=(v={onMutate:e=>{(e.get("input")??"").length>=4096&&i({message:o("com_nav_long_audio_warning"),status:"warning"})},onSuccess:async(e,n)=>{try{const a=n.get("input")??"",s=new Blob([e],{type:"audio/mpeg"});if(c&&a){const e=await caches.open("tts-responses"),t=new Request(a),n=new Response(s);e.put(t,n)}const r=URL.createObjectURL(s);u&&x(r),(e=>{const n=new Audio(e);t.current=n})(r)}catch(a){i({message:`Error processing audio: ${a.message}`,status:"error"})}},onError:e=>{i({message:o("com_nav_audio_process_error",{0:e.message}),status:"error"})}},sr([ed.textToSpeech],{mutationFn:e=>zd.textToSpeech(e),...v||{}}));var v;const b=(e,t)=>{const n=((e,t)=>{const n=new FormData;return n.append("input",e),n.append("voice",t),n})(e,l??"");m(t),h(n)},y=async(t,n)=>{const a=await caches.match(t);if(!a)return b(t,n);const s=await a.blob(),r=URL.createObjectURL(s);n?x(r):(t=>{const n=new Audio(t),a=()=>{null!=d&&1!==d&&d>0&&(n.playbackRate=d)};a();const s=()=>n.play().then((()=>e(!0)));s().catch((e=>{if(e.message&&e.message.includes("The play() request was interrupted by a call to pause()"))return console.log("Play request was interrupted by a call to pause()"),a(),s().catch(console.error);console.error(e),i({message:o("com_nav_audio_play_error",{0:e.message}),status:"error"})})),n.onended=()=>{console.log("Cached message audio ended"),URL.revokeObjectURL(t),e(!1)},p.current=n})(r)},_=n.useCallback((()=>{p.current&&(p.current.pause(),p.current.src&&URL.revokeObjectURL(p.current.src),p.current=null,e(!1))}),[e]);n.useEffect((()=>_),[_]);const j=n.useMemo((()=>s&&g&&!f),[g,f,s]),{data:w=[]}=nr([Xc.voices],(()=>zd.getVoices()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...N});var N;return{generateSpeechExternal:(e,t)=>{c?y(e,t):b(e,t)},cancelSpeech:()=>{const n=e=>{e&&(e.pause(),e.src&&URL.revokeObjectURL(e.src),t.current=null)};n(document.getElementById(`audio-${a}`)),n(p.current),e(!1)},isLoading:j,audioRef:t,voices:w}}function Tg({setIsPlaying:e}){const t=n.useRef(null);return n.useEffect((()=>{const n=()=>{e(!1),console.log("message audio ended"),t.current&&URL.revokeObjectURL(t.current.src)},a=()=>{e(!0),console.log("message audio started")},s=()=>{e(!1),console.log("message audio paused")},r=t.current;return t.current&&(t.current.muted=!0,t.current.addEventListener("ended",n),t.current.addEventListener("play",a),t.current.addEventListener("pause",s)),()=>{r&&(r.removeEventListener("ended",n),r.removeEventListener("play",a),r.removeEventListener("pause",s),URL.revokeObjectURL(r.src))}}),[e]),{audioRef:t}}const Rg=e=>{const{messageId:t,content:a,isLast:s=!1,index:r=0}=e??{},o=n.useRef(!1),i=n.useRef(void 0),[l,c]=n.useState(!1),{audioRef:d}=Tg({setIsPlaying:c}),{pauseGlobalAudio:u}=jp(r),[m,p]=T(_p.voice),g=I(_p.globalAudioPlayingFamily(r)),f=l||s&&g,{cancelSpeech:x,generateSpeechExternal:h,isLoading:v,voices:b}=Sg({setIsSpeaking:c,audioRef:d,messageId:t,isLast:s,index:r});n.useEffect((()=>{const e=b[0];if(b.length){const t=b.find((e=>e===m));if(null!=t)return om.log("useTextToSpeech.ts - Effect:",{voices:b,voice:t}),void p(t.toString());om.log("useTextToSpeech.ts - Effect:",{voices:b,voice:e}),p(e.toString())}}),[p,m,b]);return{handleMouseDown:()=>{o.current=!0,i.current=window.setTimeout((()=>{if(o.current){const e=a??"",t="string"==typeof e?e:kc(e);h(t,!1)}}),1e3)},handleMouseUp:()=>{o.current=!1,null!=i.current&&window.clearTimeout(i.current)},toggleSpeech:()=>{if(!0===f)x(),u();else{const e=a??"",t="string"==typeof e?e:kc(e);h(t,!1)}},isSpeaking:f,isLoading:v,audioRef:d,voices:b}};const Ig=e=>{const{content:t,isLast:a=!1,index:s=0}=e??{},r=n.useRef(!1),o=n.useRef(void 0),[i,l]=n.useState(!1),{audioRef:c}=Tg({setIsPlaying:l}),{pauseGlobalAudio:d}=jp(s),[u,m]=T(_p.voice),p=I(_p.globalAudioPlayingFamily(s)),g=i||a&&p,{generateSpeechLocal:f,cancelSpeechLocal:x,voices:h}=function({setIsSpeaking:e}){const t=I(_p.voice),[a,s]=n.useState([]),r=I(_p.cloudBrowserVoices),[o,i]=n.useState(!0),l=n.useCallback((()=>{const e=window.speechSynthesis;if(e)try{const t=e.getVoices();if(!Array.isArray(t))return void console.error("getVoices() did not return an array");const n=t.filter((e=>r||!0===e.localService)).map((e=>({value:e.name,label:e.name})));s(n)}catch(t){console.error("Error updating voices:",t),i(!1)}else i(!1)}),[r]);return n.useEffect((()=>{const e=window.speechSynthesis;if(e){try{e.getVoices().length?l():e.onvoiceschanged=l}catch(t){console.error("Error in useEffect:",t),i(!1)}return()=>{e.onvoiceschanged&&(e.onvoiceschanged=null)}}i(!1)}),[l]),{generateSpeechLocal:n=>{if(!o)return void console.warn("Speech synthesis is not supported");const s=window.speechSynthesis,r=a.find((e=>e.value===t));if(r)try{s.cancel();const t=new SpeechSynthesisUtterance(n);t.voice=s.getVoices().find((e=>e.name===r.value))||null,t.onend=()=>{e(!1)},t.onerror=t=>{console.error("Speech synthesis error:",t),e(!1)},e(!0),s.speak(t)}catch(i){console.error("Error generating speech:",i),e(!1)}else console.warn("Selected voice not found")},cancelSpeechLocal:()=>{if(o)try{window.speechSynthesis.cancel()}catch(t){console.error("Error cancelling speech:",t)}finally{e(!1)}},voices:a,isSpeechSynthesisSupported:o}}({setIsSpeaking:l});n.useEffect((()=>{const e=h[0];if(h.length&&"object"==typeof e){const t=h.find((e=>"object"==typeof e?e.value===u:e===u));if(null!=t){const e="object"==typeof t?t.value:t;return om.log("useTextToSpeech.ts - Effect:",{voices:h,voice:e}),void m(e)}om.log("useTextToSpeech.ts - Effect:",{voices:h,voice:e.value}),m(e.value)}}),[m,u,h]);return{handleMouseDown:()=>{r.current=!0,o.current=window.setTimeout((()=>{if(r.current){const e=t??"",n="string"==typeof e?e:kc(e);f(n)}}),1e3)},handleMouseUp:()=>{r.current=!1,null!=o.current&&window.clearTimeout(o.current)},toggleSpeech:()=>{if(!0===g)x(),d();else{const e=t??"",n="string"==typeof e?e:kc(e);f(n)}},isSpeaking:g,isLoading:!1,audioRef:c,voices:h}};const Eg=e=>{const{content:t,isLast:a=!1,index:s=0}=e??{},r=n.useRef(!1),o=n.useRef(void 0),[i,l]=n.useState(!1),{audioRef:c}=Tg({setIsPlaying:l}),{pauseGlobalAudio:d}=jp(s),[u,m]=T(_p.voice),p=I(_p.globalAudioPlayingFamily(s)),g=i||a&&p,{generateSpeechEdge:f,cancelSpeechEdge:x,voices:h}=function({setIsSpeaking:e}){const t=kg(),[a,s]=n.useState([]),r=I(_p.voice),o=n.useRef(null),i=n.useRef(null),l=n.useRef(null),c=n.useRef(null),d=n.useRef([]),{showToast:u}=Ng(),m=n.useMemo((()=>"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported("audio/mpeg")),[]),p=n.useCallback((()=>{o.current||(o.current=new M.MsEdgeTTS),o.current.getVoices().then((e=>{s(e.map((e=>({value:e.ShortName,label:e.FriendlyName}))))})).catch((e=>{console.error("Error fetching voices:",e),u({message:t("com_nav_voices_fetch_error"),status:"error"})}))}),[u,t]),g=n.useCallback((()=>{o.current||(o.current=new M.MsEdgeTTS);const e=a.find((e=>e.value===r));e?o.current.setMetadata(e.value,M.OUTPUT_FORMAT.AUDIO_24KHZ_48KBITRATE_MONO_MP3).catch((e=>{console.error("Error initializing TTS:",e),u({message:t("com_nav_tts_init_error",{0:e.message}),status:"error"})})):a.length>0&&o.current.setMetadata(a[0].value,M.OUTPUT_FORMAT.AUDIO_24KHZ_48KBITRATE_MONO_MP3).catch((e=>{console.error("Error initializing TTS:",e),u({message:t("com_nav_tts_init_error",{0:e.message}),status:"error"})}))}),[r,u,t,a]),f=n.useCallback((()=>{if(c.current&&!c.current.updating&&d.current.length>0){const n=d.current.shift();if(n)try{c.current.appendBuffer(n)}catch(e){console.error("Error appending buffer:",e),u({message:t("com_nav_buffer_append_error"),status:"error"}),d.current.unshift(n)}}}),[u,t]),x=n.useCallback((()=>{if(!c.current&&l.current)try{c.current=l.current.addSourceBuffer("audio/mpeg"),c.current.addEventListener("updateend",f)}catch(e){console.error("Error adding source buffer:",e),u({message:t("com_nav_source_buffer_error"),status:"error"})}}),[u,t,f]),h=n.useCallback((()=>{l.current||(l.current=new MediaSource,i.current=new Audio,i.current.src=URL.createObjectURL(l.current));const e=l.current;"open"===e.readyState?x():e.addEventListener("sourceopen",x)}),[x]),v=n.useCallback((n=>{(async()=>{try{if(!o.current||!i.current)throw new Error("TTS or Audio element not initialized");e(!0),d.current=[];const t=o.current.toStream(n);t.on("data",(e=>{d.current.push(new Uint8Array(e)),f()})),t.on("end",(()=>{l.current&&"open"===l.current.readyState&&l.current.endOfStream()})),i.current.onended=()=>{e(!1)},await i.current.play()}catch(a){console.error("Error generating speech:",a),u({message:t("com_nav_audio_play_error",{0:a.message}),status:"error"}),e(!1)}})()}),[e,f,u,t]),b=n.useCallback((()=>{try{i.current&&(i.current.pause(),i.current.currentTime=0),l.current&&"open"===l.current.readyState&&l.current.endOfStream(),d.current=[],e(!1)}catch(n){console.error("Error cancelling speech:",n),u({message:t("com_nav_speech_cancel_error"),status:"error"})}}),[e,u,t]);return n.useEffect((()=>{m&&p()}),[p,m]),n.useEffect((()=>{m&&g()}),[r,g,m]),n.useEffect((()=>{if(m)return h(),()=>{var e;l.current&&URL.revokeObjectURL((null==(e=i.current)?void 0:e.src)??"")}}),[h,m]),m?{generateSpeechEdge:v,cancelSpeechEdge:b,voices:a}:{generateSpeechEdge:()=>({}),cancelSpeechEdge:()=>({}),voices:[]}}({setIsSpeaking:l});n.useEffect((()=>{const e=h[0];if(h.length&&"object"==typeof e){const t=h.find((e=>"object"==typeof e?e.value===u:e===u));if(null!=t){const e="object"==typeof t?t.value:t;return om.log("useTextToSpeech.ts - Effect:",{voices:h,voice:e}),void m(e)}om.log("useTextToSpeech.ts - Effect:",{voices:h,voice:e.value}),m(e.value)}}),[m,u,h]);return{handleMouseDown:()=>{r.current=!0,o.current=window.setTimeout((()=>{if(r.current){const e=t??"",n="string"==typeof e?e:kc(e);f(n)}}),1e3)},handleMouseUp:()=>{r.current=!1,null!=o.current&&window.clearTimeout(o.current)},toggleSpeech:()=>{if(!0===g)x(),d();else{const e=t??"",n="string"==typeof e?e:kc(e);f(n)}},isSpeaking:g,isLoading:!1,audioRef:c,voices:h}};var Pg,Lg,Mg,Ag,Og,Dg,Fg,zg,Ug,Vg,Bg,$g=function(){return $g=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},$g.apply(this,arguments)};function Hg(e,t,n,a){return new(n||(n=Promise))((function(t,s){function r(e){try{i(a.next(e))}catch(t){s(t)}}function o(e){try{i(a.throw(e))}catch(t){s(t)}}function i(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n((function(e){e(a)}))).then(r,o)}i((a=a.apply(e,[])).next())}))}function Gg(e,t){var n,a,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=i(0),o.throw=i(1),o.return=i(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(r=0)),r;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(uo){i=[6,uo],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function Kg(e,t,n){if(n||2===arguments.length)for(var a,s=0,r=t.length;s<r;s++)!a&&s in t||(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return e.concat(a||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError,(Bg=Pg||(Pg={})).execute_code="execute_code",Bg.code_interpreter="code_interpreter",Bg.file_search="file_search",Bg.retrieval="retrieval",Bg.function="function",function(e){e.code_interpreter="code_interpreter",e.execute_code="execute_code",e.file_search="file_search"}(Lg||(Lg={})),function(e){e.FILE_CITATION="file_citation",e.FILE_PATH="file_path"}(Mg||(Mg={})),function(e){e.IN_PROGRESS="in_progress",e.CANCELLED="cancelled",e.FAILED="failed",e.COMPLETED="completed",e.EXPIRED="expired"}(Ag||(Ag={})),function(e){e.TEXT="text",e.IMAGE_FILE="image_file"}(Og||(Og={})),function(e){e.QUEUED="queued",e.IN_PROGRESS="in_progress",e.REQUIRES_ACTION="requires_action",e.CANCELLING="cancelling",e.CANCELLED="cancelled",e.FAILED="failed",e.COMPLETED="completed",e.EXPIRED="expired"}(Dg||(Dg={})),function(e){e.ServiceHttp="service_http",e.OAuth="oauth",e.None="none"}(Fg||(Fg={})),function(e){e.Bearer="bearer",e.Basic="basic",e.Custom="custom"}(zg||(zg={})),function(e){e.DefaultPost="default_post",e.BasicAuthHeader="basic_auth_header"}(Ug||(Ug={})),function(e){e.Vision="vision",e.FineTune="fine-tune",e.FineTuneResults="fine-tune-results",e.Assistants="assistants",e.AssistantsOutput="assistants_output"}(Vg||(Vg={}));var Wg,Qg,qg,Zg,Yg,Jg={order:"desc",limit:100};!function(e){e.ThreadCreated="thread.created",e.ThreadRunCreated="thread.run.created",e.ThreadRunQueued="thread.run.queued",e.ThreadRunInProgress="thread.run.in_progress",e.ThreadRunRequiresAction="thread.run.requires_action",e.ThreadRunCompleted="thread.run.completed",e.ThreadRunFailed="thread.run.failed",e.ThreadRunCancelling="thread.run.cancelling",e.ThreadRunCancelled="thread.run.cancelled",e.ThreadRunExpired="thread.run.expired",e.ThreadRunStepCreated="thread.run.step.created",e.ThreadRunStepInProgress="thread.run.step.in_progress",e.ThreadRunStepCompleted="thread.run.step.completed",e.ThreadRunStepFailed="thread.run.step.failed",e.ThreadRunStepCancelled="thread.run.step.cancelled",e.ThreadRunStepExpired="thread.run.step.expired",e.ThreadRunStepDelta="thread.run.step.delta",e.ThreadMessageCreated="thread.message.created",e.ThreadMessageInProgress="thread.message.in_progress",e.ThreadMessageCompleted="thread.message.completed",e.ThreadMessageIncomplete="thread.message.incomplete",e.ThreadMessageDelta="thread.message.delta",e.ErrorEvent="error"}(Wg||(Wg={})),a.string().uuid(),function(e){e.OVERRIDE_AUTH="override_auth",e.USER_PROVIDED="user_provided",e.SYSTEM_DEFINED="system_defined"}(Yg||(Yg={}));var Xg,ef,tf,nf,af=a.nativeEnum(Yg);!function(e){e.azureOpenAI="azureOpenAI",e.openAI="openAI",e.google="google",e.anthropic="anthropic",e.assistants="assistants",e.azureAssistants="azureAssistants",e.agents="agents",e.custom="custom",e.bedrock="bedrock",e.chatGPTBrowser="chatGPTBrowser",e.gptPlugins="gptPlugins"}(Xg||(Xg={})),Xg.agents,Xg.openAI,Xg.bedrock,Xg.azureOpenAI,Xg.anthropic,Xg.custom,Xg.google,function(e){e.AI21="ai21",e.Amazon="amazon",e.Anthropic="anthropic",e.Cohere="cohere",e.Meta="meta",e.MistralAI="mistral",e.StabilityAI="stability"}(ef||(ef={})),function(e){e.low="low",e.auto="auto",e.high="high"}(tf||(tf={})),function(e){e.low="low",e.medium="medium",e.high="high"}(nf||(nf={})),(Qg={})[tf.low]=0,Qg[tf.auto]=1,Qg[tf.high]=2,tf.low,tf.auto,tf.high;var sf=a.nativeEnum(tf),rf=a.nativeEnum(nf);(qg={agent:{},id:"",name:"",description:"",instructions:"",model:"",model_parameters:{},tools:[],provider:{},projectIds:[],artifacts:"",isCollaborative:!1})[Pg.execute_code]=!1,qg[Pg.file_search]=!1,{type:Pg.function}[Pg.function]={name:"image_vision",description:"Get detailed text descriptions for all current image attachments.",parameters:{type:"object",properties:{},required:[]}};var of,lf={model:{default:"gpt-4o"},temperature:{min:0,max:2,step:.01,default:1},top_p:{min:0,max:1,step:.01,default:1},presence_penalty:{min:0,max:2,step:.01,default:0},frequency_penalty:{min:0,max:2,step:.01,default:0},resendFiles:{default:!0},maxContextTokens:{default:void 0},max_tokens:{default:void 0},imageDetail:{default:tf.auto,min:0,max:2,step:1}},cf=4096,df={model:{default:"claude-3-5-sonnet-latest"},temperature:{min:0,max:1,step:.01,default:1},promptCache:{default:!0},thinking:{default:!0},thinkingBudget:{min:1024,step:100,max:2e5,default:2e3},maxOutputTokens:{min:1,max:128e3,step:1,default:8192,reset:function(e){return/claude-3[-.]5-sonnet/.test(e)||/claude-3[-.]7/.test(e)?8192:4096},set:function(e,t){return!/claude-3[-.]5-sonnet/.test(t)&&!/claude-3[-.]7/.test(t)&&e>cf?cf:e}},topP:{min:0,max:1,step:.01,default:.7},topK:{min:1,max:40,step:1,default:5},resendFiles:{default:!0},maxContextTokens:{default:void 0},legacy:{maxOutputTokens:{min:1,max:cf,step:1,default:cf}}},uf={model:{default:"gpt-3.5-turbo-test"},temperature:{min:0,max:1,step:.01,default:1},top_p:{min:0,max:1,step:.01,default:1},presence_penalty:{min:0,max:2,step:.01,default:0},frequency_penalty:{min:0,max:2,step:.01,default:0},resendFiles:{default:!0},maxContextTokens:{default:void 0},max_tokens:{default:void 0},imageDetail:{default:tf.auto}},mf=((Zg={})[Xg.openAI]=lf,Zg[Xg.google]={model:{default:"gemini-1.5-flash-latest"},maxOutputTokens:{min:1,max:8192,step:1,default:8192},temperature:{min:0,max:2,step:.01,default:1},topP:{min:0,max:1,step:.01,default:.95},topK:{min:1,max:40,step:1,default:40}},Zg[Xg.anthropic]=df,Zg[Xg.agents]=uf,Zg[Xg.bedrock]=uf,Zg)[Xg.google],pf=a.nativeEnum(Xg),gf=a.union([pf,a.string()]),ff=a.object({authField:a.string(),label:a.string(),description:a.string()}),xf=a.object({name:a.string(),pluginKey:a.string(),description:a.string(),icon:a.string().optional(),authConfig:a.array(ff).optional(),authenticated:a.boolean().optional(),isButton:a.boolean().optional(),toolkit:a.boolean().optional()}),hf=a.object({input:a.object({content:a.string()}),output:a.object({content:a.string()})});!function(e){e.functions="functions",e.classic="classic"}(of||(of={}));var vf=(of.functions,of.functions,of.classic,{default:!0});a.nativeEnum(of);var bf=a.object({agent:a.string().default(of.functions),skipCompletion:a.boolean().default(vf.default),model:a.string(),temperature:a.number().default(0)});a.object({messageId:a.string(),endpoint:a.string().optional(),clientId:a.string().nullable().optional(),conversationId:a.string().nullable(),parentMessageId:a.string().nullable(),responseMessageId:a.string().nullable().optional(),overrideParentMessageId:a.string().nullable().optional(),bg:a.string().nullable().optional(),model:a.string().nullable().optional(),title:a.string().nullable().or(a.literal("New Chat")).default("New Chat"),sender:a.string().optional(),text:a.string(),generation:a.string().nullable().optional(),isCreatedByUser:a.boolean(),error:a.boolean().optional(),clientTimestamp:a.string().optional(),createdAt:a.string().optional().default((function(){return(new Date).toISOString()})),updatedAt:a.string().optional().default((function(){return(new Date).toISOString()})),current:a.boolean().optional(),unfinished:a.boolean().optional(),searchResult:a.boolean().optional(),finish_reason:a.string().optional(),thread_id:a.string().optional(),iconURL:a.string().nullable().optional()});var yf=a.union([a.number(),a.string()]).transform((function(e){return"string"==typeof e?""===e.trim()?void 0:parseFloat(e):e})),_f=a.lazy((function(){return a.union([a.null(),a.boolean(),a.number(),a.string(),a.array(a.lazy((function(){return _f}))),a.record(a.lazy((function(){return _f})))])})),jf=a.object({conversationId:a.string().nullable(),endpoint:pf.nullable(),endpointType:pf.nullable().optional(),isArchived:a.boolean().optional(),title:a.string().nullable().or(a.literal("New Chat")).default("New Chat"),user:a.string().optional(),messages:a.array(a.string()).optional(),tools:a.union([a.array(xf),a.array(a.string())]).optional(),modelLabel:a.string().nullable().optional(),userLabel:a.string().optional(),model:a.string().nullable().optional(),promptPrefix:a.string().nullable().optional(),temperature:a.number().optional(),topP:a.number().optional(),topK:a.number().optional(),top_p:a.number().optional(),frequency_penalty:a.number().optional(),presence_penalty:a.number().optional(),parentMessageId:a.string().optional(),maxOutputTokens:yf.optional(),maxContextTokens:yf.optional(),max_tokens:yf.optional(),promptCache:a.boolean().optional(),system:a.string().optional(),thinking:a.boolean().optional(),thinkingBudget:yf.optional(),artifacts:a.string().optional(),context:a.string().nullable().optional(),examples:a.array(hf).optional(),tags:a.array(a.string()).optional(),createdAt:a.string(),updatedAt:a.string(),resendFiles:a.boolean().optional(),file_ids:a.array(a.string()).optional(),imageDetail:sf.optional(),reasoning_effort:rf.optional(),assistant_id:a.string().optional(),agent_id:a.string().optional(),region:a.string().optional(),maxTokens:yf.optional(),additionalModelRequestFields:_f.optional(),instructions:a.string().optional(),additional_instructions:a.string().optional(),append_current_datetime:a.boolean().optional(),presetOverride:a.record(a.unknown()).optional(),stop:a.array(a.string()).optional(),greeting:a.string().optional(),spec:a.string().nullable().optional(),iconURL:a.string().nullable().optional(),expiredAt:a.string().nullable().optional(),resendImages:a.boolean().optional(),agentOptions:bf.nullable().optional(),chatGptLabel:a.string().nullable().optional()}),wf=jf.omit({conversationId:!0,createdAt:!0,updatedAt:!0,title:!0}).merge(a.object({conversationId:a.string().nullable().optional(),presetId:a.string().nullable().optional(),title:a.string().nullable().optional(),defaultPreset:a.boolean().optional(),order:a.number().optional(),endpoint:gf.nullable()}));function Nf(e,t){var n=$g({},e);return Object.keys(n).forEach((function(e){null==n[e]&&delete n[e]})),n}jf.merge(a.object({endpoint:gf.nullable()})),jf.pick({maxContextTokens:!0,resendFiles:!0,imageDetail:!0,promptPrefix:!0,model:!0,temperature:!0,presence_penalty:!0,frequency_penalty:!0,stop:!0,top_p:!0,max_tokens:!0,topP:!0,topK:!0,maxOutputTokens:!0,promptCache:!0,thinking:!0,thinkingBudget:!0,region:!0,maxTokens:!0,agent_id:!0,assistant_id:!0,append_current_datetime:!0,instructions:!0}).merge(a.object({endpoint:gf.nullable()})),a.object({conversationId:a.string(),shareId:a.string(),messages:a.array(a.string()),isPublic:a.boolean(),title:a.string(),createdAt:a.string(),updatedAt:a.string()}),a.object({_id:a.string(),user:a.string(),tag:a.string(),description:a.string().optional(),createdAt:a.string(),updatedAt:a.string(),count:a.number(),position:a.number()}),jf.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,artifacts:!0,topP:!0,topK:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){return Nf(e)})).catch((function(){return{}})),a.object({maxOutputTokens:yf.optional(),temperature:yf.optional(),topP:yf.optional(),topK:yf.optional(),presencePenalty:yf.optional(),frequencyPenalty:yf.optional(),stopSequences:a.array(a.string()).optional()}).strip().optional(),jf.pick({model:!0}).transform((function(e){var t;return $g($g({},e),{model:null!==(t=e.model)&&void 0!==t?t:"text-davinci-002-render-sha"})})).catch((function(){return{model:"text-davinci-002-render-sha"}})),jf.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,artifacts:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t,n,a,s,r,o,i,l,c,d,u,m,p,g,f=$g($g({},e),{model:null!==(t=e.model)&&void 0!==t?t:"gpt-3.5-turbo",chatGptLabel:null!==(a=null!==(n=e.chatGptLabel)&&void 0!==n?n:e.modelLabel)&&void 0!==a?a:null,promptPrefix:null!==(s=e.promptPrefix)&&void 0!==s?s:null,temperature:null!==(r=e.temperature)&&void 0!==r?r:.8,top_p:null!==(o=e.top_p)&&void 0!==o?o:1,presence_penalty:null!==(i=e.presence_penalty)&&void 0!==i?i:0,frequency_penalty:null!==(l=e.frequency_penalty)&&void 0!==l?l:0,tools:null!==(c=e.tools)&&void 0!==c?c:[],agentOptions:null!==(d=e.agentOptions)&&void 0!==d?d:{agent:of.functions,skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0},iconURL:null!==(u=e.iconURL)&&void 0!==u?u:void 0,greeting:null!==(m=e.greeting)&&void 0!==m?m:void 0,spec:null!==(p=e.spec)&&void 0!==p?p:void 0,maxContextTokens:null!==(g=e.maxContextTokens)&&void 0!==g?g:void 0});return null!=e.modelLabel&&""!==e.modelLabel&&(f.modelLabel=null),f})).catch((function(){return{model:"gpt-3.5-turbo",chatGptLabel:null,promptPrefix:null,temperature:.8,top_p:1,presence_penalty:0,frequency_penalty:0,tools:[],agentOptions:{agent:of.functions,skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0},iconURL:void 0,greeting:void 0,spec:void 0,maxContextTokens:void 0}})),jf.pick({model:!0,assistant_id:!0,instructions:!0,artifacts:!0,promptPrefix:!0,iconURL:!0,greeting:!0,spec:!0,append_current_datetime:!0}).transform((function(e){var t,n,a,s,r,o,i,l;return $g($g({},e),{model:null!==(t=e.model)&&void 0!==t?t:lf.model.default,assistant_id:null!==(n=e.assistant_id)&&void 0!==n?n:void 0,instructions:null!==(a=e.instructions)&&void 0!==a?a:void 0,promptPrefix:null!==(s=e.promptPrefix)&&void 0!==s?s:null,iconURL:null!==(r=e.iconURL)&&void 0!==r?r:void 0,greeting:null!==(o=e.greeting)&&void 0!==o?o:void 0,spec:null!==(i=e.spec)&&void 0!==i?i:void 0,append_current_datetime:null!==(l=e.append_current_datetime)&&void 0!==l&&l})})).catch((function(){return{model:lf.model.default,assistant_id:void 0,instructions:void 0,promptPrefix:null,iconURL:void 0,greeting:void 0,spec:void 0,append_current_datetime:!1}})),jf.pick({model:!0,assistant_id:!0,instructions:!0,promptPrefix:!0,artifacts:!0,iconURL:!0,greeting:!0,spec:!0}).transform((function(e){return Nf(e)})).catch((function(){return{}})),jf.pick({model:!0,modelLabel:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendFiles:!0,imageDetail:!0,agent_id:!0,instructions:!0,promptPrefix:!0,iconURL:!0,greeting:!0,maxContextTokens:!0}).transform((function(e){var t,n,a,s,r,o,i,l,c,d,u,m,p;return $g($g({},e),{model:null!==(t=e.model)&&void 0!==t?t:uf.model.default,modelLabel:null!==(n=e.modelLabel)&&void 0!==n?n:null,temperature:null!==(a=e.temperature)&&void 0!==a?a:1,top_p:null!==(s=e.top_p)&&void 0!==s?s:1,presence_penalty:null!==(r=e.presence_penalty)&&void 0!==r?r:0,frequency_penalty:null!==(o=e.frequency_penalty)&&void 0!==o?o:0,resendFiles:"boolean"==typeof e.resendFiles?e.resendFiles:uf.resendFiles.default,imageDetail:null!==(i=e.imageDetail)&&void 0!==i?i:tf.auto,agent_id:null!==(l=e.agent_id)&&void 0!==l?l:void 0,instructions:null!==(c=e.instructions)&&void 0!==c?c:void 0,promptPrefix:null!==(d=e.promptPrefix)&&void 0!==d?d:null,iconURL:null!==(u=e.iconURL)&&void 0!==u?u:void 0,greeting:null!==(m=e.greeting)&&void 0!==m?m:void 0,maxContextTokens:null!==(p=e.maxContextTokens)&&void 0!==p?p:void 0})})).catch((function(){return{model:uf.model.default,modelLabel:null,temperature:1,top_p:1,presence_penalty:0,frequency_penalty:0,resendFiles:uf.resendFiles.default,imageDetail:tf.auto,agent_id:void 0,instructions:void 0,promptPrefix:null,iconURL:void 0,greeting:void 0,maxContextTokens:void 0}})),jf.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendFiles:!0,artifacts:!0,imageDetail:!0,stop:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0,max_tokens:!0,reasoning_effort:!0}).transform((function(e){return Nf(e)})).catch((function(){return{}})),jf.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,artifacts:!0,topP:!0,topK:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t=$g({},e);return t.temperature===mf.temperature.default&&delete t.temperature,t.maxOutputTokens===mf.maxOutputTokens.default&&delete t.maxOutputTokens,t.topP===mf.topP.default&&delete t.topP,t.topK===mf.topK.default&&delete t.topK,Nf(t)})).catch((function(){return{}})),jf.pick({model:!0,modelLabel:!0,promptPrefix:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0,resendFiles:!0,promptCache:!0,thinking:!0,thinkingBudget:!0,artifacts:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){return Nf(e)})).catch((function(){return{}})),jf.pick({model:!0}).transform((function(e){return Nf($g({},e))})).catch((function(){return{}})),jf.pick({model:!0,modelLabel:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0,iconURL:!0,greeting:!0,spec:!0,maxContextTokens:!0}).transform((function(e){var t,n=$g({},e);return null===n.modelLabel&&delete n.modelLabel,null===n.chatGptLabel&&delete n.chatGptLabel,null===n.promptPrefix&&delete n.promptPrefix,.8===n.temperature&&delete n.temperature,1===n.top_p&&delete n.top_p,0===n.presence_penalty&&delete n.presence_penalty,0===n.frequency_penalty&&delete n.frequency_penalty,0===(null===(t=n.tools)||void 0===t?void 0:t.length)&&delete n.tools,n.agentOptions&&n.agentOptions.agent===of.functions&&!0===n.agentOptions.skipCompletion&&"gpt-3.5-turbo"===n.agentOptions.model&&0===n.agentOptions.temperature&&delete n.agentOptions,Nf(n)})).catch((function(){return{}})),a.object({bannerId:a.string(),message:a.string(),displayFrom:a.string(),displayTo:a.string(),createdAt:a.string(),updatedAt:a.string(),isPublic:a.boolean()}),jf.pick({spec:!0,iconURL:!0,greeting:!0,agent_id:!0,resendFiles:!0,instructions:!0,additional_instructions:!0}).transform((function(e){return Nf(e)})).catch((function(){return{}}));var Cf,kf,Sf=a.object({name:a.string(),label:a.string(),preset:wf,order:a.number().optional(),default:a.boolean().optional(),description:a.string().optional(),showIconInMenu:a.boolean().optional(),showIconInHeader:a.boolean().optional(),iconURL:a.union([a.string(),pf]).optional(),authType:af.optional()}),Tf=a.object({enforce:a.boolean().default(!1),prioritize:a.boolean().default(!0),list:a.array(Sf).min(1)});(Cf={})[Xg.openAI]=!0,Cf[Xg.google]=!0,Cf[Xg.assistants]=!0,Cf[Xg.azureAssistants]=!0,Cf[Xg.agents]=!0,Cf[Xg.azureOpenAI]=!0,Cf[Xg.anthropic]=!0,Cf[Xg.custom]=!0,Cf[Xg.bedrock]=!0;var Rf=["application/vnd.ms-excel","application/msexcel","application/x-msexcel","application/x-ms-excel","application/x-excel","application/x-dos_ms_excel","application/xls","application/x-xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];Kg(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","text/vtt","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip","image/svg","image/svg+xml"],Rf,!0),Kg(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip"],Rf,!0);var If=[/^(text\/(x-c|x-csharp|x-c\+\+|x-java|html|markdown|x-php|x-python|x-script\.python|x-ruby|x-tex|plain|css|vtt|javascript|csv))$/,/^application\/(vnd\.ms-excel|msexcel|x-msexcel|x-ms-excel|x-excel|x-dos_ms_excel|xls|x-xls|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet)$/,/^(application\/(epub\+zip|csv|json|pdf|x-tar|typescript|vnd\.openxmlformats-officedocument\.(wordprocessingml\.document|presentationml\.presentation|spreadsheetml\.sheet)|xml|zip))$/,/^image\/(jpeg|gif|png|webp)$/,/^image\/(svg|svg\+xml)$/],Ef=function(e){return 1048576*e}(512),Pf={fileLimit:10,fileSizeLimit:Ef,totalSizeLimit:Ef,supportedMimeTypes:If,disabled:!1};(kf={})[Xg.assistants]=Pf,kf[Xg.azureAssistants]=Pf,kf[Xg.agents]=Pf,kf.default={fileLimit:10,fileSizeLimit:Ef,totalSizeLimit:Ef,supportedMimeTypes:If,disabled:!1};var Lf,Mf,Af=a.array(a.any()).optional().refine((function(e){return!e||e.every((function(e){return e instanceof RegExp||"string"==typeof e}))}),{message:"Each mimeType must be a string or a RegExp object."}),Of=a.object({disabled:a.boolean().optional(),fileLimit:a.number().min(0).optional(),fileSizeLimit:a.number().min(0).optional(),totalSizeLimit:a.number().min(0).optional(),supportedMimeTypes:Af.optional()}),Df=a.object({endpoints:a.record(Of).optional(),serverFileSizeLimit:a.number().min(0).optional(),avatarSizeLimit:a.number().min(0).optional()});!function(e){e.local="local",e.firebase="firebase",e.azure="azure",e.openai="openai",e.s3="s3",e.vectordb="vectordb",e.execute_code="execute_code"}(Lf||(Lf={})),function(e){e.avatar="avatar",e.unknown="unknown",e.agents="agents",e.assistants="assistants",e.execute_code="execute_code",e.image_generation="image_generation",e.assistants_output="assistants_output",e.message_attachment="message_attachment",e.filename="filename",e.updatedAt="updatedAt",e.source="source",e.filterSource="filterSource",e.context="context",e.bytes="bytes"}(Mf||(Mf={}));var Ff,zf,Uf,Vf,Bf,$f,Hf,Gf,Kf,Wf=a.object({iconPath:a.string().optional()}),Qf=Wf.extend({type:a.literal("stdio").optional(),command:a.string(),args:a.array(a.string()),env:a.record(a.string(),a.string()).optional(),stderr:a.any().optional()}),qf=Wf.extend({type:a.literal("websocket").optional(),url:a.string().url().refine((function(e){var t=new URL(e).protocol;return"ws:"===t||"wss:"===t}),{message:"WebSocket URL must start with ws:// or wss://"})}),Zf=Wf.extend({type:a.literal("sse").optional(),url:a.string().url().refine((function(e){var t=new URL(e).protocol;return"ws:"!==t&&"wss:"!==t}),{message:"SSE URL must not start with ws:// or wss://"})}),Yf=a.union([Qf,qf,Zf]),Jf=a.record(a.string(),Yf);!function(e){e.default="default",e.advanced="advanced"}(Kf||(Kf={}));var Xf,ex,tx=a.nativeEnum(Lf),nx=a.object({deploymentName:a.string().optional(),version:a.string().optional(),assistants:a.boolean().optional()}).or(a.boolean()),ax=a.object({apiKey:a.string(),serverless:a.boolean().optional(),instanceName:a.string().optional(),deploymentName:a.string().optional(),assistants:a.boolean().optional(),addParams:a.record(a.any()).optional(),dropParams:a.array(a.string()).optional(),forcePrompt:a.boolean().optional(),version:a.string().optional(),baseURL:a.string().optional(),additionalHeaders:a.record(a.any()).optional()}),sx=a.object({group:a.string(),models:a.record(a.string(),nx)}).required().and(ax),rx=a.array(sx).min(1);!function(e){e.code_interpreter="code_interpreter",e.image_vision="image_vision",e.retrieval="retrieval",e.actions="actions",e.tools="tools"}(Xf||(Xf={})),function(e){e.hide_sequential_outputs="hide_sequential_outputs",e.end_after_tools="end_after_tools",e.execute_code="execute_code",e.file_search="file_search",e.artifacts="artifacts",e.actions="actions",e.tools="tools"}(ex||(ex={})),(Ff={})[Xg.assistants]=2,Ff[Xg.azureAssistants]=1;var ox=a.object({streamRate:a.number().optional(),baseURL:a.string().optional(),titlePrompt:a.string().optional(),titleModel:a.string().optional()});ox.merge(a.object({availableRegions:a.array(a.string()).optional()}));var ix,lx=ox.merge(a.object({disableBuilder:a.boolean().optional(),pollIntervalMs:a.number().optional(),timeoutMs:a.number().optional(),version:a.union([a.string(),a.number()]).default(2),supportedIds:a.array(a.string()).min(1).optional(),excludedIds:a.array(a.string()).min(1).optional(),privateAssistants:a.boolean().optional(),retrievalModels:a.array(a.string()).min(1).optional().default(["gpt-4o","o1-preview-2024-09-12","o1-preview","o1-mini-2024-09-12","o1-mini","chatgpt-4o-latest","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini","gpt-4o-mini-2024-07-18","gpt-4-turbo-preview","gpt-3.5-turbo-0125","gpt-4-0125-preview","gpt-4-1106-preview","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-4-turbo","gpt-4-0125","gpt-4-1106"]),capabilities:a.array(a.nativeEnum(Xf)).optional().default([Xf.code_interpreter,Xf.image_vision,Xf.retrieval,Xf.actions,Xf.tools]),apiKey:a.string().optional(),models:a.object({default:a.array(a.string()).min(1),fetch:a.boolean().optional(),userIdQuery:a.boolean().optional()}).optional(),titleConvo:a.boolean().optional(),titleMethod:a.union([a.literal("completion"),a.literal("functions")]).optional(),headers:a.record(a.any()).optional()})),cx=ox.merge(a.object({recursionLimit:a.number().optional(),disableBuilder:a.boolean().optional(),capabilities:a.array(a.nativeEnum(ex)).optional().default([ex.execute_code,ex.file_search,ex.artifacts,ex.actions,ex.tools])})),dx=ox.merge(a.object({name:a.string().refine((function(e){return!pf.safeParse(e).success}),{message:"Value cannot be one of the default endpoint (EModelEndpoint) values: ".concat(Object.values(Xg).join(", "))}),apiKey:a.string(),baseURL:a.string(),models:a.object({default:a.array(a.string()).min(1),fetch:a.boolean().optional(),userIdQuery:a.boolean().optional()}),titleConvo:a.boolean().optional(),titleMethod:a.union([a.literal("completion"),a.literal("functions")]).optional(),summarize:a.boolean().optional(),summaryModel:a.string().optional(),forcePrompt:a.boolean().optional(),modelDisplayLabel:a.string().optional(),headers:a.record(a.any()).optional(),addParams:a.record(a.any()).optional(),dropParams:a.array(a.string()).optional(),customOrder:a.number().optional(),directEndpoint:a.boolean().optional(),titleMessageRole:a.string().optional()})),ux=a.object({groups:rx,plugins:a.boolean().optional(),assistants:a.boolean().optional()}).and(dx.pick({streamRate:!0,titleConvo:!0,titleMethod:!0,titleModel:!0,summarize:!0,summaryModel:!0,customOrder:!0}).partial()),mx=a.object({url:a.string().optional(),apiKey:a.string(),model:a.string(),voices:a.array(a.string())}),px=a.object({instanceName:a.string(),apiKey:a.string(),deploymentName:a.string(),apiVersion:a.string(),model:a.string(),voices:a.array(a.string())}),gx=a.object({url:a.string().optional(),websocketUrl:a.string().optional(),apiKey:a.string(),model:a.string(),voices:a.array(a.string()),voice_settings:a.object({similarity_boost:a.number().optional(),stability:a.number().optional(),style:a.number().optional(),use_speaker_boost:a.boolean().optional()}).optional(),pronunciation_dictionary_locators:a.array(a.string()).optional()}),fx=a.object({url:a.string(),apiKey:a.string().optional(),voices:a.array(a.string()),backend:a.string()}),xx=a.object({openai:mx.optional(),azureOpenAI:px.optional(),elevenlabs:gx.optional(),localai:fx.optional()}),hx=a.object({url:a.string().optional(),apiKey:a.string(),model:a.string()}),vx=a.object({instanceName:a.string(),apiKey:a.string(),deploymentName:a.string(),apiVersion:a.string()}),bx=a.object({openai:hx.optional(),azureOpenAI:vx.optional()}),yx=a.object({conversationMode:a.boolean().optional(),advancedMode:a.boolean().optional(),speechToText:a.boolean().optional().or(a.object({engineSTT:a.string().optional(),languageSTT:a.string().optional(),autoTranscribeAudio:a.boolean().optional(),decibelValue:a.number().optional(),autoSendText:a.number().optional()})).optional(),textToSpeech:a.boolean().optional().or(a.object({engineTTS:a.string().optional(),voice:a.string().optional(),languageTTS:a.string().optional(),automaticPlayback:a.boolean().optional(),playbackRate:a.number().optional(),cacheTTS:a.boolean().optional()})).optional()}).optional();!function(e){e.FILE_UPLOAD="FILE_UPLOAD",e.IMPORT="IMPORT",e.TTS="TTS",e.STT="STT"}(ix||(ix={}));var _x,jx=a.object({fileUploads:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),conversationsImport:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),tts:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional(),stt:a.object({ipMax:a.number().optional(),ipWindowInMinutes:a.number().optional(),userMax:a.number().optional(),userWindowInMinutes:a.number().optional()}).optional()});!function(e){e.PNG="png",e.WEBP="webp",e.JPEG="jpeg"}(_x||(_x={}));var wx,Nx,Cx=a.object({externalUrl:a.string().optional(),openNewTab:a.boolean().optional(),modalAcceptance:a.boolean().optional(),modalTitle:a.string().optional(),modalContent:a.string().or(a.array(a.string())).optional()}),kx=a.object({privacyPolicy:a.object({externalUrl:a.string().optional(),openNewTab:a.boolean().optional()}).optional(),termsOfService:Cx.optional(),customWelcome:a.string().optional(),endpointsMenu:a.boolean().optional(),modelSelect:a.boolean().optional(),parameters:a.boolean().optional(),sidePanel:a.boolean().optional(),multiConvo:a.boolean().optional(),bookmarks:a.boolean().optional(),presets:a.boolean().optional(),prompts:a.boolean().optional(),agents:a.boolean().optional(),temporaryChat:a.boolean().optional(),runCode:a.boolean().optional()}).default({endpointsMenu:!0,modelSelect:!0,parameters:!0,sidePanel:!0,presets:!0,multiConvo:!0,bookmarks:!0,prompts:!0,agents:!0,temporaryChat:!0,runCode:!0});a.object({version:a.string(),cache:a.boolean().default(!0),secureImageLinks:a.boolean().optional(),imageOutputType:a.nativeEnum(_x).default(_x.PNG),includedTools:a.array(a.string()).optional(),filteredTools:a.array(a.string()).optional(),mcpServers:Jf.optional(),interface:kx,fileStrategy:tx.default(Lf.local),actions:a.object({allowedDomains:a.array(a.string()).optional()}).optional(),registration:a.object({socialLogins:a.array(a.string()).optional(),allowedDomains:a.array(a.string()).optional()}).default({socialLogins:["google","facebook","openid","github","discord"]}),speech:a.object({tts:xx.optional(),stt:bx.optional(),speechTab:yx.optional()}).optional(),rateLimits:jx.optional(),fileConfig:Df.optional(),modelSpecs:Tf.optional(),endpoints:a.object((zf={all:ox.optional()},zf[Xg.openAI]=ox.optional(),zf[Xg.google]=ox.optional(),zf[Xg.anthropic]=ox.optional(),zf[Xg.gptPlugins]=ox.optional(),zf[Xg.azureOpenAI]=ux.optional(),zf[Xg.azureAssistants]=lx.optional(),zf[Xg.assistants]=lx.optional(),zf[Xg.agents]=cx.optional(),zf[Xg.custom]=a.array(dx.partial()).optional(),zf[Xg.bedrock]=ox.optional(),zf)).strict().refine((function(e){return Object.keys(e).length>0}),{message:"At least one `endpoints` field must be provided."}).optional()}),function(e){e.anyscale="anyscale",e.apipie="apipie",e.cohere="cohere",e.fireworks="fireworks",e.deepseek="deepseek",e.groq="groq",e.huggingface="huggingface",e.mistral="mistral",e.mlx="mlx",e.ollama="ollama",e.openrouter="openrouter",e.perplexity="perplexity",e.shuttleai="shuttleai",e["together.ai"]="together.ai",e.unify="unify",e.xai="xai"}(wx||(wx={})),(Nx||(Nx={})).openrouter="openrouter",Xg.openAI,Xg.assistants,Xg.azureAssistants,Xg.azureOpenAI,Xg.agents,Xg.chatGPTBrowser,Xg.gptPlugins,Xg.google,Xg.anthropic,Xg.custom,Xg.bedrock,(Uf={})[Xg.openAI]="OpenAI",Uf[Xg.assistants]="Assistants",Uf[Xg.agents]="Agents",Uf[Xg.azureAssistants]="Azure Assistants",Uf[Xg.azureOpenAI]="Azure OpenAI",Uf[Xg.chatGPTBrowser]="ChatGPT",Uf[Xg.gptPlugins]="Plugins",Uf[Xg.google]="Google",Uf[Xg.anthropic]="Anthropic",Uf[Xg.custom]="Custom",Uf[Xg.bedrock]="AWS Bedrock",Uf[wx.ollama]="Ollama",Uf[wx.deepseek]="DeepSeek",Uf[wx.xai]="xAI";var Sx,Tx,Rx,Ix,Ex,Px,Lx,Mx,Ax,Ox,Dx,Fx,zx,Ux,Vx,Bx,$x=["gpt-4o-mini","gpt-4o","gpt-3.5-turbo","gpt-3.5-turbo-0125","gpt-4-turbo","gpt-4-turbo-2024-04-09","gpt-4-0125-preview","gpt-4-turbo-preview","gpt-4-1106-preview","gpt-3.5-turbo-1106","gpt-3.5-turbo-16k-0613","gpt-3.5-turbo-16k","gpt-4","gpt-4-0314","gpt-4-32k-0314","gpt-4-0613","gpt-3.5-turbo-0613"],Hx=((Vf={})[Xg.azureAssistants]=$x,Vf[Xg.assistants]=Kg(["chatgpt-4o-latest"],$x,!0),Vf[Xg.agents]=$x,Vf[Xg.google]=["gemini-2.0-flash-001","gemini-2.0-flash-exp","gemini-2.0-flash-lite","gemini-2.0-pro-exp-02-05","gemini-1.5-flash-001","gemini-1.5-flash-002","gemini-1.5-pro-001","gemini-1.5-pro-002","gemini-1.0-pro-001"],Vf[Xg.anthropic]=["claude-3-7-sonnet-latest","claude-3-7-sonnet-20250219","claude-3-5-haiku-20241022","claude-3-5-sonnet-20241022","claude-3-5-sonnet-20240620","claude-3-5-sonnet-latest","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307","claude-2.1","claude-2","claude-1.2","claude-1","claude-1-100k","claude-instant-1","claude-instant-1-100k"],Vf[Xg.openAI]=Kg(Kg(["chatgpt-4o-latest"],$x,!0),["gpt-4-vision-preview","gpt-3.5-turbo-instruct-0914","gpt-3.5-turbo-instruct"],!1),Vf[Xg.bedrock]=["anthropic.claude-3-5-sonnet-20241022-v2:0","anthropic.claude-3-5-sonnet-20240620-v1:0","anthropic.claude-3-5-haiku-20241022-v1:0","anthropic.claude-3-haiku-20240307-v1:0","anthropic.claude-3-opus-20240229-v1:0","anthropic.claude-3-sonnet-20240229-v1:0","anthropic.claude-v2","anthropic.claude-v2:1","anthropic.claude-instant-v1","cohere.command-r-v1:0","cohere.command-r-plus-v1:0","meta.llama2-13b-chat-v1","meta.llama2-70b-chat-v1","meta.llama3-8b-instruct-v1:0","meta.llama3-70b-instruct-v1:0","meta.llama3-1-8b-instruct-v1:0","meta.llama3-1-70b-instruct-v1:0","meta.llama3-1-405b-instruct-v1:0","mistral.mistral-7b-instruct-v0:2","mistral.mixtral-8x7b-instruct-v0:1","mistral.mistral-large-2402-v1:0","mistral.mistral-large-2407-v1:0","mistral.mistral-small-2402-v1:0","ai21.jamba-instruct-v1:0","amazon.titan-text-lite-v1","amazon.titan-text-express-v1","amazon.titan-text-premier-v1:0"],Vf),Gx=Hx[Xg.openAI],Kx=((Bf={initial:[]})[Xg.openAI]=Gx,Bf[Xg.assistants]=Gx.filter((function(e){return/gpt-4|gpt-3\\.5/i.test(e)&&!/vision|instruct/i.test(e)})),Bf[Xg.agents]=Gx,Bf[Xg.gptPlugins]=Gx,Bf[Xg.azureOpenAI]=Gx,Bf[Xg.chatGPTBrowser]=["text-davinci-002-render-sha"],Bf[Xg.google]=Hx[Xg.google],Bf[Xg.anthropic]=Hx[Xg.anthropic],Bf[Xg.bedrock]=Hx[Xg.bedrock],Bf);($f={})[Xg.openAI]="/api/ask/".concat(Xg.openAI),$f[Xg.google]="/api/ask/".concat(Xg.google),$f[Xg.custom]="/api/ask/".concat(Xg.custom),$f[Xg.anthropic]="/api/ask/".concat(Xg.anthropic),$f[Xg.gptPlugins]="/api/ask/".concat(Xg.gptPlugins),$f[Xg.azureOpenAI]="/api/ask/".concat(Xg.azureOpenAI),$f[Xg.chatGPTBrowser]="/api/ask/".concat(Xg.chatGPTBrowser),$f[Xg.azureAssistants]="/api/assistants/v1/chat",$f[Xg.assistants]="/api/assistants/v2/chat",$f[Xg.agents]="/api/".concat(Xg.agents,"/chat"),$f[Xg.bedrock]="/api/".concat(Xg.bedrock,"/chat"),Xg.gptPlugins,Xg.anthropic,Xg.google,Xg.openAI,Xg.azureOpenAI,Xg.custom,Xg.agents,Xg.bedrock,(Hf={})[Xg.custom]=!0,Hf[Xg.openAI]=!0,Hf[Xg.anthropic]=!0,Hf[Xg.gptPlugins]=!0,Hf[Xg.assistants]=!0,Hf[Xg.agents]=!0,Hf[Xg.azureAssistants]=!0,Hf[Xg.azureOpenAI]=!0,Hf[Xg.bedrock]=!0,function(e){e.generative="generative",e.agents="agents"}(Sx||(Sx={})),function(e){e.PROMPT_GROUPS="promptGroups",e.SHARED_LINKS="sharedLinks"}(Tx||(Tx={})),function(e){e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.THIRTY_MINUTES=18e5]="THIRTY_MINUTES",e[e.TEN_MINUTES=6e5]="TEN_MINUTES",e[e.FIVE_MINUTES=3e5]="FIVE_MINUTES",e[e.TWO_MINUTES=12e4]="TWO_MINUTES",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.THIRTY_SECONDS=3e4]="THIRTY_SECONDS"}(Rx||(Rx={})),function(e){e.CONFIG_STORE="configStore",e.ROLES="roles",e.PLUGINS="plugins",e.GEN_TITLE="genTitle",e.TOOLS="tools",e.MODELS_CONFIG="modelsConfig",e.MODEL_QUERIES="modelQueries",e.STARTUP_CONFIG="startupConfig",e.ENDPOINT_CONFIG="endpointsConfig",e.TOKEN_CONFIG="tokenConfig",e.CUSTOM_CONFIG="customConfig",e.ABORT_KEYS="abortKeys",e.OVERRIDE_CONFIG="overrideConfig",e.BANS="bans",e.ENCODED_DOMAINS="encoded_domains",e.AUDIO_RUNS="audioRuns",e.MESSAGES="messages",e.FLOWS="flows"}(Ix||(Ix={})),function(e){e.FILE_UPLOAD_LIMIT="file_upload_limit",e.ILLEGAL_MODEL_REQUEST="illegal_model_request",e.TOKEN_BALANCE="token_balance",e.BAN="ban",e.TTS_LIMIT="tts_limit",e.STT_LIMIT="stt_limit",e.RESET_PASSWORD_LIMIT="reset_password_limit",e.VERIFY_EMAIL_LIMIT="verify_email_limit",e.CONVO_ACCESS="convo_access",e.TOOL_CALL_LIMIT="tool_call_limit"}(Ex||(Ex={})),function(e){e.NO_USER_KEY="no_user_key",e.EXPIRED_USER_KEY="expired_user_key",e.INVALID_USER_KEY="invalid_user_key",e.NO_BASE_URL="no_base_url",e.MODERATION="moderation",e.INPUT_LENGTH="INPUT_LENGTH",e.INVALID_REQUEST="invalid_request_error",e.INVALID_ACTION="invalid_action_error",e.NO_SYSTEM_MESSAGES="no_system_messages",e.GOOGLE_ERROR="google_error"}(Px||(Px={})),function(e){e.GOOGLE_SERVICE_KEY="GOOGLE_SERVICE_KEY",e.GOOGLE_API_KEY="GOOGLE_API_KEY"}(Lx||(Lx={})),function(e){e[e.LOW=85]="LOW",e[e.HIGH=170]="HIGH",e[e.ADDITIONAL=85]="ADDITIONAL"}(Mx||(Mx={})),function(e){e.GENERAL="general",e.CHAT="chat",e.SPEECH="speech",e.BETA="beta",e.DATA="data",e.ACCOUNT="account",e.COMMANDS="commands"}(Ax||(Ax={})),function(e){e.OPENAI="openai",e.AZURE_OPENAI="azureOpenAI"}(Ox||(Ox={})),function(e){e.OPENAI="openai",e.AZURE_OPENAI="azureOpenAI",e.ELEVENLABS="elevenlabs",e.LOCALAI="localai"}(Dx||(Dx={})),function(e){e.VERSION="v0.7.7-rc1",e.CONFIG_VERSION="1.2.1",e.NO_PARENT="00000000-0000-0000-0000-000000000000",e.NEW_CONVO="new",e.SEARCH="search",e[e.ENCODED_DOMAIN_LENGTH=10]="ENCODED_DOMAIN_LENGTH",e.CURRENT_MODEL="current_model",e.COMMON_DIVIDER="__",e[e.COMMANDS_MAX_LENGTH=56]="COMMANDS_MAX_LENGTH",e[e.DEFAULT_STREAM_RATE=1]="DEFAULT_STREAM_RATE",e.SAVED_TAG="Saved",e[e.MAX_CONVO_STARTERS=4]="MAX_CONVO_STARTERS",e.GLOBAL_PROJECT_NAME="instance",e.mcp_delimiter="_mcp_"}(Fx||(Fx={})),function(e){e.APP_TITLE="appTitle",e.LAST_CONVO_SETUP="lastConversationSetup",e.LAST_MODEL="lastSelectedModel",e.LAST_TOOLS="lastSelectedTools",e.LAST_SPEC="lastSelectedSpec",e.FILES_TO_DELETE="filesToDelete",e.ASST_ID_PREFIX="assistant_id__",e.AGENT_ID_PREFIX="agent_id__",e.FORK_SETTING="forkSetting",e.REMEMBER_FORK_OPTION="rememberDefaultFork",e.FORK_SPLIT_AT_TARGET="splitAtTarget",e.TEXT_DRAFT="textDraft_",e.FILES_DRAFT="filesDraft_",e.LAST_PROMPT_CATEGORY="lastPromptCategory",e.ENABLE_USER_MSG_MARKDOWN="enableUserMsgMarkdown",e.SHOW_ANALYSIS_CODE="showAnalysisCode"}(zx||(zx={})),function(e){e.DIRECT_PATH="directPath",e.INCLUDE_BRANCHES="includeBranches",e.TARGET_LEVEL="targetLevel",e.DEFAULT="default"}(Ux||(Ux={})),function(e){e.API_URL="https://api.cohere.ai/v1",e.ROLE_USER="USER",e.ROLE_SYSTEM="SYSTEM",e.ROLE_CHATBOT="CHATBOT",e.TITLE_MESSAGE="TITLE:"}(Vx||(Vx={})),function(e){e.ALL="sys__all__sys",e.MY_PROMPTS="sys__my__prompts__sys",e.NO_CATEGORY="sys__no__category__sys",e.SHARED_PROMPTS="sys__shared__prompts__sys"}(Bx||(Bx={})),(Gf={})[Xg.openAI]=Xg.openAI,Gf[Xg.bedrock]=Xg.bedrock,Gf[Xg.anthropic]=Xg.anthropic,Gf[Xg.azureOpenAI]=Xg.azureOpenAI;var Wx=function(e,t){return"/api/messages/".concat(e).concat(null!=t&&t?"/".concat(t):"")},Qx="/api/share",qx="/api/keys";function Zx(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.post(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))}var Yx=!1,Jx=[],Xx=function(e){return Zx(function(e){return"/api/auth/refresh".concat(!0===e?"?retry=true":"")}(e))},eh=function(e){!function(e){s.defaults.headers.common.Authorization="Bearer "+e}(e),window.dispatchEvent(new CustomEvent("tokenUpdated",{detail:e}))},th=function(e,t){void 0===t&&(t=null),Jx.forEach((function(n){e?n.reject(e):n.resolve(t)})),Jx=[]};s.interceptors.response.use((function(e){return e}),(function(e){return Hg(void 0,0,void 0,(function(){var t,n,a,r,o,i,l,c,d;return Gg(this,(function(u){switch(u.label){case 0:if(t=e.config,!e.response)return[2,Promise.reject(e)];if(!0===(null===(i=t.url)||void 0===i?void 0:i.includes("/api/auth/2fa")))return[2,Promise.reject(e)];if(!0===(null===(l=t.url)||void 0===l?void 0:l.includes("/api/auth/logout")))return[2,Promise.reject(e)];if(401!==e.response.status||t._retry)return[3,13];if(console.warn("401 error, refreshing token"),t._retry=!0,!Yx)return[3,5];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,new Promise((function(e,t){Jx.push({resolve:e,reject:t})}))];case 2:return r=u.sent(),t.headers.Authorization="Bearer "+r,[4,s(t)];case 3:return[2,u.sent()];case 4:return n=u.sent(),[2,Promise.reject(n)];case 5:Yx=!0,u.label=6;case 6:return u.trys.push([6,11,12,13]),[4,Xx(!0===(null===(c=t.url)||void 0===c?void 0:c.includes("api/auth/refresh")))];case 7:return a=u.sent(),(r=null!==(d=null==a?void 0:a.token)&&void 0!==d?d:"")?(t.headers.Authorization="Bearer "+r,eh(r),th(null,r),[4,s(t)]):[3,9];case 8:return[2,u.sent()];case 9:window.location.href.includes("share/")?console.log("Refresh token failed from shared link, attempting request to ".concat(t.url)):window.location.href="/login",u.label=10;case 10:return[3,13];case 11:return o=u.sent(),th(o,null),[2,Promise.reject(o)];case 12:return Yx=!1,[7];case 13:return[2,Promise.reject(e)]}}))}))}));var nh={get:function(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.get(e,$g({},t))];case 1:return[2,n.sent().data]}}))}))},getResponse:function(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.get(e,$g({},t))];case 1:return[2,n.sent()]}}))}))},post:Zx,postMultiPart:function(e,t,n){return Hg(this,0,void 0,(function(){return Gg(this,(function(a){switch(a.label){case 0:return[4,s.post(e,t,$g($g({},n),{headers:{"Content-Type":"multipart/form-data"}}))];case 1:return[2,a.sent().data]}}))}))},postTTS:function(e,t,n){return Hg(this,0,void 0,(function(){return Gg(this,(function(a){switch(a.label){case 0:return[4,s.post(e,t,$g($g({},n),{headers:{"Content-Type":"multipart/form-data"},responseType:"arraybuffer"}))];case 1:return[2,a.sent().data]}}))}))},put:function(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.put(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},delete:function(e){return Hg(this,0,void 0,(function(){return Gg(this,(function(t){switch(t.label){case 0:return[4,s.delete(e)];case 1:return[2,t.sent().data]}}))}))},deleteWithOptions:function(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.delete(e,$g({},t))];case 1:return[2,n.sent().data]}}))}))},patch:function(e,t){return Hg(this,0,void 0,(function(){return Gg(this,(function(n){switch(n.label){case 0:return[4,s.patch(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},refreshToken:Xx,dispatchTokenUpdatedEvent:eh};var ah,sh;!function(e){e.messages="messages",e.sharedMessages="sharedMessages",e.sharedLinks="sharedLinks",e.allConversations="allConversations",e.archivedConversations="archivedConversations",e.searchConversations="searchConversations",e.conversation="conversation",e.searchEnabled="searchEnabled",e.user="user",e.name="name",e.models="models",e.balance="balance",e.endpoints="endpoints",e.presets="presets",e.searchResults="searchResults",e.tokenCount="tokenCount",e.availablePlugins="availablePlugins",e.startupConfig="startupConfig",e.assistants="assistants",e.assistant="assistant",e.agents="agents",e.agent="agent",e.endpointsConfigOverride="endpointsConfigOverride",e.files="files",e.fileConfig="fileConfig",e.tools="tools",e.toolAuth="toolAuth",e.toolCalls="toolCalls",e.agentTools="agentTools",e.actions="actions",e.assistantDocs="assistantDocs",e.agentDocs="agentDocs",e.fileDownload="fileDownload",e.voices="voices",e.customConfigSpeech="customConfigSpeech",e.prompts="prompts",e.prompt="prompt",e.promptGroups="promptGroups",e.allPromptGroups="allPromptGroups",e.promptGroup="promptGroup",e.categories="categories",e.randomPrompts="randomPrompts",e.roles="roles",e.conversationTags="conversationTags",e.health="health",e.userTerms="userTerms",e.banner="banner"}(ah||(ah={})),function(e){e.fileUpload="fileUpload",e.fileDelete="fileDelete",e.updatePreset="updatePreset",e.deletePreset="deletePreset",e.loginUser="loginUser",e.logoutUser="logoutUser",e.refreshToken="refreshToken",e.avatarUpload="avatarUpload",e.speechToText="speechToText",e.textToSpeech="textToSpeech",e.assistantAvatarUpload="assistantAvatarUpload",e.agentAvatarUpload="agentAvatarUpload",e.updateAction="updateAction",e.updateAgentAction="updateAgentAction",e.deleteAction="deleteAction",e.deleteAgentAction="deleteAgentAction",e.deleteUser="deleteUser",e.updateRole="updateRole",e.enableTwoFactor="enableTwoFactor",e.verifyTwoFactor="verifyTwoFactor"}(sh||(sh={}));var rh=function(e,t){return nr([ah.messages,e],(function(){return"new"===(t=e)?Promise.resolve([]):nh.get(Wx(t));var t}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},t))},oh=function(e,t){return nr([ah.sharedMessages,e],(function(){return function(e){return nh.get(function(e){return"".concat(Qx,"/").concat(e)}(e))}(e)}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},t))},ih=function(e,t){var n=ar();return nr([ah.sharedLinks,e],(function(){return function(e){return nh.get(function(e){return"".concat(Qx,"/link/").concat(e)}(e))}(e)}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,onSuccess:function(t){n.setQueryData([ah.sharedLinks,e],{conversationId:t.conversationId,shareId:t.shareId})}},t))},lh=function(){var e=ar();return sr((function(e){return function(e){if(!e.value)throw new Error("value is required");return nh.put(qx,e)}(e)}),{onSuccess:function(t,n){e.invalidateQueries([ah.name,n.name])}})},ch=function(){var e=ar();return sr((function(){return nh.post("".concat("/api/convos","/clear"),{arg:{}})}),{onSuccess:function(){e.invalidateQueries([ah.allConversations])}})},dh=function(e){var t=ar();return sr((function(){return function(e){return nh.delete(function(e){return"".concat(qx,"/").concat(e)}(e))}(e)}),{onSuccess:function(){var n,a;t.invalidateQueries([ah.name,e]),(a=null!=(n=e)?n:"")&&a.toLowerCase().endsWith(Xg.assistants)&&(t.invalidateQueries([ah.assistants,e,Jg]),t.invalidateQueries([ah.assistantDocs]),t.invalidateQueries([ah.assistants]),t.invalidateQueries([ah.assistant]),t.invalidateQueries([ah.actions]),t.invalidateQueries([ah.tools]))}})},uh=function(){var e=ar();return sr((function(){return nh.delete("".concat(qx,"?all=true"))}),{onSuccess:function(){e.invalidateQueries([ah.name]),e.invalidateQueries([ah.assistants,Xg.assistants,Jg]),e.invalidateQueries([ah.assistants,Xg.azureAssistants,Jg]),e.invalidateQueries([ah.assistantDocs]),e.invalidateQueries([ah.assistants]),e.invalidateQueries([ah.assistant]),e.invalidateQueries([ah.actions]),e.invalidateQueries([ah.tools])}})},mh=function(e){return nr([ah.models],(function(){return Hg(void 0,0,void 0,(function(){return Gg(this,(function(e){return[2,nh.get("/api/models")]}))}))}),$g({initialData:Kx,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:1/0},e))},ph=function(){var e=ar();return sr((function(e){return function(e){return nh.post("/api/presets",e)}(e)}),{onSuccess:function(){e.invalidateQueries([ah.presets])}})},gh=function(e,t){return nr([ah.name,e],(function(){return e?function(e){return nh.get(function(e){return"".concat(qx,"?name=").concat(e)}(e))}(e):Promise.resolve({expiresAt:""})}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1},t))},fh=function(e){return nr([ah.availablePlugins],(function(){return nh.get("/api/plugins")}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},e))},xh=function(e){var t=ar(),n=null!=e?e:{},a=n.onSuccess,s=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n}(n,["onSuccess"]);return sr((function(e){return function(e){return nh.post("/api/user/plugins",e)}(e)}),$g($g({},s),{onSuccess:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.invalidateQueries([ah.user]),null==a||a.apply(void 0,e)}}))};const hh=()=>{const{data:e={}}=Mp(),{data:t={}}=mh();return({conversation:n,preset:a})=>{const s=um({convoSetup:a,endpointsConfig:e}),r=t[s]||[];return dm({conversation:n,endpoint:s,lastConversationSetup:a,models:r})}},vh=n.createContext({}),bh=()=>n.useContext(vh),yh=e=>e.data.map((({id:e,name:t,metadata:n,model:a})=>({id:e,name:t??"",metadata:n,model:a})));function _h(e=yh){const{data:t=null}=qp(Ro.assistants,void 0,{select:e}),{data:a=null}=qp(Ro.azureAssistants,void 0,{select:e});return n.useMemo((()=>({[Ro.assistants]:t,[Ro.azureAssistants]:a})),[t,a])}function jh(e){const t=hh(),{conversation:a,newConversation:s}=bh(),r=_h((e=>qr(e.data)));return{onSelect:n.useCallback((n=>{var o;const i=null==(o=r[e])?void 0:o[n];if(!i)return;const l={endpoint:e,assistant_id:i.id,model:i.model,conversationId:"new"};if(Oo(null==a?void 0:a.endpoint)){const e=t({conversation:{...a??{}},preset:l});s({template:e,preset:l,keepLatestMessage:!0})}else s({template:{...l},preset:l})}),[e,r,a,t,s])}}const wh=n.createContext({}),Nh=()=>n.useContext(wh);function Ch(){const e=ar(),t=hh(),{conversation:a,newConversation:s}=bh(),r=Nh(),[o,i]=n.useState((null==a?void 0:a.agent_id)??null),l=kp(o??"",{enabled:!!o}),c=n.useCallback(((e,n)=>{if(Do(null==a?void 0:a.endpoint)){const r=t({conversation:{...a??{},agent_id:e.id},preset:n});s({template:r,preset:n,keepLatestMessage:!0})}else s({template:{...n},preset:n})}),[a,t,s]);return{onSelect:n.useCallback((async t=>{const n=null==r?void 0:r[t];if(!n)return;i(n.id);const a={endpoint:Ro.agents,agent_id:n.id,conversationId:dc.NEW_CONVO};c({id:n.id},a);try{await e.invalidateQueries({queryKey:[Xc.agent,n.id],exact:!0,refetchType:"active"},{throwOnError:!0});const{data:t}=await l.refetch();t&&c(t,{...a,agent_id:t.id})}catch(s){if(null==s?void 0:s.silent)return void console.warn("Current fetch was cancelled");console.error("Error fetching full agent data:",s),c({},{...a,agent_id:void 0})}}),[r,c,e,l])}}function kh(){return e=>localStorage.setItem(uc.FILES_TO_DELETE,JSON.stringify(e))}function Sh(){const{data:e={}}=Mp();return n.useCallback((t=>{const{modelDisplayLabel:n}=(null==e?void 0:e[t.endpoint??""])??{};return wc({...t,modelDisplayLabel:n})}),[e])}var Th,Rh=Object.freeze,Ih=Object.defineProperty;const Eh=({codeArtifacts:e,includeShadcnui:t,customPromptMode:n})=>{if(e)return n?_c.CUSTOM:t?_c.SHADCNUI:_c.DEFAULT},Ph={"application/vnd.mermaid":"App.tsx","application/vnd.react":"App.tsx","text/html":"index.html","application/vnd.code-html":"index.html",default:"index.html"},Lh={"text/html":"static","application/vnd.react":"react-ts","application/vnd.mermaid":"react-ts","application/vnd.code-html":"static",default:"static"};function Mh(e,t){return`${e}${((null==t?void 0:t.length)??0)>0?`-${t}`:""}`}const Ah={three:"^0.167.1","lucide-react":"^0.394.0","react-router-dom":"^6.11.2","class-variance-authority":"^0.6.0",clsx:"^1.2.1","date-fns":"^3.3.1","tailwind-merge":"^1.9.1","tailwindcss-animate":"^1.0.5",recharts:"2.12.7","@radix-ui/react-accordion":"^1.1.2","@radix-ui/react-alert-dialog":"^1.0.2","@radix-ui/react-aspect-ratio":"^1.1.0","@radix-ui/react-avatar":"^1.1.0","@radix-ui/react-checkbox":"^1.0.3","@radix-ui/react-collapsible":"^1.0.3","@radix-ui/react-dialog":"^1.0.2","@radix-ui/react-dropdown-menu":"^2.1.1","@radix-ui/react-hover-card":"^1.0.5","@radix-ui/react-label":"^2.0.0","@radix-ui/react-menubar":"^1.1.1","@radix-ui/react-navigation-menu":"^1.2.0","@radix-ui/react-popover":"^1.0.7","@radix-ui/react-progress":"^1.1.0","@radix-ui/react-radio-group":"^1.1.3","@radix-ui/react-select":"^2.0.0","@radix-ui/react-separator":"^1.0.3","@radix-ui/react-slider":"^1.1.1","@radix-ui/react-switch":"^1.0.3","@radix-ui/react-tabs":"^1.0.3","@radix-ui/react-toast":"^1.1.5","@radix-ui/react-slot":"^1.1.0","@radix-ui/react-toggle":"^1.1.0","@radix-ui/react-toggle-group":"^1.1.0","embla-carousel-react":"^8.2.0","react-day-picker":"^9.0.8","dat.gui":"^0.7.9",vaul:"^0.9.1"},Oh={"application/vnd.mermaid":Object.assign({mermaid:"^11.4.1","react-zoom-pan-pinch":"^3.6.1"},Ah),"application/vnd.react":Ah,"text/html":Ah,"application/vnd.code-html":Ah,default:Ah};function Dh(e){return Oh[e]??Ah}const Fh={externalResources:["https://unpkg.com/@tailwindcss/ui/dist/tailwind-ui.min.css"]},zh={"/lib/utils.ts":Jc.utils,"/components/ui/accordion.tsx":Jc.accordian,"/components/ui/alert-dialog.tsx":Jc.alertDialog,"/components/ui/alert.tsx":Jc.alert,"/components/ui/avatar.tsx":Jc.avatar,"/components/ui/badge.tsx":Jc.badge,"/components/ui/breadcrumb.tsx":Jc.breadcrumb,"/components/ui/button.tsx":Jc.button,"/components/ui/calendar.tsx":Jc.calendar,"/components/ui/card.tsx":Jc.card,"/components/ui/carousel.tsx":Jc.carousel,"/components/ui/checkbox.tsx":Jc.checkbox,"/components/ui/collapsible.tsx":Jc.collapsible,"/components/ui/dialog.tsx":Jc.dialog,"/components/ui/drawer.tsx":Jc.drawer,"/components/ui/dropdown-menu.tsx":Jc.dropdownMenu,"/components/ui/input.tsx":Jc.input,"/components/ui/label.tsx":Jc.label,"/components/ui/menubar.tsx":Jc.menuBar,"/components/ui/navigation-menu.tsx":Jc.navigationMenu,"/components/ui/pagination.tsx":Jc.pagination,"/components/ui/popover.tsx":Jc.popover,"/components/ui/progress.tsx":Jc.progress,"/components/ui/radio-group.tsx":Jc.radioGroup,"/components/ui/select.tsx":Jc.select,"/components/ui/separator.tsx":Jc.separator,"/components/ui/skeleton.tsx":Jc.skeleton,"/components/ui/slider.tsx":Jc.slider,"/components/ui/switch.tsx":Jc.switchComponent,"/components/ui/table.tsx":Jc.table,"/components/ui/tabs.tsx":Jc.tabs,"/components/ui/textarea.tsx":Jc.textarea,"/components/ui/toast.tsx":Jc.toast,"/components/ui/toaster.tsx":Jc.toaster,"/components/ui/toggle-group.tsx":Jc.toggleGroup,"/components/ui/toggle.tsx":Jc.toggle,"/components/ui/tooltip.tsx":Jc.tooltip,"/components/ui/use-toast.tsx":Jc.useToast,"/public/index.html":A(Th||(Uh=['\n    <!DOCTYPE html>\n    <html lang="en">\n      <head>\n        <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1.0">\n        <title>Document</title>\n        <script src="https://cdn.tailwindcss.com"><\/script>\n      </head>\n      <body>\n        <div id="root"></div>\n      </body>\n    </html>\n  '],Th=Rh(Ih(Uh,"raw",{value:Rh(Uh.slice())}))))};var Uh;const Vh=e=>{const{data:t}=Mp(),a=null==t?void 0:t[e??""],{azure:s}=a??{};let r=e;s?r=Ro.azureOpenAI:r===Ro.gptPlugins&&(r=Ro.openAI);const o=lh(),i=gh(r),l=n.useCallback((()=>{if(i.data)return i.data.expiresAt||"never"}),[i.data]),c=n.useCallback((()=>{const e=l();if(!e)return!0;return!(new Date(e)<new Date)}),[l]),d=n.useCallback(((e,t)=>{const n=t?new Date(t).toISOString():"";o.mutate({name:r,value:e,expiresAt:n})}),[o,r]);return n.useMemo((()=>({getExpiry:l,checkExpiry:c,saveUserKey:d})),[l,c,d])},Bh=e=>{om.log("=====================================\nAsk function called with:"),om.dir(e),om.log("=====================================")},$h=(e,t)=>t===Ro.custom||(e===Ro.openAI||e===Ro.azureOpenAI||void 0);function Hh({index:e=0,files:t,setFiles:n,getMessages:a,setMessages:s,isSubmitting:r,conversation:o,latestMessage:i,setSubmission:l,setLatestMessage:c}){const d=I(_p.codeArtifacts),u=I(_p.includeShadcnui),m=I(_p.customPromptMode),p=P(_p.latestMessageFamily(e+1)),g=R(_p.showStopButtonByIndex(e)),f=kh(),x=Sh(),h=I(_p.isTemporary),v=ar(),{getExpiry:b}=Vh((null==o?void 0:o.endpoint)??""),y=({text:y,overrideConvoId:_,overrideUserMessageId:j,parentMessageId:w=null,conversationId:N=null,messageId:C=null},{editedText:k=null,editedMessageId:S=null,resubmitFiles:T=!1,isRegenerate:R=!1,isContinued:I=!1,isEdited:E=!1,overrideMessages:P}={})=>{var L;if(g(!1),p(),r||""===y)return;const M=null==o?void 0:o.endpoint;if(null===M)return void console.error("No endpoint available");if("search"==(N=N??(null==o?void 0:o.conversationId)??null))return void console.error("cannot send any message under search view!");if(I&&!i)return void console.error("cannot continue AI message without latestMessage!");const A=E||I;let D=P??a()??[];y=y.trim();const F=j??O();w=w??(null==i?void 0:i.messageId)??dc.NO_PARENT,Bh({index:e,conversation:o,latestMessage:i,conversationId:N,intermediateId:F,parentMessageId:w,currentMessages:D}),N==dc.NEW_CONVO&&(w=dc.NO_PARENT,D=[],N=null);const z=D.find((e=>e.messageId===(null==i?void 0:i.parentMessageId)));let U=(null==z?void 0:z.thread_id)??(null==i?void 0:i.thread_id);null==U&&(U=null==(L=D.find((e=>e.thread_id)))?void 0:L.thread_id);const V=v.getQueryData([Xc.endpoints]),B=Hu(V,M,"type"),$=Cc({endpoint:M,endpointType:B,conversation:o??{}}),{modelDisplayLabel:H}=(null==V?void 0:V[M??""])??{},G=Object.assign({endpoint:M,endpointType:B,overrideConvoId:_,overrideUserMessageId:j,artifacts:M!==Ro.agents?Eh({codeArtifacts:d,includeShadcnui:u,customPromptMode:m}):void 0},$);M!==Ro.agents?(G.key=b(),G.thread_id=U,G.modelDisplayLabel=H):G.key=new Date(Date.now()+36e5).toISOString();const K=x({model:null==o?void 0:o.model,...G}),W={text:y,sender:"User",clientTimestamp:(new Date).toLocaleString("sv").replace(" ","T"),isCreatedByUser:!0,parentMessageId:w,conversationId:N,messageId:I&&null!=C&&C?C:F,thread_id:U,error:!1},Q=(R||T)&&(null==z?void 0:z.files)&&z.files.length>0;n&&!0===Q?(W.files=z.files,n(new Map),f({})):n&&t&&t.size>0&&(W.files=Array.from(t.values()).map((e=>({file_id:e.file_id,filepath:e.filepath,type:e.type??"",height:e.height,width:e.width}))),n(new Map),f({}));const q=k??(null==i?void 0:i.text)??"",Z=A?q:"",Y=S??(null==i?void 0:i.messageId)??null,J={sender:K,text:Z,endpoint:M??"",parentMessageId:R?C:F,messageId:Y??`${R?C:F}_`,thread_id:U,conversationId:N,unfinished:!1,isCreatedByUser:!1,iconURL:null==$?void 0:$.iconURL,model:null==$?void 0:$.model,error:!1};Oo(M)?(J.model=(null==o?void 0:o.assistant_id)??"",J.text="",J.content=[{type:to.TEXT,[to.TEXT]:{value:Z}}]):M===Ro.agents?(J.model=(null==o?void 0:o.agent_id)??"",J.text="",J.content=[{type:to.TEXT,[to.TEXT]:{value:Z}}],g(!0)):$h(M,B)?(J.text="",J.content=[{type:to.TEXT,[to.TEXT]:{value:Z}}],g(!0)):g(!0),I&&(D=D.filter((e=>e.messageId!==Y))),om.log("message_state",J);const X={conversation:{...o,conversationId:N},endpointOption:G,userMessage:{...W,generation:q,responseMessageId:Y,overrideParentMessageId:R?C:null},messages:D,isEdited:A,isContinued:I,isRegenerate:R,initialResponse:J,isTemporary:h};s(R?[...X.messages,J]:[...X.messages,W,J]),0===e&&c&&c(J),l(X),om.dir("message_stream",X,{depth:null})};return{ask:y,regenerate:({parentMessageId:e})=>{const t=a(),n=null==t?void 0:t.find((t=>t.messageId==e));n&&n.isCreatedByUser?y({...n},{isRegenerate:!0}):console.error("Failed to regenerate the message: parentMessage not found or not created by user.")}}}const Gh=n.createContext(void 0),Kh=({authConfig:e,children:t})=>{const[a,s]=T(_p.user),[r,o]=n.useState(void 0),[i,l]=n.useState(void 0),[d,u]=n.useState(!1),{data:m=null}=_g(qc.USER,{enabled:!(!d||!(null==a?void 0:a.role))}),{data:p=null}=_g(qc.ADMIN,{enabled:!(!d||(null==a?void 0:a.role)!==qc.ADMIN)}),g=D(),f=n.useCallback((e=>{const{token:t,isAuthenticated:n,user:a,redirect:r}=e;s(a),o(t),cd(t),u(n),null!=r&&(r.startsWith("http://")||r.startsWith("https://")?window.location.href=r:g(r,{replace:!0}))}),[g,s]),x=function({callback:e,delay:t=400}){const a=n.useRef(null);return n.useEffect((()=>()=>{null!==a.current&&clearTimeout(a.current)}),[]),n=>{null!==a.current&&clearTimeout(a.current),null!=n&&n&&(console.log(n),a.current=setTimeout((()=>{e(n)}),t))}}({callback:e=>l(e)}),h=(e=>{const t=ar(),n=wp(),a=P(_p.defaultPreset),s=R(_p.queriesEnabled);return sr([ed.loginUser],{mutationFn:e=>zd.login(e),...e||{},onMutate:s=>{var r;a(),n(),t.removeQueries(),null==(r=null==e?void 0:e.onMutate)||r.call(e,s)},onSuccess:(...t)=>{var n;s(!0),null==(n=null==e?void 0:e.onSuccess)||n.call(e,...t)}})})({onSuccess:e=>{const{user:t,token:n,twoFAPending:a,tempToken:s}=e;a?g(`/login/2fa?tempToken=${s}`,{replace:!0}):(l(void 0),f({token:n,isAuthenticated:!0,user:t,redirect:"/c/new"}))},onError:e=>{x(e.message),g("/login",{replace:!0})}}),v=(e=>{const t=ar(),n=wp(),a=P(_p.defaultPreset),s=R(_p.queriesEnabled);return sr([ed.logoutUser],{mutationFn:()=>zd.logout(),...e||{},onSuccess:(...r)=>{var o;s(!1),a(),n(),t.removeQueries(),null==(o=null==e?void 0:e.onSuccess)||o.call(e,...r)}})})({onSuccess:e=>{f({token:void 0,isAuthenticated:!1,user:void 0,redirect:e.redirect??"/login"})},onError:e=>{x(e.message),f({token:void 0,isAuthenticated:!1,user:void 0,redirect:"/login"})}}),b=(e=>{const t=ar();return sr([ed.refreshToken],{mutationFn:()=>Fd.refreshToken(),onMutate:e=>{t.removeQueries()}})})(),y=n.useCallback((()=>v.mutate(void 0)),[v]),_=(e=>{const t=I(_p.queriesEnabled);return nr([Xc.user],(()=>zd.getUser()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...e,enabled:!0===((null==e?void 0:e.enabled)??!0)&&t})})({enabled:!!r}),j=e=>{h.mutate(e)},w=n.useCallback((()=>{!0!==(null==e?void 0:e.test)?b.mutate(void 0,{onSuccess:t=>{const{user:n,token:a=""}=t??{};if(a)f({token:a,isAuthenticated:!0,user:n});else{if(console.log("Token is not present. User is not authenticated."),!0===(null==e?void 0:e.test))return;g("/login")}},onError:t=>{console.log("refreshToken mutation error:",t),!0!==(null==e?void 0:e.test)&&g("/login")}}):console.log("Test mode. Skipping silent refresh.")}),[]);n.useEffect((()=>{_.data?s(_.data):_.isError&&(x(_.error.message),g("/login",{replace:!0})),null!=i&&i&&d&&x(void 0),null!=r&&r&&d||w()}),[r,d,_.data,_.isError,_.error,i,s,g,w,f]),n.useEffect((()=>{const e=e=>{console.log("tokenUpdated event received event");const t=e.detail;f({token:t,isAuthenticated:!0,user:a})};return window.addEventListener("tokenUpdated",e),()=>{window.removeEventListener("tokenUpdated",e)}}),[f,a]);const N=n.useMemo((()=>({user:a,token:r,error:i,login:j,logout:y,setError:l,roles:{[qc.USER]:m,[qc.ADMIN]:p},isAuthenticated:d})),[a,i,d,r,m,p]);return c.jsx(Gh.Provider,{value:N,children:t})},Wh=()=>{const e=n.useContext(Gh);if(void 0===e)throw new Error("useAuthContext should be used inside AuthProvider");return e},Qh=(e=0)=>{const t=D(),{data:a}=Ap(),s=_p.useClearConvoState(),r=I(_p.defaultPreset),{setConversation:o}=_p.useCreateConversationAtom(e),[i,l]=T(_p.isTemporary),[c,d]=T(_p.filesByIndex(e)),u=_p.useClearLatestMessages(`useNewConvo ${e}`),m=R(_p.submissionByIndex(e)),{data:p={}}=Mp(),g=mh(),f=n.useRef(),x=_h(),{pauseGlobalAudio:h}=jp(e),v=I(_p.saveDrafts),{mutateAsync:b}=Fp({onSuccess:()=>{console.log("Files deleted")},onError:e=>{console.log("Error deleting files:",e)}}),y=S((()=>async(n,a=null,i,l,c,d,h)=>{var v,b;const y=i??g.data,{endpoint:_=null}=n,j=(null===_||l)??!1,w=!r||a||r.endpoint!==_&&_||!j?a:r;if(j){let t=um({convoSetup:w??n,endpointsConfig:p});t||(t=Object.keys(p??{})[0]);const a=Hu(p,t,"type");!n.endpointType&&a?n.endpointType=a:n.endpointType&&!a&&(n.endpointType=void 0);const s=Oo(t),r=x[t]??[],o=n.assistant_id??"",i=null==(v=x[t])?void 0:v[o];if(o&&!i&&(n.assistant_id=void 0),!o&&s&&(n.assistant_id=localStorage.getItem(`${uc.ASST_ID_PREFIX}${e}${t}`)??(null==(b=r[0])?void 0:b.id)),o&&s&&n.conversationId===dc.NEW_CONVO){const e=r.find((e=>e.id===o));n.model=null==e?void 0:e.model,function({endpoint:e,model:t=""}){if(!t)return;const n=JSON.parse((localStorage.getItem(Ku)??"{}")||"{}");n.endpoint===e&&(n.model=t,localStorage.setItem(Ku,JSON.stringify(n)));const a=JSON.parse((localStorage.getItem(uc.LAST_MODEL)??"{}")||"{}");a[e]=t,localStorage.setItem(uc.LAST_MODEL,JSON.stringify(a))}({endpoint:t,model:n.model})}o&&!s&&(n.assistant_id=void 0);const l=(null==y?void 0:y[t])??[];n=dm({conversation:n,lastConversationSetup:w,endpoint:t,models:l})}if(d||s(!0),o(n),m({}),c||u(),n.conversationId===dc.NEW_CONVO&&!i){const e=localStorage.getItem(uc.APP_TITLE)??"";e&&(document.title=e),t(`/c/${dc.NEW_CONVO}`)}clearTimeout(f.current),!0!==h&&(f.current=setTimeout((()=>{const e=document.getElementById(Vr);e&&e.focus()}),150))}),[p,r,x,g.data]),_=n.useCallback((function({template:e={},preset:t,modelsData:n,disableFocus:s,buildDefault:r=!0,keepLatestMessage:o=!1,keepAddedConvos:u=!1}={}){var m,p;h(),i&&l(!1);const g=e.conversationId??"",f=!0===(!0===Fo(e.endpoint??"",e.endpointType??"")||Fo((null==t?void 0:t.endpoint)??"",(null==t?void 0:t.endpointType)??""))&&g&&g===dc.NEW_CONVO?{endpoint:e.endpoint}:e,x={conversationId:dc.NEW_CONVO,title:"New Chat",endpoint:null,...f,createdAt:"",updatedAt:""};let _=t;const j=Qu(null==(m=null==a?void 0:a.modelSpecs)?void 0:m.list);if(!_&&a&&!0===(null==(p=a.modelSpecs)?void 0:p.prioritize)&&j&&(_={...j.preset,iconURL:qu(j),spec:j.name}),"new"===x.conversationId&&!n){const e=Array.from(c.values()).filter((e=>null!=e.filepath&&""!==e.filepath&&e.source&&!e.embedded&&e.temp_file_id)).map((e=>({file_id:e.file_id,embedded:!!e.embedded,filepath:e.filepath,source:e.source})));d(new Map),localStorage.setItem(uc.FILES_TO_DELETE,JSON.stringify({})),!v&&e.length>0&&b({files:e})}y(x,_,n,r,o,u,s)}),[h,a,v,y,c,d,b]);return{switchToConversation:y,newConversation:_}};function qh(e=0,t){const a=_p.useClearSubmissionState(),[s,r]=T(_p.filesByIndex(e)),[o,i]=n.useState(!1),l=ar(),{isAuthenticated:c}=Wh(),{newConversation:d}=Qh(e),{useCreateConversationAtom:u}=_p,{conversation:m,setConversation:p}=u(e),{conversationId:g}=m??{},f="new"===t?t:g??t??"",{data:x}=rh(g??"",{enabled:c}),h=P(_p.latestMessageFamily(e)),[v,b]=T(_p.isSubmittingFamily(e)),[y,_]=T(_p.latestMessageFamily(e)),j=R(_p.messagesSiblingIdxFamily((null==y?void 0:y.parentMessageId)??null)),w=n.useCallback((e=>{l.setQueryData([Xc.messages,f],e),"new"===f&&l.setQueryData([Xc.messages,g],e)}),[f,l,g]),N=n.useCallback((()=>l.getQueryData([Xc.messages,f])),[f,l]),C=R(_p.submissionByIndex(e)),{ask:k,regenerate:S}=Hh({index:e,files:s,setFiles:r,getMessages:N,setMessages:w,isSubmitting:v,conversation:m,latestMessage:y,setSubmission:C,setLatestMessage:_}),I=()=>a(),[E,L]=T(_p.showPopoverFamily(e)),[M,A]=T(_p.abortScrollFamily(e)),[O,D]=T(_p.presetByIndex(e)),[F,z]=T(_p.optionSettingsFamily(e)),[U,V]=T(_p.showAgentSettingsFamily(e));return{newConversation:d,conversation:m,setConversation:p,isSubmitting:v,setIsSubmitting:b,getMessages:N,setMessages:w,setSiblingIdx:j,latestMessage:y,setLatestMessage:_,resetLatestMessage:h,ask:k,index:e,regenerate:S,stopGenerating:I,handleStopGenerating:e=>{e.preventDefault(),I()},handleRegenerate:e=>{e.preventDefault();const t=(null==y?void 0:y.parentMessageId)??"";t?S({parentMessageId:t}):console.error("Failed to regenerate the message: parentMessageId not found.")},handleContinue:e=>{e.preventDefault(),(()=>{if(!y)return void console.error("Failed to regenerate the message: latestMessage not found.");const e=N(),t=null==e?void 0:e.find((e=>e.messageId==y.parentMessageId));t&&t.isCreatedByUser?k({...t},{isContinued:!0,isRegenerate:!0,isEdited:!0}):console.error("Failed to regenerate the message: parentMessage not found, or not created by user.")})(),j(0)},showPopover:E,setShowPopover:L,abortScroll:M,setAbortScroll:A,preset:O,setPreset:D,optionSettings:F,setOptionSettings:z,showAgentSettings:U,setShowAgentSettings:V,files:s,setFiles:r,filesLoading:o,setFilesLoading:i}}function Zh({rootIndex:e=0,currentIndex:t,paramId:a}){const s=ar(),r=_p.useClearSubmissionState(),[o,i]=T(_p.filesByIndex(e)),l=I(_p.latestMessageFamily(e)),c=R(_p.latestMessageFamily(t)),{useCreateConversationAtom:d}=_p,{conversation:u,setConversation:m}=d(t),[p,g]=T(_p.isSubmittingFamily(t)),f=R(_p.messagesSiblingIdxFamily((null==l?void 0:l.parentMessageId)??null)),x="new"===a?a:(null==u?void 0:u.conversationId)??a??"",h=n.useCallback((e=>{s.setQueryData([Xc.messages,x,t],e);const n=e[e.length-1];n&&c({...n,depth:-1})}),[x,s,t,c]),v=n.useCallback((()=>s.getQueryData([Xc.messages,x,t])),[x,s,t]),b=R(_p.submissionByIndex(t)),{ask:y,regenerate:_}=Hh({index:t,files:o,setFiles:i,getMessages:v,setMessages:h,isSubmitting:p,conversation:u,setSubmission:b,latestMessage:l}),j=()=>r();return{ask:y,regenerate:_,getMessages:v,setMessages:h,conversation:u,isSubmitting:p,setSiblingIdx:f,latestMessage:l,stopGenerating:j,handleContinue:e=>{e.preventDefault(),(()=>{if(!l)return void console.error("Failed to regenerate the message: latestMessage not found.");const e=v(),t=null==e?void 0:e.find((e=>e.messageId==l.parentMessageId));t&&t.isCreatedByUser?y({...t},{isContinued:!0,isRegenerate:!0,isEdited:!0}):console.error("Failed to regenerate the message: parentMessage not found, or not created by user.")})(),f(0)},setConversation:m,setIsSubmitting:g,handleRegenerate:e=>{e.preventDefault();const t=null==l?void 0:l.parentMessageId;t?_({parentMessageId:t}):console.error("Failed to regenerate the message: parentMessageId not found.")},handleStopGenerating:e=>{e.preventDefault(),j()}}}const Yh=({index:e=0,rootIndex:t,setConversation:a})=>{const s=mh(),r=_h(),{data:o={}}=Mp(),i=n.useRef(),l=I(_p.conversationByKeySelector(t));n.useEffect((()=>{null!=(null==l?void 0:l.conversationId)&&a&&a((e=>{if(!e)return e;return{...e,conversationId:l.conversationId}}))}),[null==l?void 0:l.conversationId,a]);return{generateConversation:n.useCallback((({template:t={},preset:n,modelsData:c}={})=>{var d,u;let m={conversationId:"new",title:"New Chat",endpoint:null,...t,createdAt:"",updatedAt:""};(null==l?void 0:l.conversationId)&&(m.conversationId=l.conversationId);const p=c??s.data,g=um({convoSetup:n??m,endpointsConfig:o}),f=Hu(o,g,"type");!m.endpointType&&f?m.endpointType=f:m.endpointType&&!f&&(m.endpointType=void 0);const x=Oo(g),h=r[g??""]??[];if(m.assistant_id&&!(null==(d=r[g??""])?void 0:d[m.assistant_id])&&(m.assistant_id=void 0),!m.assistant_id&&x&&(m.assistant_id=localStorage.getItem(`${uc.ASST_ID_PREFIX}${e}${g}`)??(null==(u=h[0])?void 0:u.id)),null!=m.assistant_id&&x&&"new"===m.conversationId){const e=h.find((e=>e.id===m.assistant_id));m.model=null==e?void 0:e.model}null==m.assistant_id||x||(m.assistant_id=void 0);const v=(null==p?void 0:p[g??""])??[];return m=dm({conversation:m,lastConversationSetup:n,endpoint:g??"",models:v}),null!=(null==n?void 0:n.title)&&""!==n.title&&(m.title=n.title),a&&a(m),clearTimeout(i.current),i.current=setTimeout((()=>{const e=document.getElementById(Vr);e&&e.focus()}),150),m}),[r,o,e,s.data,l,a])}};const Jh={name:"Plugin store",pluginKey:"pluginStore",isButton:!0,description:"",icon:"",authConfig:[],authenticated:!1};n.createContext({}),n.createContext({});const Xh=n.createContext({}),ev=n.createContext({}),tv=()=>n.useContext(ev),nv=n.createContext({}),av=()=>n.useContext(nv),sv=n.createContext({}),rv=()=>n.useContext(sv),ov=n.createContext(void 0);function iv({children:e}){const[t,a]=n.useState(!1),[s,r]=n.useState();return c.jsx(ov.Provider,{value:{isMutating:t,setIsMutating:a,currentCode:s,setCurrentCode:r},children:e})}function lv(){const e=n.useContext(ov);if(void 0===e)throw new Error("useEditorContext must be used within an EditorProvider");return e}const{CustomFormProvider:cv,useCustomFormContext:dv}=function(){const e=n.createContext(void 0);return{CustomFormProvider:({register:t,control:a,setValue:s,getValues:r,handleSubmit:o,reset:i,children:l})=>{const d=n.useMemo((()=>({register:t,control:a,getValues:r,setValue:s,handleSubmit:o,reset:i})),[t,a,s,r,o,i]);return c.jsx(e.Provider,{value:d,children:l})},useCustomFormContext:()=>{const t=n.useContext(e);if(!t)throw new Error("useCustomFormContext must be used within a CustomFormProvider");return t}}}(),uv=n.createContext({bookmarks:[]}),mv=()=>n.useContext(uv),pv=n.createContext({}),gv=()=>n.useContext(pv),fv=n.createContext({}),xv=()=>n.useContext(fv),hv=n.createContext({}),vv=()=>n.useContext(hv),bv={announceAssertive:()=>console.warn("Announcement failed, LiveAnnouncer context is missing"),announcePolite:()=>console.warn("Announcement failed, LiveAnnouncer context is missing")},yv=_.createContext(bv),_v=()=>_.useContext(yv),jv=n.createContext({});function wv({children:e}){const t=n.useRef(0),a=n.useCallback((e=>{if(e)return t.current;const n=t.current;return t.current+=1,n}),[]),s=n.useCallback((()=>{t.current=0}),[]);return c.jsx(jv.Provider,{value:{getNextIndex:a,resetCounter:s},children:e})}const Nv=n.createContext({});function Cv({children:e}){const t=n.useRef(0),a=n.useCallback((e=>{if(e)return t.current;const n=t.current;return t.current+=1,n}),[]),s=n.useCallback((()=>{t.current=0}),[]);return c.jsx(Nv.Provider,{value:{getNextIndex:a,resetCounter:s},children:e})}const kv=n.createContext({});function Sv({children:e,conversationId:t}){const a=function({conversationId:e}){const{data:t=null}=Bp({conversationId:e},{select:e=>function(e=[]){return e.reduce(((e,t)=>{const n=`${t.messageId}_${t.partIndex??0}_${t.blockIndex??0}_${t.toolId}`,a=e[n]??[];return a.push(t),e[n]=a,e}),{})}(e)}),a=n.useMemo((()=>null!==t?t:void 0),[t]);return om.log("tools","tool calls map:",a),a}({conversationId:t});return c.jsx(kv.Provider,{value:a,children:e})}function Tv(){const e=kg(),t=n.useRef(!1),a=ar(),{showToast:s}=Ng(),{user:r,isAuthenticated:o}=Wh(),i=I(_p.modularChat),l=I(_p.availableTools),c=R(_p.presetModalVisible),[d,u]=T(_p.defaultPreset),m=$p({enabled:!!r&&o}),{preset:p,conversation:g,index:f,setPreset:x}=bh(),{data:h}=mh(),{newConversation:v}=Qh(f);n.useEffect((()=>{if(null==h?void 0:h.initial)return;const{data:e}=m;if(d||!e||t.current)return;if(e&&e.length>0&&r&&e[0].user!==r.id)return void m.refetch();const n=e.find((e=>e.defaultPreset));n?(u(n),(null==g?void 0:g.conversationId)&&"new"!==g.conversationId||v({preset:n,modelsData:h}),t.current=!0):t.current=!0}),[m.data,r,h]);const b=n.useCallback((e=>{a.setQueryData([Xc.presets],e)}),[a]),y=(_={onMutate:e=>{if(!e)return void b([]);const t=m.data??[];t&&b(t.filter((t=>t.presetId!==e.presetId)))},onSuccess:()=>{a.invalidateQueries([Xc.presets])},onError:t=>{a.invalidateQueries([Xc.presets]),console.error("Error deleting the preset:",t),s({message:e("com_endpoint_preset_delete_error"),severity:Wr.ERROR})}},sr([ed.deletePreset],{mutationFn:e=>zd.deletePreset(e),..._||{}}));var _;const j=ph(),w=(e=>sr([ed.updatePreset],{mutationFn:e=>zd.updatePreset(e),...e||{}}))({onSuccess:(t,n)=>{const r=t.title?`"${t.title}"`:e("com_endpoint_preset_title");let o=`${r} ${e("com_ui_saved")}`;t.defaultPreset&&t.presetId!==(null==d?void 0:d.presetId)?(o=`${r} ${e("com_endpoint_preset_default")}`,u(t),v({preset:t})):!1===n.defaultPreset&&(u(null),o=`${r} ${e("com_endpoint_preset_default_removed")}`),s({message:o}),a.invalidateQueries([Xc.presets])},onError:t=>{console.error("Error updating the preset:",t),s({message:e("com_endpoint_preset_save_error"),severity:Wr.ERROR})}}),N=hh();return{presetsQuery:m,onSetDefaultPreset:(e,t=!1)=>{w.mutate({...e,defaultPreset:!t})},onFileSelected:t=>{(t=>{j.mutate({...t},{onSuccess:()=>{s({message:e("com_endpoint_preset_import")}),a.invalidateQueries([Xc.presets])},onError:t=>{console.error("Error uploading the preset:",t),s({message:e("com_endpoint_preset_import_error"),severity:Wr.ERROR})}})})({...cm({preset:t}),presetId:null})},onSelectPreset:t=>{if(!t)return;const n=Tu(t,l),r=n.title?`"${n.title}"`:e("com_endpoint_preset_title");s({message:`${r} ${e("com_endpoint_preset_selected_title")}`,showIcon:!1,duration:750});const o=a.getQueryData([Xc.endpoints]),{shouldSwitch:c,isNewModular:d,newEndpointType:u,isCurrentModular:m,isExistingConversation:p}=Wu({newEndpoint:n.endpoint??"",modularChat:i,conversation:g,endpointsConfig:o}),f=m&&d&&c;if(p&&f){const e=N({conversation:{...g??{},endpointType:u},preset:{...n,endpointType:u}});v({template:e,preset:e,keepLatestMessage:!0,keepAddedConvos:!0})}else v({preset:n,keepAddedConvos:f})},onChangePreset:e=>{x(e),c(!0)},clearAllPresets:()=>y.mutate(void 0),onDeletePreset:t=>{confirm(e("com_endpoint_preset_delete_confirm"))&&y.mutate(t)},submitPreset:()=>{p&&w.mutate(cm({preset:p}))},exportPreset:()=>{if(!p)return;const e=U(p.title||"preset");V({data:cm({preset:p}),fileName:e,exportType:V.types.json})}}}function Rv({setOption:e,setter:t,optionKey:a,initialValue:s,delay:r=Gr}){const[o,i]=n.useState(s),l=n.useCallback($(e&&a?e(a):t,r),[]),c=n.useCallback(((e,t)=>{let n="object"!=typeof e?e:e.target.value;!0===t&&(n=Number(n)),i(n),l(n)}),[l]);return[c,o,i]}const Iv=(e=0)=>{const t=D(),n=ar(),a=_p.useClearConvoState(),s=_p.useClearLatestMessages(`useNavigateToConvo ${e}`),r=R(_p.submissionByIndex(e)),{hasSetConversation:o,setConversation:i}=_p.useCreateConversationAtom(e),l=(e,l=!0,c=!1)=>{if(!e)return void om.warn("conversation","Conversation not provided to `navigateToConvo`");o.current=!0,r(null),l&&s(),c&&null!=e.conversationId&&e.conversationId&&(n.setQueryData([Xc.messages,dc.NEW_CONVO],[]),n.invalidateQueries([Xc.messages,e.conversationId]));let d={...e};const u=n.getQueryData([Xc.endpoints]);if(!d.endpoint||!(null==u?void 0:u[d.endpoint])){const t=n.getQueryData([Xc.models]),a=um({convoSetup:e,endpointsConfig:u}),s=Hu(u,a,"type");!e.endpointType&&s&&(e.endpointType=s);const r=(null==t?void 0:t[a??""])??[];d=dm({models:r,conversation:e,endpoint:a,lastConversationSetup:e})}a(!0),i(d),t(`/c/${d.conversationId??dc.NEW_CONVO}`)};return{navigateToConvo:l,navigateWithLastTools:(e,t,n)=>{var a;if(e)if(e.endpoint===Ro.gptPlugins){let s=[];try{s=JSON.parse(localStorage.getItem(uc.LAST_TOOLS)??"")??[]}catch(Bg){om.error("conversation","Error parsing last selected tools",Bg)}const r=((null==(a=e.tools)?void 0:a.length)??0)>0;l({...e,tools:r?e.tools:s},t,n)}else l(e,t,n);else om.warn("conversation","Conversation not provided to `navigateToConvo`")}}},Ev=(e=!1)=>{const t=R(_p.showPluginStoreDialog),n=I(_p.availableTools),{conversation:a,setConversation:s}=bh(),r=(e=>{const t=R(_p.showPluginStoreDialog),n=I(_p.availableTools),{preset:a,setPreset:s}=bh();if(!e)return!1;function r(e){return!!(null==a?void 0:a.tools)&&!!a.tools.find((t=>"string"==typeof t?t===e:t.pluginKey===e))}return{setOption:e=>t=>{const n={};n[e]=t,s((e=>cm({preset:{...e,...n}})))},setExample:(e,t,n=null)=>{var r;const o={},i=(null==(r=null==a?void 0:a.examples)?void 0:r.slice())||[],l={...i[e]};l[t]={content:n},i[e]=l,o.examples=i,s((e=>cm({preset:{...e,...o}})))},addExample:()=>{var e;const t={},n=(null==(e=null==a?void 0:a.examples)?void 0:e.slice())||[];n.push({input:{content:""},output:{content:""}}),t.examples=n,s((e=>cm({preset:{...e,...t}})))},setOptions:e=>{const t={...e};s((e=>cm({preset:{...e,...t}})))},removeExample:()=>{var e;const t={},n=(null==(e=null==a?void 0:a.examples)?void 0:e.slice())||[];if(n.length<=1)return t.examples=[{input:{content:""},output:{content:""}}],void s((e=>cm({preset:{...e,...t}})));n.pop(),t.examples=n,s((e=>cm({preset:{...e,...t}})))},getConversation:()=>a,checkPluginSelection:r,setAgentOption:t=>n=>{const a=JSON.parse(JSON.stringify(e)),{agentOptions:r}=a;r[t]=n,s((e=>cm({preset:{...e,agentOptions:r}})))},setTools:(e,o)=>{var i;if("pluginStore"===e)return void t(!0);const l={},c=(null==(i=null==a?void 0:a.tools)?void 0:i.map((e=>"string"==typeof e?n[e]:e)).filter((e=>!!e)))||[],d=r(e),u=n[e];l.tools=d||o?c.filter((t=>t.pluginKey!==e)):[...c,u],s((e=>cm({preset:{...e,...l}})))}}})(e);if(r&&"boolean"!=typeof r)return r;function o(e){return!!(null==a?void 0:a.tools)&&!!a.tools.find((t=>"string"==typeof t?t===e:t.pluginKey===e))}return{setTools:(e,r)=>{var i;if("pluginStore"===e)return void t(!0);const l={},c=(null==(i=null==a?void 0:a.tools)?void 0:i.map((e=>"string"==typeof e?n[e]:e)).filter((e=>!!e)))||[],d=o(e),u=n[e];l.tools=d||r?c.filter((t=>t.pluginKey!==e)):[...c,u],s((e=>gi.parse({...e,...l})))},setOption:e=>t=>{const n={};if(n[e]=t,"presetOverride"===e){const e=(null==a?void 0:a.presetOverride)||{};n.presetOverride={...e,...t}}s((e=>gi.parse({...e,...n})))},setExample:(e,t,n=null)=>{var r;const o={},i=(null==(r=null==a?void 0:a.examples)?void 0:r.slice())||[],l={...i[e]};l[t]={content:n},i[e]=l,o.examples=i,s((e=>gi.parse({...e,...o})))},addExample:()=>{var e;const t={},n=(null==(e=null==a?void 0:a.examples)?void 0:e.slice())||[];n.push({input:{content:""},output:{content:""}}),t.examples=n,s((e=>gi.parse({...e,...t})))},removeExample:()=>{var e;const t={},n=(null==(e=null==a?void 0:a.examples)?void 0:e.slice())||[];if(n.length<=1)return t.examples=[{input:{content:""},output:{content:""}}],void s((e=>gi.parse({...e,...t})));n.pop(),t.examples=n,s((e=>gi.parse({...e,...t})))},setAgentOption:e=>t=>{const n=JSON.stringify(a),r=JSON.parse(n),{agentOptions:o}=r;o[e]=t,s((e=>gi.parse({...e,agentOptions:o})))},checkPluginSelection:o}};function Pv({preset:e,settingKey:t,defaultValue:a,conversation:s,inputValue:r,setInputValue:o,preventDelayedUpdate:i=!1}){const l=n.useRef(null),c=n.useRef(null);n.useEffect((()=>{if(i)return;const e=setTimeout((()=>{(null==s?void 0:s[t])!==r&&o(null==s?void 0:s[t])}),1.25*Gr);return()=>clearTimeout(e)}),[o,i,s,r,t]),n.useEffect((()=>{const e=(null==s?void 0:s.conversationId)??"";e&&l.current!==e&&(l.current=e,o(a))}),[o,null==s?void 0:s.conversationId,a]),n.useEffect((()=>{const t=(null==e?void 0:e.presetId)??"";t&&c.current!==t&&(c.current=t,o(a))}),[o,null==e?void 0:e.presetId,a])}const Lv={theme:iu(),setTheme:()=>{}},Mv=n.createContext(Lv),Av=({initialTheme:e,children:t})=>{const[a,s]=n.useState(iu),r=R(_p.fontSize),o=e=>{const t=window.document.documentElement,n=(e=>"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"===e)(e);t.classList.remove(n?"light":"dark"),t.classList.add(n?"dark":"light"),localStorage.setItem("color-theme",e)};return n.useEffect((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{o(e.matches?"dark":"light")};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}),[]),n.useEffect((()=>{const e=localStorage.getItem("fontSize");if(null==e)return r("text-base"),ou("text-base"),void localStorage.setItem("fontSize","text-base");ou(JSON.parse(e))}),[]),e&&o(e),n.useEffect((()=>{o(a)}),[a]),c.jsx(Mv.Provider,{value:{theme:a,setTheme:s},children:t})},Ov=n.createContext({}),Dv=()=>{const{ref:e}=n.useContext(Ov),{theme:t}=n.useContext(Mv);return{screenshotTargetRef:e,captureScreenshot:async()=>{if(e instanceof Function)throw new Error("Ref callback is not supported.");if(null==e?void 0:e.current)return(async e=>{if(!e)throw new Error("You should provide correct html node.");let n="dark"===t;"system"===t&&(n=window.matchMedia("(prefers-color-scheme: dark)").matches);const a=n?"#171717":"white",s=await H(e,{backgroundColor:a,imagePlaceholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="}),r=document.createElement("canvas"),o=r.getContext("2d"),i=s.width,l=s.height;return r.width=i,r.height=l,o.fillStyle=a,o.fillRect(0,0,i,l),o.drawImage(s,0,0),r.toDataURL("image/png",1)})(e.current);throw new Error("Ref is not attached to any element.")}}},Fv=({children:e})=>{const t=n.useRef(null);return c.jsx(Ov.Provider,{value:{ref:t},children:e})};function zv({conversation:e,filename:t,type:a,includeOptions:s,exportBranches:r,recursive:o}){const i=ar(),{captureScreenshot:l}=Dv(),c=function(){const e=S((({snapshot:e})=>async t=>await e.getPromise(_p.messagesSiblingIdxFamily(t))),[]),t=async({messageId:n,message:a,messages:s,branches:r=!1,recursive:o=!1})=>{let i=[];if(null!=(null==s?void 0:s.length)&&s.length>0)if(r)for(const e of s)i.push(await t({messageId:null==e?void 0:e.messageId,message:e,messages:(null==e?void 0:e.children)||[],branches:r,recursive:o}));else{let a=s[0];if(s.length>1){const t=await e(n);a=s[s.length-t-1]}i=[await t({messageId:null==a?void 0:a.messageId,message:a,messages:(null==a?void 0:a.children)||[],branches:r,recursive:o})]}if(o&&a)return{...a,children:i};{let e=[];if(a){const t={...a};delete t.children,e=[t]}for(const t of i)e=e.concat(t);return e}};return t}(),{conversationId:d}=B(),u=n.useCallback((()=>{const t="new"===d?d:(null==e?void 0:e.conversationId)??d??"",n=im({messages:i.getQueryData([Xc.messages,t])??[]});return 0===(null==n?void 0:n.length)?null:n??null}),[d,null==e?void 0:e.conversationId,i]),m=(e,t="text")=>{if(!e)return"";const n=(e,n)=>"text"===t?`>> ${e}:\n${n}`:`**${e}**\n${n}`;return e.content?e.content.map((t=>p(e.sender||"",t))).map((e=>n(e[0],e[1]))).join("\n\n\n"):n(e.sender||"",e.text)},p=(e,t)=>{if(!t)return[];if(t.type===to.ERROR)return[e,t[to.TEXT].value];if(t.type===to.TEXT){const n=t[to.TEXT];return[e,"string"==typeof n?n:n.value]}if(t.type===to.TOOL_CALL){const e=t[to.TOOL_CALL].type;if(e===ao.CODE_INTERPRETER){const e=t[to.TOOL_CALL][ao.CODE_INTERPRETER];return["Code Interpreter",JSON.stringify(e)]}if(e===ao.RETRIEVAL){const e=t[to.TOOL_CALL];return["Retrieval",JSON.stringify(e)]}if(e===ao.FUNCTION&&hc.has(t[to.TOOL_CALL].function.name)){const e=t[to.TOOL_CALL];return["Tool",JSON.stringify(e)]}if(e===ao.FUNCTION){const e=t[to.TOOL_CALL];return Wo(e),["Tool",JSON.stringify(e)]}}if(t.type===to.IMAGE_FILE){const e=t[to.IMAGE_FILE];return["Image",JSON.stringify(e)]}return[e,JSON.stringify(t)]};return{exportConversation:()=>{"json"===a?(async()=>{const n={conversationId:null==e?void 0:e.conversationId,endpoint:null==e?void 0:e.endpoint,title:null==e?void 0:e.title,exportAt:(new Date).toTimeString(),branches:r,recursive:o};!0===s&&(n.options=cm({preset:e}));const a=await c({messageId:null==e?void 0:e.conversationId,message:null,messages:u(),branches:Boolean(r),recursive:Boolean(o)});!0!==o||Array.isArray(a)?n.messages=a:n.messagesTree=a.children,V({data:n,fileName:t,extension:"json",exportType:V.types.json})})():"text"==a?(async()=>{let n=`Conversation\n########################\nconversationId: ${null==e?void 0:e.conversationId}\nendpoint: ${null==e?void 0:e.endpoint}\ntitle: ${null==e?void 0:e.title}\nexportAt: ${(new Date).toTimeString()}\n`;if(!0===s){n+="\nOptions\n########################\n";const t=cm({preset:e});for(const e of Object.keys(t))n+=`${e}: ${t[e]}\n`}const a=await c({messageId:null==e?void 0:e.conversationId,message:null,messages:u(),branches:!1,recursive:!1});if(n+="\nHistory\n########################\n",Array.isArray(a))for(const e of a)n+=`${m(e)}\n`,e.error&&(n+="(This is an error message)\n"),!0===e.unfinished&&(n+="(This is an unfinished message)\n"),n+="\n\n";else n+=`${m(a)}\n`,a.error&&(n+="(This is an error message)\n"),!0===a.unfinished&&(n+="(This is an unfinished message)\n");V({data:n,fileName:t,extension:"txt",exportType:V.types.txt})})():"markdown"==a?(async()=>{let n=`# Conversation\n- conversationId: ${null==e?void 0:e.conversationId}\n- endpoint: ${null==e?void 0:e.endpoint}\n- title: ${null==e?void 0:e.title}\n- exportAt: ${(new Date).toTimeString()}\n`;if(!0===s){n+="\n## Options\n";const t=cm({preset:e});for(const e of Object.keys(t))n+=`- ${e}: ${t[e]}\n`}const a=await c({messageId:null==e?void 0:e.conversationId,message:null,messages:u(),branches:!1,recursive:!1});if(n+="\n## History\n",Array.isArray(a))for(const e of a)n+=`${m(e,"md")}\n`,e.error&&(n+="*(This is an error message)*\n"),!0===e.unfinished&&(n+="*(This is an unfinished message)*\n"),n+="\n\n";else n+=`${m(a,"md")}\n`,a.error&&(n+="*(This is an error message)*\n"),!0===a.unfinished&&(n+="*(This is an unfinished message)*\n");V({data:n,fileName:t,extension:"md",exportType:V.types.txt})})():"csv"==a?(async()=>{const n=[],a=await c({messageId:null==e?void 0:e.conversationId,message:null,messages:u(),branches:Boolean(r),recursive:!1});if(Array.isArray(a))for(const e of a)n.push(e);else n.push(a);V({data:n,fileName:t,extension:"csv",exportType:V.types.csv,beforeTableEncode:e=>{var t,n,a,s,r,o,i,l;return[{fieldName:"sender",fieldValues:(null==(t=null==e?void 0:e.find((e=>"sender"==e.fieldName)))?void 0:t.fieldValues)??[]},{fieldName:"text",fieldValues:(null==(n=null==e?void 0:e.find((e=>"text"==e.fieldName)))?void 0:n.fieldValues)??[]},{fieldName:"isCreatedByUser",fieldValues:(null==(a=null==e?void 0:e.find((e=>"isCreatedByUser"==e.fieldName)))?void 0:a.fieldValues)??[]},{fieldName:"error",fieldValues:(null==(s=null==e?void 0:e.find((e=>"error"==e.fieldName)))?void 0:s.fieldValues)??[]},{fieldName:"unfinished",fieldValues:(null==(r=null==e?void 0:e.find((e=>"unfinished"==e.fieldName)))?void 0:r.fieldValues)??[]},{fieldName:"messageId",fieldValues:(null==(o=null==e?void 0:e.find((e=>"messageId"==e.fieldName)))?void 0:o.fieldValues)??[]},{fieldName:"parentMessageId",fieldValues:(null==(i=null==e?void 0:e.find((e=>"parentMessageId"==e.fieldName)))?void 0:i.fieldValues)??[]},{fieldName:"createdAt",fieldValues:(null==(l=null==e?void 0:e.find((e=>"createdAt"==e.fieldName)))?void 0:l.fieldValues)??[]}]}})})():"screenshot"==a&&(async()=>{let e;try{e=await l()}catch(n){return console.error("Failed to capture screenshot"),console.error(n)}G(e,`${t}.png`,"image/png")})()}}}function Uv({hasNextPage:e,isFetchingNextPage:t,setShowLoading:a,fetchNextPage:s}){const r=n.useRef(null),o=n.useRef(null),i=n.useCallback(K((()=>null!=s?s():()=>({})),750,{leading:!0}),[s]),l=n.useCallback((()=>{if(o.current){const{scrollTop:n,clientHeight:s,scrollHeight:r}=o.current;n+s>=.97*r&&!0===e&&!t?(a(!0),i()):a(!1)}}),[e,t,i,a]);n.useEffect((()=>{const e=o.current;return e&&e.addEventListener("scroll",l),()=>{null==e||e.removeEventListener("scroll",l)}}),[l,i]);const c=n.useCallback((()=>{const e=o.current;e&&(r.current=e.scrollTop)}),[o,r]);return{containerRef:o,moveToTop:c}}function Vv(e,t){const a=D(),s=z();return n.useCallback((n=>{t&&t(n),0!==n.button||n.ctrlKey||n.metaKey||(n.preventDefault(),a(e,{state:{prevLocation:s}}))}),[a,e,t,s])}const Bv=({mutateAsync:e,agent_id:t,assistant_id:a,tool_resource:s})=>{const[r,o]=n.useState([]),i=kh(),l=n.useCallback((({filesToDelete:t,agent_id:n,assistant_id:a,tool_resource:s})=>{const r=bi({agent_id:n,assistant_id:a,tool_resource:s});console.log("Deleting files:",t,r),e({files:t,...r}),o([])}),[e]),c=n.useCallback($(l,1e3),[]);n.useEffect((()=>()=>c.cancel()),[c]);return{deleteFile:n.useCallback((({file:e,setFiles:n})=>{const{file_id:r,temp_file_id:l="",filepath:d="",source:u=ji.local,embedded:m,attached:p=!1}=e;if((e.progress??1)<1)return;const g={file_id:r,embedded:m,filepath:d,source:u};n&&n((e=>{const t=new Map(e);t.delete(r),t.delete(l);const n=Object.fromEntries(t);return i(n),t})),p||o((e=>{const n=[...e,g];return c({filesToDelete:n,agent_id:t,assistant_id:a,tool_resource:s}),n}))}),[c,i,t,a,s]),deleteFiles:n.useCallback((({files:e,setFiles:n})=>{const s=e.map((e=>{const{file_id:t,embedded:n,filepath:a="",source:s=ji.local}=e;return{source:s,file_id:t,filepath:a,embedded:n}}));n&&n((e=>{const t=new Map(e);s.forEach((e=>{t.delete(e.file_id)}));const n=Object.fromEntries(t);return i(n),t})),o((e=>{const n=[...e,...s];return c({filesToDelete:n,agent_id:t,assistant_id:a}),n}))}),[c,i,t,a])}};const $v=()=>{const e=kg(),{showToast:t}=Ng(),[a,s]=n.useState({});return{startUploadTimer:(n,r,o)=>{const i=(e=>5e3+2e3*Math.floor(e/1e6))(o);a[n]&&clearTimeout(a[n]);const l=setTimeout((()=>{const n=e("com_ui_upload_delay",{0:r});t({message:n,status:"warning",duration:1e4})}),i);s((e=>({...e,[n]:l})))},clearUploadTimer:e=>{a[e]&&(clearTimeout(a[e]),s((t=>{const{[e]:n,...a}=t;return a})))}}};function Hv(e){const t=kh();return{addFile:t=>{e((e=>{const n=new Map(e);return n.set(t.file_id,t),n}))},replaceFile:t=>{e((e=>{const n=new Map(e);return n.set(t.file_id,t),n}))},updateFileById:(n,a,s=!1)=>{e((e=>{if(!e.has(n))return console.warn(`File with id ${n} not found.`),e;const r=new Map(e),o=r.get(n);if(!o)return console.warn(`File with id ${n} not found.`),e;r.set(n,{...o,...a});if((a.filepath??"")&&1!==a.progress&&!s){const e=Object.fromEntries(r);t(e)}return r}))},deleteFileById:n=>{e((e=>{const a=new Map(e);a.has(n)?a.delete(n):console.warn(`File with id ${n} not found.`);const s=Object.fromEntries(a);return t(s),a}))}}}const Gv=e=>{var t,a,s;const r=kg(),o=ar(),{showToast:i}=Ng(),[l,c]=n.useState([]),d=n.useRef(null),{startUploadTimer:u,clearUploadTimer:m}=$v(),{files:p,setFiles:g,setFilesLoading:f,conversation:x}=bh(),h=e=>c((t=>[...t,e])),{addFile:v,replaceFile:b,updateFileById:y,deleteFileById:_}=Hv((null==e?void 0:e.fileSetter)??g),j=(null==(t=null==e?void 0:e.additionalMetadata)?void 0:t.agent_id)??"",w=(null==(a=null==e?void 0:e.additionalMetadata)?void 0:a.assistant_id)??"",{data:N=null}=Dp({select:e=>Zi(e)}),C=n.useMemo((()=>(null==e?void 0:e.overrideEndpoint)??(null==x?void 0:x.endpointType)??(null==x?void 0:x.endpoint)??"default"),[null==e?void 0:e.overrideEndpoint,null==x?void 0:x.endpointType,null==x?void 0:x.endpoint]),k=n.useCallback((()=>{if(l.length>1){const e=Array.from(new Set(l)).map(((e,t)=>`${t>0?"• ":""}${r(e)||e}\n`)).join("");i({message:e,status:"error",duration:5e3})}else if(1===l.length){const e=r(l[0])||l[0];i({message:e,status:"error",duration:5e3})}c([])}),[l,i,r]),S=$(k,250);n.useEffect((()=>(l.length>0&&S(),()=>S.cancel())),[l,S]);const T=((e,t)=>{const n=ar(),{onSuccess:a,...s}=e||{};return sr([ed.fileUpload],{mutationFn:e=>{const n=e.get("width")??"",a=e.get("height")??"",s=e.get("version")??"",r=e.get("endpoint")??"";return Oo(r)&&"2"===s?zd.uploadFile(e,t):""!==n&&""!==a?zd.uploadImage(e,t):zd.uploadFile(e,t)},...s,onSuccess:(e,t,s)=>{n.setQueryData([Xc.files],(t=>[e,...t??[]]));const r=t.get("endpoint"),o=t.get("message_file"),i=t.get("agent_id")??"",l=t.get("assistant_id")??"",c=t.get("tool_resource")??"";"true"!==o?(i&&c&&n.setQueryData([Xc.agent,i],(t=>{var n;if(!t)return t;const a={},s=t.tool_resources??{},r=(null==(n=t.tool_resources)?void 0:n[c])??{file_ids:[]};return r.file_ids||(r.file_ids=[]),r.file_ids.push(e.file_id),a.tool_resources={...s,[c]:r},{...t,...a}})),l?(n.setQueryData([Xc.assistants,r,To],(t=>t?{...t,data:t.data.map((t=>{var n;if(t.id!==l)return t;const a={};if(c||(a.file_ids=[...t.file_ids??[],e.file_id]),c===ro.code_interpreter){const s=t.tool_resources??{},r=(null==(n=t.tool_resources)?void 0:n[c])??{file_ids:[]};r.file_ids||(r.file_ids=[]),r.file_ids.push(e.file_id),a.tool_resources={...s,[c]:r}}return{...t,...a}}))}:t)),null==a||a(e,t,s)):null==a||a(e,t,s)):null==a||a(e,t,s)}})})({onSuccess:e=>{m(e.temp_file_id),console.log("upload success",e),j?o.refetchQueries([Xc.agent,j]):(y(e.temp_file_id,{progress:.9,filepath:e.filepath},!!w),setTimeout((()=>{y(e.temp_file_id,{progress:1,file_id:e.file_id,temp_file_id:e.temp_file_id,filepath:e.filepath,type:e.type,height:e.height,width:e.width,filename:e.filename,source:e.source,embedded:e.embedded},!!w)}),300))},onError:(e,t)=>{var n,a;const s=e;console.log("upload error",s);const r=t.get("file_id");m(r),_(r);const o="ERR_CANCELED"===(null==s?void 0:s.code)?"com_error_files_upload_canceled":(null==(a=null==(n=null==s?void 0:s.response)?void 0:n.data)?void 0:a.message)??"com_error_files_upload";h(o)}},null==(s=d.current)?void 0:s.signal),R=async t=>{var n,a;const s=(null==(n=t.file)?void 0:n.name)??"File";u(t.file_id,s,t.size);const r=new FormData;r.append("endpoint",C),r.append("file",t.file,encodeURIComponent(s)),r.append("file_id",t.file_id);const i=t.width??0,l=t.height??0;i&&r.append("width",i.toString()),l&&r.append("height",l.toString());const c=(null==e?void 0:e.additionalMetadata)??{};if(null==e?void 0:e.additionalMetadata)for(const[e,o=""]of Object.entries(c))o&&r.append(e,o);if(Do(C)){j||r.append("message_file","true");const e=t.tool_resource;null!=e&&r.append("tool_resource",e),null!=(null==x?void 0:x.agent_id)&&null==r.get("agent_id")&&r.append("agent_id",x.agent_id)}if(!Oo(C))return void T.mutate(r);const d=(null==x?void 0:x.model)??"",m=(null==x?void 0:x.assistant_id)??"";w||r.append("message_file","true");const p=o.getQueryData([Xc.endpoints]),g=(null==(a=null==p?void 0:p[C])?void 0:a.version)??wl[C];!w&&m&&(r.append("version",g),r.append("model",d),r.append("assistant_id",m));(r.get("version")??"")||r.append("version",g);(r.get("model")??"")||r.append("model",d),T.mutate(r)},I=(e,t)=>{const n=new Image;n.onload=async()=>{e.width=n.width,e.height=n.height,e={...e,progress:.6},b(e),await R(e),URL.revokeObjectURL(t)},n.src=t},E=async(t,n)=>{var a;d.current=new AbortController;const s=Array.from(t);let r;try{r=(({files:e,fileList:t,setError:n,endpointFileConfig:a})=>{const{fileLimit:s,fileSizeLimit:r,totalSizeLimit:o,supportedMimeTypes:i}=a,l=Array.from(e.values()),c=t.reduce(((e,t)=>e+t.size),0);if(0===c)return n("com_error_files_empty"),!1;const d=l.reduce(((e,t)=>e+t.size),0);if(s&&t.length+e.size>s)return n(`You can only upload up to ${s} files at a time.`),!1;for(let m=0;m<t.length;m++){let e=t[m],a=e.type;const s=e.name.split(".").pop()??"",o=zi[s];if(!o||a&&a===o||(a=o),!a)return n("Unable to determine file type for: "+e.name),!1;if(e.type!==a){const n=new File([e],e.name,{type:a});e=n,t[m]=n}if(!ru(e.type,i))return console.log(e),n("Currently, unsupported file type: "+e.type),!1;if(r&&e.size>=r)return n(`File size exceeds ${r/Vi} MB.`),!1}if(o&&d+c>o)return n(`The total size of the files cannot exceed ${o/Vi} MB.`),!1;const u=[...l.map((e=>{var t,n;return`${(null==(t=e.file)?void 0:t.name)??e.filename}-${e.size}-${(null==(n=e.type)?void 0:n.split("/")[0])??"file"}`})),...t.map((e=>`${null==e?void 0:e.name}-${null==e?void 0:e.size}-${(null==e?void 0:e.type.split("/")[0])??"file"}`))];return new Set(u).size===u.length||(n("com_error_files_dupe"),!1)})({files:p,fileList:s,setError:h,endpointFileConfig:(null==N?void 0:N.endpoints[C])??(null==N?void 0:N.endpoints.default)??Gi.endpoints[C]??Gi.endpoints.default})}catch(o){return console.error("file validation error",o),void h("com_error_files_validation")}if(r)for(const i of s){const t=O();try{const s=URL.createObjectURL(i),r={file_id:t,file:i,type:i.type,preview:s,progress:.2,size:i.size};null!=n&&""!==n&&(r.tool_resource=n);const o="image"===i.type.split("/")[0],l=r.tool_resource??(null==(a=null==e?void 0:e.additionalMetadata)?void 0:a.tool_resource);if(Do(C)&&!o&&null==l){h("com_error_files_unsupported_capability");continue}if(v(r),o){I(r,s);continue}await R(r)}catch(o){_(t),console.log("file handling error",o),h("com_error_files_process")}}else f(!1)};return{handleFileChange:(e,t)=>{e.stopPropagation(),e.target.files&&(f(!0),E(e.target.files,t),e.target.value="")},handleFiles:E,abortUpload:()=>{d.current&&(om.log("files","Aborting upload"),d.current.abort("User aborted upload"),d.current=null)},setFiles:g,files:p}};function Kv(e,t=[],a=300){const s=n.useRef(),r=n.useRef();r.current=n.useCallback(e,t);const o=n.useCallback($((()=>{var e;return s.current=null==(e=r.current)?void 0:e.call(r)}),a),[]);n.useEffect(o,t),n.useEffect((()=>()=>s.current instanceof Function?s.current():void 0),[])}const Wv=({conversationId:e,textAreaRef:t,files:a,setFiles:s})=>{const{setValue:r}=dv(),o=I(_p.saveDrafts),[i,l]=n.useState(null),c=n.useMemo((()=>Array.from(a.keys())),[a]),{data:d}=Op(),u=e=>{try{const t=(new TextEncoder).encode(e);return btoa(String.fromCharCode(...t))}catch(Bg){return""}},m=n.useCallback((e=>{const t=JSON.parse((localStorage.getItem(`${uc.FILES_DRAFT}${e}`)??"")||"[]");0!==t.length?t.forEach((e=>{const t=null==d?void 0:d.find((t=>t.file_id===e)),n=null==d?void 0:d.find((t=>t.temp_file_id===e)),{fileToRecover:a,fileIdToRecover:r}=t?{fileToRecover:t,fileIdToRecover:e}:{fileToRecover:n,fileIdToRecover:((null==n?void 0:n.temp_file_id)??"")||e};a&&s((e=>{const t=new Map(e);return t.set(r,{...a,progress:1,attached:!0,size:a.bytes}),t}))})):s(new Map)}),[d,s]),p=n.useCallback((e=>{const t=(localStorage.getItem(`${uc.TEXT_DRAFT}${e}`)??"")||"";r("text",(e=>{try{const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return(new TextDecoder).decode(n)}catch(Bg){return""}})(t))}),[r]),g=n.useCallback((e=>{(null==t?void 0:t.current)&&(""===t.current.value?localStorage.removeItem(`${uc.TEXT_DRAFT}${e}`):localStorage.setItem(`${uc.TEXT_DRAFT}${e}`,u(t.current.value)))}),[t]);n.useEffect((()=>{if(!o||null==e||""===e)return;const n=$((()=>{(null==t?void 0:t.current)&&t.current.value?localStorage.setItem(`${uc.TEXT_DRAFT}${e}`,u(t.current.value)):localStorage.removeItem(`${uc.TEXT_DRAFT}${e}`)}),1e3),a=null==t?void 0:t.current;return a&&a.addEventListener("input",n),()=>{a&&a.removeEventListener("input",n),n.cancel()}}),[e,o,t]),n.useEffect((()=>{if(o&&null!=e&&""!==e&&e!==i){s(new Map);try{null!=i&&i&&g(i),p(e),m(e)}catch(Bg){console.error(Bg)}l(e)}}),[e,i,m,p,o,g,s]),n.useEffect((()=>{o&&null!=e&&""!==e&&i===e&&(0===c.length?localStorage.removeItem(`${uc.FILES_DRAFT}${e}`):localStorage.setItem(`${uc.FILES_DRAFT}${e}`,JSON.stringify(c)))}),[a,e,o,i,c]);return{clearDraft:n.useCallback((()=>{null!=e&&e&&(localStorage.removeItem(`${uc.TEXT_DRAFT}${e}`),localStorage.removeItem(`${uc.FILES_DRAFT}${e}`))}),[e])}};function Qv({textAreaRef:e,submitButtonRef:t,setIsScrollable:a,disabled:s=!1}){const r=kg(),o=Sh(),i=n.useRef(!1),l=Nh(),{handleFiles:c}=Gv(),d=vv(),u=(()=>{const e=ar(),t=n.useRef(Date.now());return n.useCallback((()=>{const n=Date.now();n-t.current>tc.FIVE_MINUTES&&(om.log("Checking health on interaction. Time elapsed:",n-t.current),e.invalidateQueries([Xc.health]),t.current=n)}),[e])})(),m=I(_p.enterToSend),{index:p,conversation:g,isSubmitting:f,filesLoading:x,latestMessage:h,setFilesLoading:v}=bh(),[b,y]=T(_p.activePromptByIndex(p)),{endpoint:_=""}=g||{},{entity:j,isAgent:w,isAssistant:N}=Ju({endpoint:_,agentsMap:l,assistantMap:d,agent_id:null==g?void 0:g.agent_id,assistant_id:null==g?void 0:g.assistant_id}),C=(null==j?void 0:j.name)??"",k=(((null==h?void 0:h.unfinished)??!1)&&!f||((null==h?void 0:h.error)??!1))&&!N;n.useEffect((()=>{const t=b??"";t&&e.current&&(Pu(e.current,t),Lu(e.current),y(void 0))}),[b,y,e]),n.useEffect((()=>{var t,n;if((null==(t=e.current)?void 0:t.value)??"")return;const a=()=>{var e;if(s)return r("com_endpoint_config_placeholder");const t=(null==g?void 0:g.endpoint)??"",n=(null==g?void 0:g.agent_id)??"",a=(null==g?void 0:g.assistant_id)??"";if(!(!w||n&&(null==l?void 0:l[n])))return r("com_endpoint_agent_placeholder");if(N&&(!a||!(null==(e=null==d?void 0:d[t])?void 0:e[a])))return r("com_endpoint_assistant_placeholder");if(k)return r("com_endpoint_message_not_appendable");const i=N||w?(({name:e="",localize:t,isAgent:n})=>e&&e.length>0?e:t(!0===n?"com_ui_agent":"com_ui_assistant"))({name:C,isAgent:w,localize:r}):o(g);return`${r("com_endpoint_message_new",{0:i||r("com_endpoint_ai")})}`},i=a();if((null==(n=e.current)?void 0:n.getAttribute("placeholder"))===i)return;const c=$((()=>{var t,n;const s=a();(null==(t=e.current)?void 0:t.getAttribute("placeholder"))!==s&&(null==(n=e.current)||n.setAttribute("placeholder",s),Lu(e.current))}),80);return c(),()=>c.cancel()}),[w,r,s,o,l,C,e,N,d,g,h,k]);const S=n.useCallback((n=>{var s;if(e.current&&Au(e.current)){const t=Au(e.current);t&&a(t)}if("Enter"===n.key&&f)return;u();const r="Enter"===n.key&&!n.shiftKey,o="Enter"===n.key&&(n.ctrlKey||n.metaKey),l=i.current||"Process"===n.key||229===n.keyCode;if(r&&x&&n.preventDefault(),r&&n.preventDefault(),"Enter"===n.key&&!m&&!o&&e.current&&!l)return n.preventDefault(),Pu(e.current,"\n"),void Lu(e.current);if((r||o)&&!l){const e=document.getElementById(Br);e&&(console.log("Unmuting global audio"),e.muted=!1),null==(s=t.current)||s.click()}}),[f,u,x,m,a,e,t]),R=n.useCallback((t=>{if(!e.current)return;const n=t.clipboardData;if(n&&n.files.length>0){v(!0);const e=[];for(const t of n.files){const n=new File([t],`clipboard_${+new Date}_${t.name}`,{type:t.type});e.push(n)}c(e)}}),[c,v,e]);return{textAreaRef:e,handlePaste:R,handleKeyDown:S,handleCompositionStart:()=>{i.current=!0},handleCompositionEnd:()=>{i.current=!1}}}function qv({value:e,options:t}){const[a,s]=n.useState(!1),[r,o]=n.useState(""),i=n.useMemo((()=>{if(!r)return t;const n=q(t,r,{keys:["label","value"]}),a=t.find((t=>t.value===e));return a&&!n.includes(a)&&n.push(a),n}),[r,e,t]);return{open:a,setOpen:s,searchValue:r,setSearchValue:o,matches:i}}const Zv=e=>{const t={};return Object.entries(e).forEach((([e,n])=>{try{const a=fi.shape[e];if(a){const s=(e=>"true"===e||"false"!==e&&(isNaN(Number(e))?e:Number(e)))(n),r=a.parse(s);t[e]=r}}catch(a){console.warn(`Invalid value for setting ${e}:`,a)}})),null!=t.assistant_id&&t.assistant_id&&!Oo(t.endpoint)&&(t.endpoint=Ro.assistants),null!=t.agent_id&&t.agent_id&&!Do(t.endpoint)&&(t.endpoint=Ro.agents),t};function Yv({textAreaRef:e}){const t=n.useRef(0),a=n.useRef(!1),s=dv(),[r]=Z(),o=hh(),i=I(_p.modularChat),l=I(_p.availableTools),c=ar(),{conversation:d,newConversation:u}=bh(),m=n.useCallback((e=>{if(!e)return;const t=Tu(e,l);let n=t.endpoint??"";const a=c.getQueryData([Xc.endpoints]);if(n&&a&&!a[n]){const e=n.toLowerCase();for(const[s,r]of Object.entries(a))if(r&&r.type===Ro.custom&&s.toLowerCase()===e){n=s,t.endpoint=s,t.endpointType=Ro.custom;break}}const{template:s,shouldSwitch:r,isNewModular:m,newEndpointType:p,isCurrentModular:g,isExistingConversation:f}=Wu({newEndpoint:n,modularChat:i,conversation:d,endpointsConfig:a});if(f&&(g&&m&&r)){s.endpointType=p;const e=o({conversation:{...d??{},endpointType:s.endpointType},preset:s});u({template:e,preset:t,keepLatestMessage:!0,keepAddedConvos:!0})}else u({preset:t,keepAddedConvos:!0})}),[c,i,d,l,u,o]);n.useEffect((()=>{const n=setInterval((()=>{if(a.current||t.current>=50)return clearInterval(n),void(t.current>=50&&console.warn("Max attempts reached, failed to process parameters"));if(t.current+=1,!e.current)return;const{decodedPrompt:o,validSettings:i}=(()=>{const e={};r.forEach(((t,n)=>{e[n]=t}));const t=e.prompt||"";return delete e.prompt,{decodedPrompt:t,validSettings:Zv(e)}})();!s.getValues("text")&&o&&(s.setValue("text",o,{shouldValidate:!0}),e.current.focus(),e.current.setSelectionRange(o.length,o.length)),Object.keys(i).length>0&&m(i),(()=>{const e=window.location.pathname;window.history.replaceState({},"",e),a.current=!0,console.log("Parameters processed successfully"),clearInterval(n)})()}),100);return()=>{clearInterval(n)}}),[r,s,e,m,u])}const Jv=({permissionType:e,permission:t})=>{const a=n.useContext(Gh),s=null==a?void 0:a.user,r=null==a?void 0:a.roles,o=(null==a?void 0:a.isAuthenticated)||!1,i=n.useCallback((({user:e,permissionType:t,permission:n})=>{var s,i;return!!a&&(!!(o&&null!=(null==e?void 0:e.role)&&r&&r[e.role])&&!0===(null==(i=null==(s=r[e.role])?void 0:s[t])?void 0:i[n]))}),[a,o,r]);return n.useMemo((()=>i({user:s,permissionType:e,permission:t})),[s,e,t,i])},Xv={Escape:!0,Backspace:!0,Enter:!0},eb=(e,t)=>{var n,a;const s=null==(n=e.current)?void 0:n.value;if("string"!=typeof s||0===s.length||s[0]!==t)return!1;const r=null==(a=e.current)?void 0:a.selectionStart;return"number"==typeof r&&1===r};const tb=()=>{const e=I(_p.engineSTT),t=I(_p.engineTTS),a=e,s=t;return n.useMemo((()=>({speechToTextEndpoint:a,textToSpeechEndpoint:s})),[a,s])},nb=(e,t)=>{const{showToast:a}=Ng(),{speechToTextEndpoint:s}=tb(),r="external"===s,o=n.useRef(null),i=n.useRef(null),l=n.useRef(null),c=n.useRef(null),[d,u]=n.useState(!1),[m,p]=n.useState(!1),[g,f]=n.useState([]),[x,h]=n.useState(!1),[v]=T(_p.decibelValue),[b]=T(_p.autoSendText),[y]=T(_p.speechToText),[_]=T(_p.autoTranscribeAudio),{mutate:j,isLoading:w}=(N={onSuccess:n=>{const a=n.text;e(a),h(!1),b>-1&&y&&a.length>0&&setTimeout((()=>{t(a)}),1e3*b)},onError:()=>{a({message:"An error occurred while processing the audio, maybe the audio was too short",status:"error"}),h(!1)}},sr([ed.speechToText],{mutationFn:e=>zd.speechToText(e),...N||{}}));var N;const C=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});u(!0),o.current=e??null}catch(e){u(!1)}},k=()=>{if(g.length>0){const e=new Blob(g,{type:"audio/wav"});f([]);const t=new FormData;t.append("audio",e,"audio.wav"),h(!0),c.current&&(c.current.removeEventListener("dataavailable",(e=>{g.push(e.data)})),c.current.removeEventListener("stop",k),c.current=null),j(t)}else a({message:"The audio was too short",status:"warning"})},S=async()=>{if(x)a({message:"A request is already being made. Please wait.",status:"warning"});else if(o.current||await C(),o.current)try{f([]),c.current=new MediaRecorder(o.current),c.current.addEventListener("dataavailable",(e=>{g.push(e.data)})),c.current.addEventListener("stop",k),c.current.start(100),!l.current&&_&&y&&((e,t)=>{const n=new AudioContext,a=n.createMediaStreamSource(e),s=n.createAnalyser();s.minDecibels=v,a.connect(s);const r=s.frequencyBinCount,o=new Uint8Array(r);let l=Date.now();const c=()=>{s.getByteFrequencyData(o),o.some((e=>e>0))&&(l=Date.now()),Date.now()-l>3e3?t():i.current=window.requestAnimationFrame(c)};i.current=window.requestAnimationFrame(c)})(o.current,R),p(!0)}catch(e){a({message:`Error starting recording: ${e}`,status:"error"})}else a({message:"Microphone permission not granted",status:"error"})},R=()=>{var e;c.current&&("recording"===c.current.state?(c.current.stop(),null==(e=o.current)||e.getTracks().forEach((e=>e.stop())),o.current=null,null!==i.current&&(window.cancelAnimationFrame(i.current),i.current=null),p(!1)):a({message:"MediaRecorder is not recording",status:"error"}))},I=async e=>{if(e.shiftKey&&e.altKey&&"KeyL"===e.code&&r){if(!window.MediaRecorder)return void a({message:"MediaRecorder is not supported in this browser",status:"error"});!1===d&&await C(),m?R():S(),e.preventDefault()}};return n.useEffect((()=>(window.addEventListener("keydown",I),()=>{window.removeEventListener("keydown",I)})),[m]),{isListening:m,externalStopRecording:()=>{m?R():a({message:"Not currently recording. Please start recording first.",status:"warning"})},externalStartRecording:()=>{m?a({message:"Already listening. Please stop recording first.",status:"warning"}):S()},isLoading:w}},ab=(e,t)=>{const{speechToTextEndpoint:a}=tb(),s="external"===a,{isListening:r,isLoading:o,startRecording:i,stopRecording:l}=((e,t)=>{const{showToast:a}=Ng(),{speechToTextEndpoint:s}=tb(),r="browser"===s,o=n.useRef(null),i=n.useRef(null),l=n.useRef(),[c]=T(_p.autoSendText),[d]=T(_p.languageSTT),[u]=T(_p.autoTranscribeAudio),{listening:m,finalTranscript:p,resetTranscript:g,interimTranscript:f,isMicrophoneAvailable:x,browserSupportsSpeechRecognition:h}=Y.useSpeechRecognition(),v=n.useMemo((()=>m),[m]);n.useEffect((()=>{null!=f&&""!==f&&i.current!==f&&(e(f),i.current=f)}),[e,f]),n.useEffect((()=>{if(null!=p&&""!==p&&o.current!==p)return e(p),o.current=p,c>-1&&p.length>0&&(l.current=setTimeout((()=>{t(p),g()}),1e3*c)),()=>{l.current&&clearTimeout(l.current)}}),[e,t,g,p,c]);const b=()=>{h?x?!0===v?J.stopListening():J.startListening({language:d,continuous:u}):a({message:"Microphone is not available",status:"error"}):a({message:"Browser does not support SpeechRecognition",status:"error"})};return n.useEffect((()=>{const e=e=>{e.shiftKey&&e.altKey&&"KeyL"===e.code&&!r&&b()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[]),{isListening:v,isLoading:!1,startRecording:b,stopRecording:b}})(e,t),{isListening:c,isLoading:d,externalStartRecording:u,externalStopRecording:m}=nb(e,t);return{isLoading:s?d:o,isListening:s?c:r,stopRecording:s?m:l,startRecording:s?u:i}},sb={},rb=e=>n.useMemo((()=>{if(!(null==e?void 0:e.username))return"";if(e.avatar)return e.avatar;const{username:t}=e;if(sb[t])return sb[t];const n=X(ee,{seed:t,fontFamily:["Verdana"],fontSize:36});let a="";return n.toDataUri().then((e=>{a=e,sb[t]=e})).catch((e=>{console.error("Failed to generate avatar:",e)})),a}),[e]);function ob(e=.01,t=.007,a){const s=n.useCallback((e=>{const n=e?e/1048576:0;return e?n<=1?.1:Math.max(.05/Math.sqrt(n),.002):t}),[t]),r=n.useMemo((()=>s(a)),[a,s]),[o,i]=n.useState(e),l=n.useCallback((e=>a?e<.7?r:Math.max(5e-4,r*(1-e)):r),[r,a]);return n.useEffect((()=>{let t,n;if(!(e>=1&&o>=1))return e>=1&&o<1?(i(.99),t=setTimeout((()=>{i(1)}),200)):n=setInterval((()=>{i((e=>{if(e>=1)return clearInterval(n),1;const t=l(e);return Math.min(e+t,.95)}))}),200),()=>{clearInterval(n),clearTimeout(t)}}),[o,e,r,a,l]),o}const ib=(e,t)=>t?`${t}${dc.COMMON_DIVIDER}${e}`:t;function lb(e){const{user:t}=Wh(),a=dv(),{ask:s,index:r,getMessages:o,setMessages:i,latestMessage:l}=bh(),{addedIndex:c,ask:d,conversation:u}=rv(),m=I(_p.autoSendPrompts),p=I(_p.allConversationsSelector),g=R(_p.activePromptByIndex(r)),f=n.useCallback((t=>{if(!t)return console.warn("No data provided to submitMessage");const n=o();!(null==n?void 0:n.some((e=>e.messageId===(null==l?void 0:l.messageId))))&&l&&i([...n||[],l]);const r=c&&p[c]&&u,m=r&&p.every((e=>e===dc.NEW_CONVO))&&!(null==n?void 0:n.length)?O():void 0,g=r?O():void 0,f=c-1,x=(new Date).toISOString();s({text:t.text,overrideConvoId:ib(f,m),overrideUserMessageId:ib(f,g),clientTimestamp:x}),r&&d({text:t.text,overrideConvoId:ib(c,m),overrideUserMessageId:ib(c,g),clientTimestamp:x},{overrideMessages:n}),a.reset(),(null==e?void 0:e.clearDraft)&&e.clearDraft()}),[s,a,e,c,u,i,o,p,d,l]),x=n.useCallback((e=>{const n=Ru({text:e,user:t});if(m)return void f({text:n});const s=a.getValues("text").trim().length>1?`\n${n}`:n;g(s)}),[m,f,g,a,t]);return{submitMessage:f,submitPrompt:x}}function cb({text:e,content:t}){const a=n.useRef(null);n.useEffect((()=>()=>{a.current&&clearTimeout(a.current)}),[]);return n.useCallback((n=>{a.current&&clearTimeout(a.current),n(!0);let s=e??"";t&&(s=t.reduce(((e,n,a)=>{if(n.type===to.TEXT){return e+("string"==typeof n.text?n.text:n.text.value)+(a===t.length-1?"":"\n")}return e}),"")),te(s,{format:"text/plain"}),a.current=setTimeout((()=>{n(!1)}),3e3)}),[e,t])}function db(e){const t=kg(),{user:a}=Wh(),s=I(_p.UsernameDisplay),{message:r,currentEditId:o,setCurrentEditId:i,isMultiMessage:l}=e,{ask:c,index:d,regenerate:u,latestMessage:m,handleContinue:p,setLatestMessage:g,conversation:f,isSubmitting:x}=bh(),{conversation:h,isSubmitting:v}=rv(),b=n.useMemo((()=>!0===l?h:f),[l,h,f]),y=Nh(),_=vv(),{text:j,content:w,messageId:N=null,isCreatedByUser:C}=r??{},k=n.useMemo((()=>N===o),[N,o]),S=n.useCallback((e=>i&&i(!0===e?-1:N)),[N,i]),T=n.useMemo((()=>{if(!Oo(null==b?void 0:b.endpoint))return;const e=(null==b?void 0:b.endpoint)??"",t=(null==r?void 0:r.model)??"";return(null==_?void 0:_[e])?_[e][t]:void 0}),[null==b?void 0:b.endpoint,null==r?void 0:r.model,_]),R=n.useMemo((()=>{if(!Do(null==b?void 0:b.endpoint))return;if(!y)return;const e=(null==r?void 0:r.model)??"";if(e)return y[e];const t=(null==b?void 0:b.agent_id)??"";return t?y[t]:void 0}),[y,null==b?void 0:b.agent_id,null==b?void 0:b.endpoint,null==r?void 0:r.model]),E=n.useMemo((()=>!0===l?v:x),[l,v,x]),P=n.useCallback((()=>{E&&!0===C||!r||u(r)}),[E,C,r,u]),L=cb({text:j,content:w}),M=n.useMemo((()=>!0===(null==r?void 0:r.isCreatedByUser)?s?((null==a?void 0:a.name)??"")||(null==a?void 0:a.username):t("com_user_message"):R?R.name??"Assistant":T?T.name??"Assistant":null==r?void 0:r.sender),[r,R,T,s,a,t]);return{ask:c,edit:k,index:d,agent:R,assistant:T,enterEdit:S,conversation:b,messageLabel:M,isSubmitting:E,latestMessage:m,handleContinue:p,copyToClipboard:L,setLatestMessage:g,regenerateMessage:P}}function ub({message:e}){const t=n.useRef(""),[a,s]=n.useState(null),r=n.useMemo((()=>{var t;return 0===((null==(t=null==e?void 0:e.children)?void 0:t.length)??0)}),[e]),{index:o,conversation:i,latestMessage:l,setAbortScroll:c,setLatestMessage:d,isSubmitting:u}=bh(),{isSubmitting:m}=rv(),p=I(_p.latestMessageFamily(o+1)),g=n.useMemo((()=>u||m),[u,m]);n.useEffect((()=>{const n=null==i?void 0:i.conversationId;if(n===dc.NEW_CONVO)return;if(!e)return;if(!r)return;const a=Fu(e,n),s={textKey:a,"latestText.current":t.current,messageId:e.messageId,convoId:n};a!==t.current||null!=n&&t.current&&n!==t.current.split(dc.COMMON_DIVIDER)[2]?(om.log("latest_message","[useMessageProcess] Setting latest message; logInfo:",s),t.current=a,d({...e})):om.log("latest_message","No change in latest message; logInfo",s)}),[r,e,d,null==i?void 0:i.conversationId]);const f=n.useCallback((e=>{K((()=>{om.log("message_scrolling",`useMessageProcess: setting abort scroll to ${g}, handleScroll event`,e),c(!!g)}),500)()}),[g,c]),x=n.useMemo((()=>{var e;return r&&p&&0===((null==(e=p.children)?void 0:e.length)??0)||!!a}),[r,p,a]);return n.useEffect((()=>{if(r&&p&&p.conversationId===(null==e?void 0:e.conversationId)){const t=Object.assign({},p,{parentMessageId:e.parentMessageId,depth:e.depth});s(t)}}),[r,p,e,s,l]),{showSibling:x,handleScroll:f,conversation:i,siblingMessage:a,setSiblingMessage:s,isSubmittingFamily:g,latestMultiMessage:p}}const mb=.85,pb=150;function gb(e){const t=I(_p.autoScroll),a=n.useRef(null),s=n.useRef(null),[r,o]=n.useState(!1),{conversation:i,setAbortScroll:l,isSubmitting:c,abortScroll:d}=bh(),{conversationId:u}=i??{},m=n.useRef(),p=n.useCallback((e=>{clearTimeout(m.current),m.current=setTimeout((()=>{o(e)}),pb)}),[]);n.useEffect((()=>{if(!s.current||!a.current)return;const e=new IntersectionObserver((([e])=>{p(!e.isIntersecting)}),{root:a.current,threshold:mb});return e.observe(s.current),()=>{e.disconnect(),clearTimeout(m.current)}}),[s,a,p]);const g=n.useCallback((()=>{if(s.current&&a.current){const e=new IntersectionObserver((([e])=>{p(!e.isIntersecting)}),{root:a.current,threshold:mb});return e.observe(s.current),()=>e.disconnect()}}),[p]),f=()=>p(!1),{scrollToRef:x,handleSmoothToRef:h}=function({targetRef:e,callback:t,smoothCallback:a}){const s=(t,n)=>{var a;null==(a=e.current)||a.scrollIntoView({behavior:t}),n()},r=n.useCallback(K((()=>s("instant",t)),145,{leading:!0}),[e]),o=n.useCallback(K((()=>s("smooth",a)),750,{leading:!0}),[e]);return{scrollToRef:r,handleSmoothToRef:e=>{e.preventDefault(),o()}}}({targetRef:s,callback:f,smoothCallback:()=>{f(),l(!1)}});return n.useEffect((()=>{if(e&&0!==e.length&&s.current&&a.current)return c&&x&&!0!==d&&x(),()=>{!0===d&&x&&x.cancel()}}),[c,e,x,d]),n.useEffect((()=>{s.current&&a.current&&x&&t&&u!==dc.NEW_CONVO&&x()}),[t,u,x]),{conversation:i,scrollableRef:a,messagesEndRef:s,scrollToBottom:x,showScrollButton:r,handleSmoothToRef:h,debouncedHandleScroll:g}}const fb=e=>{const t=ar(),a=null==e?void 0:e.isEntityTool,s=xh({onMutate:e=>{t.setQueryData([Xc.toolAuth,so.execute_code],(()=>({authenticated:"install"===e.action,message:So.USER_PROVIDED})))},onSuccess:()=>{t.invalidateQueries([Xc.toolAuth,so.execute_code])},onError:()=>{t.invalidateQueries([Xc.toolAuth,so.execute_code])}}),r=n.useCallback((e=>{s.mutate({pluginKey:so.execute_code,action:"install",auth:{LIBRECHAT_CODE_API_KEY:e},isEntityTool:a})}),[s,a]);return{removeTool:n.useCallback((()=>{s.mutate({pluginKey:so.execute_code,action:"uninstall",auth:{LIBRECHAT_CODE_API_KEY:null},isEntityTool:a})}),[s,a]),installTool:r}};function xb({onSubmit:e,onRevoke:t}){const a=ne(),[s,r]=n.useState(!1),{installTool:o,removeTool:i}=fb({isEntityTool:!0}),{reset:l}=a,c=n.useCallback((t=>{l(),o(t.apiKey),r(!1),null==e||e()}),[e,l,o]),d=n.useCallback((()=>{l(),i(),r(!1),null==t||t()}),[l,t,i]);return{methods:a,isDialogOpen:s,setIsDialogOpen:r,handleRevokeApiKey:d,onSubmit:c}}function hb(){const[e,t]=n.useState(1),[a,s]=n.useState(1),[r,o]=n.useState(1),[i,l]=n.useState(!1),[c,d]=n.useState(""),[u,m]=n.useState(!1),[p,g]=n.useState(""),[f,x]=n.useState(!1),[h,v]=n.useState(void 0),b=e=>{const t=e.offsetWidth;let n;t<501?o(8):(n=t<640?2:t<1024?3:4,o(2*n))},y=n.useCallback((e=>{if(null!==e){1===r&&b(e);new ResizeObserver((()=>b(e))).observe(e)}}),[r]);return{maxPage:e,setMaxPage:t,currentPage:a,setCurrentPage:s,itemsPerPage:r,setItemsPerPage:o,searchChanged:i,setSearchChanged:l,searchValue:c,setSearchValue:d,gridRef:y,handleSearch:e=>{d(e.target.value),l(!0)},handleChangePage:e=>{s(e)},error:u,setError:m,errorMessage:p,setErrorMessage:g,showPluginAuthForm:f,setShowPluginAuthForm:x,selectedPlugin:h,setSelectedPlugin:v}}const vb={misc:ue,roleplay:de,write:ce,idea:le,shop:ie,finance:oe,code:re,travel:se,teach_or_explain:ae},bb={code:"text-red-500",misc:"text-blue-300",shop:"text-purple-400",idea:"text-yellow-300",write:"text-purple-400",travel:"text-yellow-300",finance:"text-orange-400",roleplay:"text-orange-400",teach_or_explain:"text-blue-300"};function yb({category:e,className:t=""}){const n=vb[e],a=bb[e]+" "+t;return n?c.jsx(n,{className:rm(a,t),"aria-hidden":"true"}):null}const _b=[{label:"com_ui_loading",value:""}],jb={label:"com_ui_empty_category",value:""},wb=(e="")=>{const t=kg(),{data:n=_b}=(a={select:n=>n.map((n=>({label:t(n.label),value:n.value,icon:n.value?c.jsx(yb,{category:n.value,className:e}):null})))},nr([Xc.categories],(()=>zd.getCategories()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...a,enabled:void 0===(null==a?void 0:a.enabled)||a.enabled}));var a;return{categories:n,emptyCategory:jb}};function Nb(){const e=ar(),t=I(_p.promptsCategory),[a,s]=T(_p.promptsName),[r,o]=T(_p.promptsPageSize),[i,l]=T(_p.promptsPageNumber),c=n.useRef(1);n.useEffect((()=>{i>1&&i>c.current&&(c.current=i)}),[i]);const d=Jp({name:a,pageSize:r,category:t,pageNumber:i+""});n.useEffect((()=>{c.current=1,l(1),e.resetQueries([Xc.promptGroups,a,t,r])}),[r,a,t,l]);const u=n.useMemo((()=>{var e,t;return(null==(t=null==(e=d.data)?void 0:e.pages[i-1+""])?void 0:t.promptGroups)||[]}),[d.data,i]),m=d.isFetchingNextPage,p=!!d.hasNextPage||c.current>i,g=!!d.hasPreviousPage||i>1,f=n.useCallback($((e=>{s(e)}),850),[s]);return{name:a,setName:f,nextPage:()=>{l((e=>e+1)),d.hasNextPage&&d.fetchNextPage()},prevPage:()=>{l((e=>e-1)),d.hasPreviousPage&&d.fetchPreviousPage()},isFetching:m,pageSize:r,setPageSize:o,hasNextPage:p,groupsQuery:d,promptGroups:u,hasPreviousPage:g}}function Cb({genTitle:e,setMessages:t,getMessages:a,setCompleted:s,isAddedRequest:r=!1,setConversation:o,setIsSubmitting:i,newConversation:l,setShowStopButton:c,resetLatestMessage:d}){const u=ar(),m=R(_p.abortScroll),{announcePolite:p}=_v(),g=n.useRef(Date.now()),{conversationId:f}=B(),{token:x}=Wh(),h=function({setMessages:e,getMessages:t}){const a=ar(),s=n.useMemo((()=>new Map),[]);return n.useCallback((({data:n,submission:r})=>{const{type:o,messageId:i,thread_id:l,conversationId:c,index:d}=n,u=t(),m=(null==u?void 0:u.filter((e=>e.messageId!==i)).map((e=>({...e,thread_id:l}))))??[],p=m[m.length-1],{initialResponse:g}=r;let f=s.get(i);f||(f={...g,parentMessageId:(null==p?void 0:p.messageId)??"",conversationId:c,messageId:i,thread_id:l},s.set(i,f));const x=n[to.TEXT],h=null!=x&&"string"==typeof x?{value:x}:n[o];o===to.IMAGE_FILE&&au(a,h),f.content=[...f.content??[]],f.content[d]={type:o,[o]:h},o!==to.TEXT&&g.content&&(f.content[f.content.length-1].type===to.TOOL_CALL&&1===f.content[f.content.length-1][to.TOOL_CALL].progress||f.content[f.content.length-1].type===to.IMAGE_FILE)&&f.content.push(g.content[0]),e([...m,f])}),[a,t,s,e])}({setMessages:t,getMessages:a}),v=function({setMessages:e,getMessages:t,setIsSubmitting:a,announcePolite:s,lastAnnouncementTimeRef:r}){const o=n.useRef(new Map),i=n.useRef(new Map),l=n.useRef(new Map),c=(e,t,n,a=!1)=>{const s=n.type??"";if(!s)return console.warn("No content type found in content part"),e;const r=[...e.content||[]];if(r[t]||(r[t]={type:n.type}),s.startsWith(to.TEXT)&&to.TEXT in n&&"string"==typeof n.text){const e=r[t],a={type:to.TEXT,text:(e.text||"")+n.text};null!=n.tool_call_ids&&(a.tool_call_ids=n.tool_call_ids),r[t]=a}else if(s.startsWith(to.THINK)&&to.THINK in n&&"string"==typeof n.think){const e=r[t],a={type:to.THINK,think:(e.think||"")+n.think};r[t]=a}else if(s===to.IMAGE_URL&&"image_url"in n){const e=r[t];r[t]={...e}}else if(s===to.TOOL_CALL&&"tool_call"in n){const e=r[t],s=null==e?void 0:e.tool_call,o=n.tool_call.args??"",i=a?n.tool_call.args:((null==s?void 0:s.args)??"")+o,l={id:yc([n.tool_call.id,null==s?void 0:s.id])??"",name:yc([n.tool_call.name,null==s?void 0:s.name])??"",args:i,type:ao.TOOL_CALL,auth:n.tool_call.auth,expires_at:n.tool_call.expires_at};a&&(l.progress=1,l.output=n.tool_call.output),r[t]={type:to.TOOL_CALL,tool_call:l}}return{...e,content:r}};return n.useCallback((({event:n,data:d},u)=>{const m=t()||[],{userMessage:p}=u;a(!0);const g=Date.now();if(g-r.current>Fr&&(s({message:"composing",isStatus:!0}),r.current=g),"on_run_step"===n){const t=d,n=t.runId??"";if(!n)return void console.warn("No message id found in run step event");l.current.set(t.id,t);let a=i.current.get(n);a||(a={...m[m.length-1],parentMessageId:p.messageId,conversationId:p.conversationId,messageId:n,content:[]},i.current.set(n,a),e([...m.slice(0,-1),a])),t.stepDetails.type===no.TOOL_CALLS&&t.stepDetails.tool_calls.forEach((e=>{const n=e.id??"";"id"in e&&n&&o.current.set(t.id,n)}))}else if("on_agent_update"===n){const{runId:t,message:n}=d,a=t??"";if(!a)return void console.warn("No message id found in agent update event");const s={...m[m.length-1],parentMessageId:p.messageId,conversationId:p.conversationId,messageId:a,content:[{type:to.TEXT,text:n}]};e([...m.slice(0,-1),s])}else if("on_message_delta"===n){const n=d,a=l.current.get(n.id),s=(null==a?void 0:a.runId)??"";if(!a||!s)return void console.warn("No run step or runId found for message delta event");const r=i.current.get(s);if(r&&n.delta.content){const o=Array.isArray(n.delta.content)?n.delta.content[0]:n.delta.content,l=c(r,a.index,o);i.current.set(s,l);const d=t()||[];e([...d.slice(0,-1),l])}}else if("on_reasoning_delta"===n){const n=d,a=l.current.get(n.id),s=(null==a?void 0:a.runId)??"";if(!a||!s)return void console.warn("No run step or runId found for reasoning delta event");const r=i.current.get(s);if(r&&null!=n.delta.content){const o=Array.isArray(n.delta.content)?n.delta.content[0]:n.delta.content,l=c(r,a.index,o);i.current.set(s,l);const d=t()||[];e([...d.slice(0,-1),l])}}else if("on_run_step_delta"===n){const t=d,n=l.current.get(t.id),a=(null==n?void 0:n.runId)??"";if(!n||!a)return void console.warn("No run step or runId found for run step delta event");const s=i.current.get(a);if(s&&t.delta.type===no.TOOL_CALLS&&t.delta.tool_calls){let r={...s};t.delta.tool_calls.forEach((e=>{const a=o.current.get(t.id)??"",s={type:to.TOOL_CALL,tool_call:{name:e.name??"",args:e.args??"",id:a}};null!=t.delta.auth&&(s.tool_call.auth=t.delta.auth,s.tool_call.expires_at=t.delta.expires_at),r=c(r,n.index,s)})),i.current.set(a,r);const l=m.map((e=>e.messageId===n.runId?r:e));e(l)}}else if("on_run_step_completed"===n){const{result:t}=d,{id:n}=t,a=l.current.get(n),s=(null==a?void 0:a.runId)??"";if(!a||!s)return void console.warn("No run step or runId found for completed tool call event");const r=i.current.get(s);if(r){let n={...r};const o={type:to.TOOL_CALL,tool_call:t.tool_call};n=c(n,a.index,o,!0),i.current.set(s,n);const l=m.map((e=>e.messageId===a.runId?n:e));e(l)}}return()=>{o.current.clear(),i.current.clear(),l.current.clear()}}),[t,a,r,s,e])}({setMessages:t,getMessages:a,announcePolite:p,setIsSubmitting:i,lastAnnouncementTimeRef:g}),b=function(){const e=R(_p.messageAttachmentsMap);return({data:t})=>{const{messageId:n}=t;e((e=>{const a=e[n]||[];return{...e,[n]:[...a,t]}}))}}(),y=n.useCallback(((e,n)=>{const{messages:a,userMessage:s,plugin:r,plugins:o,initialResponse:l,isRegenerate:c=!1}=n,d=e??"";i(!0);const u=Date.now();u-g.current>Fr&&(p({message:"composing",isStatus:!0}),g.current=u),t(c?[...a,{...l,text:d,plugin:r??null,plugins:o??[]}]:[...a,s,{...l,text:d,plugin:r??null,plugins:o??[]}])}),[t,p,i]),_=n.useCallback(((n,a)=>{const{requestMessage:s,responseMessage:l,conversation:c}=n,{messages:d,isRegenerate:m=!1}=a,p=c??a.conversation;if(m){const e=[...d,l].filter((e=>e));t(e)}else{const e=[...d,s,l].filter((e=>e));t(e)}const g=c.conversationId!==a.conversation.conversationId;g&&u.setQueryData([Xc.allConversations],(e=>e?Cu(e,a.conversation.conversationId):e)),e&&g&&s.parentMessageId===dc.NO_PARENT&&setTimeout((()=>{e.mutate({conversationId:p.conversationId})}),2500),o&&!r&&o((e=>({...e,...p}))),i(!1)}),[t,o,e,r,u,i]),j=n.useCallback(((e,n)=>{const{conversationId:a,thread_id:s,responseMessage:i,requestMessage:l}=e,{initialResponse:m,messages:g,userMessage:f}=n,x=g.filter((e=>e.messageId!==f.messageId));t([...x,l,{...m,...i}]),p({message:"start",isStatus:!0});let h={};o&&!r?(o((e=>{let t=null==e?void 0:e.title;if(l.parentMessageId!==dc.NO_PARENT&&(null==t?void 0:t.toLowerCase().includes("new chat"))){const e=u.getQueryData([Xc.allConversations]),n=ku(e,a);t=null==n?void 0:n.title}return h=gi.parse({...e,conversationId:a,thread_id:s,title:t,messages:[l.messageId,i.messageId]}),h})),u.setQueryData([Xc.allConversations],(e=>e?l.parentMessageId===dc.NO_PARENT?_u(e,h):wu(e,h):e))):o&&o((e=>(h=gi.parse({...e,conversationId:a,thread_id:s,messages:[l.messageId,i.messageId]}),h))),c(!0),d&&d()}),[u,t,r,p,o,c,d]),w=n.useCallback(((e,n)=>{const{messages:a,userMessage:s,isRegenerate:i=!1,isTemporary:l=!1}=n,c={...n.initialResponse,parentMessageId:s.messageId,messageId:s.messageId+"_"};t(i?[...a,c]:[...a,s,c]);const{conversationId:f,parentMessageId:x}=s;g.current=Date.now(),p({message:"start",isStatus:!0});let h={};if(o&&!r){if(o((e=>{let t=null==e?void 0:e.title;if((i?s.overrideParentMessageId:x)!==dc.NO_PARENT&&(null==t?void 0:t.toLowerCase().includes("new chat"))){const e=u.getQueryData([Xc.allConversations]),n=ku(e,f);t=null==n?void 0:n.title}return h=gi.parse({...e,conversationId:f,title:t}),h})),l)return;u.setQueryData([Xc.allConversations],(e=>e?x===dc.NO_PARENT?_u(e,h):wu(e,h):e))}else o&&o((e=>(h=gi.parse({...e,conversationId:f}),h)));d&&d(),zu((()=>m(!1)))}),[t,u,m,r,p,o,d]),N=n.useCallback(((n,l)=>{const{requestMessage:d,responseMessage:m,conversation:g,runMessages:f}=n,{messages:x,conversation:h,isRegenerate:v=!1,isTemporary:b=!1}=l;c(!1),s((e=>new Set(e.add(l.initialResponse.messageId))));const y=a();if(!y||0===y.length)return i(!1);p({message:"end",isStatus:!0}),p({message:Du(m)}),f?t([...f]):v&&m?t([...x,m]):null!=d&&null!=m&&t([...x,d,m]);const _=g.conversationId!==h.conversationId;_&&u.setQueryData([Xc.allConversations],(e=>e?Cu(e,h.conversationId):e)),e&&_&&!b&&d&&d.parentMessageId===dc.NO_PARENT&&setTimeout((()=>{e.mutate({conversationId:g.conversationId})}),2500),o&&!0!==r&&("/c/new"===window.location.pathname&&window.history.pushState({},"","/c/"+g.conversationId),o((e=>{const t={...e,...g};return null!=(null==e?void 0:e.model)&&e.model!==h.model&&(t.model=e.model),t}))),i(!1)}),[e,u,a,t,s,r,p,o,i,c]),C=n.useCallback((({data:e,submission:n})=>{const{messages:a,userMessage:r,initialResponse:o}=n;s((e=>new Set(e.add(o.messageId))));const c=r.conversationId??n.conversationId??"",d=e=>{const t=e.responseMessage??e,n={...o,...t,error:!0,parentMessageId:r.messageId};return void 0!==n.messageId&&""!==n.messageId||(n.messageId=O()),ci.parse(n)};if(!e){const e=c||O(),s=d({text:"Error connecting to server, try refreshing the page.",...n,conversationId:e});return t([...a,r,s]),l&&l({template:{conversationId:e},preset:pi.parse(n.conversation)}),void i(!1)}const u=e.conversationId??"";if(!c&&!u){const s=O(),o=d(e);return t([...a,r,o]),l&&l({template:{conversationId:s},preset:pi.parse(n.conversation)}),void i(!1)}if(!u){const n=d(e);return t([...a,r,n]),void i(!1)}console.log("Error:",e);const m=ci.parse({...e,error:!0,parentMessageId:r.messageId});t([...a,r,m]),u&&"new"===f&&l&&l({template:{conversationId:u},preset:pi.parse(n.conversation)}),i(!1)}),[t,f,i,s,l]),k=n.useCallback((async(e="",n,a)=>{var s;const r=`${e}:${(null==(s=null==a?void 0:a[a.length-1])?void 0:s.messageId)??""}`;console.log({conversationId:e,submission:n,messages:a,runAbortKey:r});const{endpoint:o,endpointType:c}=n.conversation??{},d=c??o;try{const e=await fetch(`${Jl[d??""]}/abort`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify({abortKey:r,endpoint:d})}),t=e.headers.get("content-type");if(null!=t&&t.includes("application/json")){const t=await e.json();if(console.log(`[aborted] RESPONSE STATUS: ${e.status}`,t),404===e.status)return void i(!1);!0===t.final?N(t,n):_(t,n)}else{if(204!==e.status)throw new Error("Unexpected response from server; Status: "+e.status+" "+e.statusText);{const t={...n.initialResponse},a={requestMessage:n.userMessage,responseMessage:t,conversation:n.conversation};console.log(`[aborted] RESPONSE STATUS: ${e.status}`,a),i(!1)}}}catch(u){console.error("Error cancelling request"),console.error(u);const a=e||O(),s=n.initialResponse.text.length>45?n.initialResponse.text:"",r={...n,...n.initialResponse,text:(s||(null==u?void 0:u.message))??"Error cancelling request",unfinished:!!s.length,error:!0},o=ci.parse(r);t([...n.messages,n.userMessage,o]),l&&l({template:{conversationId:a},preset:pi.parse(n.conversation)}),i(!1)}}),[x,i,N,_,t,l]);return{stepHandler:v,syncHandler:j,finalHandler:N,errorHandler:C,messageHandler:y,contentHandler:h,createdHandler:w,attachmentHandler:b,abortConversation:k}}function kb(e,t,a=!1,s=0){const r=eg(),o=R(_p.activeRunFamily(s)),{token:i,isAuthenticated:l}=Wh(),[c,d]=n.useState(new Set),u=R(_p.abortScrollFamily(s)),m=R(_p.showStopButtonByIndex(s)),{setMessages:p,getMessages:g,setConversation:f,setIsSubmitting:x,newConversation:h,resetLatestMessage:v}=t,{stepHandler:b,syncHandler:y,finalHandler:_,errorHandler:j,messageHandler:w,contentHandler:N,createdHandler:C,attachmentHandler:k,abortConversation:S}=Cb({genTitle:r,setMessages:p,getMessages:g,setCompleted:d,isAddedRequest:a,setConversation:f,setIsSubmitting:x,newConversation:h,setShowStopButton:m,resetLatestMessage:v}),{data:T}=Ap(),I=zp({enabled:!!l&&(null==T?void 0:T.checkBalance)});n.useEffect((()=>{if(null==e||0===Object.keys(e).length)return;let{userMessage:t}=e;const n=function(e){var t=e.conversation,n=e.userMessage,a=e.endpointOption,s=e.isEdited,r=e.isContinued,o=e.isTemporary,i=gi.parse(t).conversationId,l=a,c=l.endpoint,d=l.endpointType,u=Jl[null!=d?d:c];return s&&Oo(c)?u+="/modify":s&&(u=u.replace("/ask/","/edit/")),{server:u,payload:mo(mo(mo({},n),a),{isContinued:!(!s||!r),conversationId:i,isTemporary:o})}}(e);let{payload:a}=n;(Oo(a.endpoint)||Do(a.endpoint))&&(a=bi(a));const s=new me(n.server,{payload:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});return s.addEventListener("attachment",(t=>{try{const n=JSON.parse(t.data);k({data:n,submission:e})}catch(n){console.error(n)}})),s.addEventListener("message",(n=>{const a=JSON.parse(n.data);if(null!=a.final){const{plugins:t}=a;return _(a,{...e,plugins:t}),(null==T?void 0:T.checkBalance)&&I.refetch(),void console.log("final",a)}if(null!=a.created){const n=O();o(n),t={...t,...a.message,overrideParentMessageId:t.overrideParentMessageId},C(a,{...e,userMessage:t})}else if(null!=a.event)b(a,{...e,userMessage:t});else if(null!=a.sync){const n=O();o(n),y(a,{...e,userMessage:t})}else if(null!=a.type){const{text:t,index:n}=a;N({data:a,submission:e})}else{const n=a.text??a.response,{plugin:s,plugins:r}=a,o={...e.initialResponse,parentMessageId:a.parentMessageId,messageId:a.messageId};null!=a.message&&w(n,{...e,plugin:s,plugins:r,userMessage:t,initialResponse:o})}})),s.addEventListener("open",(()=>{u(!1),console.log("connection is opened")})),s.addEventListener("cancel",(async()=>{var n,a;const s=null==(n=null==e?void 0:e.initialResponse)?void 0:n.messageId;if(c.has(s))return x(!1),void d((e=>(e.delete(s),new Set(e))));d((e=>new Set(e.add(s))));const r=g(),o=null==(a=null==r?void 0:r[r.length-1])?void 0:a.conversationId;return await S(o??t.conversationId??e.conversationId,e,r)})),s.addEventListener("error",(async n=>{if(401===n.responseCode)try{const e=await Fd.refreshToken(),t=(null==e?void 0:e.token)??"";if(!t)throw new Error("Token refresh failed.");return s.headers={"Content-Type":"application/json",Authorization:`Bearer ${t}`},Fd.dispatchTokenUpdatedEvent(t),void s.stream()}catch(r){console.log(r)}let a;console.log("error in server stream."),(null==T?void 0:T.checkBalance)&&I.refetch();try{a=JSON.parse(n.data)}catch(r){console.error(r),console.log(n),x(!1)}j({data:a,submission:{...e,userMessage:t}})})),x(!0),s.stream(),()=>{const e=s.readyState<=1;if(s.close(),e){const e=new Event("cancel");s.dispatchEvent(e)}}}),[e])}const Sb=_.createContext(void 0),Tb=({value:e,children:t})=>{const[a,s]=n.useState(!1);return c.jsx(Sb.Provider,{value:e??{error:a,setError:s},children:t})},Rb=()=>{const e=_.useContext(Sb);if(void 0===e)throw new Error("useApiErrorBoundary must be used inside ApiErrorBoundaryProvider");return e};function Ib(e){const[t,a]=n.useState(!1);return n.useEffect((()=>{const n=window.matchMedia(e);n.matches!==t&&a(n.matches);const s=()=>a(n.matches);return n.addEventListener("change",s),()=>n.removeEventListener("change",s)}),[t,e]),t}function Eb(e,t){const[a,s]=n.useState(t);n.useEffect((()=>{const n=localStorage.getItem(e);function a(t){if(t.key!==e)return;const n=localStorage.getItem(e);s(JSON.parse(n??""))}return n||localStorage.setItem(e,JSON.stringify(t)),s(n?JSON.parse(n):t),window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}),[]);return[a,t=>{try{s(t),localStorage.setItem(e,JSON.stringify(t)),"undefined"!=typeof window&&window.dispatchEvent(new StorageEvent("storage",{key:e}))}catch(Bg){console.error(Bg)}}]}function Pb(e,t,a,s){n.useEffect((()=>{const n=n=>{const r=n.target;r&&"id"in r&&a.includes(r.id)||(null==r?void 0:r.parentNode)&&"id"in r.parentNode&&a.includes(r.parentNode.id)||s&&s(r)||e.current&&!e.current.contains(r)&&t()};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}}),[e,t])}function Lb(){const{toast:e,onOpenChange:t}=jg(),n={[Wr.INFO]:"border-gray-500 bg-gray-500",[Wr.SUCCESS]:"border-green-500 bg-green-500",[Wr.WARNING]:"border-orange-500 bg-orange-500",[Wr.ERROR]:"border-red-500 bg-red-500"};return c.jsx(ja,{open:e.open,onOpenChange:t,className:"toast-root",style:{height:"74px",marginBottom:"0px"},children:c.jsx("div",{className:"w-full p-1 text-center md:w-auto md:text-justify",children:c.jsxs("div",{className:`alert-root pointer-events-auto inline-flex flex-row gap-2 rounded-md border px-3 py-2 text-white ${n[e.severity]}`,children:[e.showIcon&&c.jsx("div",{className:"mt-1 flex-shrink-0 flex-grow-0",children:c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"icon-sm",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"}),c.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),c.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),c.jsx(wa,{className:"flex-1 justify-center gap-2",children:c.jsx("div",{className:"whitespace-pre-wrap text-left",children:e.message})})]})})})}const Mb=({statusMessage:e,logMessage:t})=>c.jsxs("div",{className:"sr-only",children:[c.jsx("div",{"aria-live":"polite","aria-atomic":"true",children:e}),c.jsx("div",{"aria-live":"polite","aria-atomic":"true",children:t})]}),Ab=({children:e})=>{const[t,a]=n.useState(""),[s,r]=n.useState(""),o=n.useRef(null),i=kg(),l=n.useMemo((()=>({start:i("com_a11y_start"),end:i("com_a11y_end"),composing:i("com_a11y_ai_composing")})),[i]),d=n.useCallback((e=>{o.current&&clearTimeout(o.current),a(e),o.current=setTimeout((()=>{a("")}),1e3)}),[]),u=n.useCallback((e=>{r(e)}),[]),m=n.useCallback((({message:e,isStatus:t=!1})=>{const n=(l[e]??e).replace(/[*`_]/g,"");t?d(n):u(n)}),[l,d,u]),p={announcePolite:m,announceAssertive:m};return n.useEffect((()=>()=>{o.current&&clearTimeout(o.current)}),[]),c.jsxs(yv.Provider,{value:p,children:[e,c.jsx(Mb,{statusMessage:t,logMessage:s})]})},Ob=({children:e})=>c.jsx("div",{role:"alert","aria-live":"assertive",className:"relative mt-6 rounded-lg border border-red-500/20 bg-red-50/50 px-6 py-4 text-red-700 shadow-sm transition-all dark:bg-red-950/30 dark:text-red-100",children:e}),Db=({onSubmit:e,startupConfig:t,error:a,setError:s})=>{var r;const o=kg(),{register:i,getValues:l,handleSubmit:d,formState:{errors:u}}=ne(),[m,p]=n.useState(!1),{data:g}=Ap(),f=null==(r=null==g?void 0:g.ldap)?void 0:r.username;n.useEffect((()=>{a&&a.includes("422")&&!m&&p(!0)}),[a,m]);const x=vg({onMutate:()=>{s(void 0),p(!1)}});if(!t)return null;const h=e=>{var t;const n=null==(t=u[e])?void 0:t.message;return n?c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500 dark:text-red-900",children:String(n)}):null};return c.jsxs(c.Fragment,{children:[m&&c.jsxs("div",{className:"mt-2 rounded-md border border-green-500 bg-green-500/10 px-3 py-2 text-sm text-gray-600 dark:text-gray-200",children:[o("com_auth_email_verification_resend_prompt"),c.jsx("button",{type:"button",className:"ml-2 text-blue-600 hover:underline",onClick:()=>{const e=l("email");if(!e)return p(!1);x.mutate({email:e})},disabled:x.isLoading,children:o("com_auth_email_resend_link")})]}),c.jsxs("form",{className:"mt-6","aria-label":"Login form",method:"POST",onSubmit:d((t=>e(t))),children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",id:"email",autoComplete:f?"username":"email","aria-label":o("com_auth_email"),...i("email",{required:o("com_auth_email_required"),maxLength:{value:120,message:o("com_auth_email_max_length")},pattern:{value:f?/\S+/:/\S+@\S+\.\S+/,message:o("com_auth_email_pattern")}}),"aria-invalid":!!u.email,className:"\n                webkit-dark-styles transition-color peer w-full rounded-2xl border border-border-light\n                bg-surface-primary px-3.5 pb-2.5 pt-3 text-text-primary duration-200 focus:border-green-500 focus:outline-none\n              ",placeholder:" "}),c.jsx("label",{htmlFor:"email",className:"\n                absolute start-3 top-1.5 z-10 origin-[0] -translate-y-4 scale-75 transform bg-surface-primary px-2 text-sm text-text-secondary-alt duration-200\n                peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100\n                peer-focus:top-1.5 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-green-600 dark:peer-focus:text-green-500\n                rtl:peer-focus:left-auto rtl:peer-focus:translate-x-1/4\n                ",children:f?o("com_auth_username").replace(/ \(.*$/,""):o("com_auth_email_address")})]}),h("email")]}),c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"password",id:"password",autoComplete:"current-password","aria-label":o("com_auth_password"),...i("password",{required:o("com_auth_password_required"),minLength:{value:8,message:o("com_auth_password_min_length")},maxLength:{value:128,message:o("com_auth_password_max_length")}}),"aria-invalid":!!u.password,className:"\n                webkit-dark-styles transition-color peer w-full rounded-2xl border border-border-light\n                bg-surface-primary px-3.5 pb-2.5 pt-3 text-text-primary duration-200 focus:border-green-500 focus:outline-none\n                ",placeholder:" "}),c.jsx("label",{htmlFor:"password",className:"\n                absolute start-3 top-1.5 z-10 origin-[0] -translate-y-4 scale-75 transform bg-surface-primary px-2 text-sm text-text-secondary-alt duration-200\n                peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100\n                peer-focus:top-1.5 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-green-600 dark:peer-focus:text-green-500\n                rtl:peer-focus:left-auto rtl:peer-focus:translate-x-1/4\n                ",children:o("com_auth_password")})]}),h("password")]}),t.passwordResetEnabled&&c.jsx("a",{href:"/forgot-password",className:"inline-flex p-1 text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:o("com_auth_password_forgot")}),c.jsx("div",{className:"mt-6",children:c.jsx("button",{"aria-label":o("com_auth_continue"),"data-testid":"login-button",type:"submit",className:"\n            w-full rounded-2xl bg-green-600 px-4 py-3 text-sm font-medium text-white\n            transition-colors hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-700\n          ",children:o("com_auth_continue")})})]})]})};function Fb(){const e=kg(),{error:t,setError:n,login:a}=Wh(),{startupConfig:s}=pe();return c.jsxs(c.Fragment,{children:[null!=t&&c.jsx(Ob,{children:e(lm(t))}),!0===(null==s?void 0:s.emailLoginEnabled)&&c.jsx(Db,{onSubmit:a,startupConfig:s,error:t,setError:n}),!0===(null==s?void 0:s.registrationEnabled)&&c.jsxs("p",{className:"my-4 text-center text-sm font-light text-gray-700 dark:text-white",children:[" ",e("com_auth_no_account")," ",c.jsx("a",{href:"/register",className:"inline-flex p-1 text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:e("com_auth_sign_up")})]})]})}function zb({className:e=""}){return c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",xmlns:"http://www.w3.org/2000/svg",className:rm("lucide lucide-blocks",e),children:[c.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),c.jsx("path",{d:"M10 21V8a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H3"})]})}function Ub({className:e="",...t}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none",className:rm("h-4 w-4",e),width:"16",height:"16",strokeWidth:"2",...t,children:c.jsxs("g",{fill:"currentColor",children:[c.jsx("path",{d:"M13.164.98a.7.7 0 0 0-1.328 0l-.478 1.435a.7.7 0 0 1-.443.443l-1.436.478a.7.7 0 0 0 0 1.328l1.436.479a.7.7 0 0 1 .443.442l.478 1.436a.7.7 0 0 0 1.328 0l.478-1.436a.7.7 0 0 1 .443-.443l1.436-.478a.7.7 0 0 0 0-1.328l-1.436-.478a.7.7 0 0 1-.443-.443L13.164.979Z"}),c.jsx("path",{d:"M13.237 10.534c-.228-.245-.513-.46-.847-.46a.823.823 0 0 0-.828.849c.04 1.04.128 2.067.263 3.08a.619.619 0 0 1-.528.695c-.872.121-1.748.208-2.626.262a.8.8 0 0 1-.845-.805c0-.325.21-.602.45-.82.235-.215.375-.488.375-.787 0-.683-.738-1.237-1.65-1.237-.911 0-1.65.554-1.65 1.237 0 .294.137.563.364.775.245.229.461.513.461.848a.823.823 0 0 1-.85.829 33.809 33.809 0 0 1-3.266-.278.619.619 0 0 1-.532-.532 34.099 34.099 0 0 1-.278-3.267.823.823 0 0 1 .83-.85c.333 0 .619.216.846.461.212.228.482.364.776.364.683 0 1.237-.738 1.237-1.65 0-.91-.554-1.65-1.237-1.65-.299 0-.572.142-.786.376-.219.24-.496.45-.821.45a.8.8 0 0 1-.805-.845c.054-.885.142-1.76.262-2.626a.619.619 0 0 1 .695-.528c1.022.136 2.05.224 3.08.263a.822.822 0 0 0 .85-.828c0-.334-.217-.62-.462-.847-.227-.212-.363-.482-.363-.776C5.352 1.554 6.09 1 7.002 1c.91 0 1.649.554 1.649 1.237 0 .173-.012.327-.029.473C8.258 3 8 3.41 8 4c0 1.5 1.667 1.833 2.5 2 .167.833.5 2.5 2 2.5.732 0 1.186-.397 1.479-.9l.034-.001c.683 0 1.237.738 1.237 1.65 0 .911-.554 1.65-1.237 1.65-.294 0-.564-.137-.776-.364Z"})]})})}function Vb({size:e=25,className:t=""}){const n=e,a=e;return c.jsx("svg",{width:a,height:n,viewBox:"0 0 41 41",fill:"none",xmlns:"http://www.w3.org/2000/svg",strokeWidth:"1.5",className:rm(t,""),children:c.jsx("path",{d:"M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z",fill:"currentColor"})})}const Bb=_.forwardRef(((e,t)=>{const{className:n="icon-md",size:a="1.2em"}=e;return c.jsx("svg",{ref:t,fill:"none",strokeWidth:"2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",height:a,width:a,className:rm(n),children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.2929 4.29291C15.0641 2.52167 17.9359 2.52167 19.7071 4.2929C21.4783 6.06414 21.4783 8.93588 19.7071 10.7071L18.7073 11.7069L11.1603 19.2539C10.7182 19.696 10.1489 19.989 9.53219 20.0918L4.1644 20.9864C3.84584 21.0395 3.52125 20.9355 3.29289 20.7071C3.06453 20.4788 2.96051 20.1542 3.0136 19.8356L3.90824 14.4678C4.01103 13.8511 4.30396 13.2818 4.7461 12.8397L13.2929 4.29291ZM13 7.41422L6.16031 14.2539C6.01293 14.4013 5.91529 14.591 5.88102 14.7966L5.21655 18.7835L9.20339 18.119C9.40898 18.0847 9.59872 17.9871 9.7461 17.8397L16.5858 11L13 7.41422ZM18 9.5858L14.4142 6.00001L14.7071 5.70712C15.6973 4.71693 17.3027 4.71693 18.2929 5.70712C19.2831 6.69731 19.2831 8.30272 18.2929 9.29291L18 9.5858Z",fill:"currentColor"})})}));function $b({className:e="icon-sm"}){return c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.00633 5.5C6.02321 5.53319 6.07042 5.60366 6.19525 5.70906C6.42458 5.9027 6.81573 6.12215 7.38659 6.32603C8.5196 6.73067 10.1506 7 12 7C13.8494 7 15.4804 6.73067 16.6134 6.32603C17.1843 6.12215 17.5754 5.9027 17.8048 5.70906C17.9296 5.60366 17.9768 5.53319 17.9937 5.5C17.9768 5.46681 17.9296 5.39634 17.8048 5.29094C17.5754 5.0973 17.1843 4.87785 16.6134 4.67397C15.4804 4.26933 13.8494 4 12 4C10.1506 4 8.5196 4.26933 7.38659 4.67397C6.81573 4.87785 6.42458 5.0973 6.19525 5.29094C6.07042 5.39634 6.02321 5.46681 6.00633 5.5ZM18 7.91726C17.7726 8.02403 17.5333 8.12123 17.2861 8.20951C15.8856 8.70968 14.0166 9 12 9C9.98341 9 8.1144 8.70968 6.71392 8.20951C6.46674 8.12123 6.22738 8.02403 6 7.91726V11.9866C6.00813 12.0073 6.03931 12.0661 6.14259 12.1624C6.31976 12.3277 6.63181 12.5252 7.10609 12.7189C8.04837 13.1039 9.43027 13.3932 11.051 13.476C11.6026 13.5042 12.0269 13.9741 11.9987 14.5257C11.9705 15.0773 11.5005 15.5016 10.949 15.4734C9.17744 15.3829 7.55934 15.0646 6.34969 14.5704C6.23097 14.5219 6.11419 14.4709 6 14.4173V18.4866C6.00813 18.5073 6.03931 18.5661 6.14259 18.6624C6.31976 18.8277 6.63181 19.0252 7.10609 19.2189C8.04837 19.6039 9.43027 19.8932 11.051 19.976C11.6026 20.0042 12.0269 20.4741 11.9987 21.0257C11.9705 21.5773 11.5005 22.0016 10.949 21.9734C9.17744 21.8829 7.55934 21.5646 6.34969 21.0704C5.74801 20.8246 5.19611 20.5146 4.77833 20.1249C4.35948 19.7341 4 19.1866 4 18.5V5.5C4 4.74631 4.43048 4.16346 4.90494 3.76283C5.38405 3.35829 6.01803 3.03902 6.71392 2.79049C8.1144 2.29032 9.98341 2 12 2C14.0166 2 15.8856 2.29032 17.2861 2.79049C17.982 3.03902 18.616 3.35829 19.0951 3.76283C19.5695 4.16346 20 4.74631 20 5.5V10C20 10.5523 19.5523 11 19 11C18.4477 11 18 10.5523 18 10V7.91726ZM17.5 13C18.0523 13 18.5 13.4477 18.5 14V14.6707C18.851 14.7948 19.172 14.9823 19.4492 15.2195L20.0308 14.8837C20.5091 14.6075 21.1207 14.7714 21.3968 15.2497C21.673 15.728 21.5091 16.3396 21.0308 16.6157L20.4499 16.9511C20.4828 17.1291 20.5 17.3125 20.5 17.5C20.5 17.6873 20.4828 17.8707 20.45 18.0485L21.0308 18.3838C21.5091 18.6599 21.6729 19.2715 21.3968 19.7498C21.1206 20.2281 20.5091 20.392 20.0308 20.1158L19.4495 19.7803C19.1722 20.0176 18.8511 20.2052 18.5 20.3293V21C18.5 21.5523 18.0523 22 17.5 22C16.9477 22 16.5 21.5523 16.5 21V20.3293C16.1489 20.2052 15.8277 20.0176 15.5504 19.7802L14.969 20.1159C14.4907 20.392 13.8791 20.2282 13.603 19.7499C13.3269 19.2716 13.4907 18.66 13.969 18.3839L14.55 18.0484C14.5172 17.8706 14.5 17.6873 14.5 17.5C14.5 17.3127 14.5172 17.1294 14.55 16.9515L13.9691 16.6161C13.4908 16.34 13.3269 15.7284 13.6031 15.2501C13.8792 14.7718 14.4908 14.608 14.9691 14.8841L15.5504 15.2197C15.8278 14.9824 16.1489 14.7948 16.5 14.6707V14C16.5 13.4477 16.9477 13 17.5 13ZM16.624 17.0174C16.6274 17.0117 16.6308 17.0059 16.6342 17.0001C16.6374 16.9946 16.6405 16.989 16.6436 16.9834C16.8187 16.6937 17.1367 16.5 17.5 16.5C17.8645 16.5 18.1835 16.6951 18.3583 16.9865C18.3607 16.9909 18.3632 16.9953 18.3658 16.9997C18.3685 17.0044 18.3713 17.0091 18.3741 17.0138C18.4543 17.1577 18.5 17.3235 18.5 17.5C18.5 17.6737 18.4557 17.8371 18.3778 17.9794C18.3737 17.9861 18.3697 17.9929 18.3657 17.9998C18.3619 18.0064 18.3581 18.0131 18.3545 18.0198C18.1789 18.3077 17.8619 18.5 17.5 18.5C17.1362 18.5 16.8178 18.3058 16.6428 18.0154C16.64 18.0102 16.6371 18.005 16.6341 17.9999C16.631 17.9945 16.6278 17.9891 16.6246 17.9838C16.5452 17.8404 16.5 17.6755 16.5 17.5C16.5 17.325 16.545 17.1605 16.624 17.0174Z",fill:"currentColor"})})}function Hb({className:e="m-auto",size:t="1em"}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm("animate-spin",e),children:c.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})}function Gb({className:e="icon-md-heavy",size:t="1em"}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:t,width:t,fill:"none",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm(e),children:c.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z",clipRule:"evenodd"})})}function Kb({className:e=""}){return c.jsx("svg",{fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm("h-4 w-4",e),height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.0633 5.67375C18.5196 5.98487 18.6374 6.607 18.3262 7.06331L10.8262 18.0633C10.6585 18.3093 10.3898 18.4678 10.0934 18.4956C9.79688 18.5234 9.50345 18.4176 9.29289 18.2071L4.79289 13.7071C4.40237 13.3166 4.40237 12.6834 4.79289 12.2929C5.18342 11.9023 5.81658 11.9023 6.20711 12.2929L9.85368 15.9394L16.6738 5.93664C16.9849 5.48033 17.607 5.36263 18.0633 5.67375Z",fill:"currentColor"})})}function Wb({className:e=""}){return c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm(e,"h-4 w-4"),height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}function Qb({size:e=25,className:t=""}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm("lucide lucide-bot",t),children:[c.jsx("path",{d:"M12 8V4H8"}),c.jsx("rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}),c.jsx("path",{d:"M2 14h2"}),c.jsx("path",{d:"M20 14h2"}),c.jsx("path",{d:"M15 13v2"}),c.jsx("path",{d:"M9 13v2"})]})}function qb({className:e=""}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true",className:rm("h-6 w-6",e),children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"})})}function Zb({className:e=""}){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 7C9 4.23858 11.2386 2 14 2C16.7614 2 19 4.23858 19 7V15C19 18.866 15.866 22 12 22C8.13401 22 5 18.866 5 15V9C5 8.44772 5.44772 8 6 8C6.55228 8 7 8.44772 7 9V15C7 17.7614 9.23858 20 12 20C14.7614 20 17 17.7614 17 15V7C17 5.34315 15.6569 4 14 4C12.3431 4 11 5.34315 11 7V15C11 15.5523 11.4477 16 12 16C12.5523 16 13 15.5523 13 15V9C13 8.44772 13.4477 8 14 8C14.5523 8 15 8.44772 15 9V15C15 16.6569 13.6569 18 12 18C10.3431 18 9 16.6569 9 15V7Z",fill:"currentColor"})})}function Yb({className:e}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm(e??"","lucide lucide-messages-square"),children:[c.jsx("path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v5Z"}),c.jsx("path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1"})]})}function Jb({className:e="",size:t="1em"}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:t,width:t,fill:"none",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm("icon-md-heavy",e),children:c.jsx("path",{fill:"currentColor",d:"M3.07 10.876C3.623 6.436 7.41 3 12 3a9.15 9.15 0 0 1 6.012 2.254V4a1 1 0 1 1 2 0v4a1 1 0 0 1-1 1H15a1 1 0 1 1 0-2h1.957A7.15 7.15 0 0 0 12 5a7 7 0 0 0-6.946 6.124 1 1 0 1 1-1.984-.248m16.992 1.132a1 1 0 0 1 .868 1.116C20.377 17.564 16.59 21 12 21a9.15 9.15 0 0 1-6-2.244V20a1 1 0 1 1-2 0v-4a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2H7.043A7.15 7.15 0 0 0 12 19a7 7 0 0 0 6.946-6.124 1 1 0 0 1 1.116-.868"})})}function Xb({className:e=""}){return c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm("h-3 w-3 -rotate-180",e),height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("polygon",{points:"11 19 2 12 11 5 11 19"}),c.jsx("polygon",{points:"22 19 13 12 22 5 22 19"})]})}function ey(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",id:"google",className:"h-5 w-5",children:[c.jsx("path",{fill:"#fbbb00",d:"M113.47 309.408 95.648 375.94l-65.139 1.378C11.042 341.211 0 299.9 0 256c0-42.451 10.324-82.483 28.624-117.732h.014L86.63 148.9l25.404 57.644c-5.317 15.501-8.215 32.141-8.215 49.456.002 18.792 3.406 36.797 9.651 53.408z"}),c.jsx("path",{fill:"#518ef8",d:"M507.527 208.176C510.467 223.662 512 239.655 512 256c0 18.328-1.927 36.206-5.598 53.451-12.462 58.683-45.025 109.925-90.134 146.187l-.014-.014-73.044-3.727-10.338-64.535c29.932-17.554 53.324-45.025 65.646-77.911h-136.89V208.176h245.899z"}),c.jsx("path",{fill:"#28b446",d:"m416.253 455.624.014.014C372.396 490.901 316.666 512 256 512c-97.491 0-182.252-54.491-225.491-134.681l82.961-67.91c21.619 57.698 77.278 98.771 142.53 98.771 28.047 0 54.323-7.582 76.87-20.818l83.383 68.262z"}),c.jsx("path",{fill:"#f14336",d:"m419.404 58.936-82.933 67.896C313.136 112.246 285.552 103.82 256 103.82c-66.729 0-123.429 42.957-143.965 102.724l-83.397-68.276h-.014C71.23 56.123 157.06 0 256 0c62.115 0 119.068 22.126 163.404 58.936z"})]})}function ty(){return c.jsxs("svg",{viewBox:"0 0 40 40",width:"25",height:"25",children:[c.jsxs("linearGradient",{id:"a",x1:-277.375,x2:-277.375,y1:406.602,y2:407.573,gradientTransform:"matrix(40 0 0 -39.7778 11115.001 16212.334)",gradientUnits:"userSpaceOnUse",children:[c.jsx("stop",{offset:0,stopColor:"#0062e0"}),c.jsx("stop",{offset:1,stopColor:"#19afff"})]}),c.jsx("path",{fill:"url(#a)",d:"M16.7 39.8C7.2 38.1 0 29.9 0 20 0 9 9 0 20 0s20 9 20 20c0 9.9-7.2 18.1-16.7 19.8l-1.1-.9h-4.4l-1.1.9z"}),c.jsx("path",{fill:"#fff",d:"m27.8 25.6.9-5.6h-5.3v-3.9c0-1.6.6-2.8 3-2.8H29V8.2c-1.4-.2-3-.4-4.4-.4-4.6 0-7.8 2.8-7.8 7.8V20h-5v5.6h5v14.1c1.1.2 2.2.3 3.3.3 1.1 0 2.2-.1 3.3-.3V25.6h4.4z"})]})}function ny(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",id:"openid",className:"h-5 w-5",children:c.jsx("path",{fill:"currentColor",d:"M271.5 432l-68 32C88.5 453.7 0 392.5 0 318.2c0-71.5 82.5-131 191.7-144.3v43c-71.5 12.5-124 53-124 101.3 0 51 58.5 93.3 135.7 103v-340l68-33.2v384zM448 291l-131.3-28.5 36.8-20.7c-19.5-11.5-43.5-20-70-24.8v-43c46.2 5.5 87.7 19.5 120.3 39.3l35-19.8L448 291z"})})}function ay(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",fill:"none",children:c.jsx("path",{fill:"currentColor",d:"M12 0a12 12 0 0 0-3.84 23.399c.608.112.832-.256.832-.576v-2.015c-3.395.736-4.115-1.632-4.115-1.632a3.241 3.241 0 0 0-1.359-1.792c-1.104-.736.064-.736.064-.736a2.566 2.566 0 0 1 1.824 1.216a2.638 2.638 0 0 0 3.616 1.024a2.607 2.607 0 0 1 .768-1.6c-2.688-.32-5.504-1.344-5.504-5.984a4.677 4.677 0 0 1 1.216-3.168a4.383 4.383 0 0 1 .128-3.136s1.024-.32 3.36 1.216a11.66 11.66 0 0 1 6.112 0c2.336-1.536 3.36-1.216 3.36-1.216a4.354 4.354 0 0 1 .128 3.136a4.628 4.628 0 0 1 1.216 3.168c0 4.672-2.848 5.664-5.536 5.952a2.881 2.881 0 0 1 .832 2.24v3.36c0 .32.224.672.832.576A12 12 0 0 0 12 0z"})})}function sy(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",id:"discord",className:"h-6 w-6",children:[c.jsx("circle",{cx:"512",cy:"512",r:"512",fill:"#5865f2"}),c.jsx("path",{fill:"#fff",d:"M689.43 349a422.21 422.21 0 0 0-104.22-32.32 1.58 1.58 0 0 0-1.68.79 294.11 294.11 0 0 0-13 26.66 389.78 389.78 0 0 0-117.05 0 269.75 269.75 0 0 0-13.18-26.66 1.64 1.64 0 0 0-1.68-.79A421 421 0 0 0 334.44 349a1.49 1.49 0 0 0-.69.59c-66.37 99.17-84.55 195.9-75.63 291.41a1.76 1.76 0 0 0 .67 1.2 424.58 424.58 0 0 0 127.85 64.63 1.66 1.66 0 0 0 1.8-.59 303.45 303.45 0 0 0 26.15-42.54 1.62 1.62 0 0 0-.89-2.25 279.6 279.6 0 0 1-39.94-19 1.64 1.64 0 0 1-.16-2.72c2.68-2 5.37-4.1 7.93-6.22a1.58 1.58 0 0 1 1.65-.22c83.79 38.26 174.51 38.26 257.31 0a1.58 1.58 0 0 1 1.68.2c2.56 2.11 5.25 4.23 8 6.24a1.64 1.64 0 0 1-.14 2.72 262.37 262.37 0 0 1-40 19 1.63 1.63 0 0 0-.87 2.28 340.72 340.72 0 0 0 26.13 42.52 1.62 1.62 0 0 0 1.8.61 423.17 423.17 0 0 0 128-64.63 1.64 1.64 0 0 0 .67-1.18c10.68-110.44-17.88-206.38-75.7-291.42a1.3 1.3 0 0 0-.63-.63zM427.09 582.85c-25.23 0-46-23.16-46-51.6s20.38-51.6 46-51.6c25.83 0 46.42 23.36 46 51.6.02 28.44-20.37 51.6-46 51.6zm170.13 0c-25.23 0-46-23.16-46-51.6s20.38-51.6 46-51.6c25.83 0 46.42 23.36 46 51.6.01 28.44-20.17 51.6-46 51.6z"})]})}function ry(){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"0 0 814 1000",id:"apple",className:"h-6 w-6",children:c.jsx("path",{d:"M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z",fill:"currentColor"})})}function oy({size:e=25,className:t=""}){return c.jsxs("svg",{viewBox:"0 0 24 16",overflow:"visible",width:e,height:e,className:rm("fill-current text-black",t),children:[c.jsx("g",{style:{transform:"translateX(13px) rotateZ(0deg)",transformOrigin:"4.775px 7.73501px"},children:c.jsx("path",{shapeRendering:"geometricPrecision",fillOpacity:"1",d:" M0,0 C0,0 6.1677093505859375,15.470022201538086 6.1677093505859375,15.470022201538086 C6.1677093505859375,15.470022201538086 9.550004005432129,15.470022201538086 9.550004005432129,15.470022201538086 C9.550004005432129,15.470022201538086 3.382294178009033,0 3.382294178009033,0 C3.382294178009033,0 0,0 0,0 C0,0 0,0 0,0z"})}),c.jsx("g",{style:{transform:"none",transformOrigin:"7.935px 7.73501px"},opacity:"1",children:c.jsx("path",{shapeRendering:"geometricPrecision",fillOpacity:"1",d:" M5.824605464935303,9.348296165466309 C5.824605464935303,9.348296165466309 7.93500280380249,3.911694288253784 7.93500280380249,3.911694288253784 C7.93500280380249,3.911694288253784 10.045400619506836,9.348296165466309 10.045400619506836,9.348296165466309 C10.045400619506836,9.348296165466309 5.824605464935303,9.348296165466309 5.824605464935303,9.348296165466309 C5.824605464935303,9.348296165466309 5.824605464935303,9.348296165466309 5.824605464935303,9.348296165466309z M6.166755199432373,0 C6.166755199432373,0 0,15.470022201538086 0,15.470022201538086 C0,15.470022201538086 3.4480772018432617,15.470022201538086 3.4480772018432617,15.470022201538086 C3.4480772018432617,15.470022201538086 4.709278583526611,12.22130012512207 4.709278583526611,12.22130012512207 C4.709278583526611,12.22130012512207 11.16093635559082,12.22130012512207 11.16093635559082,12.22130012512207 C11.16093635559082,12.22130012512207 12.421928405761719,15.470022201538086 12.421928405761719,15.470022201538086 C12.421928405761719,15.470022201538086 15.87000560760498,15.470022201538086 15.87000560760498,15.470022201538086 C15.87000560760498,15.470022201538086 9.703250885009766,0 9.703250885009766,0 C9.703250885009766,0 6.166755199432373,0 6.166755199432373,0 C6.166755199432373,0 6.166755199432373,0 6.166755199432373,0z"})})]})}function iy({size:e=24,className:t=""}){return c.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",className:rm("text-white dark:text-black",t),children:c.jsx("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function ly(){return c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 5C14.4477 5 14 4.55228 14 4C14 3.44772 14.4477 3 15 3H20C20.5523 3 21 3.44772 21 4V9C21 9.55228 20.5523 10 20 10C19.4477 10 19 9.55228 19 9V6.41421L13.7071 11.7071C13.3166 12.0976 12.6834 12.0976 12.2929 11.7071C11.9024 11.3166 11.9024 10.6834 12.2929 10.2929L17.5858 5H15ZM4 7C4 5.34315 5.34315 4 7 4H10C10.5523 4 11 4.44772 11 5C11 5.55228 10.5523 6 10 6H7C6.44772 6 6 6.44772 6 7V17C6 17.5523 6.44772 18 7 18H17C17.5523 18 18 17.5523 18 17V14C18 13.4477 18.4477 13 19 13C19.5523 13 20 13.4477 20 14V17C20 18.6569 18.6569 20 17 20H7C5.34315 20 4 18.6569 4 17V7Z",fill:"currentColor"})})}const cy=({className:e=""})=>c.jsxs("svg",{className:e,width:"17",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M11.6439 3C10.9352 3 10.2794 3.37508 9.92002 3.98596L9.49644 4.70605C8.96184 5.61487 7.98938 6.17632 6.93501 6.18489L6.09967 6.19168C5.39096 6.19744 4.73823 6.57783 4.38386 7.19161L4.02776 7.80841C3.67339 8.42219 3.67032 9.17767 4.01969 9.7943L4.43151 10.5212C4.95127 11.4386 4.95127 12.5615 4.43151 13.4788L4.01969 14.2057C3.67032 14.8224 3.67339 15.5778 4.02776 16.1916L4.38386 16.8084C4.73823 17.4222 5.39096 17.8026 6.09966 17.8083L6.93502 17.8151C7.98939 17.8237 8.96185 18.3851 9.49645 19.294L9.92002 20.014C10.2794 20.6249 10.9352 21 11.6439 21H12.3561C13.0648 21 13.7206 20.6249 14.08 20.014L14.5035 19.294C15.0381 18.3851 16.0106 17.8237 17.065 17.8151L17.9004 17.8083C18.6091 17.8026 19.2618 17.4222 19.6162 16.8084L19.9723 16.1916C20.3267 15.5778 20.3298 14.8224 19.9804 14.2057L19.5686 13.4788C19.0488 12.5615 19.0488 11.4386 19.5686 10.5212L19.9804 9.7943C20.3298 9.17767 20.3267 8.42219 19.9723 7.80841L19.6162 7.19161C19.2618 6.57783 18.6091 6.19744 17.9004 6.19168L17.065 6.18489C16.0106 6.17632 15.0382 5.61487 14.5036 4.70605L14.08 3.98596C13.7206 3.37508 13.0648 3 12.3561 3H11.6439Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),c.jsx("circle",{cx:"12",cy:"12",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]});function dy({unpin:e=!1}){return e?c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-sm",children:[c.jsx("path",{d:"M15 15V17.5585C15 18.4193 14.4491 19.1836 13.6325 19.4558L13.1726 19.6091C12.454 19.8487 11.6616 19.6616 11.126 19.126L4.87403 12.874C4.33837 12.3384 4.15132 11.546 4.39088 10.8274L4.54415 10.3675C4.81638 9.55086 5.58066 9 6.44152 9H9M12 6.2L13.6277 3.92116C14.3461 2.91549 15.7955 2.79552 16.6694 3.66942L20.3306 7.33058C21.2045 8.20448 21.0845 9.65392 20.0788 10.3723L18 11.8571",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M8 16L3 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M4 4L20 20",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}):c.jsx("svg",{className:"icon-sm",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.4845 2.8798C16.1773 1.57258 14.0107 1.74534 12.9272 3.24318L9.79772 7.56923C9.60945 7.82948 9.30775 7.9836 8.98654 7.9836H6.44673C3.74061 7.9836 2.27414 11.6759 4.16948 13.5713L6.59116 15.993L2.29324 20.2909C1.90225 20.6819 1.90225 21.3158 2.29324 21.7068C2.68422 22.0977 3.31812 22.0977 3.70911 21.7068L8.00703 17.4088L10.4287 19.8305C12.3241 21.7259 16.0164 20.2594 16.0164 17.5533V15.0135C16.0164 14.6923 16.1705 14.3906 16.4308 14.2023L20.7568 11.0728C22.2547 9.98926 22.4274 7.8227 21.1202 6.51549L17.4845 2.8798ZM11.8446 18.4147C12.4994 19.0694 14.0141 18.4928 14.0141 17.5533V15.0135C14.0141 14.0499 14.4764 13.1447 15.2572 12.58L19.5832 9.45047C20.0825 9.08928 20.1401 8.3671 19.7043 7.93136L16.0686 4.29567C15.6329 3.85993 14.9107 3.91751 14.5495 4.4168L11.4201 8.74285C10.8553 9.52359 9.95016 9.98594 8.98654 9.98594H6.44673C5.5072 9.98594 4.93059 11.5006 5.58535 12.1554L11.8446 18.4147Z",fill:"currentColor"})})}function uy({className:e=""}){return c.jsx("svg",{fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm("icon-md h-4 w-4",e),height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5555 4C10.099 4 9.70052 4.30906 9.58693 4.75114L9.29382 5.8919H14.715L14.4219 4.75114C14.3083 4.30906 13.9098 4 13.4533 4H10.5555ZM16.7799 5.8919L16.3589 4.25342C16.0182 2.92719 14.8226 2 13.4533 2H10.5555C9.18616 2 7.99062 2.92719 7.64985 4.25342L7.22886 5.8919H4C3.44772 5.8919 3 6.33961 3 6.8919C3 7.44418 3.44772 7.8919 4 7.8919H4.10069L5.31544 19.3172C5.47763 20.8427 6.76455 22 8.29863 22H15.7014C17.2354 22 18.5224 20.8427 18.6846 19.3172L19.8993 7.8919H20C20.5523 7.8919 21 7.44418 21 6.8919C21 6.33961 20.5523 5.8919 20 5.8919H16.7799ZM17.888 7.8919H6.11196L7.30423 19.1057C7.3583 19.6142 7.78727 20 8.29863 20H15.7014C16.2127 20 16.6417 19.6142 16.6958 19.1057L17.888 7.8919ZM10 10C10.5523 10 11 10.4477 11 11V16C11 16.5523 10.5523 17 10 17C9.44772 17 9 16.5523 9 16V11C9 10.4477 9.44772 10 10 10ZM14 10C14.5523 10 15 10.4477 15 11V16C15 16.5523 14.5523 17 14 17C13.4477 17 13 16.5523 13 16V11C13 10.4477 13.4477 10 14 10Z",fill:"currentColor"})})}function my({size:e,className:t="icon-md"}){return c.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.4646 19C15.2219 20.6961 13.7632 22 12 22C10.2368 22 8.77806 20.6961 8.53544 19H6C4.34315 19 3 17.6569 3 16V13.5C3 12.9477 3.44772 12.5 4 12.5H4.5C5.32843 12.5 6 11.8284 6 11C6 10.1716 5.32843 9.5 4.5 9.5H4C3.44772 9.5 3 9.05229 3 8.5L3 6C3 4.34315 4.34315 3 6 3L18 3C19.6569 3 21 4.34315 21 6L21 16C21 17.6569 19.6569 19 18 19H15.4646ZM12 20C12.8284 20 13.5 19.3284 13.5 18.5V18C13.5 17.4477 13.9477 17 14.5 17H18C18.5523 17 19 16.5523 19 16L19 6C19 5.44772 18.5523 5 18 5L6 5C5.44772 5 5 5.44772 5 6V7.53544C6.69615 7.77806 8 9.23676 8 11C8 12.7632 6.69615 14.2219 5 14.4646L5 16C5 16.5523 5.44771 17 6 17H9.5C10.0523 17 10.5 17.4477 10.5 18V18.5C10.5 19.3284 11.1716 20 12 20Z",fill:"currentColor"})})}function py({size:e=25,className:t="h-4 w-4"}){const n=e,a=e;return c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:rm(t,""),width:a,height:n,xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"m8.0458 0.81981a1.1197 1.1197 0 0 0-1.0608 0.76184l-6.7912 20.123a1.1178 1.1178 0 0 0 1.0592 1.4751h5.4647a1.1197 1.1197 0 0 0 1.0608-0.7615l1.3528-4.0084-2.3684-2.2107a0.51536 0.51536 0 0 1 0.35193-0.8923h3.0639l1.8213-5.3966-2.8111-8.3294a1.1181 1.1181 0 0 0-1.0595-0.76049h-0.0836z"}),c.jsx("path",{d:"m7.1147 15.307a0.51536 0.51536 0 0 0-0.35193 0.8923l7.1552 6.6782a1.1248 1.1248 0 0 0 0.76724 0.30238h0.2417a1.1181 1.1181 0 0 0 1.0534-1.4755l-2.1591-6.3974z"}),c.jsx("path",{d:"m17.015 1.5807a1.1178 1.1178 0 0 0-1.0593-0.76049h-7.8258a1.1181 1.1181 0 0 1 1.0593 0.76049l6.7916 20.123a1.1181 1.1181 0 0 1-1.0593 1.4757h7.8261a1.1181 1.1181 0 0 0 1.059-1.4757z"})]})}function gy({className:e="h-4 w-4"}){return c.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"1",viewBox:"0 0 40 40",strokeLinecap:"round",strokeLinejoin:"round",className:e,height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{d:"M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z"})})}function fy({size:e=25,className:t=""}){return c.jsxs("svg",{width:e,height:e,className:t,viewBox:"0 0 19 17",fill:"none",preserveAspectRatio:"xMidYMid meet",focusable:"false",children:[c.jsx("path",{d:"M9.62674 16.2202H9.7049C10.4225 16.2202 11.0016 15.6412 11.0016 14.9236V4.04224H8.33008V14.92C8.33008 15.6376 8.90914 16.2202 9.62674 16.2202Z",fill:"#F9AB00"}),c.jsx("path",{d:"M14.6819 8.02813C13.3249 6.66752 11.2964 6.39398 9.66577 7.2004L15.0585 12.5931C15.2823 12.8169 15.6624 12.7281 15.7583 12.4297C16.2308 10.927 15.8756 9.21822 14.6819 8.02813Z",fill:"#5BB974"}),c.jsx("path",{d:"M4.64953 8.02813C6.00659 6.66752 8.03507 6.39398 9.66567 7.2004L4.27297 12.5931C4.04916 12.8169 3.66904 12.7281 3.57312 12.4297C3.10064 10.927 3.45589 9.21822 4.64953 8.02813Z",fill:"#129EAF"}),c.jsx("path",{d:"M14.284 3.84326C12.1383 3.84326 10.3159 5.25005 9.66577 7.20038H18.1918C18.5399 7.20038 18.7744 6.83092 18.6145 6.5183C17.8081 4.93033 16.1704 3.84326 14.284 3.84326Z",fill:"#AF5CF7"}),c.jsx("path",{d:"M10.5574 1.55901C9.04053 3.07593 8.74567 5.36019 9.66577 7.20039L15.6944 1.17179C15.943 0.923113 15.8436 0.496814 15.5132 0.390239C13.8151 -0.1604 11.8896 0.226822 10.5574 1.55901Z",fill:"#FF8BCB"}),c.jsx("path",{d:"M8.77408 1.55901C10.291 3.07593 10.5859 5.36019 9.66576 7.20039L3.63716 1.17179C3.38848 0.923113 3.48795 0.496814 3.81833 0.390239C5.51643 -0.1604 7.44189 0.226822 8.77408 1.55901Z",fill:"#FA7B17"}),c.jsx("path",{d:"M5.04752 3.84326C7.19323 3.84326 9.01566 5.25005 9.66577 7.20038H1.13976C0.791616 7.20038 0.55715 6.83092 0.717013 6.5183C1.52343 4.93033 3.16114 3.84326 5.04752 3.84326Z",fill:"#4285F4"})]})}function xy({size:e=25,className:t=""}){return c.jsx("svg",{width:e,height:e,className:rm("dark:fill-white",t),viewBox:"0 0 18 18",preserveAspectRatio:"xMidYMid meet",focusable:"false",children:c.jsx("path",{d:"M2 4.006C2 2.898 2.897 2 4.006 2h9.988C15.102 2 16 2.897 16 4.006v9.988A2.005 2.005 0 0 1 13.994 16H4.006A2.005 2.005 0 0 1 2 13.994V4.006zM13.992 9l.003-.003L10.997 6 9.75 7.247 11.503 9 9.75 10.753 10.997 12l2.997-2.997L13.992 9zm-9.99 0L4 8.997 6.997 6l1.247 1.247L6.492 9l1.753 1.753L6.997 12 4 9.003 4.003 9z",fillRule:"evenodd"})})}function hy({size:e=25,className:t=""}){return c.jsxs("svg",{width:e,height:e,className:t,viewBox:"0 0 18 18",preserveAspectRatio:"xMidYMid meet",focusable:"false",children:[c.jsx("path",{fill:"url(#_4rif_paint0_radial_897_42)",d:"M9 18c0-1.245-.24-2.415-.72-3.51a8.934 8.934 0 00-1.912-2.857A8.934 8.934 0 003.51 9.72 8.646 8.646 0 000 9a8.886 8.886 0 003.51-.697 9.247 9.247 0 002.857-1.936A8.934 8.934 0 008.28 3.51C8.76 2.415 9 1.245 9 0c0 1.245.232 2.415.697 3.51a9.247 9.247 0 001.936 2.857 9.247 9.247 0 002.857 1.936A8.886 8.886 0 0018 9c-1.245 0-2.415.24-3.51.72a8.934 8.934 0 00-2.857 1.912 9.247 9.247 0 00-1.935 2.858A8.886 8.886 0 009 18z"}),c.jsx("defs",{children:c.jsxs("radialGradient",{id:"_4rif_paint0_radial_897_42",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"rotate(135 9 3.728) scale(25.4558 12.7279)",children:[c.jsx("stop",{offset:".325",stopColor:"#FFDDB7"}),c.jsx("stop",{offset:".706",stopColor:"#076EFF"})]})})]})}function vy({className:e=""}){return c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",width:"800px",height:"800px",viewBox:"0 0 512 512",className:rm("h-4 w-4",e),children:c.jsx("path",{d:"M473.16,221.48l-2.26-9.59H262.46v88.22H387c-12.93,61.4-72.93,93.72-121.94,93.72-35.66,0-73.25-15-98.13-39.11a140.08,140.08,0,0,1-41.8-98.88c0-37.16,16.7-74.33,41-98.78s61-38.13,97.49-38.13c41.79,0,71.74,22.19,82.94,32.31l62.69-62.36C390.86,72.72,340.34,32,261.6,32h0c-60.75,0-119,23.27-161.58,65.71C58,139.5,36.25,199.93,36.25,256S56.83,369.48,97.55,411.6C141.06,456.52,202.68,480,266.13,480c57.73,0,112.45-22.62,151.45-63.66,38.34-40.4,58.17-96.3,58.17-154.9C475.75,236.77,473.27,222.12,473.16,221.48Z"})})}function by({className:e}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:rm(e),strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}),c.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),c.jsx("line",{x1:"12",x2:"12",y1:"19",y2:"22"})]})}function yy({className:e="",size:t="1em"}){return c.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",height:t,width:t,className:rm(e),children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 4.9099C11 4.47485 10.4828 4.24734 10.1621 4.54132L6.67572 7.7372C6.49129 7.90626 6.25019 8.00005 6 8.00005H4C3.44772 8.00005 3 8.44776 3 9.00005V15C3 15.5523 3.44772 16 4 16H6C6.25019 16 6.49129 16.0938 6.67572 16.2629L10.1621 19.4588C10.4828 19.7527 11 19.5252 11 19.0902V4.9099ZM8.81069 3.06701C10.4142 1.59714 13 2.73463 13 4.9099V19.0902C13 21.2655 10.4142 22.403 8.81069 20.9331L5.61102 18H4C2.34315 18 1 16.6569 1 15V9.00005C1 7.34319 2.34315 6.00005 4 6.00005H5.61102L8.81069 3.06701ZM20.3166 6.35665C20.8019 6.09313 21.409 6.27296 21.6725 6.75833C22.5191 8.3176 22.9996 10.1042 22.9996 12.0001C22.9996 13.8507 22.5418 15.5974 21.7323 17.1302C21.4744 17.6185 20.8695 17.8054 20.3811 17.5475C19.8927 17.2896 19.7059 16.6846 19.9638 16.1962C20.6249 14.9444 20.9996 13.5175 20.9996 12.0001C20.9996 10.4458 20.6064 8.98627 19.9149 7.71262C19.6514 7.22726 19.8312 6.62017 20.3166 6.35665ZM15.7994 7.90049C16.241 7.5688 16.8679 7.65789 17.1995 8.09947C18.0156 9.18593 18.4996 10.5379 18.4996 12.0001C18.4996 13.3127 18.1094 14.5372 17.4385 15.5604C17.1357 16.0222 16.5158 16.1511 16.0539 15.8483C15.5921 15.5455 15.4632 14.9255 15.766 14.4637C16.2298 13.7564 16.4996 12.9113 16.4996 12.0001C16.4996 10.9859 16.1653 10.0526 15.6004 9.30063C15.2687 8.85905 15.3578 8.23218 15.7994 7.90049Z",fill:"currentColor"})})}function _y({className:e="",size:t="1em"}){return c.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",height:t,width:t,className:rm(e),children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM9.5 8.5C8.94772 8.5 8.5 8.94772 8.5 9.5V14.5C8.5 15.0523 8.94772 15.5 9.5 15.5H14.5C15.0523 15.5 15.5 15.0523 15.5 14.5V9.5C15.5 8.94772 15.0523 8.5 14.5 8.5H9.5Z",fill:"currentColor"})})}function jy(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}function wy({className:e=""}){return c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:rm("text-black dark:text-white",e),"aria-hidden":!0,children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7929 2.79289C18.0118 1.57394 19.9882 1.57394 21.2071 2.79289C22.4261 4.01184 22.4261 5.98815 21.2071 7.20711L12.7071 15.7071C12.5196 15.8946 12.2652 16 12 16H9C8.44772 16 8 15.5523 8 15V12C8 11.7348 8.10536 11.4804 8.29289 11.2929L16.7929 2.79289ZM19.7929 4.20711C19.355 3.7692 18.645 3.7692 18.2071 4.2071L10 12.4142V14H11.5858L19.7929 5.79289C20.2308 5.35499 20.2308 4.64501 19.7929 4.20711ZM6 5C5.44772 5 5 5.44771 5 6V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V14C19 13.4477 19.4477 13 20 13C20.5523 13 21 13.4477 21 14V18C21 19.6569 19.6569 21 18 21H6C4.34315 21 3 19.6569 3 18V6C3 4.34314 4.34315 3 6 3H10C10.5523 3 11 3.44771 11 4C11 4.55228 10.5523 5 10 5H6Z",fill:"currentColor"})})}function Ny(){return c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-sm",children:[c.jsx("path",{d:"M9 3H15M9 3V9.2759C9 9.74377 8.83597 10.1968 8.53644 10.5563L4.85085 14.979C4.30108 15.6387 4 16.4703 4 17.3291V17.3291C4 19.3565 5.64353 21 7.67094 21H16.3291C18.3565 21 20 19.3565 20 17.3291V17.3291C20 16.4703 19.6989 15.6387 19.1492 14.979L15.4636 10.5563C15.164 10.1968 15 9.74377 15 9.2759V3M9 3H8M15 3H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M5 14.774C11.5 12.839 12.15 16.7089 18 14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Cy({className:e=""}){return c.jsxs("svg",{version:"1.1",viewBox:"0 0 233.33 290",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:rm("h-11 w-11",e),children:[c.jsx("defs",{children:c.jsxs("linearGradient",{id:"linearGradient1842",x1:"163.92",x2:"173.66",y1:"22.212",y2:"-6.5784",gradientTransform:"translate(.10391 .050143)",gradientUnits:"userSpaceOnUse",children:[c.jsx("stop",{stopColor:"#640a62",offset:"0"}),c.jsx("stop",{stopColor:"#852283",offset:".49917"}),c.jsx("stop",{stopColor:"#640a62",offset:"1"})]})}),c.jsxs("g",{children:[c.jsx("path",{transform:"matrix(.43416 .90084 -.89966 .4366 0 0)",d:"m259.29-126.03a232.2 237.56 0 0 1-17.412 231.34l-193.32-131.59z",fill:"url(#linearGradient1842)"}),c.jsx("path",{transform:"matrix(.6967 .051926 -.051926 .6967 35.578 23.196)",d:"m50.818 31.415c-1.4654 2.4749-10.838 2.4195-12.997 4.3204-2.1584 1.9009-3.288 11.206-5.9282 12.347-2.6402 1.1409-10.191-4.4132-13.054-4.1441-2.8636 0.26917-9.2466 7.133-12.053 6.5041-2.8066-0.62889-5.6503-9.5602-8.1252-11.026-2.4749-1.4654-11.673 0.33572-13.574-1.8227s1.0482-11.056-0.0927-13.696c-1.1409-2.6402-9.6412-6.5898-9.9104-9.4533-0.26917-2.8636 7.3463-8.328 7.9752-11.135 0.62889-2.8066-3.9265-10.998-2.4612-13.473 1.4654-2.4749 10.838-2.4195 12.997-4.3204 2.1584-1.9009 3.288-11.206 5.9282-12.347 2.6402-1.1409 10.191 4.4132 13.054 4.1441 2.8636-0.26917 9.2466-7.133 12.053-6.5041 2.8066 0.62889 5.6503 9.5602 8.1252 11.026s11.673-0.33572 13.574 1.8227c1.9009 2.1584-1.0482 11.056 0.0927 13.696 1.1409 2.6402 9.6412 6.5898 9.9104 9.4533 0.26917 2.8635-7.3463 8.328-7.9752 11.135-0.62889 2.8066 3.9265 10.998 2.4612 13.473z",fill:"#ff9d78",stroke:"#f29472",strokeWidth:"4.7877"}),c.jsx("circle",{cx:"170.36",cy:"215.76",r:"12.903",fill:"#cfffff"}),c.jsx("path",{d:"m220.77 174.77c-88.526 101.03-191.21 85.731-209.5 82.142-2.2101-2e-5 -2.6686 0.42426-3.437 2.0021l-1.7042 7.5028c0.056197 2.3603 0.37544 2.6428 1.9121 3.5409 18.396 3.3746 130.27 19.488 223.46-86.881 0.64011-1.5095 0.46653-3.1324-0.59137-4.7337l-5.1558-3.6482c-1.586-0.8743-3.9524-0.94332-4.9837 0.0751z",color:"#000000",fill:"#ff9d78",stroke:"#f29472",strokeLinejoin:"round",strokeWidth:"2.8913"}),c.jsxs("g",{fill:"#cfffff",children:[c.jsx("circle",{cx:"72.684",cy:"99.47",r:"12.903"}),c.jsx("circle",{cx:"99.144",cy:"172.32",r:"12.903"}),c.jsx("circle",{cx:"59.617",cy:"214.78",r:"12.903"}),c.jsx("circle",{cx:"135.4",cy:"118.42",r:"12.903"}),c.jsx("path",{transform:"rotate(38.66)",d:"m254.21-1.9608a12.903 12.903 0 0 1-6.4852 11.194 12.903 12.903 0 0 1-12.937-0.0582 12.903 12.903 0 0 1-6.3843-11.252l12.903 0.1161z"}),c.jsx("path",{d:"m29.476 158.16a12.903 12.903 0 0 0-3.6562 0.5293l-3.3691 23.189a12.903 12.903 0 0 0 7.0254 2.0879 12.903 12.903 0 0 0 12.904-12.904 12.903 12.903 0 0 0-12.904-12.902z"})]})]})]})}function ky({className:e="",size:t="1em"}){const n=t,a=t;return c.jsxs("svg",{width:a,height:n,viewBox:"0 0 24 24",stroke:"currentColor",fill:"none",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm("text-token-secondary h-2/3 w-2/3",e),xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),c.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),c.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]})}function Sy({className:e="",size:t=24}){return c.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:rm("icon-md shrink-0",e),children:[c.jsx("path",{d:"M19.3975 1.35498C19.3746 1.15293 19.2037 1.00021 19.0004 1C18.7971 0.999793 18.6259 1.15217 18.6026 1.35417C18.4798 2.41894 18.1627 3.15692 17.6598 3.65983C17.1569 4.16274 16.4189 4.47983 15.3542 4.60264C15.1522 4.62593 14.9998 4.79707 15 5.00041C15.0002 5.20375 15.1529 5.37457 15.355 5.39746C16.4019 5.51605 17.1562 5.83304 17.6716 6.33906C18.1845 6.84269 18.5078 7.57998 18.6016 8.63539C18.6199 8.84195 18.7931 9.00023 19.0005 9C19.2078 8.99977 19.3806 8.84109 19.3985 8.6345C19.4883 7.59673 19.8114 6.84328 20.3273 6.32735C20.8433 5.81142 21.5967 5.48834 22.6345 5.39851C22.8411 5.38063 22.9998 5.20782 23 5.00045C23.0002 4.79308 22.842 4.61992 22.6354 4.60157C21.58 4.50782 20.8427 4.18447 20.3391 3.67157C19.833 3.15623 19.516 2.40192 19.3975 1.35498Z",fill:"currentColor"}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 3C11.4833 3 11.8974 3.34562 11.9839 3.82111C12.4637 6.46043 13.279 8.23983 14.5196 9.48039C15.7602 10.721 17.5396 11.5363 20.1789 12.0161C20.6544 12.1026 21 12.5167 21 13C21 13.4833 20.6544 13.8974 20.1789 13.9839C17.5396 14.4637 15.7602 15.279 14.5196 16.5196C13.279 17.7602 12.4637 19.5396 11.9839 22.1789C11.8974 22.6544 11.4833 23 11 23C10.5167 23 10.1026 22.6544 10.0161 22.1789C9.53625 19.5396 8.72096 17.7602 7.48039 16.5196C6.23983 15.279 4.46043 14.4637 1.82111 13.9839C1.34562 13.8974 1 13.4833 1 13C1 12.5167 1.34562 12.1026 1.82111 12.0161C4.46043 11.5363 6.23983 10.721 7.48039 9.48039C8.72096 8.23983 9.53625 6.46043 10.0161 3.82111C10.1026 3.34562 10.5167 3 11 3ZM5.66618 13C6.9247 13.5226 7.99788 14.2087 8.89461 15.1054C9.79134 16.0021 10.4774 17.0753 11 18.3338C11.5226 17.0753 12.2087 16.0021 13.1054 15.1054C14.0021 14.2087 15.0753 13.5226 16.3338 13C15.0753 12.4774 14.0021 11.7913 13.1054 10.8946C12.2087 9.99788 11.5226 8.9247 11 7.66618C10.4774 8.9247 9.79134 9.99788 8.89461 10.8946C7.99788 11.7913 6.9247 12.4774 5.66618 13Z",fill:"currentColor"})]})}function Ty({className:e}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm(e),children:[c.jsx("path",{d:"M2 10v3"}),c.jsx("path",{d:"M6 6v11"}),c.jsx("path",{d:"M10 3v18"}),c.jsx("path",{d:"M14 8v7"}),c.jsx("path",{d:"M18 5v13"}),c.jsx("path",{d:"M22 10v3"})]})}function Ry({size:e="1em",className:t}){return c.jsx("svg",{viewBox:"64 64 896 896",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:t,width:e,height:e,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"})})}function Iy({className:e="icon-md-heavy",size:t="1em"}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",height:t,width:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:rm(e),children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),c.jsx("path",{d:"M12 17h.01"})]})}function Ey({size:e=25,className:t=""}){return c.jsx("svg",{width:e,height:e,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:rm("fill-current text-black",t),children:c.jsx("g",{fill:"currentColor",children:c.jsx("path",{d:"M12,18.1397014 L9.574,18.9487014 L8.628,18.3177014 L9.658,17.9737014 L9.342,17.0257014 L7.574,17.6147014 L7,17.2327014 L7,14.4997014 C7,14.3107014 6.893,14.1377014 6.724,14.0527014 L5,13.1907014 L5,10.8087014 L6.5,10.0587014 L8,10.8087014 L8,12.4997014 C8,12.6897014 8.107,12.8627014 8.276,12.9477014 L10.276,13.9477014 L10.724,13.0527014 L9,12.1907014 L9,10.8087014 L10.724,9.94770136 C10.893,9.86270136 11,9.68970136 11,9.49970136 L11,7.99970136 L10,7.99970136 L10,9.19070136 L8.5,9.94070136 L7,9.19070136 L7,6.76770136 L8,6.10070136 L8,7.99970136 L9,7.99970136 L9,5.43470136 L9.574,5.05170136 L12,5.86070136 L12,18.1397014 Z M17.5,16.9997014 C17.775,16.9997014 18,17.2237014 18,17.4997014 C18,17.7757014 17.775,17.9997014 17.5,17.9997014 C17.225,17.9997014 17,17.7757014 17,17.4997014 C17,17.2237014 17.225,16.9997014 17.5,16.9997014 L17.5,16.9997014 Z M16.5,5.99970136 C16.775,5.99970136 17,6.22370136 17,6.49970136 C17,6.77570136 16.775,6.99970136 16.5,6.99970136 C16.225,6.99970136 16,6.77570136 16,6.49970136 C16,6.22370136 16.225,5.99970136 16.5,5.99970136 L16.5,5.99970136 Z M18.5,11.9997014 C18.775,11.9997014 19,12.2237014 19,12.4997014 C19,12.7757014 18.775,12.9997014 18.5,12.9997014 C18.225,12.9997014 18,12.7757014 18,12.4997014 C18,12.2237014 18.225,11.9997014 18.5,11.9997014 L18.5,11.9997014 Z M17.092,12.9997014 C17.299,13.5807014 17.849,13.9997014 18.5,13.9997014 C19.327,13.9997014 20,13.3277014 20,12.4997014 C20,11.6727014 19.327,10.9997014 18.5,10.9997014 C17.849,10.9997014 17.299,11.4197014 17.092,11.9997014 L13,11.9997014 L13,9.99970136 L16.5,9.99970136 C16.776,9.99970136 17,9.77670136 17,9.49970136 L17,7.90770136 C17.581,7.70070136 18,7.15070136 18,6.49970136 C18,5.67270136 17.327,4.99970136 16.5,4.99970136 C15.673,4.99970136 15,5.67270136 15,6.49970136 C15,7.15070136 15.419,7.70070136 16,7.90770136 L16,8.99970136 L13,8.99970136 L13,5.49970136 C13,5.28470136 12.862,5.09370136 12.658,5.02570136 L9.658,4.02570136 C9.511,3.97670136 9.351,3.99870136 9.223,4.08370136 L6.223,6.08370136 C6.084,6.17670136 6,6.33270136 6,6.49970136 L6,9.19070136 L4.276,10.0527014 C4.107,10.1377014 4,10.3107014 4,10.4997014 L4,13.4997014 C4,13.6897014 4.107,13.8627014 4.276,13.9477014 L6,14.8087014 L6,17.4997014 C6,17.6667014 6.084,17.8237014 6.223,17.9157014 L9.223,19.9157014 C9.306,19.9717014 9.402,19.9997014 9.5,19.9997014 C9.553,19.9997014 9.606,19.9917014 9.658,19.9737014 L12.658,18.9737014 C12.862,18.9067014 13,18.7157014 13,18.4997014 L13,15.9997014 L15.293,15.9997014 L16.146,16.8537014 L16.159,16.8407014 C16.061,17.0407014 16,17.2627014 16,17.4997014 C16,18.3267014 16.673,18.9997014 17.5,18.9997014 C18.327,18.9997014 19,18.3267014 19,17.4997014 C19,16.6727014 18.327,15.9997014 17.5,15.9997014 C17.262,15.9997014 17.04,16.0607014 16.841,16.1597014 L16.854,16.1467014 L15.854,15.1467014 C15.76,15.0527014 15.633,14.9997014 15.5,14.9997014 L13,14.9997014 L13,12.9997014 L17.092,12.9997014 Z"})})})}const Py=()=>{const e=D(),t=kg(),{startupConfig:a,startupConfigError:s,isFetching:r}=pe(),{watch:o,register:i,handleSubmit:l,formState:{errors:d}}=ne({mode:"onChange"}),u=o("password"),[m,p]=n.useState(""),[g,f]=n.useState(!1),[x,h]=n.useState(3),v=z(),b=new URLSearchParams(v.search).get("token"),y=(_={onMutate:()=>{f(!0)},onSuccess:()=>{f(!1),h(3);const t=setInterval((()=>{h((n=>n<=1?(clearInterval(t),e("/c/new",{replace:!0}),0):n-1))}),1e3)},onError:e=>{var t,n,a,s;f(!1),(null==(n=null==(t=e.response)?void 0:t.data)?void 0:n.message)&&p((null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.message)??"")}},j=ar(),sr((function(e){return function(e){return nh.post("/api/auth/register",e)}(e)}),$g($g({},_),{onSuccess:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];j.invalidateQueries([ah.user]),(null==_?void 0:_.onSuccess)&&_.onSuccess.apply(_,e)}})));var _,j;const w=(e,n,a,s)=>{var r;return c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:e,type:a,autoComplete:e,"aria-label":t(n),...i(e,s),"aria-invalid":!!d[e],className:"\n            webkit-dark-styles transition-color peer w-full rounded-2xl border border-border-light\n            bg-surface-primary px-3.5 pb-2.5 pt-3 text-text-primary duration-200 focus:border-green-500 focus:outline-none\n          ",placeholder:" ","data-testid":e}),c.jsx("label",{htmlFor:e,className:"\n            absolute start-3 top-1.5 z-10 origin-[0] -translate-y-4 scale-75 transform bg-surface-primary px-2 text-sm text-text-secondary-alt duration-200\n            peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100\n            peer-focus:top-1.5 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-green-500\n            rtl:peer-focus:left-auto rtl:peer-focus:translate-x-1/4\n          ",children:t(n)})]}),d[e]&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500",children:String(null==(r=d[e])?void 0:r.message)??""})]})};return c.jsxs(c.Fragment,{children:[m&&c.jsxs(Ob,{children:[t("com_auth_error_create")," ",m]}),y.isSuccess&&x>0&&c.jsx("div",{className:"rounded-md border border-green-500 bg-green-500/10 px-3 py-2 text-sm text-gray-600 dark:text-gray-200",role:"alert",children:t((null==a?void 0:a.emailEnabled)?"com_auth_registration_success_generic":"com_auth_registration_success_insecure")+" "+t("com_auth_email_verification_redirecting",{0:x.toString()})}),!s&&!r&&c.jsxs(c.Fragment,{children:[c.jsxs("form",{className:"mt-6","aria-label":"Registration form",method:"POST",onSubmit:l((e=>y.mutate({...e,token:b??void 0}))),children:[w("name","com_auth_full_name","text",{required:t("com_auth_name_required"),minLength:{value:3,message:t("com_auth_name_min_length")},maxLength:{value:80,message:t("com_auth_name_max_length")}}),w("username","com_auth_username","text",{minLength:{value:2,message:t("com_auth_username_min_length")},maxLength:{value:80,message:t("com_auth_username_max_length")}}),w("email","com_auth_email","email",{required:t("com_auth_email_required"),minLength:{value:1,message:t("com_auth_email_min_length")},maxLength:{value:120,message:t("com_auth_email_max_length")},pattern:{value:/\S+@\S+\.\S+/,message:t("com_auth_email_pattern")}}),w("password","com_auth_password","password",{required:t("com_auth_password_required"),minLength:{value:8,message:t("com_auth_password_min_length")},maxLength:{value:128,message:t("com_auth_password_max_length")}}),w("confirm_password","com_auth_password_confirm","password",{validate:e=>e===u||t("com_auth_password_not_match")}),c.jsx("div",{className:"mt-6",children:c.jsx("button",{disabled:Object.keys(d).length>0,type:"submit","aria-label":"Submit registration",className:"\n            w-full rounded-2xl bg-green-600 px-4 py-3 text-sm font-medium text-white\n            transition-colors hover:bg-green-700 focus:outline-none focus:ring-2\n            focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50\n            disabled:hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700\n          ",children:g?c.jsx(Hb,{}):t("com_auth_continue")})})]}),c.jsxs("p",{className:"my-4 text-center text-sm font-light text-gray-700 dark:text-white",children:[t("com_auth_already_have_account")," ",c.jsx("a",{href:"/login","aria-label":"Login",className:"inline-flex p-1 text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:t("com_auth_login")})]})]})]})};function Ly(){const e=kg(),{register:t,handleSubmit:n,watch:a,formState:{errors:s}}=ne(),r=D(),[o]=Z(),i=a("password"),l=sr((function(e){return function(e){return nh.post("/api/auth/resetPassword",e)}(e)})),{setError:d,setHeaderText:u}=pe();return l.isSuccess?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"relative mb-8 mt-4 rounded-2xl border border-green-400 bg-green-100 px-4 py-3 text-center text-green-700 dark:bg-gray-900 dark:text-white",role:"alert",children:e("com_auth_login_with_new_password")}),c.jsx("button",{onClick:()=>r("/login"),"aria-label":e("com_auth_sign_in"),className:"w-full transform rounded-2xl bg-green-500 px-4 py-3 tracking-wide text-white transition-colors duration-200 hover:bg-green-600 focus:bg-green-600 focus:outline-none",children:e("com_auth_continue")})]}):c.jsxs("form",{className:"mt-6","aria-label":"Password reset form",method:"POST",onSubmit:n((e=>{l.mutate(e,{onError:()=>{d("com_auth_error_invalid_reset_token")},onSuccess:()=>{u("com_auth_reset_password_success")}})})),children:[c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"hidden",id:"token",value:o.get("token")??"",...t("token",{required:"Unable to process: No valid reset token"})}),c.jsx("input",{type:"hidden",id:"userId",value:o.get("userId")??"",...t("userId",{required:"Unable to process: No valid user id"})}),c.jsx("input",{type:"password",id:"password",autoComplete:"current-password","aria-label":e("com_auth_password"),...t("password",{required:e("com_auth_password_required"),minLength:{value:8,message:e("com_auth_password_min_length")},maxLength:{value:128,message:e("com_auth_password_max_length")}}),"aria-invalid":!!s.password,className:"\n              webkit-dark-styles transition-color peer w-full rounded-2xl border border-border-light\n              bg-surface-primary px-3.5 pb-2.5 pt-3 text-text-primary duration-200 focus:border-green-500 focus:outline-none\n           ",placeholder:" "}),c.jsx("label",{htmlFor:"password",className:"\n              absolute start-3 top-1.5 z-10 origin-[0] -translate-y-4 scale-75 transform bg-surface-primary px-2 text-sm text-text-secondary-alt duration-200\n              peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100\n              peer-focus:top-1.5 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-green-500\n              rtl:peer-focus:left-auto rtl:peer-focus:translate-x-1/4\n          ",children:e("com_auth_password")})]}),s.password&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500 dark:text-red-900",children:s.password.message})]}),c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"password",id:"confirm_password","aria-label":e("com_auth_password_confirm"),...t("confirm_password",{validate:t=>t===i||e("com_auth_password_not_match")}),"aria-invalid":!!s.confirm_password,className:"\n            webkit-dark-styles transition-color peer w-full rounded-2xl border border-border-light\n            bg-surface-primary px-3.5 pb-2.5 pt-3 text-text-primary duration-200 focus:border-green-500 focus:outline-none\n            ",placeholder:" "}),c.jsx("label",{htmlFor:"confirm_password",className:"\n              absolute start-3 top-1.5 z-10 origin-[0] -translate-y-4 scale-75 transform bg-surface-primary px-2 text-sm text-text-secondary-alt duration-200\n              peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100\n              peer-focus:top-1.5 peer-focus:-translate-y-4 peer-focus:scale-75 peer-focus:px-2 peer-focus:text-green-500\n              rtl:peer-focus:left-auto rtl:peer-focus:translate-x-1/4\n            ",children:e("com_auth_password_confirm")})]}),s.confirm_password&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500 dark:text-red-900",children:s.confirm_password.message}),s.token&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500 dark:text-red-900",children:s.token.message}),s.userId&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-500 dark:text-red-900",children:s.userId.message})]}),c.jsx("div",{className:"mt-6",children:c.jsx("button",{disabled:!!s.password||!!s.confirm_password,type:"submit","aria-label":e("com_auth_submit_registration"),className:"\n            w-full rounded-2xl bg-green-600 px-4 py-3 text-sm font-medium text-white\n            transition-colors hover:bg-green-700 focus:outline-none focus:ring-2\n            focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50\n            disabled:hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700\n          ",children:e("com_auth_continue")})})]})}const My=({className:e="",children:t,...n})=>c.jsx(Ia,{className:rm(e),...n,children:c.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:t})});My.displayName=Ia.displayName;const Ay=n.forwardRef((({className:e="",...t},n)=>c.jsx(Na,{className:rm("fixed inset-0 z-50 bg-gray-500/90 transition-opacity animate-in fade-in dark:bg-gray-800/90",e),...t,ref:n})));Ay.displayName=Na.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsxs(My,{children:[c.jsx(Ay,{}),c.jsx(Ca,{ref:n,className:rm("fixed z-50 grid w-full max-w-lg scale-100 gap-4 bg-white p-6 opacity-100 animate-in fade-in-90 slide-in-from-bottom-10 sm:rounded-lg sm:zoom-in-90 sm:slide-in-from-bottom-0 md:w-full","dark:bg-gray-900",e),...t})]}))).displayName=Ca.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(ka,{ref:n,className:rm("text-lg font-semibold text-gray-900","dark:text-gray-50",e),...t}))).displayName=ka.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Sa,{ref:n,className:rm("text-sm text-gray-500","dark:text-gray-400",e),...t}))).displayName=Sa.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Ta,{ref:n,className:rm("inline-flex h-10 items-center justify-center rounded-md bg-gray-900 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-gray-100 dark:text-gray-900 dark:hover:bg-gray-100 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900",e),...t}))).displayName=Ta.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Ra,{ref:n,className:rm("mt-2 inline-flex h-10 items-center justify-center rounded-md border border-gray-200 bg-transparent px-4 py-2 text-sm font-semibold text-gray-900 transition-colors hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:text-gray-100 dark:hover:bg-gray-800 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900 sm:mt-0",e),...t}))).displayName=Ra.displayName;const Oy=n.forwardRef((({...e},t)=>c.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e})));Oy.displayName="Breadcrumb";const Dy=n.forwardRef((({className:e,...t},n)=>c.jsx("ol",{ref:n,className:rm("text-muted-foreground flex flex-wrap items-center gap-1.5 break-words text-sm sm:gap-2.5",e),...t})));Dy.displayName="BreadcrumbList";const Fy=n.forwardRef((({className:e,...t},n)=>c.jsx("li",{ref:n,className:rm("inline-flex items-center gap-1.5",e),...t})));Fy.displayName="BreadcrumbItem";const zy=n.forwardRef((({asChild:e,className:t,...n},a)=>{const s=e?Ea:"a";return c.jsx(s,{ref:a,className:rm("hover:text-foreground transition-colors",t),...n})}));zy.displayName="BreadcrumbLink";n.forwardRef((({className:e,...t},n)=>c.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:rm("text-foreground font-normal",e),...t}))).displayName="BreadcrumbPage";const Uy=({children:e,className:t,...n})=>c.jsx("li",{role:"presentation","aria-hidden":"true",className:rm("[&>svg]:size-3.5",t),...n,children:e??c.jsx(ge,{})});Uy.displayName="BreadcrumbSeparator";const Vy=fe("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-surface-destructive text-destructive-foreground hover:bg-surface-destructive-hover",outline:"text-text-primary border border-border-light bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",submit:"bg-surface-submit text-white hover:bg-surface-submit-hover"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-lg px-8",icon:"size-10"}},defaultVariants:{variant:"default",size:"default"}}),By=n.forwardRef((({className:e,variant:t,size:n,asChild:a=!1,...s},r)=>{const o=a?Ea:"button";return c.jsx(o,{className:rm(Vy({variant:t,size:n,className:e})),ref:r,...s})}));By.displayName="Button";const $y=n.forwardRef((({className:e="",...t},n)=>c.jsx(Pa,{ref:n,className:rm("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:c.jsx(La,{className:rm("flex items-center justify-center"),children:c.jsx(xe,{className:"h-4 w-4"})})})));$y.displayName=Pa.displayName;const Hy=Ha,Gy=Ga,Ky=Ka;n.forwardRef((({className:e="",inset:t,children:n,...a},s)=>c.jsxs(Ma,{ref:s,className:rm("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm font-medium outline-none focus:bg-gray-100 data-[state=open]:bg-gray-100 dark:focus:bg-gray-900 dark:data-[state=open]:bg-gray-900",t?"pl-8":"",e),...a,children:[n,c.jsx(ge,{className:"ml-auto h-4 w-4"})]}))).displayName=Ma.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Aa,{ref:n,className:rm("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-100 bg-white p-1 text-gray-700 shadow-md animate-in slide-in-from-left-1 dark:border-gray-800 dark:bg-gray-800 dark:text-gray-400",e),...t}))).displayName=Aa.displayName;const Wy=n.forwardRef((({className:e="",sideOffset:t=4,...n},a)=>c.jsx(Oa,{children:c.jsx(Da,{ref:a,sideOffset:t,className:rm("z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-100 bg-white p-1 text-gray-700 shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-800 dark:bg-gray-800 dark:text-gray-400",e),...n})})));Wy.displayName=Da.displayName;const Qy=n.forwardRef((({className:e="",inset:t,...n},a)=>c.jsx(Fa,{ref:a,className:rm("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm font-medium outline-none focus:bg-gray-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-900",t?"pl-8":"",e),...n})));Qy.displayName=Fa.displayName;const qy=n.forwardRef((({className:e="",children:t,checked:n,...a},s)=>c.jsxs(za,{ref:s,className:rm("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm font-medium outline-none focus:bg-gray-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-900",e),checked:n,...a,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Ua,{children:c.jsx(xe,{className:"h-4 w-4"})})}),t]})));qy.displayName=za.displayName;n.forwardRef((({className:e="",children:t,...n},a)=>c.jsxs(Va,{ref:a,className:rm(e,"relative flex cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm font-medium outline-none focus:bg-gray-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-gray-800"),...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Ua,{children:c.jsx(he,{className:"h-2 w-2 fill-current"})})}),t]}))).displayName=Va.displayName;n.forwardRef((({className:e="",inset:t,...n},a)=>c.jsx(Ba,{ref:a,className:rm("px-2 py-1.5 text-sm font-semibold text-gray-900 dark:text-gray-300",t?"pl-8":"",e),...n}))).displayName=Ba.displayName;const Zy=n.forwardRef((({className:e="",...t},n)=>c.jsx($a,{ref:n,className:rm("-mx-1 my-1 h-px bg-border-medium",e),...t})));Zy.displayName=$a.displayName;const Yy=Xa,Jy=es,Xy=({className:e="",children:t,...n})=>c.jsx(Wa,{className:rm(e),...n,children:c.jsx("div",{className:"fixed inset-0 z-[999] flex items-start justify-center sm:items-center",children:t})});Xy.displayName=Wa.displayName;const e_=n.forwardRef((({className:e,...t},n)=>c.jsx(Qa,{className:rm("fixed inset-0 z-[999] bg-gray-600/65 transition-all duration-100 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=open]:fade-in dark:bg-black/80",e??""),...t,ref:n})));e_.displayName=Qa.displayName;const t_=n.forwardRef((({className:e,children:t=!0,showCloseButton:n=!0,disableScroll:a=!1,...s},r)=>{const o=Ib("(max-width: 768px)");return c.jsxs(Xy,{children:[c.jsx(e_,{}),c.jsxs(qa,{ref:r,className:rm("fixed z-[999] grid w-full gap-4 rounded-b-lg bg-white pb-6 animate-in data-[state=open]:fade-in-90 data-[state=open]:slide-in-from-bottom-10 sm:rounded-lg","dark:bg-gray-700",o?"fixed left-1/2 top-1/2 z-[999] m-auto grid w-11/12 -translate-x-1/2 -translate-y-1/2 gap-4 rounded-xl bg-white pb-6":"",a?"overflow-hidden":"",e??""),...s,children:[t,n&&c.jsxs(Za,{className:"absolute right-6 top-[1.6rem] rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100 dark:focus:ring-white dark:focus:ring-offset-gray-700 dark:data-[state=open]:bg-gray-800",children:[c.jsx(ve,{className:"h-5 w-5 text-black dark:text-white"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}));t_.displayName=qa.displayName;const n_=({className:e,...t})=>c.jsx("div",{className:rm("flex flex-col space-y-2 border-b border-black/10 p-6 pb-4 text-left dark:border-white/10",e??""),...t});n_.displayName="DialogHeader";const a_=({className:e,...t})=>c.jsx("div",{className:rm("flex flex-row justify-between space-x-2 px-6 py-4",e??""),...t});a_.displayName="DialogFooter";const s_=n.forwardRef((({className:e,...t},n)=>c.jsx(Ya,{ref:n,className:rm("text-lg font-semibold text-gray-900","dark:text-gray-50",e??""),...t})));s_.displayName=Ya.displayName;const r_=n.forwardRef((({className:e,...t},n)=>c.jsx(Ja,{ref:n,className:rm("text-sm text-gray-500","dark:text-gray-400",e??""),...t})));r_.displayName=Ja.displayName;const o_=n.forwardRef((({className:e,...t},n)=>c.jsx(Za,{ref:n,className:rm("mt-2 inline-flex h-10 items-center justify-center rounded-lg border border-gray-200 bg-transparent px-4 py-2 text-sm font-semibold text-gray-900 transition-colors hover:bg-gray-100 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:text-gray-100 dark:hover:bg-gray-800 sm:mt-0",e??"","focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900"),...t})));o_.displayName=Ya.displayName;const i_=n.forwardRef((({className:e,...t},n)=>c.jsx(By,{ref:n,variant:"outline",className:rm("mt-2 inline-flex h-10 items-center justify-center rounded-lg border border-gray-200 bg-transparent px-4 py-2 text-sm font-semibold text-gray-900 transition-colors hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:text-gray-100 dark:hover:bg-gray-800 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900 sm:mt-0",e??"","focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900"),...t})));i_.displayName=Ya.displayName;const l_=ns,c_=as,d_=ss,u_=n.forwardRef((({className:e="",align:t="center",sideOffset:n=6,disabled:a=!1,...s},r)=>a?null:c.jsx(ts,{ref:r,align:t,sideOffset:n,className:rm("z-50 w-64 rounded-md border border-none bg-surface-tertiary p-4 shadow-md outline-none animate-in fade-in-0",e),...s})));u_.displayName=ts.displayName;const m_=n.forwardRef((({className:e,...t},n)=>c.jsx("input",{className:rm("flex h-10 w-full rounded-lg border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",e??""),ref:n,...t})));m_.displayName="Input";const p_=n.forwardRef((({className:e,...t},n)=>c.jsx(be,{className:rm("flex max-h-5 w-full rounded-md border border-gray-300 bg-transparent px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:text-gray-50",e??""),ref:n,...t})));p_.displayName="Input";const g_=n.forwardRef((({className:e="",...t},n)=>c.jsx(rs,{ref:n,className:rm("block w-full break-all text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-200",e),...t})));g_.displayName=rs.displayName;const f_=n.forwardRef((({children:e,triggerRef:t,onOpenChange:n,...a})=>c.jsx(Xa,{...a,onOpenChange:e=>{!e&&(null==t?void 0:t.current)&&setTimeout((()=>{var e;null==(e=t.current)||e.focus()}),0),null==n||n(e)},children:e}))),x_=es,h_=Wa,v_=Za,b_=n.forwardRef((({className:e,...t},n)=>c.jsx(Qa,{ref:n,className:rm("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t})));b_.displayName=Qa.displayName;const y_=n.forwardRef((({className:e,overlayClassName:t,showCloseButton:n=!0,children:a,...s},r)=>c.jsxs(h_,{children:[c.jsx(b_,{className:t}),c.jsxs(qa,{ref:r,className:rm("max-w-11/12 fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 rounded-2xl bg-background p-6 text-text-primary shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",e),...s,children:[a,n&&c.jsxs(Za,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-ring-primary ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(ve,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]})));y_.displayName=qa.displayName;const __=({className:e,...t})=>c.jsx("div",{className:rm("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});__.displayName="DialogHeader";const j_=({className:e,...t})=>c.jsx("div",{className:rm("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});j_.displayName="DialogFooter";const w_=n.forwardRef((({className:e,...t},n)=>c.jsx(Ya,{ref:n,className:rm("text-lg font-semibold leading-none tracking-tight",e),...t})));w_.displayName=Ya.displayName;const N_=n.forwardRef((({className:e,...t},n)=>c.jsx(Ja,{ref:n,className:rm("text-sm text-muted-foreground",e),...t})));N_.displayName=Ja.displayName;const C_=n.forwardRef((({className:e,onDoubleClick:t,...n},a)=>c.jsxs(os,{ref:a,className:rm("relative flex w-full cursor-pointer touch-none select-none items-center",e),onDoubleClick:t,...n,children:[c.jsx(is,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:c.jsx(ls,{className:"absolute h-full bg-primary"})}),c.jsx(cs,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})));C_.displayName=os.displayName;const k_=n.forwardRef((({className:e="",orientation:t="horizontal",decorative:n=!0,...a},s)=>c.jsx(ds,{ref:s,decorative:n,orientation:t,className:rm("shrink-0 bg-border-light","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...a})));k_.displayName=ds.displayName;const S_=({label:e,labelClassName:t,placeholder:n="Select an option",options:a,className:s,value:r,onChange:o,onBlur:i})=>{const l=e=>null!=e&&"object"==typeof e&&"value"in e,[d,u]=_.useState(!1),[m,p]=_.useState(r),[g,f]=_.useState(!1);_.useEffect((()=>{p(r)}),[r]);const x=e=>{p(e),o(e)};return c.jsxs(ye,{value:m,setValue:x,children:[null!=e&&c.jsx(_e,{className:rm("mb-2 block text-sm font-medium text-text-primary",t??""),children:e}),c.jsx("div",{className:rm("relative",g?"rounded-md ring-2 ring-ring-primary":""),children:c.jsx(je,{placeholder:n,className:rm("h-10 w-full rounded-md border border-border-light bg-surface-primary px-3 py-2 text-sm","placeholder-text-secondary hover:bg-surface-hover","focus:outline-none",s),onChange:e=>x(e.target.value),onBlur:()=>{f(!1),i()},onFocusVisible:()=>{f(!0),u(!0)},onMouseDown:()=>{f(!1)}})}),c.jsx(we,{gutter:4,sameWidth:!0,open:d,onClose:()=>u(!1),className:rm("z-50 max-h-60 w-full overflow-auto rounded-md bg-surface-primary p-1 shadow-lg","animate-in fade-in-0 zoom-in-95"),children:a.map(((e,t)=>c.jsxs(Ne,{className:rm("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none","cursor-pointer hover:bg-surface-tertiary hover:text-text-primary","data-[active-item]:bg-surface-tertiary data-[active-item]:text-text-primary"),value:l(e)?`${e.value??""}`:e,children:[l(e)&&null!=e.icon&&c.jsx("span",{className:"mr-2 flex-shrink-0",children:e.icon}),l(e)?e.label:e]},t)))})]})};function T_({className:e,...t}){return c.jsx("div",{className:rm("animate-pulse rounded-md bg-surface-tertiary opacity-50 dark:opacity-25",e),...t})}const R_=n.forwardRef((({className:e,...t},n)=>c.jsx(us,{className:rm("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-unchecked",e),...t,ref:n,children:c.jsx(ms,{className:rm("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})));R_.displayName=us.displayName;const I_=n.forwardRef((({className:e,...t},n)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:n,className:rm("w-full caption-bottom text-sm",e),...t})})));I_.displayName="Table";const E_=n.forwardRef((({className:e,...t},n)=>c.jsx("thead",{ref:n,className:rm("[&_tr]:border-b",e),...t})));E_.displayName="TableHeader";const P_=n.forwardRef((({className:e,...t},n)=>c.jsx("tbody",{ref:n,className:rm("[&_tr:last-child]:border-0",e),...t})));P_.displayName="TableBody";n.forwardRef((({className:e,...t},n)=>c.jsx("tfoot",{ref:n,className:rm("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",e),...t}))).displayName="TableFooter";const L_=n.forwardRef((({className:e,...t},n)=>c.jsx("tr",{ref:n,className:rm("hover:bg-muted/50 data-[state=selected]:bg-muted border-b border-border-light transition-colors",e),...t})));L_.displayName="TableRow";const M_=n.forwardRef((({className:e,...t},n)=>c.jsx("th",{ref:n,className:rm("text-muted-foreground h-12 px-4 text-left align-middle font-medium [&:has([role=checkbox])]:pr-0",e),...t})));M_.displayName="TableHead";const A_=n.forwardRef((({className:e,...t},n)=>c.jsx("td",{ref:n,className:rm("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t})));A_.displayName="TableCell";n.forwardRef((({className:e,...t},n)=>c.jsx("caption",{ref:n,className:rm("text-muted-foreground mt-4 text-sm",e),...t}))).displayName="TableCaption";n.forwardRef((({className:e="",...t},n)=>c.jsx(ps,{ref:n,className:rm("inline-flex items-center justify-center rounded-md bg-surface-primary",e),...t}))).displayName=ps.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(gs,{className:rm("inline-flex min-w-[100px] items-center justify-center rounded-[0.185rem] px-3 py-1.5 text-sm font-medium text-gray-700 transition-all disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-800 data-[state=active]:shadow-sm dark:data-[state=active]:bg-gray-700 dark:data-[state=active]:text-gray-200",e),...t,ref:n}))).displayName=gs.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(fs,{className:rm("mt-2 rounded-md p-6",e),...t,ref:n}))).displayName=fs.displayName;const O_=n.forwardRef((({CancelButton:e,LabelNode:t,label:n,onRemove:a,className:s="",labelClassName:r="",...o},i)=>c.jsxs("div",{ref:i,...o,className:rm("flex max-h-8 items-center overflow-y-hidden rounded-3xl border-2 border-green-600 bg-green-600/20 text-xs text-green-600 dark:text-white",s),children:[c.jsxs("div",{className:rm("ml-1 whitespace-pre-wrap px-2 py-1",r),children:[t?c.jsxs(c.Fragment,{children:[t," "]}):null,n]}),e||a&&c.jsx("button",{onClick:e=>{e.stopPropagation(),a(e)},className:"rounded-full bg-green-600/50","aria-label":`Remove ${n}`,children:c.jsx(ve,{className:"m-[1.5px] p-1"})})]})));O_.displayName="Tag";const D_=n.memo(O_);n.forwardRef((({className:e="",...t},n)=>c.jsx("textarea",{className:rm("flex h-20 w-full resize-none rounded-md border border-gray-300 bg-transparent px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:text-gray-50 dark:focus:ring-gray-400 dark:focus:ring-offset-gray-900",e),ref:n,...t}))).displayName="Textarea";const F_=n.forwardRef(((e,t)=>{const[,a]=n.useState(!1),s=I(_p.chatDirection).toLowerCase();return n.useLayoutEffect((()=>a(!0)),[]),c.jsx(Ce,{dir:s,...e,ref:t})})),z_=n.forwardRef((function({description:e,side:t="top",className:a,role:s,...r},o){const i=ke({placement:t}),l=Se(i,(e=>e.mounted)),d=Se(i,(e=>e.placement)),{x:u,y:m}=n.useMemo((()=>{switch(d.split("-")[0]){case"top":return{x:0,y:-8};case"bottom":return{x:0,y:8};case"left":return{x:-8,y:0};case"right":return{x:8,y:0};default:return{x:0,y:0}}}),[d]);return c.jsxs(Te,{store:i,hideTimeout:0,children:[c.jsx(Re,{...r,ref:o,role:s,onKeyDown:e=>{"button"===s&&"Enter"===e.key&&(e.preventDefault(),e.target.click())},className:rm("cursor-pointer",a)}),c.jsx(hr,{children:!0===l&&c.jsxs(Ie,{gutter:4,alwaysVisible:!0,className:"tooltip",render:c.jsx(vr.div,{initial:{opacity:0,x:u,y:m},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:u,y:m}}),children:[c.jsx(Ee,{}),e]})})]})}));n.forwardRef((({className:e,...t},n)=>c.jsx("ul",{ref:n,className:rm("flex flex-row items-center gap-1",e),...t}))).displayName="PaginationContent";n.forwardRef((({className:e,...t},n)=>c.jsx("li",{ref:n,className:rm("",e),...t}))).displayName="PaginationItem";const U_=n.forwardRef((({className:e,value:t,...n},a)=>c.jsx(xs,{ref:a,className:rm("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:c.jsx(hs,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})));U_.displayName=xs.displayName;const V_=n.forwardRef((({className:e,containerClassName:t,...n},a)=>c.jsx(Pe,{ref:a,containerClassName:rm("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:rm("disabled:cursor-not-allowed",e),...n})));V_.displayName="InputOTP";const B_=n.forwardRef((({className:e,...t},n)=>c.jsx("div",{ref:n,className:rm("flex items-center",e),...t})));B_.displayName="InputOTPGroup";const $_=n.forwardRef((({index:e,className:t,...a},s)=>{const r=n.useContext(Le),{char:o,hasFakeCaret:i,isActive:l}=r.slots[e];return c.jsxs("div",{ref:s,className:rm("text-md relative flex h-11 w-11 items-center justify-center border-y border-r border-input shadow-sm transition-all first:rounded-l-xl first:border-l last:rounded-r-xl",l&&"z-10 ring-1 ring-ring",t),...a,children:[o,i&&c.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:c.jsx("div",{className:"animate-caret-blink h-4 w-px bg-foreground duration-1000"})})]})}));$_.displayName="InputOTPSlot";const H_=n.forwardRef((({...e},t)=>c.jsx("div",{ref:t,role:"separator",...e,children:c.jsx(Me,{})})));H_.displayName="InputOTPSeparator";n.forwardRef((({className:e="",children:t,...n},a)=>c.jsxs(vs,{ref:a,className:rm("border-input ring-offset-background placeholder:text-muted-foreground flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-gray-200 bg-transparent px-3 py-2 text-sm shadow-sm focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-600 [&>span]:line-clamp-1","rounded-lg hover:bg-gray-100/50 dark:hover:bg-gray-700",e),...n,children:[t,c.jsx(bs,{asChild:!0,children:c.jsx(ys,{className:"h-4 w-4 opacity-50"})})]}))).displayName=vs.displayName;const G_=n.forwardRef((({className:e="",...t},n)=>c.jsx(_s,{ref:n,className:rm("flex cursor-default items-center justify-center py-1 dark:text-white",e),...t,children:c.jsx(js,{})})));G_.displayName=_s.displayName;const K_=n.forwardRef((({className:e="",...t},n)=>c.jsx(ws,{ref:n,className:rm("flex cursor-default items-center justify-center py-1 dark:text-white",e),...t,children:c.jsx(Ns,{})})));K_.displayName=ws.displayName;n.forwardRef((({className:e="",children:t,position:n="popper",...a},s)=>c.jsx(Cs,{children:c.jsxs(ks,{ref:s,className:rm("bg-popover text-popover-foreground relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-gray-600","popper"===n?"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1":"",e),position:n,...a,children:[c.jsx(G_,{}),c.jsx(Ss,{className:rm("p-1","popper"===n?"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]":""),children:t}),c.jsx(K_,{})]})}))).displayName=ks.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Ts,{ref:n,className:rm("px-2 py-1.5 text-sm font-semibold",e),...t}))).displayName=Ts.displayName;n.forwardRef((({className:e="",children:t,...n},a)=>c.jsxs(Rs,{ref:a,className:rm("focus:bg-accent focus:text-accent-foreground relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50","rounded-lg hover:bg-gray-100/50 dark:hover:bg-gray-700",e),...n,children:[c.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(Is,{children:c.jsx(Es,{className:"h-4 w-4"})})}),c.jsx(Ps,{children:t})]}))).displayName=Rs.displayName;n.forwardRef((({className:e="",...t},n)=>c.jsx(Ls,{ref:n,className:rm("bg-muted -mx-1 my-1 h-px",e),...t}))).displayName=Ls.displayName;const W_=e=>"object"==typeof e&&"divider"in e,Q_=e=>"object"==typeof e&&"value"in e&&"label"in e,q_=({value:e,label:t="",onChange:n,options:a,className:s="",sizeClasses:r,testId:o="dropdown-menu",icon:i,iconOnly:l=!1,renderValue:d,ariaLabel:u,portal:m=!0})=>{const p=Ae({value:e,setValue:e=>{n(e)}}),g=e=>{if(null!=e&&""!==e)return a.filter((e=>!W_(e))).map((e=>"string"==typeof e?{value:e,label:e}:e)).find((t=>Q_(t)&&t.value===e))};return c.jsxs("div",{className:rm("relative",s),children:[c.jsxs(Oe,{store:p,className:rm("focus:ring-offset-ring-offset relative inline-flex items-center justify-between rounded-lg border border-input bg-background px-3 py-2 text-sm text-text-primary transition-all duration-200 ease-in-out hover:bg-accent hover:text-accent-foreground focus:ring-ring-primary",l?"h-full w-10":"w-fit gap-2",s),"data-testid":o,"aria-label":u,children:[c.jsxs("div",{className:"flex w-full items-center gap-2",children:[i,!l&&c.jsxs("span",{className:"block truncate",children:[t,(()=>{const t=g(e);return t&&d?d(t):(e=>{if(null==e||""===e)return"";const t=g(e);return t?t.label:e})(e)})()]})]}),!l&&c.jsx(De,{})]}),c.jsx(Fe,{portal:m,store:p,className:rm("popover-ui",r,s,"max-h-[80vh] overflow-y-auto"),children:a.map(((t,n)=>{if(W_(t))return c.jsx("div",{className:"my-1 border-t border-border-heavy"},`divider-${n}`);const a="string"==typeof t?{value:t,label:t}:t;return Q_(a)?c.jsx(ze,{value:String(a.value),className:"select-item","data-theme":a.value,children:c.jsxs("div",{className:"flex w-full items-center gap-2",children:[null!=a.icon&&c.jsx("span",{children:a.icon}),c.jsx("span",{className:"block truncate",children:a.label}),e===a.value&&c.jsx("span",{className:"ml-auto pl-2",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md block group-hover:hidden",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM16.0755 7.93219C16.5272 8.25003 16.6356 8.87383 16.3178 9.32549L11.5678 16.0755C11.3931 16.3237 11.1152 16.4792 10.8123 16.4981C10.5093 16.517 10.2142 16.3973 10.0101 16.1727L7.51006 13.4227C7.13855 13.014 7.16867 12.3816 7.57733 12.0101C7.98598 11.6386 8.61843 11.6687 8.98994 12.0773L10.6504 13.9039L14.6822 8.17451C15 7.72284 15.6238 7.61436 16.0755 7.93219Z",fill:"currentColor"})})})]})},`option-${n}`):null}))})]})},Z_=n.forwardRef((({children:e,handleFileChange:t},n)=>c.jsxs(c.Fragment,{children:[e,c.jsx("input",{ref:n,multiple:!0,type:"file",style:{display:"none"},onChange:t})]})));Z_.displayName="FileUpload";const Y_=({keyPrefix:e,trigger:t,items:n,isOpen:a,setIsOpen:s,menuId:r,modal:o,gutter:i=8,sameWidth:l,className:d,focusLoop:u,iconClassName:m,itemClassName:p})=>{const g=Ue({open:a,setOpen:s,focusLoop:u});return c.jsxs(Ve,{store:g,children:[t,c.jsx(Be,{id:r,className:rm("popover-ui z-50",d),gutter:i,modal:o,sameWidth:l,children:n.filter((e=>!1!==e.show)).map(((t,n)=>!0===t.separate?c.jsx($e,{className:"my-1 h-px bg-white/10"},n):c.jsxs(He,{id:t.id,className:rm("group flex w-full cursor-pointer items-center gap-2 rounded-lg px-3 py-3.5 text-sm text-text-primary outline-none transition-colors duration-200 hover:bg-surface-hover focus:bg-surface-hover md:px-2.5 md:py-2",p),disabled:t.disabled,render:t.render,ref:t.ref,hideOnClick:t.hideOnClick,onClick:e=>{e.preventDefault(),t.onClick&&t.onClick(e),!1!==t.hideOnClick&&g.hide()},children:[null!=t.icon&&c.jsx("span",{className:rm("mr-2 size-4",m),"aria-hidden":"true",children:t.icon}),t.label,null!=t.kbd&&c.jsxs("kbd",{className:"ml-auto hidden font-sans text-xs text-black/50 group-hover:inline group-focus:inline dark:text-white/50",children:["⌘",t.kbd]})]},`${e??""}${n}`)))})]})},J_=({delay:e,children:t})=>(e=>{const[t,a]=n.useState(!0),s=n.useRef(null);return n.useEffect((()=>{if(t){const t=new Promise((t=>{const n=setTimeout((()=>{a(!1),t()}),e);return()=>{clearTimeout(n)}}));s.current=t}return()=>{s.current=null}}),[e,t]),e=>{if(t&&s.current)throw s.current;return e()}})(e)((()=>t)),X_=({theme:e,onChange:t})=>{const a={system:c.jsx(We,{}),dark:c.jsx(Ke,{color:"white"}),light:c.jsx(Ge,{})},s="dark"===e?"light":"dark",r=`Switch to ${s} theme`;return n.useEffect((()=>{const e=e=>{e.ctrlKey&&e.shiftKey&&"t"===e.key.toLowerCase()&&(e.preventDefault(),t(s))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[s,t]),c.jsx("button",{className:"flex items-center gap-2 rounded-lg p-2 transition-colors hover:bg-surface-hover focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","aria-label":r,"aria-keyshortcuts":"Ctrl+Shift+T",onClick:e=>{e.preventDefault(),t(s)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t(s))},children:a[e]})},ej=({returnThemeOnly:e})=>{const{theme:t,setTheme:a}=n.useContext(Mv),[s,r]=n.useState(""),o=n.useCallback((e=>{const t=Date.now();"number"==typeof window.lastThemeChange&&t-window.lastThemeChange<500||(window.lastThemeChange=t,a(e),r("dark"===e?"Dark theme enabled":"Light theme enabled"))}),[a]);return n.useEffect((()=>{if("system"===t){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;a(e?"dark":"light")}}),[t,a]),n.useEffect((()=>{if(s){const e=setTimeout((()=>r("")),1e3);return()=>clearTimeout(e)}}),[s]),!0===e?c.jsx(X_,{theme:t,onChange:o}):c.jsxs("div",{className:"flex flex-col items-center justify-center bg-white pt-6 dark:bg-gray-900 sm:pt-0",children:[c.jsx("div",{className:"absolute bottom-0 left-0 m-4",children:c.jsx(X_,{theme:t,onChange:o})}),s&&c.jsx("div",{"aria-live":"polite",className:"sr-only",children:s})]})};function tj({value:e,onChange:t,placeholder:a,className:s=""}){const r=kg(),o=n.useRef(null),i=n.useCallback((e=>t(e.target.value)),[t]);return c.jsxs("div",{className:rm("focus:to-surface-primary/50 group sticky left-0 top-0 z-10 flex h-12 items-center gap-2 bg-gradient-to-b from-surface-tertiary-alt from-65% to-transparent px-3 py-2 text-text-primary transition-colors duration-300 focus:bg-gradient-to-b focus:from-surface-primary",s),children:[c.jsx(Qe,{className:"h-4 w-4 text-text-secondary-alt transition-colors duration-300","aria-hidden":"true"}),c.jsx("input",{ref:o,type:"text",value:e??"",onChange:i,placeholder:a??r("com_ui_select_search_model"),"aria-label":"Search Model",className:"flex-1 rounded-md border-none bg-transparent px-2.5 py-2 text-sm placeholder-text-secondary focus:outline-none focus:ring-1 focus:ring-ring-primary"}),c.jsx("button",{className:rm("relative flex h-5 w-5 items-center justify-end rounded-md text-text-secondary-alt",(null==e?void 0:e.length)?"cursor-pointer opacity-100":"hidden"),"aria-label":"Clear search",onClick:()=>{t(""),setTimeout((()=>{var e;null==(e=o.current)||e.focus()}),0)},tabIndex:0,children:c.jsx(ve,{"aria-hidden":"true",className:rm("text-text-secondary-alt",(null==e?void 0:e.length)?"cursor-pointer opacity-100":"opacity-0")})})]})}function nj(e){return"string"==typeof e?e.startsWith("---")&&e.endsWith("---")?"":e.toUpperCase():""}function aj({availableOptions:e=[],placeholder:t,getTextKeyOverride:a,className:s,disabled:r=!1}){const[o,i]=n.useState(null),l=e.length>10&&!r,d=a||nj,u=n.useMemo((()=>{const t=o??"";if(!l||!t||!e.length)return e;const n=t.toUpperCase();return e.filter((e=>d(e).includes(n)))}),[e,d,o,l]),m=n.useCallback((e=>i(e)),[]);return[u,l?c.jsx(tj,{value:o,className:s,onChange:m,placeholder:t}):null]}function sj({title:e,value:t,disabled:a,setValue:s,availableValues:r,showAbove:o=!1,showLabel:i=!0,emptyTitle:l=!1,iconSide:d="right",optionIconSide:u="left",placeholder:m,containerClassName:p,optionsListClass:g,optionsClass:f,currentValueClass:x,subContainerClassName:h,className:v,renderOption:b,searchClassName:y,searchPlaceholder:j,showOptionIcon:w=!1}){const N=kg(),C={className:"top-full mt-3"};o&&(C.className="bottom-full mb-3");let k=e;l?k="":k||(k=N("com_ui_model"));const S=r??[],[T,R]=aj({availableOptions:S,placeholder:j,getTextKeyOverride:e=>function(e){return"string"==typeof e?e:"label"in e?e.label??"":"value"in e?(e.value??"")+"":""}(e).toUpperCase(),className:y,disabled:a}),I=null!=R?T:S,E=w&&null!=t&&null!=t.icon,P=n.useRef(null);return c.jsx("div",{className:rm("flex items-center justify-center gap-2",p??""),children:c.jsx("div",{className:rm("relative w-full",h??""),children:c.jsx(br,{value:t,onChange:s,disabled:a,children:({open:e})=>c.jsxs(c.Fragment,{children:[c.jsxs(yr,{ref:P,"data-testid":"select-dropdown-button",onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),!e&&P.current&&P.current.click())},className:rm("relative flex w-full cursor-default flex-col rounded-md border border-black/10 bg-white py-2 pl-3 pr-10 text-left focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:bg-white dark:border-gray-600 dark:bg-gray-700 sm:text-sm",v??""),children:[i&&c.jsx(_r,{className:"block text-xs text-gray-700 dark:text-gray-500",id:"headlessui-listbox-label-:r1:","data-headlessui-state":"",children:k}),c.jsx("span",{className:"inline-flex w-full truncate",children:c.jsxs("span",{className:rm("flex h-6 items-center gap-1 truncate text-sm text-gray-800 dark:text-white",i?"":"text-xs",x??""),children:[!i&&!l&&c.jsxs("span",{className:"text-xs text-gray-700 dark:text-gray-500",children:[k,":"]}),E&&"right"!==u&&c.jsx("span",{className:"icon-md flex items-center",children:t.icon}),E&&c.jsx("span",{className:"icon-md absolute right-0 mr-8 flex items-center",children:t.icon}),t?"string"!=typeof t?t.label??"":t:c.jsx("span",{className:"text-text-secondary",children:m})]})}),c.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 text-gray-400",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",style:o?{transform:"scaleY(-1)"}:{},children:c.jsx("polyline",{points:"6 9 12 15 18 9"})})})]}),c.jsx(jr,{show:e,as:_.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",...C,children:c.jsxs(wr,{className:rm("absolute z-10 mt-2 max-h-60 w-full overflow-auto rounded border bg-white text-xs ring-black/10 dark:border-gray-600 dark:bg-gray-700 dark:ring-white/20 md:w-[100%]",g??""),children:[b&&c.jsx(Nr,{value:null,className:rm("group relative flex h-[42px] cursor-pointer select-none items-center overflow-hidden pl-3 pr-9 text-gray-800 hover:bg-gray-20 dark:text-white dark:hover:bg-gray-700",f??""),children:b()},"listbox-render-option"),R,I.map(((e,n)=>{if(!e)return null;const a="string"==typeof e?e:e.label??e.value??"",s="string"==typeof e?e:e.value??"",r="string"==typeof e?null:e.icon??null;let o=t;return"string"!=typeof o&&(o=(null==o?void 0:o.value)??""),c.jsx(Nr,{value:e,className:({active:e})=>rm("group relative flex h-[42px] cursor-pointer select-none items-center overflow-hidden pl-3 pr-9 text-gray-800 hover:bg-gray-20 dark:text-white dark:hover:bg-gray-600",e?"bg-surface-active text-text-primary":"",f??""),children:c.jsxs("span",{className:"flex items-center gap-1.5 truncate",children:[c.jsxs("span",{className:rm("flex h-6 items-center gap-1 text-gray-800 dark:text-gray-200",e===t?"font-semibold":"","left"===d?"ml-4":""),children:[null!=r&&c.jsx("span",{className:rm("mr-1","right"===u?"absolute right-0 pr-2":""),children:r}),a]}),s===o&&c.jsx("span",{className:rm("absolute inset-y-0 flex items-center text-gray-800 dark:text-gray-200","left"===d?"left-0 pl-2":"right-0 pr-3"),children:c.jsx(Kb,{})})]})},n)}))]})})]})})})})}const rj=({title:e,description:t,selected:n,icon:a,className:s="",textClassName:r="",children:o,onClick:i,...l})=>c.jsx("div",{id:n?"selected-endpoint":void 0,role:"option","aria-selected":n,"aria-label":e,"data-testid":"chat-menu-item",className:rm("group m-1.5 flex cursor-pointer gap-2 rounded px-5 py-2.5 !pr-3 text-sm !opacity-100 hover:bg-black/5 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 dark:hover:bg-gray-600 md:min-w-[240px]",s||""),tabIndex:0,onClick:i,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i&&i())},...l,children:c.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[c.jsx("div",{children:c.jsxs("div",{className:rm("flex items-center gap-1 "),children:[null!=a?a:null,c.jsxs("div",{className:rm("truncate",r),children:[e,c.jsx("div",{className:"text-token-text-tertiary",children:t})]})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[o,n&&c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md block ",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM16.0755 7.93219C16.5272 8.25003 16.6356 8.87383 16.3178 9.32549L11.5678 16.0755C11.3931 16.3237 11.1152 16.4792 10.8123 16.4981C10.5093 16.517 10.2142 16.3973 10.0101 16.1727L7.51006 13.4227C7.13855 13.014 7.16867 12.3816 7.57733 12.0101C7.98598 11.6386 8.61843 11.6687 8.98994 12.0773L10.6504 13.9039L14.6822 8.17451C15 7.72284 15.6238 7.61436 16.0755 7.93219Z",fill:"currentColor"})})]})]})});function oj({title:e="Plugins",value:t,setSelected:n,availableValues:a,showAbove:s=!1,showLabel:r=!0,containerClassName:o,isSelected:i,optionValueKey:l="value",searchPlaceholder:d}){const u=e,[m,p]=aj({availableOptions:a,placeholder:d,getTextKeyOverride:e=>(e.name||"").toUpperCase()}),g=Boolean(p),f=g?m:a;return c.jsx(Ms,{children:c.jsx("div",{className:rm("flex items-center justify-center gap-2",o??""),children:c.jsxs("div",{className:"relative",children:[c.jsx(As,{asChild:!0,children:c.jsxs("button",{"data-testid":"select-dropdown-button",className:rm("relative flex flex-col rounded-md border border-black/10 bg-white py-2 pl-3 pr-10 text-left focus:outline-none focus:ring-0 focus:ring-offset-0 dark:border-gray-700 dark:bg-gray-800 dark:bg-gray-800 sm:text-sm","pointer-cursor font-normal","hover:bg-gray-50 radix-state-open:bg-gray-50 dark:hover:bg-gray-700 dark:radix-state-open:bg-gray-700"),children:[" ",r&&c.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-500 ",children:u}),c.jsx("span",{className:"inline-flex",id:"selected-plugins",children:c.jsx("span",{className:rm("flex h-6 items-center gap-1 text-sm text-gray-800 dark:text-white",r?"":"text-xs"),children:c.jsx("span",{className:"flex items-center gap-1 ",children:c.jsxs("div",{className:"flex gap-1",children:[0===t.length&&"None selected",t.map(((e,t)=>c.jsxs("div",{className:"relative",children:[e.icon?c.jsx("img",{src:e.icon,alt:`${e} logo`,className:"icon-lg rounded-sm"}):c.jsx(qe,{className:"icon-lg rounded-sm bg-white"}),c.jsx("div",{className:"absolute inset-0 rounded-sm ring-1 ring-inset ring-black/10"})]},t)))]})})})}),c.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4  text-gray-400",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",style:s?{transform:"scaleY(-1)"}:{},children:c.jsx("polyline",{points:"6 9 12 15 18 9"})})})]})}),c.jsx(Os,{children:c.jsxs(Ds,{side:"bottom",align:"center",className:rm("mt-2 max-h-[52vh] min-w-full overflow-hidden overflow-y-auto rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-700 dark:text-white",g&&"relative"),children:[p,f.map((e=>{if(!e)return null;const t=i(e[l]);return c.jsx(rj,{title:e.name,value:e[l],selected:t,onClick:()=>n(e.pluginKey),icon:e.icon?c.jsx("img",{src:e.icon,alt:`${e.name} logo`,className:"icon-sm mr-1 rounded-sm bg-cover"}):c.jsx(qe,{className:"icon-sm mr-1 rounded-sm bg-white bg-cover dark:bg-gray-800"})},`${e[l]}`)}))]})})]})})})}_.memo((({label:e="Value",ariaLabel:t="Value",min:a=0,max:s=100,step:r=1,stepClick:o=1,initialValue:i=0,showButtons:l=!0,onChange:d,disabled:u=!1})=>{const m=kg(),[p,g]=n.useState(i),[f,x]=n.useState(!1),h=n.useRef(null),v=`model-parameter-${t.toLowerCase().replace(/\s+/g,"-")}`,b=e.startsWith("com_")?m(e):e,y=(e=>{const t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0})(r),_=n.useCallback((e=>{const t=Math.min(Math.max(e,a),s),n=Object.is(t,-0)?0:t;g(n),null==d||d(n)}),[a,s,d]),j=n.useCallback((e=>{_(parseFloat(e.target.value))}),[_]),w=n.useCallback((()=>{_(p+o)}),[p,o,_]),N=n.useCallback((()=>{_(p-o)}),[p,o,_]),C=n.useCallback((e=>{"ArrowRight"===e.key||"ArrowUp"===e.key?(e.preventDefault(),w()):"ArrowLeft"!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),N())}),[w,N]);return n.useEffect((()=>{const e=h.current;if(e){const t=(p-a)/(s-a)*100;e.style.backgroundSize=`${t}% 100%`}}),[p,a,s]),c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[c.jsx("label",{htmlFor:v,className:"text-sm font-medium "+(u?"text-gray-400 dark:text-gray-400":""),children:b}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("output",{htmlFor:v,className:"select-none text-sm font-medium "+(u?"text-gray-400 dark:text-gray-400":""),"aria-live":"polite",children:p.toFixed(y).replace("-0.00","0.00")}),l&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{type:"button",onClick:N,className:"rounded-md p-1 transition-colors "+(u?"cursor-not-allowed text-gray-400 dark:text-gray-400":"hover:bg-gray-200 dark:hover:bg-gray-700"),"aria-label":`Decrease ${e}`,disabled:u,children:c.jsx(Me,{size:16})}),c.jsx("button",{type:"button",onClick:w,className:"rounded-md p-1 transition-colors "+(u?"cursor-not-allowed text-gray-400 dark:text-gray-400":"hover:bg-gray-200 dark:hover:bg-gray-700"),"aria-label":`Increase ${e}`,disabled:u,children:c.jsx(Ze,{size:16})})]})]})]}),c.jsxs("div",{className:"relative w-full",children:[c.jsx("input",{ref:h,type:"range",id:v,min:a,max:s,step:r,value:p,onChange:j,onKeyDown:C,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),className:"slider-thumb h-2 w-full appearance-none rounded-lg bg-gradient-to-r from-gray-500 to-gray-500 bg-no-repeat focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 "+(u?"cursor-not-allowed opacity-50":"cursor-pointer"),tabIndex:0,style:{backgroundSize:"50% 100%",backgroundPosition:"left"},"aria-valuemin":a,"aria-valuemax":s,"aria-valuenow":p,"aria-valuetext":`${p.toFixed(y).replace("-0.00","0.00")}`,disabled:u}),f?c.jsxs("div",{className:"trab mt-1 flex justify-between",children:[c.jsx("span",{className:"text-xs text-gray-500",children:a}),c.jsx("span",{className:"text-xs text-gray-500",children:s})]}):c.jsx("div",{className:"mt-1",style:{height:"1rem"}})]})]})}));const ij=n.forwardRef(((e,t)=>{const n=kg(),{title:a,main:s,buttons:r,selection:o,className:i,leftButtons:l,description:d="",mainClassName:u,headerClassName:m,footerClassName:p,showCloseButton:g,overlayClassName:f,showCancelButton:x=!0}=e,{selectHandler:h,selectClasses:v,selectText:b,isLoading:y}=o||{},_=n("com_ui_cancel");return c.jsxs(y_,{overlayClassName:f,showCloseButton:g,ref:t,className:rm("w-11/12 border-none bg-background text-foreground",i??""),onClick:e=>e.stopPropagation(),children:[c.jsxs(__,{className:rm(m??""),children:[c.jsx(w_,{children:a}),d&&c.jsx(N_,{className:"items-center justify-center",children:d})]}),c.jsx("div",{className:rm("px-0 py-2",u),children:null!=s?s:null}),c.jsxs(j_,{className:p,children:[c.jsx("div",{children:null!=l?c.jsx("div",{className:"mt-3 flex h-auto gap-3 max-sm:w-full max-sm:flex-col sm:mt-0 sm:flex-row",children:l}):null}),c.jsxs("div",{className:"flex h-auto gap-3 max-sm:w-full max-sm:flex-col sm:flex-row",children:[null!=r?r:null,x&&c.jsx(v_,{className:"btn btn-neutral border-token-border-light relative justify-center rounded-lg text-sm ring-offset-2 focus:ring-2 focus:ring-black dark:ring-offset-0 max-sm:order-last max-sm:w-full sm:order-first",children:_}),o?c.jsx(v_,{onClick:h,disabled:y,className:`${v??"bg-gray-800 text-white transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-gray-200 dark:text-gray-800 dark:hover:bg-gray-200"} flex h-10 items-center justify-center rounded-lg border-none px-4 py-2 text-sm disabled:opacity-80 max-sm:order-first max-sm:w-full sm:order-none`,children:!0===y?c.jsx(Hb,{className:"size-4 text-white"}):b}):null]})]})]})})),lj=n.forwardRef((({className:e,options:t,onSelect:a,...s},r)=>{const[o,i]=n.useState(!1),[l,d]=n.useState(s.value||""),[u,m]=n.useState(-1),p=n.useRef(null),g=e=>{d(e),i(!1),m(-1),a&&a(e),s.onChange&&s.onChange({target:{value:e}})};return n.useEffect((()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&(i(!1),m(-1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),c.jsxs("div",{className:"relative",ref:p,children:[c.jsxs("div",{className:"relative",children:[c.jsx(m_,{...s,value:l,onChange:e=>{d(e.target.value),s.onChange&&s.onChange(e)},onKeyDown:e=>{switch(e.key){case"ArrowDown":e.preventDefault(),o?m((e=>e<t.length-1?e+1:e)):i(!0);break;case"ArrowUp":e.preventDefault(),m((e=>e>0?e-1:0));break;case"Enter":e.preventDefault(),o&&-1!==u&&g(t[u]),i(!1);break;case"Escape":i(!1),m(-1)}},"aria-haspopup":"listbox","aria-controls":"dropdown-list",className:rm("bg-surface-secondary",e??""),ref:r}),c.jsx("button",{type:"button",className:"text-tertiary hover:text-secondary absolute inset-y-0 right-0 flex items-center rounded-md px-2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring-primary",onClick:()=>i(!o),"aria-label":o?"Close dropdown":"Open dropdown",children:c.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),o&&c.jsx("ul",{id:"dropdown-list",role:"listbox",className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-border-medium bg-surface-secondary shadow-lg focus:ring-1 focus:ring-inset focus:ring-ring-primary",children:t.map(((e,t)=>c.jsx("li",{role:"option","aria-selected":t===u,className:rm("cursor-pointer rounded-md px-3 py-2","focus:bg-surface-tertiary focus:outline-none focus:ring-1 focus:ring-inset focus:ring-ring-primary",t===u?"text-primary bg-surface-active":"text-secondary hover:bg-surface-tertiary"),onClick:()=>g(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),g(e))},tabIndex:0,children:e},t)))})]})}));function cj({title:e,value:t,availableValues:n,setValue:a,showAbove:s=!1,showLabel:r=!0,emptyTitle:o=!1,footer:i}){const l=kg();let d=e;o?d="":d||(d=l("com_ui_model"));const[u,m]=aj({availableOptions:n}),p=Boolean(m),g=p?u:n;return c.jsx(Ms,{children:c.jsx("div",{className:"flex items-center justify-center gap-2",children:c.jsxs("div",{className:"relative w-full",children:[c.jsx(As,{asChild:!0,children:c.jsxs("button",{"data-testid":"select-dropdown-button",className:rm("pointer-cursor relative flex flex-col rounded-lg border border-black/10 bg-white py-2 pl-3 pr-10 text-left focus:ring-0 focus:ring-offset-0 dark:border-gray-700 dark:bg-gray-800 sm:text-sm","hover:bg-gray-50 radix-state-open:bg-gray-50 dark:hover:bg-gray-700 dark:radix-state-open:bg-gray-700","min-w-[200px] max-w-[215px] sm:min-w-full sm:max-w-full"),"aria-label":`Select ${d}`,"aria-haspopup":"false",children:[" ",r&&c.jsx("label",{className:"block text-xs text-gray-700 dark:text-gray-500",children:d}),c.jsx("span",{className:"inline-flex w-full",children:c.jsx("span",{className:rm("flex h-6 items-center gap-1 text-sm text-text-primary",r?"":"text-xs","min-w-[75px] font-normal"),children:"string"!=typeof t&&t?t.label??"":t??""})}),c.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2",children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 text-gray-400",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",style:s?{transform:"scaleY(-1)"}:{},children:c.jsx("polyline",{points:"6 9 12 15 18 9"})})})]})}),c.jsx(Os,{children:c.jsxs(Ds,{side:"bottom",align:"start",className:rm("mr-3 mt-2 max-h-[52vh] w-full max-w-[85vw] overflow-hidden overflow-y-auto rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-700 dark:text-white sm:max-w-full lg:max-h-[52vh]",p&&"relative"),children:[m,g.map((e=>c.jsx(rj,{title:e,value:e,selected:!(!t||t!==e),onClick:()=>a(e)},e))),i]})})]})})})}lj.displayName="InputWithDropdown";const dj=({value:e,onChange:t,isSearching:n,placeholder:a})=>{const s=!0===n,r=null!=e&&e.length>0;return c.jsxs("div",{className:"relative w-full",children:[c.jsx("div",{className:"relative rounded-lg transition-all duration-500 ease-in-out",children:c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute left-3 top-1/2 z-50 -translate-y-1/2",children:c.jsx(Qe,{className:rm("\n                h-4 w-4 transition-all duration-500 ease-in-out",s&&r?"text-blue-400":"text-gray-400")})}),c.jsx("input",{type:"text",value:e,onChange:t,placeholder:a,className:"\n              peer relative z-20 w-full rounded-lg bg-surface-secondary px-10\n              py-2 outline-none ring-0 backdrop-blur-sm transition-all\n              duration-500 ease-in-out placeholder:text-gray-400\n              focus:outline-none focus:ring-0\n            "}),c.jsx("div",{className:`\n              pointer-events-none absolute inset-0 z-20 rounded-lg\n              bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-blue-500/20\n              transition-all duration-500 ease-in-out\n              ${s&&r?"opacity-100 blur-sm":"opacity-0 blur-none"}\n            `}),c.jsx("div",{className:`\n              absolute right-3 top-1/2 z-20 -translate-y-1/2\n              transition-all duration-500 ease-in-out\n              ${s&&r?"scale-100 opacity-100":"scale-0 opacity-0"}\n            `,children:c.jsxs("div",{className:"relative h-2 w-2",children:[c.jsx("div",{className:"absolute inset-0 animate-ping rounded-full bg-blue-500/60"}),c.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500"})]})})]})}),c.jsx("div",{className:`\n          absolute -inset-8 -z-10\n          transition-all duration-700 ease-in-out\n          ${s&&r?"scale-105 opacity-100":"scale-100 opacity-0"}\n        `,children:c.jsxs("div",{className:"absolute inset-0",children:[c.jsx("div",{className:`\n              bg-gradient-radial absolute inset-0 from-blue-500/10 to-transparent\n              transition-opacity duration-700 ease-in-out\n              ${s&&r?"animate-pulse-slow opacity-100":"opacity-0"}\n            `}),c.jsx("div",{className:`\n              absolute inset-0 bg-gradient-to-r from-purple-500/5 via-blue-500/5 to-purple-500/5\n              blur-xl transition-all duration-700 ease-in-out\n              ${s&&r?"animate-gradient-x opacity-100":"opacity-0"}\n            `})]})}),c.jsx("div",{className:"\n          absolute inset-0 -z-20 scale-100 bg-gradient-to-r from-blue-500/10 \n          via-purple-500/10 to-blue-500/10 opacity-0 blur-xl\n          transition-all duration-500 ease-in-out\n          peer-focus:scale-105 peer-focus:opacity-100\n        "})]})};function uj({title:e="Plugins",value:t,disabled:a,setSelected:s,availableValues:r,showAbove:o=!1,showLabel:i=!0,containerClassName:l,optionsClassName:d="",labelClassName:u="",isSelected:m,className:p,searchPlaceholder:g,optionValueKey:f="value"}){const[x,h]=n.useState(!1),v=n.useRef(null),b=["select-plugin","plugins-label","selected-plugins"];Pb(v,(()=>h(!1)),b);const[y,j]=aj({availableOptions:r,placeholder:g,getTextKeyOverride:e=>(e.name||"").toUpperCase()}),w=Boolean(j)?y:r,N={className:"top-full mt-3"};o&&(N.className="bottom-full mb-3");const C={open:x};return c.jsx("div",{className:rm("flex items-center justify-center gap-2",l??""),children:c.jsx("div",{className:"relative w-full",children:c.jsx(br,{value:t,onChange:e=>{s(e),h(!0)},disabled:a,children:()=>c.jsxs(c.Fragment,{children:[c.jsxs(yr,{className:rm("relative flex w-full cursor-default flex-col rounded-md border border-black/10 bg-white py-2 pl-3 pr-10 text-left focus:outline-none focus:ring-0 focus:ring-offset-0 dark:border-gray-600 dark:border-white/20 dark:bg-gray-800 sm:text-sm",p??""),id:b[0],onClick:()=>h((e=>!e)),...C,children:[" ",i&&c.jsx(_r,{className:rm("block text-xs text-gray-700 dark:text-gray-500",u),id:b[1],"data-headlessui-state":"",children:e}),c.jsx("span",{className:"inline-flex w-full truncate",id:b[2],children:c.jsxs("span",{className:rm("flex h-6 items-center gap-1 truncate text-sm text-gray-800 dark:text-white",i?"":"text-xs"),children:[!i&&e.length>0&&c.jsxs("span",{className:"text-xs text-gray-700 dark:text-gray-500",children:[e,":"]}),c.jsx("span",{className:"flex h-6 items-center gap-1 truncate",children:c.jsx("div",{className:"flex gap-1",children:t.map(((e,t)=>c.jsxs("div",{className:"relative",style:{width:"16px",height:"16px"},children:[e.icon?c.jsx("img",{src:e.icon,alt:`${e} logo`,className:"h-full w-full rounded-sm bg-white"}):c.jsx(qe,{className:"h-full w-full rounded-sm bg-white"}),c.jsx("div",{className:"absolute inset-0 rounded-sm ring-1 ring-inset ring-black/10"})]},t)))})})]})}),c.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4  text-gray-400",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",style:o?{transform:"scaleY(-1)"}:{},children:c.jsx("polyline",{points:"6 9 12 15 18 9"})})})]}),c.jsx(jr,{show:x,as:_.Fragment,leave:"transition ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",...N,children:c.jsxs(wr,{ref:v,className:rm("absolute z-50 mt-2 max-h-60 w-full overflow-auto rounded bg-white text-base text-xs ring-1 ring-black/10 focus:outline-none dark:bg-gray-800 dark:ring-white/20 dark:last:border-0 md:w-[100%]",d),children:[j,w.map(((e,t)=>{if(!e)return null;const n=m(e[f]);return c.jsx(Nr,{value:e[f],className:"group relative flex h-[42px] cursor-pointer select-none items-center overflow-hidden border-b border-black/10 pl-3 pr-9 text-gray-800 last:border-0 hover:bg-gray-20 dark:border-white/20 dark:text-white dark:hover:bg-gray-700",children:c.jsxs("span",{className:"flex items-center gap-1.5 truncate",children:[!e.isButton&&c.jsx("span",{className:"h-6 w-6 shrink-0",children:c.jsxs("div",{className:"relative",style:{width:"100%",height:"100%"},children:[e.icon?c.jsx("img",{src:e.icon,alt:`${e.name} logo`,className:"h-full w-full rounded-sm bg-white"}):c.jsx(qe,{className:"h-full w-full rounded-sm bg-white"}),c.jsx("div",{className:"absolute inset-0 rounded-sm ring-1 ring-inset ring-black/10"})]})}),c.jsx("span",{className:rm("flex h-6 items-center gap-1 text-gray-800 dark:text-gray-200",n?"font-semibold":""),children:e.name}),e.isButton&&c.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-800 dark:text-gray-200",children:c.jsx(Ye,{})}),n&&!e.isButton&&c.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-800 dark:text-gray-200",children:c.jsx(Kb,{})})]})},t)}))]})})]})})})})}function mj(){const e=D(),t=kg(),[a]=Z(),[s,r]=n.useState(3),[o,i]=n.useState(""),[l,d]=n.useState(!1),[u,m]=n.useState(!1),p=n.useMemo((()=>a.get("token")||""),[a]),g=n.useMemo((()=>a.get("email")||""),[a]),f=n.useCallback((()=>{r(3);const t=setInterval((()=>{r((n=>n<=1?(clearInterval(t),e("/c/new",{replace:!0}),0):n-1))}),1e3)}),[e]),x=sr({mutationFn:e=>zd.verifyEmail(e),...{onSuccess:()=>{i(t("com_auth_email_verification_success")+" 🎉"),m(!0),f()},onError:e=>{i(t("com_auth_email_verification_failed")+" 😢"),d(!0),m(!0)}}||{}});const h=vg({onSuccess:()=>{i(t("com_auth_email_resent_success")+" 📧"),f()},onError:()=>{i(t("com_auth_email_resent_failed")+" 😢")},onMutate:()=>d(!1)}),v=()=>{h.mutate({email:g})};n.useEffect((()=>{u||x.isLoading||(p&&g?x.mutate({email:g,token:p}):(i(g?t("com_auth_email_verification_failed_token_missing")+" 😢":t("com_auth_email_verification_invalid")+" 🤨"),d(!0),m(!0)))}),[p,g,u,x]);const b=()=>c.jsxs("div",{className:"flex flex-col items-center justify-center",children:[c.jsx("h1",{className:"mb-4 text-center text-3xl font-semibold text-black dark:text-white",children:o}),s>0&&c.jsx("p",{className:"text-center text-lg text-gray-600 dark:text-gray-400",children:t("com_auth_email_verification_redirecting",{0:s.toString()})}),l&&0===s&&c.jsxs("p",{className:"text-center text-lg text-gray-600 dark:text-gray-400",children:[t("com_auth_email_verification_resend_prompt"),c.jsx("button",{className:"ml-2 text-blue-600 hover:underline",onClick:v,disabled:h.isLoading,children:t("com_auth_email_resend_link")})]})]}),y=()=>c.jsxs("div",{className:"flex flex-col items-center justify-center",children:[c.jsx("h1",{className:"mb-4 text-center text-3xl font-semibold text-black dark:text-white",children:t("com_auth_email_verification_in_progress")}),c.jsx("div",{className:"mt-4 flex justify-center",children:c.jsx(Hb,{className:"h-8 w-8 text-green-500"})})]});return c.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center bg-white pt-6 dark:bg-gray-900 sm:pt-0",children:[c.jsx("div",{className:"absolute bottom-0 left-0 m-4",children:c.jsx(ej,{})}),u?c.jsx(b,{}):c.jsx(y,{})]})}const pj=()=>{const{error:e}=Rb(),t=D();return _.useEffect((()=>{var t;null==(t=null==e?void 0:e.response)||t.status}),[e,t]),null},gj=({children:e})=>c.jsx("div",{className:"relative mt-6 rounded-lg border border-green-500/20 bg-green-50/50 px-6 py-4 text-green-700 shadow-sm transition-all dark:bg-green-950/30 dark:text-green-100",role:"alert",children:e}),fj=()=>{const e=kg();return c.jsxs("div",{className:"flex flex-col space-y-4",children:[c.jsx("p",{children:e("com_auth_reset_password_if_email_exists")}),c.jsx("a",{className:"inline-flex text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",href:"/login",children:e("com_auth_back_to_login")})]})};function xj(){const e=kg(),{register:t,handleSubmit:a,formState:{errors:s}}=ne(),[r,o]=n.useState(void 0),{startupConfig:i,setHeaderText:l}=pe(),d=sr((function(e){return function(e){return nh.post("/api/auth/requestPasswordReset",e)}(e)}));return r?c.jsx(gj,{children:r}):c.jsxs("form",{className:"mt-8 space-y-6","aria-label":"Password reset form",method:"POST",onSubmit:a((t=>{d.mutate(t,{onSuccess:t=>{t.link&&!(null==i?void 0:i.emailEnabled)?(l("com_auth_reset_password"),o(c.jsxs("span",{children:[e("com_auth_click")," ",c.jsx("a",{className:"text-green-500 hover:underline",href:t.link,children:e("com_auth_here")})," ",e("com_auth_to_reset_your_password")]}))):(l("com_auth_reset_password_link_sent"),o(c.jsx(fj,{})))},onError:()=>{l("com_auth_reset_password_link_sent"),o(c.jsx(fj,{}))}})})),children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"email",id:"email",autoComplete:"off","aria-label":e("com_auth_email"),...t("email",{required:e("com_auth_email_required"),minLength:{value:3,message:e("com_auth_email_min_length")},maxLength:{value:120,message:e("com_auth_email_max_length")},pattern:{value:/\S+@\S+\.\S+/,message:e("com_auth_email_pattern")}}),"aria-invalid":!!s.email,className:"\n              peer w-full rounded-lg border border-gray-300 bg-transparent px-4 py-3\n              text-base text-gray-900 placeholder-transparent transition-all\n              focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-500/20\n              dark:border-gray-700 dark:text-white dark:focus:border-green-500\n            ",placeholder:"email@example.com"}),c.jsx("label",{htmlFor:"email",className:"\n              absolute -top-2 left-2 z-10 bg-white px-2 text-sm text-gray-600\n              transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base\n              peer-placeholder-shown:text-gray-500 peer-focus:-top-2 peer-focus:text-sm\n              peer-focus:text-green-600 dark:bg-gray-900 dark:text-gray-400\n              dark:peer-focus:text-green-500\n            ",children:e("com_auth_email_address")})]}),s.email&&c.jsx("p",{role:"alert",className:"text-sm font-medium text-red-600 dark:text-red-400",children:s.email.message})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("button",{type:"submit",disabled:!!s.email,className:"\n            w-full rounded-2xl bg-green-600 px-4 py-3 text-sm font-medium text-white\n            transition-colors hover:bg-green-700 focus:outline-none focus:ring-2\n            focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50\n            disabled:hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700\n          ",children:e("com_auth_continue")}),c.jsx("a",{href:"/login",className:"block text-center text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:e("com_auth_back_to_login")})]})]})}const hj=({currentPage:e,maxPage:t,onChangePage:n})=>{const a=kg(),s=[...Array(t).keys()].map((e=>e+1)),r=e=>{e<1||e>t||n(e)};return c.jsxs("div",{className:"flex gap-2 text-sm text-black/60 dark:text-white/70",children:[c.jsxs("div",{role:"button",tabIndex:0,"aria-label":"Previous page",onClick:()=>r(e-1),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||n(e-1)},className:"flex cursor-default items-center text-sm "+(1===e?"text-black/70 opacity-50 dark:text-white/70":"text-black/70 hover:text-black/50 dark:text-white/70 dark:hover:text-white/50"),style:{userSelect:"none"},children:[c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"15 18 9 12 15 6"})}),a("com_ui_prev")]}),s.map((t=>c.jsx("div",{role:"button",tabIndex:0,className:"flex h-5 w-5 items-center justify-center text-sm "+(e===t?"text-blue-600 hover:text-blue-600 dark:text-blue-600 dark:hover:text-blue-600":"text-black/70 hover:text-black/50 dark:text-white/70 dark:hover:text-white/50"),style:{userSelect:"none"},onClick:()=>n(t),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||n(t)},children:t},t))),c.jsxs("div",{role:"button","aria-label":"Next page",tabIndex:0,onClick:()=>r(e+1),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||n(e+1)},className:"flex cursor-default items-center text-sm "+(e===t?"text-black/70 opacity-50 dark:text-white/70":"text-black/70 hover:text-black/50 dark:text-white/70 dark:hover:text-white/50"),style:{userSelect:"none"},children:[a("com_ui_next"),c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"9 18 15 12 9 6"})})]})]})};function vj({plugin:e,onInstall:t,onUninstall:n,isInstalled:a}){const s=kg(),r=()=>{a?n():t()};return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"flex flex-col gap-4 rounded border border-black/10 bg-white p-6 dark:border-gray-500 dark:bg-gray-700",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"h-[70px] w-[70px] shrink-0",children:c.jsxs("div",{className:"relative h-full w-full",children:[c.jsx("img",{src:e.icon,alt:`${e.name} logo`,className:"h-full w-full rounded-[5px]"}),c.jsx("div",{className:"absolute inset-0 rounded-[5px] ring-1 ring-inset ring-black/10"})]})}),c.jsxs("div",{className:"flex min-w-0 flex-col items-start justify-between",children:[c.jsx("div",{className:"mb-2 line-clamp-1 max-w-full text-lg leading-5 text-gray-700/80 dark:text-gray-50",children:e.name}),a?c.jsx("button",{className:"btn relative bg-gray-300 hover:bg-gray-400 dark:bg-gray-50 dark:hover:bg-gray-200",onClick:r,"aria-label":`${s("com_nav_plugin_uninstall")} ${e.name}`,children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[s("com_nav_plugin_uninstall"),c.jsx(Xe,{className:"flex h-4 w-4 items-center stroke-2"})]})}):c.jsx("button",{className:"btn btn-primary relative","aria-label":`${s("com_nav_plugin_install")} ${e.name}`,onClick:r,children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[s("com_nav_plugin_install"),c.jsx(Je,{className:"flex h-4 w-4 items-center stroke-2"})]})})]})]}),c.jsx("div",{className:"line-clamp-3 h-[60px] text-sm text-gray-700/70 dark:text-gray-50/70",children:e.description})]})})}function bj({content:e,position:t}){return c.jsx(d_,{children:c.jsx(u_,{side:t,className:"w-80 ",children:c.jsx("div",{className:"space-y-2",children:c.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:c.jsx("div",{dangerouslySetInnerHTML:{__html:e}})})})})})}function yj({plugin:e,onSubmit:t,isEntityTool:n}){const{register:a,handleSubmit:s,formState:{errors:r,isDirty:o,isValid:i,isSubmitting:l}}=ne(),d=kg(),u=(null==e?void 0:e.authConfig)??[];return c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full gap-6 sm:grid-cols-2",children:c.jsxs("form",{className:"col-span-1 flex w-full flex-col items-start justify-start gap-2",method:"POST",onSubmit:s((a=>t({pluginKey:(null==e?void 0:e.pluginKey)??"",action:"install",auth:a,isEntityTool:n}))),children:[u.map(((e,t)=>{const n=e.authField.split("||")[0];return c.jsxs("div",{className:"flex w-full flex-col gap-1",children:[c.jsx("label",{htmlFor:n,className:"mb-1 text-left text-sm font-medium text-gray-700/70 dark:text-gray-50/70",children:e.label}),c.jsxs(l_,{openDelay:300,children:[c.jsx(c_,{className:"grid w-full items-center gap-2",children:c.jsx("input",{type:"text",autoComplete:"off",id:n,"aria-invalid":!!r[n],"aria-describedby":`${n}-error`,"aria-label":e.label,"aria-required":"true",...a(n,{required:`${e.label} is required.`,minLength:{value:10,message:`${e.label} must be at least 10 characters long`}}),className:"flex h-10 max-h-10 w-full resize-none rounded-md border border-gray-200 bg-transparent px-3 py-2 text-sm text-gray-700 shadow-[0_0_10px_rgba(0,0,0,0.05)] outline-none placeholder:text-gray-400 focus:border-gray-400 focus:bg-gray-50 focus:outline-none focus:ring-0 focus:ring-gray-400 focus:ring-opacity-0 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-500 dark:bg-gray-700 dark:text-gray-50 dark:shadow-[0_0_15px_rgba(0,0,0,0.10)] dark:focus:border-gray-400 focus:dark:bg-gray-600 dark:focus:outline-none dark:focus:ring-0 dark:focus:ring-gray-400 dark:focus:ring-offset-0"})}),c.jsx(bj,{content:e.description,position:"right"})]}),r[n]&&c.jsx("span",{role:"alert",className:"mt-1 text-sm text-red-400",children:r[n].message})]},`${n}-${t}`)})),c.jsx("button",{disabled:!o||!i||l,type:"button",className:"btn btn-primary relative",onClick:()=>{s((a=>t({pluginKey:(null==e?void 0:e.pluginKey)??"",action:"install",auth:a,isEntityTool:n})))()},children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[d("com_ui_save"),c.jsx(et,{className:"flex h-4 w-4 items-center stroke-2"})]})})]})})})}function _j({isOpen:e,setIsOpen:t}){const a=kg(),{user:s}=Wh(),{data:r}=fh(),{setTools:o}=Ev(),[i,l]=n.useState([]),{maxPage:d,setMaxPage:u,currentPage:m,setCurrentPage:p,itemsPerPage:g,searchChanged:f,setSearchChanged:x,searchValue:h,setSearchValue:v,gridRef:b,handleSearch:y,handleChangePage:_,error:j,setError:w,errorMessage:N,setErrorMessage:C,showPluginAuthForm:k,setShowPluginAuthForm:S,selectedPlugin:T,setSelectedPlugin:I}=hb(),E=n.useCallback((e=>{var t,n;w(!0),(null==(n=null==(t=e.response)?void 0:t.data)?void 0:n.message)&&C(e.response.data.message),setTimeout((()=>{w(!1),C("")}),5e3)}),[w,C]),{installPlugin:P,uninstallPlugin:L}=function(e={}){const t=R(_p.availableTools),{onInstallError:a,onInstallSuccess:s,onUninstallError:r,onUninstallSuccess:o}=e,i=xh();return{installPlugin:n.useCallback(((e,n)=>{i.mutate(e,{onError:e=>{a&&a(e)},onSuccess:(...e)=>{t((e=>({...e,[n.pluginKey]:n}))),s&&s(...e)}})}),[i,a,s,t]),uninstallPlugin:n.useCallback((e=>{i.mutate({pluginKey:e,action:"uninstall",auth:null},{onError:e=>{r&&r(e)},onSuccess:(...n)=>{t((t=>{const n={...t};return delete n[e],n})),o&&o(...n)}})}),[i,r,o,t])}}({onInstallError:E,onUninstallError:E,onUninstallSuccess:(e,t)=>{o(t.pluginKey,!0)}}),M=(e,t)=>{t&&(P(e,t),S(!1))},A=null==r?void 0:r.filter((e=>e.name.toLowerCase().includes(h.toLowerCase())));return n.useEffect((()=>{s&&s.plugins&&l(s.plugins),A&&(u(Math.ceil(A.length/g)),f&&(p(1),x(!1)))}),[r,g,s,h,A,f,u,p,x]),c.jsxs(Cr,{open:e,onClose:()=>{t(!1),p(1),v("")},className:"relative z-[102]",children:[c.jsx("div",{className:"fixed inset-0 bg-gray-600/65 transition-opacity dark:bg-black/80"}),c.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:c.jsxs(kr,{className:"relative w-full transform overflow-hidden overflow-y-auto rounded-lg bg-white text-left shadow-xl transition-all dark:bg-gray-700 max-sm:h-full sm:mx-7 sm:my-8 sm:max-w-2xl lg:max-w-5xl xl:max-w-7xl",style:{minHeight:"610px"},children:[c.jsxs("div",{className:"flex items-center justify-between border-b-[1px] border-black/10 p-6 pb-4 dark:border-white/10",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("div",{className:"text-center sm:text-left",children:c.jsx(Sr,{className:"text-lg font-medium leading-6 text-gray-800 dark:text-gray-200",children:a("com_nav_plugin_store")})})}),c.jsx("div",{children:c.jsx("div",{className:"sm:mt-0",children:c.jsx("button",{onClick:()=>{t(!1),p(1)},className:"inline-block text-gray-500 hover:text-gray-200",tabIndex:0,children:c.jsx(ve,{})})})})]}),j&&c.jsxs("div",{className:"relative m-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",role:"alert",children:[a("com_nav_plugin_auth_error")," ",N]}),k&&c.jsx("div",{className:"p-4 sm:p-6 sm:pt-4",children:c.jsx(yj,{plugin:T,onSubmit:e=>M(e,T)})}),c.jsxs("div",{className:"p-4 sm:p-6 sm:pt-4",children:[c.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[c.jsx("div",{className:"flex items-center",children:c.jsxs("div",{className:"relative flex items-center",children:[c.jsx(Qe,{className:"absolute left-2 h-6 w-6 text-gray-500"}),c.jsx("input",{type:"text",value:h,onChange:y,placeholder:a("com_nav_plugin_search"),className:"\n                    text-token-text-primary flex rounded-md border border-border-heavy bg-surface-tertiary py-2 pl-10 pr-2"})]})}),c.jsx("div",{ref:b,className:"grid grid-cols-1 grid-rows-2 gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",style:{minHeight:"410px"},children:A&&A.slice((m-1)*g,m*g).map(((e,t)=>c.jsx(vj,{plugin:e,isInstalled:i.includes(e.pluginKey),onInstall:()=>(e=>{const t=null==r?void 0:r.find((t=>t.pluginKey===e));if(!t)return;I(t);const{authConfig:n,authenticated:a}=t??{};n&&n.length>0&&!a?S(!0):M({pluginKey:e,action:"install",auth:null},t)})(e.pluginKey),onUninstall:()=>L(e.pluginKey)},t)))})]}),c.jsx("div",{className:"mt-2 flex flex-col items-center gap-2 sm:flex-row sm:justify-between",children:d>0?c.jsx(hj,{currentPage:m,maxPage:d,onChangePage:_}):c.jsx("div",{style:{height:"21px"}})})]})]})})]})}const jj=_.memo((()=>{const[e]=Z(),t=e.get("tempToken"),a=null!==t&&""!==t?t:"",{control:s,handleSubmit:r,formState:{errors:o}}=ne(),i=kg(),{showToast:l}=Ng(),[d,u]=n.useState(!1),[m,p]=n.useState(!1),{mutate:g}=(e=>{const t=ar();return sr((e=>zd.verifyTwoFactorTemp(e)),{...e||{},onSuccess:(n,...a)=>{var s;t.setQueryData([Xc.user,"2fa"],n),null==(s=null==e?void 0:e.onSuccess)||s.call(e,n,...a)}})})({onSuccess:e=>{null!=e.token&&""!==e.token&&(window.location.href="/")},onMutate:()=>{p(!0)},onError:e=>{var t,n;p(!1);const a=e,s="string"==typeof(null==(n=null==(t=a.response)?void 0:t.data)?void 0:n.message)?a.response.data.message:"Error verifying 2FA";l({message:s,status:"error"})}}),f=n.useCallback((e=>{const t={tempToken:a};d&&null!=e.backupCode&&""!==e.backupCode?t.backupCode=e.backupCode:null!=e.token&&""!==e.token&&(t.token=e.token),g(t)}),[a,d,g]),x=n.useCallback((()=>{u(!0)}),[]),h=n.useCallback((()=>{u(!1)}),[]);return c.jsx("div",{className:"mt-4",children:c.jsxs("form",{onSubmit:r(f),children:[c.jsx(g_,{className:"flex justify-center break-keep text-center text-sm text-text-primary",children:i("com_auth_two_factor")}),!d&&c.jsxs("div",{className:"my-4 flex justify-center text-text-primary",children:[c.jsx(tt,{name:"token",control:s,render:({field:{onChange:e,value:t}})=>c.jsxs(V_,{maxLength:6,value:null!=t?t:"",onChange:e,pattern:nt,children:[c.jsxs(B_,{children:[c.jsx($_,{index:0}),c.jsx($_,{index:1}),c.jsx($_,{index:2})]}),c.jsx(H_,{}),c.jsxs(B_,{children:[c.jsx($_,{index:3}),c.jsx($_,{index:4}),c.jsx($_,{index:5})]})]})}),o.token&&c.jsx("span",{className:"text-sm text-red-500",children:o.token.message})]}),d&&c.jsxs("div",{className:"my-4 flex justify-center text-text-primary",children:[c.jsx(tt,{name:"backupCode",control:s,render:({field:{onChange:e,value:t}})=>c.jsx(V_,{maxLength:8,value:null!=t?t:"",onChange:e,pattern:at,children:c.jsxs(B_,{children:[c.jsx($_,{index:0}),c.jsx($_,{index:1}),c.jsx($_,{index:2}),c.jsx($_,{index:3}),c.jsx($_,{index:4}),c.jsx($_,{index:5}),c.jsx($_,{index:6}),c.jsx($_,{index:7})]})})}),o.backupCode&&c.jsx("span",{className:"text-sm text-red-500",children:o.backupCode.message})]}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsx("button",{type:"submit","aria-label":i("com_auth_continue"),"data-testid":"login-button",disabled:m,className:"w-full rounded-2xl bg-green-600 px-4 py-3 text-sm font-medium text-white transition-colors hover:bg-green-700 disabled:opacity-80 dark:bg-green-600 dark:hover:bg-green-700",children:i(m?"com_auth_email_verifying_ellipsis":"com_ui_verify")})}),c.jsx("div",{className:"mt-4 flex justify-center",children:d?c.jsx("button",{type:"button",onClick:h,className:"inline-flex p-1 text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:i("com_ui_use_2fa_code")}):c.jsx("button",{type:"button",onClick:x,className:"inline-flex p-1 text-sm font-medium text-green-600 transition-colors hover:text-green-700 dark:text-green-400 dark:hover:text-green-300",children:i("com_ui_use_backup_code")})})]})})})),wj=e=>e.split("\n").map((e=>e.trim())).filter(Boolean).map(((e,t)=>({number:t+1,content:e}))),Nj=async()=>{const e=await(async()=>{if("userAgentData"in navigator)try{const e=navigator.userAgentData,t=await e.getHighEntropyValues(["platform","platformVersion"]);return{os:t.platform,version:t.platformVersion}}catch(Bg){om.warn("Failed to get high entropy values"),om.error(Bg)}const e=navigator.userAgent.toLowerCase();return e.includes("mac")?{os:"macOS"}:e.includes("win")?{os:"Windows"}:e.includes("linux")?{os:"Linux"}:e.includes("android")?{os:"Android"}:e.includes("ios")||e.includes("iphone")||e.includes("ipad")?{os:"iOS"}:{os:"Unknown"}})();return{userAgent:navigator.userAgent,platform:e.os,platformVersion:e.version,language:navigator.language,windowSize:`${window.innerWidth}x${window.innerHeight}`}};function Cj(){const e=st(),t={message:e.message??"An unexpected error occurred",stack:e.stack,status:e.status,statusText:e.statusText,data:e.data};return c.jsx("div",{role:"alert",className:"flex min-h-screen flex-col items-center justify-center bg-surface-primary bg-gradient-to-br",children:c.jsxs("div",{className:"bg-surface-primary/60 mx-4 w-11/12 max-w-4xl rounded-2xl border border-border-light p-8 shadow-2xl backdrop-blur-xl",children:[c.jsx("h2",{className:"mb-6 text-center text-3xl font-medium tracking-tight text-text-primary",children:"Oops! Something Unexpected Occurred"}),c.jsxs("div",{className:"mb-4 rounded-xl border border-red-500/20 bg-red-500/5 p-4 text-sm text-gray-600 dark:text-gray-200",children:[c.jsx("h3",{className:"mb-2 font-medium",children:"Error Message:"}),c.jsx("pre",{className:"whitespace-pre-wrap text-sm font-light leading-relaxed text-text-primary",children:t.message})]}),("number"==typeof t.status||"string"==typeof t.statusText)&&c.jsxs("div",{className:"mb-4 rounded-xl border border-yellow-500/20 bg-yellow-500/5 p-4 text-sm text-text-primary",children:[c.jsx("h3",{className:"mb-2 font-medium",children:"Status:"}),c.jsxs("p",{className:"text-text-primary",children:["number"==typeof t.status&&`${t.status} `,"string"==typeof t.statusText&&t.statusText]})]}),null!=t.stack&&""!==t.stack.trim()&&c.jsxs("details",{className:"group mb-4 rounded-xl border border-border-light p-4",children:[c.jsxs("summary",{className:"mb-2 flex cursor-pointer items-center justify-between text-sm font-medium text-text-primary",children:[c.jsx("span",{children:"Stack Trace"}),c.jsx("div",{className:"flex items-center",children:c.jsx(By,{variant:"outline",size:"sm",onClick:async()=>{null!=t.stack&&""!==t.stack&&await navigator.clipboard.writeText(t.stack)},className:"ml-2 px-2 py-1 text-xs",children:"Copy"})})]}),c.jsx("div",{className:"overflow-x-auto rounded-lg bg-black/5 p-4 dark:bg-white/5",children:wj(t.stack).map((({number:e,content:t})=>c.jsxs("div",{className:"flex",children:[c.jsx("span",{className:"select-none pr-4 font-mono text-xs text-text-secondary",children:String(e).padStart(3,"0")}),c.jsx("pre",{className:"flex-1 font-mono text-xs leading-relaxed text-text-primary",children:t})]},e)))})]}),null!=t.data&&c.jsxs("details",{className:"group mb-4 rounded-xl border border-border-light p-4",children:[c.jsxs("summary",{className:"mb-2 flex cursor-pointer items-center justify-between text-sm font-medium text-text-primary",children:[c.jsx("span",{children:"Additional Details"}),c.jsx("span",{className:"transition-transform group-open:rotate-90",children:">"})]}),c.jsx("pre",{className:"whitespace-pre-wrap text-xs font-light leading-relaxed text-text-primary",children:JSON.stringify(t.data,null,2)})]}),c.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[c.jsx("p",{className:"text-sm font-light text-text-secondary",children:"Please try one of the following:"}),c.jsxs("ul",{className:"list-inside list-disc text-sm text-text-secondary",children:[c.jsx("li",{children:"Refresh the page"}),c.jsx("li",{children:"Clear your browser cache"}),c.jsx("li",{children:"Check your internet connection"}),c.jsx("li",{children:"Contact the Admin if the issue persists"})]}),c.jsxs("div",{className:"mt-4 flex flex-col items-center gap-4 sm:flex-row sm:justify-center",children:[c.jsx(By,{variant:"submit",onClick:()=>window.location.reload(),className:"w-full sm:w-auto",children:"Refresh Page"}),c.jsx(By,{variant:"outline",onClick:async()=>{try{const e=await Nj(),n={timestamp:(new Date).toISOString(),browser:e,error:{...t,stack:null!=t.stack&&""!==t.stack.trim()?wj(t.stack):void 0}},a=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`error-log-${(new Date).toISOString()}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}catch(Bg){om.warn("Failed to download error logs:"),om.error(Bg)}},className:"w-full sm:w-auto",children:"Download Error Logs"})]})]})]})})}const kj=({active:e,children:t})=>e?c.jsxs(c.Fragment,{children:[c.jsx("style",{children:"\n  @keyframes blink-animation {\n    0%,\n    100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0;\n    }\n  }"}),c.jsx("div",{style:{animation:"blink-animation 3s infinite"},children:t})]}):c.jsx(c.Fragment,{children:t}),Sj=({id:e,enabled:t,serverDomain:n,oauthPath:a,Icon:s,label:r})=>t?c.jsx("div",{className:"mt-2 flex gap-x-2",children:c.jsxs("a",{"aria-label":`${r}`,className:"flex w-full items-center space-x-3 rounded-2xl border border-border-light bg-surface-primary px-5 py-3 text-text-primary transition-colors duration-200 hover:bg-surface-tertiary",href:`${n}/oauth/${a}`,"data-testid":e,children:[c.jsx(s,{}),c.jsx("p",{children:r})]})}):null;function Tj({startupConfig:e}){var t;const n=kg();if(!e)return null;const a={discord:e.discordLoginEnabled&&c.jsx(Sj,{enabled:e.discordLoginEnabled,serverDomain:e.serverDomain,oauthPath:"discord",Icon:sy,label:n("com_auth_discord_login"),id:"discord"},"discord"),facebook:e.facebookLoginEnabled&&c.jsx(Sj,{enabled:e.facebookLoginEnabled,serverDomain:e.serverDomain,oauthPath:"facebook",Icon:ty,label:n("com_auth_facebook_login"),id:"facebook"},"facebook"),github:e.githubLoginEnabled&&c.jsx(Sj,{enabled:e.githubLoginEnabled,serverDomain:e.serverDomain,oauthPath:"github",Icon:ay,label:n("com_auth_github_login"),id:"github"},"github"),google:e.googleLoginEnabled&&c.jsx(Sj,{enabled:e.googleLoginEnabled,serverDomain:e.serverDomain,oauthPath:"google",Icon:ey,label:n("com_auth_google_login"),id:"google"},"google"),apple:e.appleLoginEnabled&&c.jsx(Sj,{enabled:e.appleLoginEnabled,serverDomain:e.serverDomain,oauthPath:"apple",Icon:ry,label:n("com_auth_apple_login"),id:"apple"},"apple"),openid:e.openidLoginEnabled&&c.jsx(Sj,{enabled:e.openidLoginEnabled,serverDomain:e.serverDomain,oauthPath:"openid",Icon:()=>e.openidImageUrl?c.jsx("img",{src:e.openidImageUrl,alt:"OpenID Logo",className:"h-5 w-5"}):c.jsx(ny,{}),label:e.openidLabel,id:"openid"},"openid")};return e.socialLoginEnabled&&c.jsxs(c.Fragment,{children:[e.emailLoginEnabled&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"relative mt-6 flex w-full items-center justify-center border border-t border-gray-300 uppercase dark:border-gray-600",children:c.jsx("div",{className:"absolute bg-white px-3 text-xs text-black dark:bg-gray-900 dark:text-white",children:"Or"})}),c.jsx("div",{className:"mt-8"})]}),c.jsx("div",{className:"mt-2",children:null==(t=e.socialLogins)?void 0:t.map((e=>a[e]||null))})]})}const Rj=({onHeightChange:e})=>{const{data:t}=(e=>{const t=I(_p.queriesEnabled);return nr([Xc.banner],(()=>zd.getBanner()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e,enabled:t})})(),[a,s]=T(_p.hideBannerHint),r=n.useRef(null);if(n.useEffect((()=>{e&&r.current&&e(r.current.offsetHeight)}),[t,a,e]),!t||t.bannerId&&a.includes(t.bannerId))return null;return c.jsxs("div",{ref:r,className:"sticky top-0 z-20 flex items-center bg-neutral-900 from-gray-700 to-gray-900 px-2 py-1 text-slate-50 dark:bg-gradient-to-r dark:text-white md:relative",children:[c.jsx("div",{className:"w-full truncate px-4 text-center text-sm",dangerouslySetInnerHTML:{__html:t.message}}),c.jsx("button",{type:"button","aria-label":"Dismiss banner",className:"h-8 w-8 opacity-80 hover:opacity-100",onClick:()=>{s([...a,t.bannerId]),e&&e(0)},children:c.jsx(ve,{className:"mx-auto h-4 w-4"})})]})};function Ij({startupConfig:e}){var t,n;const a=kg();if(!e)return null;const s=null==(t=e.interface)?void 0:t.privacyPolicy,r=null==(n=e.interface)?void 0:n.termsOfService,o=(null==s?void 0:s.externalUrl)&&c.jsx("a",{className:"text-sm text-green-500",href:s.externalUrl,target:s.openNewTab?"_blank":void 0,rel:"noreferrer",children:a("com_ui_privacy_policy")}),i=(null==r?void 0:r.externalUrl)&&c.jsx("a",{className:"text-sm text-green-500",href:r.externalUrl,target:r.openNewTab?"_blank":void 0,rel:"noreferrer",children:a("com_ui_terms_of_service")});return c.jsxs("div",{className:"align-end m-4 flex justify-center gap-2",role:"contentinfo",children:[o,o&&i&&c.jsx("div",{className:"border-r-[1px] border-gray-300 dark:border-gray-600"}),i]})}const Ej=({children:e})=>c.jsx("div",{className:"mt-16 flex justify-center",children:c.jsx("div",{role:"alert","aria-live":"assertive",className:"rounded-md border border-red-500 bg-red-500/10 px-3 py-2 text-sm text-gray-600 dark:text-gray-200",children:e})});function Pj({children:e,header:t,isFetching:n,startupConfig:a,startupConfigError:s,pathname:r,error:o}){const i=kg(),l=null!=s,d=()=>l?c.jsx(Ej,{children:i("com_auth_error_login_server")}):"com_auth_error_invalid_reset_token"===o?c.jsxs(Ej,{children:[i("com_auth_error_invalid_reset_token")," ",c.jsx("a",{className:"font-semibold text-green-600 hover:underline",href:"/forgot-password",children:i("com_auth_click_here")})," ",i("com_auth_to_try_again")]}):null!=o&&o?c.jsx(Ej,{children:i(o)}):null;return c.jsxs("div",{className:"relative flex min-h-screen flex-col bg-white dark:bg-gray-900",children:[c.jsx(Rj,{}),c.jsx(kj,{active:n,children:c.jsx("div",{className:"mt-6 h-10 w-full bg-cover",children:c.jsx("img",{src:"/assets/logo.svg",className:"h-full w-full object-contain",alt:i("com_ui_logo",{0:(null==a?void 0:a.appTitle)??"LibreChat"})})})}),c.jsx(d,{}),c.jsx("div",{className:"absolute bottom-0 left-0 md:m-4",children:c.jsx(ej,{})}),c.jsx("div",{className:"flex flex-grow items-center justify-center",children:c.jsxs("div",{className:"w-authPageWidth overflow-hidden bg-white px-6 py-4 dark:bg-gray-900 sm:max-w-md sm:rounded-lg",children:[!l&&!n&&c.jsx("h1",{className:"mb-4 text-center text-3xl font-semibold text-black dark:text-white",style:{userSelect:"none"},children:t}),e,!r.includes("2fa")&&(r.includes("login")||r.includes("register"))&&c.jsx(Tj,{startupConfig:a})]})}),c.jsx(Ij,{startupConfig:a})]})}const Lj={"/login":"com_auth_welcome_back","/register":"com_auth_create_account","/forgot-password":"com_auth_reset_password","/reset-password":"com_auth_reset_password","/login/2fa":"com_auth_verify_your_identity"};function Mj({isAuthenticated:e}){const[t,a]=n.useState(null),[s,r]=n.useState(null),[o,i]=n.useState(null),{data:l,isFetching:d,error:u}=Ap({enabled:!e||null===o}),m=kg(),p=D(),g=z();n.useEffect((()=>{e&&p("/c/new",{replace:!0}),l&&i(l)}),[e,p,l]),n.useEffect((()=>{document.title=(null==o?void 0:o.appTitle)||"LibreChat"}),[null==o?void 0:o.appTitle]),n.useEffect((()=>{a(null),r(null)}),[g.pathname]);const f={error:t,setError:a,headerText:s,setHeaderText:r,startupConfigError:u,startupConfig:o,isFetching:d};return c.jsx(Pj,{header:m(s||Lj[g.pathname]),isFetching:d,startupConfig:o,startupConfigError:u,pathname:g.pathname,error:t,children:c.jsx(rt,{context:f})})}function Aj(){const{isAuthenticated:e}=Wh(),[t,a]=T(_p.queriesEnabled);return n.useEffect((()=>{if(t)return;const e=setTimeout((()=>{a(!0)}),500);return()=>{clearTimeout(e)}}),[t,a]),c.jsx(Mj,{isAuthenticated:e})}const Oj=({name:e,onSave:t})=>{const a=n.useRef(null),s=n.useRef(),[r,o]=n.useState(!1),[i,l]=n.useState(e),d=()=>{const e=null==i?void 0:i.trim();t(e||""),o(!1)};return n.useEffect((()=>{var e;r&&(null==(e=a.current)||e.focus())}),[r]),n.useEffect((()=>{l(e)}),[e]),c.jsx("div",{className:"flex items-center",children:c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center"},className:"gap-2",children:r?c.jsxs(c.Fragment,{children:[c.jsx(m_,{type:"text",value:i??"",onChange:e=>{l(e.target.value)},onKeyDown:t=>{"Escape"===t.key&&(o(!1),l(e)),"Enter"===t.key&&d()},ref:a,className:"flex w-full max-w-none rounded-lg text-2xl font-bold transition duration-200",style:{whiteSpace:"nowrap",textOverflow:"ellipsis"}}),c.jsx(By,{onClick:()=>{d(),clearTimeout(s.current)},variant:"ghost",size:"sm",className:"h-10 flex-shrink-0","aria-label":"Save prompt name",children:c.jsx(Ry,{className:"icon-md"})})]}):c.jsxs(c.Fragment,{children:[c.jsx(g_,{className:"text-2xl font-bold",style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:i}),c.jsx(By,{onClick:()=>{o(!0)},variant:"ghost",size:"sm","aria-label":"Edit prompt name",className:"h-10 flex-shrink-0",children:c.jsx(Bb,{className:"icon-md"})})]})})})};function Dj({setName:e,className:t=""}){const a=kg(),[s,r]=n.useState(""),o=R(_p.promptsCategory),i=I(_p.promptsCategory),{categories:l}=wb("h-4 w-4"),[d,u]=n.useState(!1),m=n.useMemo((()=>[...[{value:gc.ALL,label:a("com_ui_all_proper"),icon:c.jsx(ot,{className:"h-4 w-4 text-text-primary"})},{value:gc.MY_PROMPTS,label:a("com_ui_my_prompts"),icon:c.jsx(it,{className:"h-4 w-4 text-text-primary"})},{value:gc.SHARED_PROMPTS,label:a("com_ui_shared_prompts"),icon:c.jsx(lt,{className:"h-4 w-4 text-text-primary"})},{divider:!0,value:null}],...l?[...l]:[{value:gc.NO_CATEGORY,label:a("com_ui_no_category")}]]),[l,a]),p=n.useCallback((e=>{e===gc.ALL?o(""):o(e)}),[o]);return n.useEffect((()=>{u(!0);const e=setTimeout((()=>{u(!1)}),500);return()=>clearTimeout(e)}),[s]),c.jsxs("div",{className:rm("flex w-full gap-2 text-text-primary",t),children:[c.jsx(q_,{value:i||gc.ALL,onChange:p,options:m,className:"bg-transparent",icon:c.jsx(ot,{className:"h-4 w-4"}),label:"Filter: ",ariaLabel:a("com_ui_filter_prompts"),iconOnly:!0}),c.jsx(dj,{value:s,onChange:t=>{r(t.target.value),e(t.target.value)},isSearching:d,placeholder:a("com_ui_filter_prompts_name")})]})}const{promptsEditorMode:Fj,alwaysMakeProd:zj}=_p,Uj=()=>{const e=kg(),[t,n]=T(Fj),a=R(zj);return c.jsx("div",{className:"relative flex h-10 items-center justify-center rounded-xl border border-border-light bg-surface-primary transition-all duration-300",children:c.jsxs("div",{className:"relative flex w-48 items-stretch md:w-64",children:[c.jsx("div",{className:"absolute rounded-lg bg-surface-hover shadow-lg transition-all duration-300 ease-in-out",style:{top:"1px",left:t===zr.SIMPLE?"2px":"calc(50% + 2px)",width:"calc(50% - 4px)",height:"calc(100% - 2px)"}}),c.jsx("button",{type:"button",onClick:()=>{a(!0),n(zr.SIMPLE)},className:"relative z-10 flex-1 rounded-xl px-3 py-2 text-sm font-medium transition-all duration-300 md:px-6 "+(t===zr.SIMPLE?"text-text-primary":"text-text-secondary hover:text-text-primary"),children:c.jsx("span",{className:"relative",children:e("com_ui_simple")})}),c.jsx("button",{type:"button",onClick:()=>n(zr.ADVANCED),className:"relative z-10 flex-1 rounded-xl px-3 py-2 text-sm font-medium transition-all duration-300 md:px-6 "+(t===zr.ADVANCED?"text-text-primary":"text-text-secondary hover:text-text-primary"),children:c.jsx("span",{className:"relative",children:e("com_ui_advanced")})})]})})},Vj=({control:e,promptPerm:t,label:n,confirmChange:a})=>c.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[n,c.jsx(tt,{name:t,control:e,render:({field:e})=>c.jsx(R_,{...e,checked:e.value,onCheckedChange:t=>{!1===t&&a?a(t,e.onChange):e.onChange(t)},value:e.value.toString()})})]}),Bj=()=>{const e=kg(),{user:t,roles:a}=Wh(),{showToast:s}=Ng(),[r,o]=n.useState(null),{mutate:i,isLoading:l}=(e=>{const t=ar(),{onMutate:n,onSuccess:a,onError:s}=e??{};return sr((e=>(td.partial().parse(e.updates),zd.updatePromptPermissions(e))),{onSuccess:(e,n,s)=>{t.invalidateQueries([Xc.roles,n.roleName]),a&&a(e,n,s)},onError:(...e)=>{const t=e[0];null!=t&&console.error("Failed to update prompt permissions:",t),s&&s(...e)},onMutate:n})})({onSuccess:()=>{s({status:"success",message:e("com_ui_saved")})},onError:()=>{s({status:"error",message:e("com_ui_error_save_admin_settings")})}}),[d,u]=n.useState(!1),[m,p]=n.useState(qc.USER),g=n.useMemo((()=>(null==a?void 0:a[m])?a[m][Zc.PROMPTS]:ld[m][Zc.PROMPTS]),[a,m]),{reset:f,control:x,setValue:h,getValues:v,handleSubmit:b,formState:{isSubmitting:y}}=ne({mode:"onChange",defaultValues:g});if(n.useEffect((()=>{var e;(null==(e=null==a?void 0:a[m])?void 0:e[Zc.PROMPTS])?f(a[m][Zc.PROMPTS]):f(ld[m][Zc.PROMPTS])}),[a,m,f]),(null==t?void 0:t.role)!==qc.ADMIN)return null;const _=[{promptPerm:Yc.SHARED_GLOBAL,label:e("com_ui_prompts_allow_share_global")},{promptPerm:Yc.CREATE,label:e("com_ui_prompts_allow_create")},{promptPerm:Yc.USE,label:e("com_ui_prompts_allow_use")}],j=[{label:qc.USER,onClick:()=>{p(qc.USER)}},{label:qc.ADMIN,onClick:()=>{p(qc.ADMIN)}}];return c.jsxs(c.Fragment,{children:[c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsxs(By,{size:"sm",variant:"outline",className:"mr-2 h-10 w-fit gap-1 border transition-all dark:bg-transparent dark:hover:bg-surface-tertiary sm:m-0",children:[c.jsx(ct,{className:"cursor-pointer","aria-hidden":"true"}),c.jsx("span",{className:"hidden sm:flex",children:e("com_ui_admin")})]})}),c.jsxs(y_,{className:"w-11/12 max-w-lg border-border-light bg-surface-primary text-text-primary",children:[c.jsx(w_,{children:`${e("com_ui_admin_settings")} - ${e("com_ui_prompts")}`}),c.jsxs("div",{className:"p-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"font-medium",children:[e("com_ui_role_select"),":"]}),c.jsx(Y_,{menuId:"prompt-role-dropdown",isOpen:d,setIsOpen:u,trigger:c.jsx(dt,{className:"inline-flex w-1/5 items-center justify-center rounded-lg border border-border-light bg-transparent px-2 py-1 text-text-primary transition-all ease-in-out hover:bg-surface-tertiary",children:m}),items:j,itemClassName:"items-center justify-center",sameWidth:!0})]}),c.jsxs("form",{onSubmit:b((e=>{i({roleName:m,updates:e})})),children:[c.jsx("div",{className:"py-5",children:_.map((({promptPerm:t,label:n})=>c.jsxs("div",{children:[c.jsx(Vj,{control:x,promptPerm:t,label:n,getValues:v,setValue:h,...m===qc.ADMIN&&t===Yc.USE?{confirmChange:(e,t)=>o({newValue:e,callback:t})}:{}}),m===qc.ADMIN&&t===Yc.USE&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"mb-2 max-w-full whitespace-normal break-words text-sm text-red-600",children:[c.jsx("span",{children:e("com_ui_admin_access_warning")}),"\n",c.jsxs("a",{href:"https://www.librechat.ai/docs/configuration/librechat_yaml/object_structure/interface",target:"_blank",rel:"noreferrer",className:"inline-flex items-center text-blue-500 underline",children:[e("com_ui_more_info"),c.jsx(ut,{size:16,className:"ml-1"})]})]})})]},t)))}),c.jsx("div",{className:"flex justify-end",children:c.jsx(By,{type:"submit",disabled:y||l,variant:"submit",children:e("com_ui_save")})})]})]})]})]}),c.jsx(f_,{open:null!==r,onOpenChange:e=>{e||o(null)},children:c.jsx(ij,{showCloseButton:!0,title:e("com_ui_confirm_change"),className:"w-11/12 max-w-lg",main:c.jsx("p",{className:"mb-4",children:e("com_ui_confirm_admin_use_change")}),selection:{selectHandler:()=>{r&&r.callback(r.newValue),o(null)},selectClasses:"bg-surface-destructive hover:bg-surface-destructive-hover text-white transition-colors duration-200",selectText:e("com_ui_confirm_action"),isLoading:!1}})})]})},$j=/prompts\/(?!new(?:\/|$)).*$/,Hj=e=>{if(!e||e.includes("/d/"))return"new";const t=e.split("/");return t[t.length-1]};function Gj(){const e=z(),t=kg(),{user:a}=Wh(),{prevLocationPath:s}=xv(),r=n.useMemo((()=>Hj(s)),[s]),o=R(_p.promptsName),i=R(_p.promptsCategory);I(_p.promptsEditorMode);const l=Vv("/c/"+r,n.useCallback((()=>{o(""),i("")}),[o,i])),d=Vv("/d/prompts"),u=n.useMemo((()=>$j.test(e.pathname)),[e.pathname]);return c.jsxs("div",{className:"mr-2 mt-2 flex h-10 items-center justify-between",children:[c.jsx(Oy,{className:"mt-1 px-2 dark:text-gray-200",children:c.jsxs(Dy,{children:[c.jsx(Fy,{className:"hover:dark:text-white",children:c.jsxs(zy,{href:"/",className:"flex flex-row items-center gap-1",onClick:l,children:[c.jsx(mt,{className:"icon-xs","aria-hidden":"true"}),c.jsx("span",{className:"hidden md:flex",children:t("com_ui_back_to_chat")}),c.jsx("span",{className:"flex md:hidden",children:t("com_ui_chat")})]})}),c.jsx(Uy,{}),c.jsx(Fy,{className:"hover:dark:text-white",children:c.jsxs(zy,{href:"/d/prompts",className:"flex flex-row items-center gap-1",onClick:d,children:[c.jsx(pt,{className:"h-4 w-4 dark:text-gray-300","aria-hidden":"true"}),t("com_ui_prompts")]})})]})}),c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u&&c.jsx(Uj,{}),(null==a?void 0:a.role)===qc.ADMIN&&c.jsx(Bj,{})]})]})}const Kj=n.memo((function({prevPage:e,nextPage:t,hasPreviousPage:n,hasNextPage:a,isFetching:s,isChatRoute:r}){const o=kg();return c.jsxs("div",{className:"my-1 flex justify-between",children:[c.jsx("div",{className:"mb-2 flex gap-2",children:!r&&c.jsx(ej,{returnThemeOnly:!0})}),c.jsxs("div",{className:"mb-2 flex gap-2",children:[c.jsx(By,{variant:"outline",size:"sm",onClick:()=>e(),disabled:!n,children:o("com_ui_prev")}),c.jsx(By,{variant:"outline",size:"sm",onClick:()=>t(),disabled:!a||s,children:o("com_ui_next")})]})]})}));const Wj=n.memo((function({group:e,instanceProjectId:t}){const a=B(),s=D(),r=kg(),{user:o}=Wh(),i=n.useRef(null),[l,u]=n.useState(e.name),m=n.useMemo((()=>(null==o?void 0:o.id)===e.author),[null==o?void 0:o.id,e.author]),p=n.useMemo((()=>{var n;return t&&(null==(n=e.projectIds)?void 0:n.includes(t))}),[e.projectIds,t]),g=bg({onMutate:()=>{i.current&&clearTimeout(i.current)}}),f=(e=>{const t=ar(),{onSuccess:n,...a}=e||{},s=I(_p.promptsName),r=I(_p.promptsPageSize),o=I(_p.promptsCategory);return sr({mutationFn:e=>zd.deletePromptGroup(e.id),...a,onSuccess:(e,a,i)=>{t.setQueryData([Xc.promptGroups,s,o,r],(e=>e?em(e,a.id):e)),sm(t,a.id),n&&n(e,a,i)}})})({onSuccess:(t,n)=>{n.id===e._id&&s("/d/prompts")}}),{isLoading:x}=g,h=n.useCallback((()=>{console.log(e._id??"",{name:l}),g.mutate({id:e._id??"",payload:{name:l}})}),[e._id,l,g]),v=n.useCallback((t=>{"Enter"===t.key&&(t.preventDefault(),s(`/d/prompts/${e._id}`,{replace:!0}))}),[e._id,s]),b=n.useCallback((()=>{f.mutate({id:e._id??""})}),[e._id,f]),y=n.useCallback((()=>{s(`/d/prompts/${e._id}`,{replace:!0})}),[e._id,s]);return c.jsx("div",{className:rm("mx-2 my-2 flex cursor-pointer rounded-lg border border-border-light bg-surface-primary p-3 shadow-sm transition-all duration-300 ease-in-out hover:bg-surface-secondary",a.promptId===e._id&&"bg-surface-hover"),onClick:y,onKeyDown:v,role:"button",tabIndex:0,"aria-label":`${e.name} prompt group`,children:c.jsxs("div",{className:"flex w-full items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 truncate pr-2",children:[c.jsx(yb,{category:e.category??"",className:"icon-lg","aria-hidden":"true"}),c.jsx(g_,{className:"text-md cursor-pointer truncate font-semibold text-text-primary",children:e.name})]}),c.jsxs("div",{className:"flex h-full items-center gap-2",children:[p&&c.jsx(d,{className:"icon-md text-green-500","aria-label":r("com_ui_global_group")}),(m||(null==o?void 0:o.role)===qc.ADMIN)&&c.jsxs(c.Fragment,{children:[c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"ghost",onClick:e=>e.stopPropagation(),className:"h-8 w-8 p-0 hover:bg-surface-hover","aria-label":r("com_ui_rename_prompt")+" "+e.name,children:c.jsx(gt,{className:"icon-sm text-text-primary","aria-hidden":"true"})})}),c.jsx(ij,{showCloseButton:!1,title:r("com_ui_rename_prompt"),className:"w-11/12 max-w-lg",main:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(m_,{value:l,onChange:e=>u(e.target.value),className:"w-full","aria-label":r("com_ui_rename_prompt")+" "+e.name})})}),selection:{selectHandler:h,selectClasses:"bg-surface-submit hover:bg-surface-submit-hover text-white disabled:hover:bg-surface-submit",selectText:r("com_ui_save"),isLoading:x}})]}),c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-surface-hover",onClick:e=>e.stopPropagation(),"aria-label":r("com_ui_delete_prompt")+" "+e.name,children:c.jsx(uy,{className:"icon-sm text-text-primary","aria-hidden":"true"})})}),c.jsx(ij,{showCloseButton:!1,title:r("com_ui_delete_prompt"),className:"w-11/12 max-w-lg",main:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsxs(g_,{htmlFor:"confirm-delete",className:"text-left text-sm font-medium",children:[r("com_ui_delete_confirm")," ",c.jsx("strong",{children:e.name})]})})}),selection:{selectHandler:b,selectClasses:"bg-red-600 dark:bg-red-600 hover:bg-red-700 dark:hover:bg-red-800 text-white",selectText:r("com_ui_delete")}})]})]})]})]})})}));function Qj({file:e,fileType:t}){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36",fill:"none",className:"h-10 w-10 flex-shrink-0",width:"36",height:"36",children:[c.jsx("rect",{width:"36",height:"36",rx:"6",fill:t.fill}),((null==e?void 0:e.progress)??1)>=1&&c.jsx(c.Fragment,{children:c.jsx(t.paths,{})})]})}function qj({circumference:e,offset:t,circleCSSProperties:n}){return c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",className:"h-6 w-6",children:[c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 stroke-gray-400",strokeWidth:"10",fill:"transparent",r:"55",cx:"60",cy:"60"}),c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 transition-[stroke-dashoffset]",stroke:"currentColor",strokeWidth:"10",strokeDasharray:`${e} ${e}`,strokeDashoffset:t,fill:"transparent",r:"55",cx:"60",cy:"60",style:n})]})})}const Zj={[Ul.anyscale]:"/assets/anyscale.png",[Ul.apipie]:"/assets/apipie.png",[Ul.cohere]:"/assets/cohere.png",[Ul.deepseek]:"/assets/deepseek.svg",[Ul.fireworks]:"/assets/fireworks.png",[Ul.groq]:"/assets/groq.png",[Ul.huggingface]:"/assets/huggingface.svg",[Ul.mistral]:"/assets/mistral.png",[Ul.mlx]:"/assets/mlx.png",[Ul.ollama]:"/assets/ollama.png",[Ul.openrouter]:"/assets/openrouter.png",[Ul.perplexity]:"/assets/perplexity.png",[Ul.shuttleai]:"/assets/shuttleai.png",[Ul["together.ai"]]:"/assets/together.png",[Ul.unify]:"/assets/unify.webp",[Ul.xai]:"/assets/xai.svg"},Yj={[Ul.cohere]:{[$r.landing]:"p-2"},[Ul.xai]:{[$r.landing]:"p-2",[$r.menuItem]:"bg-white",[$r.message]:"bg-white",[$r.nav]:"bg-white"}},Jj=({currentEndpoint:e,context:t="",className:n})=>{var a;if(e===Ul.openrouter)return n;return rm((null==(a=Yj[e])?void 0:a[t])??"",t===$r.landing?"":n)};const Xj=n.memo((function({className:e="",endpoint:t,iconURL:n="",context:a}){const s=t??"";if(!s)return c.jsx(Qb,{className:e});const r=s.toLowerCase();if(n)return c.jsx("img",{className:e,src:n,alt:`${s} Icon`});const o=Zj[r]??"";return o?c.jsx("img",{className:Jj({currentEndpoint:r,context:a,className:e}),src:o,alt:`${r} Icon`}):c.jsx(Qb,{className:e})}));function ew(e){const t=(null==e?void 0:e.toLowerCase())??"";return t&&/\b(o1|o3)\b/i.test(t)?"#000000":t.includes("gpt-4")?"#AB68FF":"#19C37D"}function tw(e,t){return!0===(null==e?void 0:e.toLowerCase().includes("code"))?c.jsx(xy,{size:.75*t}):!0===(null==e?void 0:e.toLowerCase().includes("gemini"))||!0===(null==e?void 0:e.toLowerCase().includes("learnlm"))?c.jsx(hy,{size:.7*t}):c.jsx(fy,{size:.7*t})}function nw(e){return!0===(null==e?void 0:e.toLowerCase().includes("code"))?"Codey":!0===(null==e?void 0:e.toLowerCase().includes("gemini"))||!0===(null==e?void 0:e.toLowerCase().includes("learnlm"))?"Gemini":"PaLM2"}const aw=n.memo((e=>{const{error:t,button:n,iconURL:a="",endpoint:s,size:r=30,model:o="",assistantName:i,agentName:l}=e,d={icon:a?c.jsx("div",{className:"relative flex h-6 w-6 items-center justify-center",children:c.jsx("div",{title:i,style:{width:r,height:r},className:rm("overflow-hidden rounded-full",e.className??""),children:c.jsx("img",{className:"shadow-stroke h-full w-full object-cover",src:a,alt:i,style:{height:"80",width:"80"}})})}):c.jsx("div",{className:"h-6 w-6",children:c.jsx("div",{className:"shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(ky,{className:"h-2/3 w-2/3 text-gray-400"})})}),name:s},u={icon:a?c.jsx("div",{className:"relative flex h-6 w-6 items-center justify-center",children:c.jsx("div",{title:l,style:{width:r,height:r},className:rm("overflow-hidden rounded-full",e.className??""),children:c.jsx("img",{className:"shadow-stroke h-full w-full object-cover",src:a,alt:l,style:{height:"80",width:"80"}})})}):c.jsx("div",{className:"h-6 w-6",children:c.jsx("div",{className:"shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(ft,{className:"h-2/3 w-2/3 text-gray-400"})})}),name:s},m={[Ro.assistants]:d,[Ro.agents]:u,[Ro.azureAssistants]:d,[Ro.azureOpenAI]:{icon:c.jsx(py,{size:.5555555555555556*r}),bg:"linear-gradient(0.375turn, #61bde2, #4389d0)",name:"ChatGPT"},[Ro.openAI]:{icon:c.jsx(Vb,{size:.5555555555555556*r}),bg:ew(o),name:"ChatGPT"},[Ro.gptPlugins]:{icon:c.jsx(Ub,{size:.7*r}),bg:`rgba(69, 89, 164, ${!0===n?.75:1})`,name:"Plugins"},[Ro.google]:{icon:tw(o,r),name:nw(o)},[Ro.anthropic]:{icon:c.jsx(oy,{size:.5555555555555556*r}),bg:"#d09a74",name:"Claude"},[Ro.bedrock]:{icon:c.jsx(Ey,{className:"icon-xl text-white"}),bg:"#268672",name:Ql[Ro.bedrock]},[Ro.custom]:{icon:c.jsx(Qb,{size:.7*r}),name:"Custom"},null:{icon:c.jsx(Vb,{size:.7*r}),bg:"grey",name:"N/A"},default:{icon:c.jsx("div",{className:"h-6 w-6",children:c.jsx("div",{className:"overflow-hidden rounded-full",children:c.jsx(Xj,{iconURL:a,endpoint:s??"",className:"h-full w-full object-contain",context:"message"})})}),name:s}};let{icon:p,bg:g,name:f}=null!=s&&s&&m[s]?m[s]??{}:m.default;return a&&m[a]&&({icon:p,bg:g,name:f}=m[a]),Oo(s)?p:c.jsxs("div",{title:f??"",style:{background:null!=g&&g||"transparent",width:r,height:r},className:rm("relative flex h-9 w-9 items-center justify-center rounded-sm p-1 text-white",e.className??""),children:[p,!0===t&&c.jsx("span",{className:"absolute right-0 top-[20px] -mr-2 flex h-3 w-3 items-center justify-center rounded-full border border-white bg-red-500 text-[10px] text-white",children:"!"})]})})),sw=n.memo((({size:e,user:t,avatarSrc:n,username:a,className:s})=>c.jsx("div",{title:a,style:{width:e,height:e},className:rm("relative flex items-center justify-center",s??""),children:(null==t?void 0:t.avatar)||(null==t?void 0:t.username)&&""!==(null==t?void 0:t.username.trim())?c.jsx("img",{className:"rounded-full",src:((null==t?void 0:t.avatar)??"")||n,alt:"avatar"}):c.jsx("div",{style:{backgroundColor:"rgb(121, 137, 255)",width:"20px",height:"20px",boxShadow:"rgba(240, 246, 252, 0.1) 0px 0px 0px 1px"},className:"relative flex h-9 w-9 items-center justify-center rounded-sm p-1 text-white",children:c.jsx(jy,{})})})));sw.displayName="UserAvatar";const rw=n.memo((e=>{const{user:t}=Wh(),{size:n=30,isCreatedByUser:a}=e,s=rb(t),r=kg();if(a){const a=(null==t?void 0:t.name)??(null==t?void 0:t.username)??r("com_nav_user");return c.jsx(sw,{size:n,user:t,avatarSrc:s,username:a,className:e.className})}return c.jsx(aw,{...e})}));rw.displayName="Icon";const ow=e=>{const{size:t=30,iconURL:n="",iconClassName:a,error:s}=e;let r="default";"string"==typeof e.endpoint&&(r=e.endpoint);const o={[Ro.azureOpenAI]:{icon:c.jsx(py,{className:a}),name:e.chatGptLabel??"ChatGPT"},[Ro.openAI]:{icon:c.jsx(gy,{className:a}),name:e.chatGptLabel??"ChatGPT"},[Ro.gptPlugins]:{icon:c.jsx(my,{}),name:"Plugins"},[Ro.google]:{icon:c.jsx(vy,{}),name:e.modelLabel??"Google"},[Ro.anthropic]:{icon:c.jsx(oy,{className:"icon-md shrink-0 dark:text-white"}),name:e.modelLabel??"Claude"},[Ro.custom]:{icon:c.jsx(Qb,{}),name:"Custom"},[Ro.chatGPTBrowser]:{icon:c.jsx(qb,{}),name:"ChatGPT"},[Ro.assistants]:{icon:c.jsx(Sy,{className:"icon-sm"}),name:"Assistant"},[Ro.azureAssistants]:{icon:c.jsx(Sy,{className:"icon-sm"}),name:"Assistant"},[Ro.agents]:{icon:c.jsx(ft,{className:"icon-sm"}),name:e.modelLabel??Ql[Ro.agents]},[Ro.bedrock]:{icon:c.jsx(Ey,{className:"icon-xl text-text-primary"}),name:e.modelLabel??Ql[Ro.bedrock]},default:{icon:c.jsx(Xj,{iconURL:n,endpoint:r,className:"icon-sm",context:"nav"}),name:r}};let{icon:i,name:l}=o[r]??o.default;return n&&null!=o[n]&&({icon:i,name:l}=o[n]),c.jsxs("div",{"data-testid":"convo-icon",title:l,"aria-hidden":"true",style:{width:t,height:t},className:rm("relative flex items-center justify-center rounded-sm text-text-secondary",e.className??""),children:[i,!0===s&&c.jsx("span",{className:"absolute right-0 top-[20px] -mr-2 flex h-4 w-4 items-center justify-center rounded-full border border-white bg-red-500 text-[10px] text-text-secondary",children:"!"})]})},iw=({className:e="",assistantName:t="",avatar:n="",context:a,size:s})=>t&&n?c.jsx("img",{src:n,className:"bg-token-surface-secondary dark:bg-token-surface-tertiary h-full w-full rounded-full object-cover",alt:t,width:"80",height:"80"}):t?c.jsx(ky,{className:rm("text-token-secondary",e),size:s}):c.jsx(Sy,{className:rm("landing"===a?"icon-2xl":"",e)}),lw={[Ro.azureOpenAI]:py,[Ro.openAI]:Vb,[Ro.gptPlugins]:my,[Ro.anthropic]:oy,[Ro.chatGPTBrowser]:qb,[Ro.google]:vy,[Ro.custom]:Qb,[Ro.assistants]:iw,[Ro.azureAssistants]:iw,[Ro.agents]:({className:e="",avatar:t="",agentName:n,size:a})=>null!=n&&n&&t?c.jsx("img",{src:t,className:"bg-token-surface-secondary dark:bg-token-surface-tertiary h-full w-full rounded-full object-cover",alt:n,width:"80",height:"80"}):c.jsx(ft,{className:rm(""===n?"icon-2xl":"",e),size:a}),[Ro.bedrock]:({className:e=""})=>c.jsx(Ey,{className:rm(e,"h-full w-full")}),unknown:Xj},cw=n.memo((({iconURL:e,altName:t,containerStyle:n={width:"20",height:"20"},imageStyle:a={width:"100%",height:"100%"},className:s="icon-xl mr-1 shrink-0 overflow-hidden rounded-full"})=>c.jsx("div",{className:s,style:n,children:c.jsx("img",{src:e,alt:t??"",style:a,className:"object-cover"})}))),dw={"menu-item":"relative flex h-full items-center justify-center overflow-hidden rounded-full",message:"icon-md",default:"icon-xl relative flex h-full overflow-hidden rounded-full"},uw={"menu-item":{width:"20px",height:"20px"},default:{width:"100%",height:"100%"}},mw={default:{width:"100%",height:"100%"}},pw=n.memo((({iconURL:e="",modelLabel:t="",endpointIconURL:a,assistantAvatar:s,assistantName:r,agentAvatar:o,agentName:i,context:l})=>{const d=n.useMemo((()=>lw[e]??lw.unknown),[e]);return n.useMemo((()=>!(!e||!e.includes("http")&&!e.startsWith("/images/"))),[e])?c.jsx(cw,{iconURL:e,altName:t,className:dw[l??"default"]??dw.default,containerStyle:uw[l??"default"]??uw.default,imageStyle:mw[l??"default"]??mw.default}):c.jsx("div",{className:"shadow-stroke relative flex h-full items-center justify-center rounded-full bg-white text-black",children:c.jsx(d,{size:41,context:l,className:"h-2/3 w-2/3",agentName:i,iconURL:a,assistantName:r,avatar:s??o})})}));function gw({conversation:e,endpointsConfig:t,assistantMap:a,agentsMap:s,className:r="",containerClassName:o="",context:i,size:l}){var d,u;const m=(null==e?void 0:e.iconURL)??"";let p=null==e?void 0:e.endpoint;p=Zu({endpointsConfig:t,iconURL:m,endpoint:p});const{entity:g,isAgent:f}=n.useMemo((()=>Ju({endpoint:p,agentsMap:s,assistantMap:a,agent_id:null==e?void 0:e.agent_id,assistant_id:null==e?void 0:e.assistant_id})),[p,null==e?void 0:e.agent_id,null==e?void 0:e.assistant_id,s,a]),x=(null==g?void 0:g.name)??"",h=f?null==(d=null==g?void 0:g.avatar)?void 0:d.filepath:null==(u=null==g?void 0:g.metadata)?void 0:u.avatar,v=Hu(t,p,"iconURL"),b=Yu({endpoint:p,endpointsConfig:t,endpointIconURL:v}),y=lw[b]??null;return c.jsx(c.Fragment,{children:m&&m.includes("http")?c.jsx(pw,{iconURL:m,modelLabel:(null==e?void 0:e.chatGptLabel)??(null==e?void 0:e.modelLabel)??"",endpointIconURL:v,assistantAvatar:h,assistantName:x,agentAvatar:h,agentName:x,context:i}):c.jsx("div",{className:o,children:p&&null!=y&&c.jsx(y,{size:l,context:i,endpoint:p,className:r,iconURL:v,assistantName:x,agentName:x,avatar:h})})})}function fw({conversation:e,endpointsConfig:t,className:n="mr-0",assistantMap:a,context:s}){var r,o;const i=(null==e?void 0:e.iconURL)??"";let l=null==e?void 0:e.endpoint;l=Zu({endpointsConfig:t,iconURL:i,endpoint:l});const d=Hu(t,l,"type"),u=Hu(t,l,"iconURL"),m=Oo(l)?null==(r=null==a?void 0:a[l])?void 0:r[(null==e?void 0:e.assistant_id)??""]:null,p=m&&(null==(o=m.metadata)?void 0:o.avatar)||"",g=m&&(m.name??""),f=p||i;return f&&(f.includes("http")||f.startsWith("/images/"))?c.jsx(pw,{iconURL:f,modelLabel:(null==e?void 0:e.chatGptLabel)??(null==e?void 0:e.modelLabel)??"",context:s,endpointIconURL:u,assistantAvatar:p,assistantName:g??""}):c.jsx(ow,{size:20,iconURL:u,endpoint:l,endpointType:d,model:null==e?void 0:e.model,error:!1,className:n,isCreatedByUser:!1,chatGptLabel:void 0,modelLabel:void 0,jailbreak:void 0})}const xw={max:"com_endpoint_openai_max",temp:"com_endpoint_openai_temp",topp:"com_endpoint_openai_topp",freq:"com_endpoint_openai_freq",pres:"com_endpoint_openai_pres",resend:"com_endpoint_openai_resend_files",detail:"com_endpoint_openai_detail"},hw={anthropic:{temp:"com_endpoint_anthropic_temp",topp:"com_endpoint_anthropic_topp",topk:"com_endpoint_anthropic_topk",maxoutputtokens:"com_endpoint_anthropic_maxoutputtokens",resend:xw.resend,promptcache:"com_endpoint_anthropic_prompt_cache"},google:{temp:"com_endpoint_google_temp",topp:"com_endpoint_google_topp",topk:"com_endpoint_google_topk",maxoutputtokens:"com_endpoint_google_maxoutputtokens"},openAI:xw,azureOpenAI:xw,gptPlugins:{func:"com_endpoint_func_hover",skip:"com_endpoint_skip_hover",...xw}};function vw({endpoint:e,type:t,side:n}){var a;const s=kg(),r=null==(a=hw[e])?void 0:a[t];return r?c.jsx(d_,{children:c.jsx(u_,{side:n,className:"z-[999] w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:s(r)})})})}):null}function bw({conversation:e,setOption:t,readonly:n}){const a=kg(),{endpoint:s,endpointType:r,chatGptLabel:o,promptPrefix:i,temperature:l,top_p:d,frequency_penalty:u,presence_penalty:m,resendFiles:p,imageDetail:g}=e??{},[f,x]=Rv({setOption:t,optionKey:"chatGptLabel",initialValue:o}),[h,v]=Rv({setOption:t,optionKey:"promptPrefix",initialValue:i}),[b,y]=Rv({setOption:t,optionKey:"temperature",initialValue:l}),[_,j]=Rv({setOption:t,optionKey:"top_p",initialValue:d}),[w,N]=Rv({setOption:t,optionKey:"frequency_penalty",initialValue:u}),[C,k]=Rv({setOption:t,optionKey:"presence_penalty",initialValue:m});if(!e)return null;const S=t("resendFiles"),T=t("imageDetail"),R=r??s;return c.jsxs("div",{className:"grid grid-cols-5 gap-6",children:[c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 sm:col-span-3",children:[c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"chatGptLabel",className:"text-left text-sm font-medium",children:[a("com_endpoint_custom_name")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default_blank"),")"]})]}),c.jsx(m_,{id:"chatGptLabel",disabled:n,value:x||"",onChange:f,placeholder:a("com_endpoint_openai_custom_name_placeholder"),className:rm(fm,"flex h-10 max-h-10 w-full resize-none px-3 py-2",mm)})]}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"promptPrefix",className:"text-left text-sm font-medium",children:[a("com_endpoint_prompt_prefix")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:"promptPrefix",disabled:n,value:v||"",onChange:h,placeholder:a("com_endpoint_openai_prompt_prefix_placeholder"),className:rm(fm,"flex max-h-[138px] min-h-[100px] w-full resize-none px-3 py-2 ")})]})]}),c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 px-3 sm:col-span-2",children:[c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"temp-int",className:"text-left text-sm font-medium",children:[a("com_endpoint_temperature")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default_with_num",{0:"1"}),")"]})]}),c.jsx(p_,{id:"temp-int",disabled:n,value:y,onChange:b,max:2,min:0,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:n,value:[y??1],onValueChange:e=>b(e[0]),onDoubleClick:()=>b(1),max:2,min:0,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:R??"",type:"temp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"top-p-int",className:"text-left text-sm font-medium",children:[a("com_endpoint_top_p")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default"),": 1)"]})]}),c.jsx(p_,{id:"top-p-int",disabled:n,value:j,onChange:e=>_(Number(e)),max:1,min:0,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:n,value:[j??1],onValueChange:e=>_(e[0]),onDoubleClick:()=>_(1),max:1,min:0,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:R??"",type:"topp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"freq-penalty-int",className:"text-left text-sm font-medium",children:[a("com_endpoint_frequency_penalty")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default"),": 0)"]})]}),c.jsx(p_,{id:"freq-penalty-int",disabled:n,value:N,onChange:e=>w(Number(e)),max:2,min:-2,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:n,value:[N??0],onValueChange:e=>w(e[0]),onDoubleClick:()=>w(0),max:2,min:-2,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:R??"",type:"freq",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"pres-penalty-int",className:"text-left text-sm font-medium",children:[a("com_endpoint_presence_penalty")," ",c.jsxs("small",{className:"opacity-40",children:["(",a("com_endpoint_default"),": 0)"]})]}),c.jsx(p_,{id:"pres-penalty-int",disabled:n,value:k,onChange:e=>C(Number(e)),max:2,min:-2,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:n,value:[k??0],onValueChange:e=>C(e[0]),onDoubleClick:()=>C(0),max:2,min:-2,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:R??"",type:"pres",side:Kr.Left})]}),c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-2 flex w-full justify-between gap-2",children:[c.jsx("label",{htmlFor:"resend-files",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:c.jsx("small",{children:a("com_endpoint_plug_resend_files")})}),c.jsx("label",{htmlFor:"image-detail-value",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:c.jsx("small",{children:a("com_endpoint_plug_image_detail")})}),c.jsx(m_,{id:"image-detail-value",disabled:!0,value:g??Lo.auto,className:rm(fm,xm,"flex rounded-md bg-transparent py-2 text-xs focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 dark:border-gray-700","pointer-events-none max-h-5 w-12 border-0 group-hover/temp:border-gray-200")})]}),c.jsxs("div",{className:"flex w-full justify-between gap-2",children:[c.jsx(l_,{openDelay:500,children:c.jsxs(c_,{children:[c.jsx(R_,{id:"resend-files",checked:p??!0,onCheckedChange:e=>S(e),disabled:n,className:"flex"}),c.jsx(vw,{endpoint:R??"",type:"resend",side:Kr.Bottom})]})}),c.jsx(l_,{openDelay:500,children:c.jsxs(c_,{className:"flex w-[52%] md:w-[125px]",children:[c.jsx(C_,{id:"image-detail-slider",disabled:n,value:[Uo[g??""]??Uo[Lo.auto]],onValueChange:e=>T(Vo[e[0]]),onDoubleClick:()=>T(Lo.auto),max:2,min:0,step:1}),c.jsx(vw,{endpoint:R??"",type:"detail",side:Kr.Bottom})]})})]})]})]})]})}function yw({conversation:e,setOption:t,models:a,readonly:s}){const r=kg(),o=n.useMemo((()=>({label:r("com_endpoint_use_active_assistant"),value:""})),[r]),i=_h((e=>qr(e.data))),{model:l,endpoint:d,assistant_id:u,endpointType:m,promptPrefix:p,instructions:g}=e??{},f=n.useMemo((()=>Object.values(i[d??""]??{})),[i,d]),x=n.useMemo((()=>{const e=f.map((({id:e,name:t})=>({label:t,value:e})));return[o,...e].filter(Boolean)}),[f,o]),[h,v]=Rv({setOption:t,optionKey:"promptPrefix",initialValue:p}),[b,y]=Rv({setOption:t,optionKey:"instructions",initialValue:g}),_=n.useMemo((()=>{var e;return null!=u&&u?null==(e=i[d??""])?void 0:e[u]:null}),[u,i,d]),j=n.useMemo((()=>a.map((e=>({label:e===(null==_?void 0:_.model)?`${e} (${r("com_endpoint_assistant_model")})`:e,value:e})))),[a,_,r]),[w,N]=n.useState(null!=_?{label:_.name??"",value:_.id}:o);if(n.useEffect((()=>{""===w.value&&t("presetOverride")({assistant_id:w.value})}),[w]),!e)return null;const C=t("model"),k=m??d;return c.jsxs("div",{className:"grid grid-cols-6 gap-6",children:[c.jsx("div",{className:"col-span-6 flex flex-col items-center justify-start gap-6 sm:col-span-3",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(sj,{value:l??"",setValue:lu(C),availableValues:j,disabled:s,className:rm(fm,"flex w-full resize-none",pm),containerClassName:"flex w-full resize-none"})})}),c.jsx("div",{className:"col-span-6 flex flex-col items-center justify-start gap-6 px-3 sm:col-span-3",children:c.jsxs(l_,{openDelay:300,children:[c.jsx(c_,{className:"grid w-full items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(sj,{title:r("com_endpoint_assistant"),value:w,setValue:lu((e=>{var n;if(!e)return void N(o);const a=null==(n=i[d??""])?void 0:n[e];a?(N({label:a.name??"",value:a.id||""}),t("assistant_id")(a.id),a.model&&C(a.model)):N(o)})),availableValues:x,disabled:s,className:rm(fm,"flex w-full resize-none",pm),containerClassName:"flex w-full resize-none"})})}),c.jsx(vw,{endpoint:k??"",type:"temp",side:Kr.Left})]})}),c.jsxs("div",{className:"col-span-6 flex flex-col items-center justify-start gap-6",children:[c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"promptPrefix",className:"text-left text-sm font-medium",children:[r("com_endpoint_prompt_prefix_assistants")," ",c.jsxs("small",{className:"opacity-40",children:["(",r("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:"promptPrefix",disabled:s,value:v??"",onChange:h,placeholder:r("com_endpoint_prompt_prefix_assistants_placeholder"),className:rm(fm,"flex max-h-[240px] min-h-[80px] w-full resize-none px-3 py-2 ")})]}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"instructions",className:"text-left text-sm font-medium",children:[r("com_endpoint_instructions_assistants")," ",c.jsxs("small",{className:"opacity-40",children:["(",r("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:"instructions",disabled:s,value:y??"",onChange:b,placeholder:r("com_endpoint_instructions_assistants_placeholder"),className:rm(fm,"flex max-h-[240px] min-h-[80px] w-full resize-none px-3 py-2 ")})]})]})]})}const _w=n.memo((function({selectedValue:e,displayValue:t,items:a,setValue:s,ariaLabel:r,searchPlaceholder:o,selectPlaceholder:i,containerClassName:l,isCollapsed:d,SelectIcon:u,showCarat:m,className:p,disabled:g,iconClassName:f,iconSide:x="left",selectId:h}){const[v,b]=n.useState(""),y=n.useRef(null),[_,j]=n.useState(null),w=e=>({id:`item-${e.value}`,value:e.value,label:e.label,icon:e.icon}),N=xt({defaultItems:a.map(w),resetValueOnHide:!0,value:v,setValue:b}),C=Ae({combobox:N,defaultItems:a.map(w),value:e,setValue:s}),k=n.useMemo((()=>q(a,v,{keys:["value","label"],baseSort:(e,t)=>e.index<t.index?-1:1}).map(w)),[v,a]);n.useEffect((()=>{y.current&&!d&&j(y.current.offsetWidth)}),[d]);const S=rm("flex h-5 w-5 items-center justify-center overflow-hidden rounded-full",f),T=rm("mr-2 flex h-5 w-5 items-center justify-center overflow-hidden rounded-full",f);return c.jsxs("div",{className:rm("flex w-full items-center justify-center px-1",l),children:[c.jsx(ht,{store:C,className:"sr-only",children:r}),c.jsxs(Oe,{ref:y,store:C,id:h,disabled:g,className:rm("flex items-center justify-center gap-2 rounded-full bg-surface-secondary","text-text-primary hover:bg-surface-tertiary","border border-border-light",d?"h-10 w-10":"h-10 w-full rounded-md px-3 py-2 text-sm",p),children:[null!=u&&"left"===x&&c.jsx("div",{className:S,children:u}),!d&&c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"flex-grow truncate text-left",children:null!=t?t||i:e||i}),null!=u&&"right"===x&&c.jsx("div",{className:S,children:u}),m&&c.jsx(vt,{className:"h-4 w-4 text-text-secondary"})]})]}),c.jsxs(Fe,{store:C,gutter:4,portal:!0,className:"z-50 overflow-hidden rounded-md border border-border-light bg-surface-secondary shadow-lg",style:{width:d?"300px":_??"300px"},children:[c.jsx("div",{className:"p-2",children:c.jsxs("div",{className:"relative",children:[c.jsx(Qe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-text-primary"}),c.jsx(je,{store:N,autoSelect:!0,placeholder:o,className:"w-full rounded-md border border-border-light bg-surface-tertiary py-2 pl-9 pr-3 text-sm text-text-primary focus:outline-none"})]})}),c.jsx("div",{className:"max-h-[300px] overflow-auto",children:c.jsx(bt,{store:N,children:c.jsx(yt,{store:C,items:k,itemSize:36,overscan:5,children:({value:e,icon:t,label:n,...a})=>c.jsxs(Ne,{...a,className:rm("flex w-full cursor-pointer items-center px-3 text-sm","text-text-primary hover:bg-surface-tertiary","data-[active-item]:bg-surface-tertiary"),render:c.jsx(ze,{value:e}),children:[null!=t&&"left"===x&&c.jsx("div",{className:T,children:t}),c.jsx("span",{className:"flex-grow truncate text-left",children:n}),null!=t&&"right"===x&&c.jsx("div",{className:T,children:t})]},a.id)})})})]})]})}));function jw({side:e,description:t,disabled:n,langCode:a,sideOffset:s=30,className:r}){const o=kg();if(n)return null;const i=a?o(t):t;return c.jsx(d_,{children:c.jsx(u_,{side:e,className:`z-[999] w-80 ${r}`,sideOffset:s,children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:i})})})})}const ww={[Sc.Slider]:function({label:e="",settingKey:t,defaultValue:a,range:s,description:r="",columnSpan:o,setOption:i,optionType:l,options:d,readonly:u=!1,showDefault:m=!1,includeInput:p=!0,labelCode:g=!1,descriptionCode:f=!1,conversation:x}){const h=kg(),{preset:v}=bh(),b=n.useMemo((()=>(!s&&d&&d.length>0)??!1),[d,s]),[y,_,j]=Rv({optionKey:l!==Rc.Custom?t:void 0,initialValue:l!==Rc.Custom?null==x?void 0:x[t]:a,setter:()=>({}),setOption:i,delay:b?0:Gr});Pv({preset:v,settingKey:t,defaultValue:a,conversation:x,inputValue:_,setInputValue:j});const w=n.useMemo((()=>b?(null==x?void 0:x[t])??a:_),[x,a,t,_,b]),N=n.useMemo((()=>b&&d?d.reduce(((e,t,n)=>(e[t]=n,e)),{}):{}),[b,d]),C=n.useMemo((()=>b&&d?d.reduce(((e,t,n)=>(e[n]=t,e)),{}):{}),[b,d]),k=n.useCallback((e=>{y(b?C[e]:e)}),[b,y,C]),S=n.useMemo((()=>b&&d?d.length-1:s?s.max:0),[b,d,s]);return s||b?c.jsx("div",{className:rm("flex flex-col items-center justify-start gap-2",null!=o?`col-span-${o}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex w-full items-center justify-between",children:[c.jsxs(g_,{htmlFor:`${t}-dynamic-setting`,className:"text-left text-sm font-medium",children:[g?h(e)??e:e||t," ",m&&c.jsxs("small",{className:"opacity-40",children:["(",h("com_endpoint_default"),": ",a,")"]})]}),p&&!b?c.jsx(p_,{id:`${t}-dynamic-setting-input-number`,disabled:u,value:_??a,onChange:e=>y(Number(e)),max:s?s.max:((null==d?void 0:d.length)??0)-1,min:s?s.min:0,step:s?s.step??1:1,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))}):c.jsx(m_,{id:`${t}-dynamic-setting-input`,disabled:u,value:w??a,onChange:()=>({}),className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{id:`${t}-dynamic-setting-slider`,disabled:u,value:[b?N[w??""]:_??a],onValueChange:e=>k(e[0]),onDoubleClick:()=>y(a),max:S,min:s?s.min:0,step:s?s.step??1:1,className:"flex h-4 w-full"})]}),r&&c.jsx(jw,{description:f?h(r)??r:r,side:Kr.Left})]})}):null},[Sc.Dropdown]:function({label:e="",settingKey:t,defaultValue:a,description:s="",columnSpan:r,setOption:o,optionType:i,options:l,readonly:d=!1,showLabel:u=!0,showDefault:m=!1,labelCode:p=!1,descriptionCode:g=!1,placeholder:f="",placeholderCode:x=!1,conversation:h}){const v=kg(),{preset:b}=bh(),[y,_]=n.useState(null),j=n.useMemo((()=>i===Rc.Custom?y:(null==h?void 0:h[t])??a),[h,a,i,t,y]);return Pv({preset:b,settingKey:t,defaultValue:a,conversation:h,inputValue:y,setInputValue:_,preventDelayedUpdate:!0}),l&&0!==l.length?c.jsx("div",{className:rm("flex flex-col items-center justify-start gap-6",null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[!0===u&&c.jsx("div",{className:"flex w-full justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-dropdown`,className:"text-left text-sm font-medium",children:[p?v(e)??e:e||t,m&&c.jsxs("small",{className:"opacity-40",children:["(",v("com_endpoint_default"),": ",a,")"]})]})}),c.jsx(sj,{showLabel:!1,emptyTitle:!0,disabled:d,value:j,setValue:e=>{i!==Rc.Custom?o(t)(e):_(e)},availableValues:l,containerClassName:"w-full",id:`${t}-dynamic-dropdown`,placeholder:x?v(f)??f:f})]}),s&&c.jsx(jw,{description:g?v(s)??s:s,side:Kr.Left})]})}):null},[Sc.Switch]:function({label:e="",settingKey:t,defaultValue:a,description:s="",columnSpan:r,setOption:o,optionType:i,readonly:l=!1,showDefault:d=!1,labelCode:u=!1,descriptionCode:m=!1,conversation:p}){const g=kg(),{preset:f}=bh(),[x,h]=n.useState(!!a);Pv({preset:f,settingKey:t,defaultValue:a,conversation:p,inputValue:x,setInputValue:h,preventDelayedUpdate:!0});const v=n.useMemo((()=>i===Rc.Custom?x:(null==p?void 0:p[t])??a),[p,a,i,t,x]);return c.jsx("div",{className:"flex flex-col items-center justify-start gap-6 "+(null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsx("div",{className:"flex justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-switch`,className:"text-left text-sm font-medium",children:[u?g(e)??e:e||t," ",d&&c.jsxs("small",{className:"opacity-40",children:["(",g("com_endpoint_default"),":"," ",null!=a?"com_ui_on":"com_ui_off",")"]})]})}),c.jsx(R_,{id:`${t}-dynamic-switch`,checked:v,onCheckedChange:e=>{i!==Rc.Custom?o(t)(e):h(e)},disabled:l,className:"flex"})]}),s&&c.jsx(jw,{description:m?g(s)??s:s,side:Kr.Left})]})})},[Sc.Textarea]:function({label:e="",settingKey:t,defaultValue:n,description:a="",columnSpan:s,setOption:r,optionType:o,placeholder:i="",readonly:l=!1,showDefault:d=!1,labelCode:u=!1,descriptionCode:m=!1,placeholderCode:p=!1,conversation:g}){const f=kg(),{preset:x}=bh(),[h,v,b]=Rv({optionKey:o!==Rc.Custom?t:void 0,initialValue:o!==Rc.Custom?null==g?void 0:g[t]:n,setter:()=>({}),setOption:r});return Pv({preset:x,settingKey:t,defaultValue:void 0===n?"":n,conversation:g,inputValue:v,setInputValue:b}),c.jsx("div",{className:"flex flex-col items-center justify-start gap-6 "+(null!=s?`col-span-${s}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsx("div",{className:"flex w-full justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-textarea`,className:"text-left text-sm font-medium",children:[u?f(e)??e:e||t," ",d&&c.jsxs("small",{className:"opacity-40",children:["(",void 0!==n&&n.length?`${f("com_endpoint_default")}: ${n}`:f("com_endpoint_default_blank"),")"]})]})}),c.jsx(F_,{id:`${t}-dynamic-textarea`,disabled:l,value:v??"",onChange:h,placeholder:p?f(i)??i:i,className:rm("flex max-h-[138px] min-h-[100px] w-full resize-none rounded-lg bg-surface-secondary px-3 py-2 focus:outline-none")})]}),a&&c.jsx(jw,{description:m?f(a)??a:a,side:Kr.Left})]})})},[Sc.Input]:function({label:e="",settingKey:t,defaultValue:n,description:a="",type:s="string",columnSpan:r,setOption:o,optionType:i,placeholder:l="",readonly:d=!1,showDefault:u=!1,labelCode:m=!1,descriptionCode:p=!1,placeholderCode:g=!1,conversation:f}){const x=kg(),{preset:h}=bh(),[v,b,y]=Rv({optionKey:i!==Rc.Custom?t:void 0,initialValue:i!==Rc.Custom?null==f?void 0:f[t]:n,setter:()=>({}),setOption:o});return Pv({preset:h,settingKey:t,defaultValue:void 0===n?"":n,conversation:f,inputValue:b,setInputValue:y}),c.jsx("div",{className:"flex flex-col items-center justify-start gap-6 "+(null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsx("div",{className:"flex w-full justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-input`,className:"text-left text-sm font-medium",children:[m?x(e)||e:e||t," ",u&&c.jsxs("small",{className:"opacity-40",children:["(",void 0!==n&&n.length?`${x("com_endpoint_default")}: ${n}`:x("com_endpoint_default_blank"),")"]})]})}),c.jsx(m_,{id:`${t}-dynamic-input`,disabled:d,value:b??n??"",onChange:e=>{const t=e.target.value;"number"===s?""===t?v(e):isNaN(Number(t))||v(e,!0):v(e)},placeholder:g&&x(l)||l,className:rm("flex h-10 max-h-10 w-full resize-none border-none bg-surface-secondary px-3 py-2")})]}),a&&c.jsx(jw,{description:p&&x(a)||a,side:Kr.Left})]})})},[Sc.Checkbox]:function({label:e="",settingKey:t,defaultValue:a,description:s="",columnSpan:r,setOption:o,optionType:i,readonly:l=!1,showDefault:d=!1,labelCode:u=!1,descriptionCode:m=!1,conversation:p}){const g=kg(),{preset:f}=bh(),[x,h]=n.useState(!!a),v=n.useMemo((()=>i===Rc.Custom?x:(null==p?void 0:p[t])??a),[p,a,i,t,x]);return Pv({preset:f,settingKey:t,defaultValue:a,conversation:p,inputValue:x,setInputValue:h,preventDelayedUpdate:!0}),c.jsx("div",{className:"flex flex-col items-center justify-start gap-6 "+(null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsx(c_,{className:"grid w-full items-center",children:c.jsxs("div",{className:"flex justify-start gap-4",children:[c.jsxs(g_,{htmlFor:`${t}-dynamic-checkbox`,className:"text-left text-sm font-medium",children:[u?g(e)??e:e||t," ",d&&c.jsxs("small",{className:"opacity-40",children:["(",g("com_endpoint_default"),":"," ",g(null!=a?"com_ui_yes":"com_ui_no"),")"]})]}),c.jsx($y,{id:`${t}-dynamic-checkbox`,disabled:l,checked:v,onCheckedChange:e=>{i!==Rc.Custom?o(t)(e):h(e)},className:"mt-[2px] focus:ring-opacity-20 dark:border-gray-500 dark:bg-gray-700 dark:text-gray-50 dark:focus:ring-gray-600 dark:focus:ring-opacity-50 dark:focus:ring-offset-0"})]})}),s&&c.jsx(jw,{description:m?g(s)??s:s,side:Kr.Left})]})})},[Sc.Tags]:function({label:e="",settingKey:t,defaultValue:a=[],description:s="",columnSpan:r,setOption:o,optionType:i,placeholder:l="",readonly:d=!1,showDefault:u=!1,labelCode:m=!1,descriptionCode:p=!1,placeholderCode:g=!1,descriptionSide:f=Kr.Left,conversation:x,minTags:h,maxTags:v}){const b=kg(),{preset:y}=bh(),{showToast:_}=Ng(),j=n.useRef(null),[w,N]=n.useState(""),[C,k]=n.useState(a??[]),S=n.useCallback((e=>{i!==Rc.Custom?o(t)(e):k(e)}),[i,o,t]),T=n.useCallback((()=>{j.current&&j.current.focus()}),[j]),R=n.useMemo((()=>i===Rc.Custom?C:(null==x?void 0:x[t])?x[t]:a??[]),[x,a,i,t,C]),I=n.useCallback((e=>{if(!R)return;if(null!=h&&R.length<=h)return void _({message:b("com_ui_min_tags",{0:h+""}),status:"warning"});const t=R.filter(((t,n)=>n!==e));S(t)}),[b,h,R,_,S]),E=n.useCallback((()=>{if(!w)return;let e=[...R??[],w];null!=v&&e.length>v&&(_({message:b("com_ui_max_tags",{0:v+""}),status:"warning"}),e=e.slice(-v)),S(e),N("")}),[w,R,S,v,_,b]);return Pv({preset:y,settingKey:t,defaultValue:void 0===a?[]:a,inputValue:C,setInputValue:k,preventDelayedUpdate:!0,conversation:x}),c.jsx("div",{className:"flex flex-col items-center justify-start gap-6 "+(null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsx("div",{className:"flex w-full justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-input`,className:"text-left text-sm font-medium",children:[m?b(e)??e:e||t," ",u&&c.jsxs("small",{className:"opacity-40",children:["(",void 0!==a&&a.length?`${b("com_endpoint_default")}: ${a}`:b("com_endpoint_default_blank"),")"]})]})}),c.jsx("div",{children:c.jsxs("div",{className:"mb-2 flex flex-wrap break-all rounded-lg bg-surface-secondary",children:[R&&R.length>0&&c.jsx("div",{className:"flex w-full gap-1 p-1",children:R.map(((e,t)=>c.jsx(D_,{label:e,onClick:T,onRemove:()=>{I(t),j.current&&j.current.focus()}},`${e}-${t}`)))}),c.jsx(m_,{ref:j,id:`${t}-dynamic-input`,disabled:d,value:w,onKeyDown:e=>{R&&("Backspace"!==e.key||w||I(R.length-1),"Enter"===e.key&&E())},onChange:e=>N(e.target.value),placeholder:g?b(l)??l:l,className:rm("flex h-10 max-h-10 border-none bg-surface-secondary px-3 py-2")})]})})]}),s&&c.jsx(jw,{description:p?b(s)??s:s,side:f})]})})},[Sc.Combobox]:function({label:e="",settingKey:t,defaultValue:a,description:s="",columnSpan:r,setOption:o,optionType:i,options:l,items:d,showLabel:u=!0,showDefault:m=!1,labelCode:p=!1,descriptionCode:g=!1,searchPlaceholderCode:f=!1,selectPlaceholderCode:x=!1,conversation:h,isCollapsed:v=!1,SelectIcon:b=null,selectPlaceholder:y="",searchPlaceholder:_=""}){const j=kg(),{preset:w}=bh(),[N,C]=n.useState(null),k=n.useMemo((()=>i===Rc.Custom?N:(null==h?void 0:h[t])??a),[h,a,i,t,N]),S=n.useMemo((()=>null!=d?d:(l??[]).map((e=>({label:e,value:e})))),[l,d]),T=n.useCallback((e=>{i===Rc.Custom?C(e):o(t)(e)}),[i,o,t]);return Pv({preset:w,settingKey:t,defaultValue:a,conversation:h,inputValue:N,setInputValue:C,preventDelayedUpdate:!0}),0===(S??l??[]).length?null:c.jsx("div",{className:rm("flex flex-col items-center justify-start gap-6",null!=r?`col-span-${r}`:"col-span-full"),children:c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[!0===u&&c.jsx("div",{className:"flex w-full justify-between",children:c.jsxs(g_,{htmlFor:`${t}-dynamic-combobox`,className:"text-left text-sm font-medium",children:[p?j(e)??e:e||t,m&&c.jsxs("small",{className:"opacity-40",children:["(",j("com_endpoint_default"),": ",a,")"]})]})}),c.jsx(_w,{displayValue:k,selectPlaceholder:!0===x?j(y):y,searchPlaceholder:!0===f?j(_):_,isCollapsed:v,ariaLabel:t,selectedValue:k??"",setValue:T,items:S,SelectIcon:b})]}),s&&c.jsx(jw,{description:g?j(s)??s:s,side:Kr.Left})]})})}},Nw={model:{key:"model",label:"com_ui_model",labelCode:!0,type:"string",component:"dropdown",optionType:"model",selectPlaceholder:"com_ui_select_model",searchPlaceholder:"com_ui_select_search_model",searchPlaceholderCode:!0,selectPlaceholderCode:!0,columnSpan:4},temperature:{key:"temperature",label:"com_endpoint_temperature",labelCode:!0,description:"com_endpoint_openai_temp",descriptionCode:!0,type:"number",component:"slider",optionType:"model",columnSpan:4},topP:{key:"topP",label:"com_endpoint_top_p",labelCode:!0,description:"com_endpoint_anthropic_topp",descriptionCode:!0,type:"number",component:"slider",optionType:"model",columnSpan:4},stop:{key:"stop",label:"com_endpoint_stop",labelCode:!0,description:"com_endpoint_openai_stop",descriptionCode:!0,placeholder:"com_endpoint_stop_placeholder",placeholderCode:!0,type:"array",default:[],component:"tags",optionType:"conversation",minTags:0,maxTags:4},imageDetail:{key:"imageDetail",label:"com_endpoint_plug_image_detail",labelCode:!0,description:"com_endpoint_openai_detail",descriptionCode:!0,type:"enum",default:Lo.auto,component:"slider",options:[Lo.low,Lo.auto,Lo.high],optionType:"conversation",columnSpan:2}},Cw=(e,t)=>({...e,...t}),kw={modelLabel:{key:"modelLabel",label:"com_endpoint_custom_name",labelCode:!0,type:"string",default:"",component:"input",placeholder:"com_endpoint_openai_custom_name_placeholder",placeholderCode:!0,optionType:"conversation"},maxContextTokens:{key:"maxContextTokens",label:"com_endpoint_context_tokens",labelCode:!0,type:"number",component:"input",placeholder:"com_nav_theme_system",placeholderCode:!0,description:"com_endpoint_context_info",descriptionCode:!0,optionType:"model",columnSpan:2},resendFiles:{key:"resendFiles",label:"com_endpoint_plug_resend_files",labelCode:!0,description:"com_endpoint_openai_resend_files",descriptionCode:!0,type:"boolean",default:!0,component:"switch",optionType:"conversation",showDefault:!1,columnSpan:2},promptPrefix:{key:"promptPrefix",label:"com_endpoint_prompt_prefix",labelCode:!0,type:"string",default:"",component:"textarea",placeholder:"com_endpoint_openai_prompt_prefix_placeholder",placeholderCode:!0,optionType:"model"}},Sw={chatGptLabel:{...kw.modelLabel,key:"chatGptLabel"},temperature:Cw(Nw.temperature,{default:Qo.temperature.default,range:{min:Qo.temperature.min,max:Qo.temperature.max,step:Qo.temperature.step}}),top_p:Cw(Nw.topP,{key:"top_p",default:Qo.top_p.default,range:{min:Qo.top_p.min,max:Qo.top_p.max,step:Qo.top_p.step}}),frequency_penalty:{key:"frequency_penalty",label:"com_endpoint_frequency_penalty",labelCode:!0,description:"com_endpoint_openai_freq",descriptionCode:!0,type:"number",default:Qo.frequency_penalty.default,range:{min:Qo.frequency_penalty.min,max:Qo.frequency_penalty.max,step:Qo.frequency_penalty.step},component:"slider",optionType:"model",columnSpan:4},presence_penalty:{key:"presence_penalty",label:"com_endpoint_presence_penalty",labelCode:!0,description:"com_endpoint_openai_pres",descriptionCode:!0,type:"number",default:Qo.presence_penalty.default,range:{min:Qo.presence_penalty.min,max:Qo.presence_penalty.max,step:Qo.presence_penalty.step},component:"slider",optionType:"model",columnSpan:4},max_tokens:{key:"max_tokens",label:"com_endpoint_max_output_tokens",labelCode:!0,type:"number",component:"input",description:"com_endpoint_openai_max_tokens",descriptionCode:!0,placeholder:"com_nav_theme_system",placeholderCode:!0,optionType:"model",columnSpan:2},reasoning_effort:{key:"reasoning_effort",label:"com_endpoint_reasoning_effort",labelCode:!0,description:"com_endpoint_openai_reasoning_effort",descriptionCode:!0,type:"enum",default:Mo.medium,component:"slider",options:[Mo.low,Mo.medium,Mo.high],optionType:"model",columnSpan:4}},Tw={maxOutputTokens:{key:"maxOutputTokens",label:"com_endpoint_max_output_tokens",labelCode:!0,type:"number",component:"input",description:"com_endpoint_anthropic_maxoutputtokens",descriptionCode:!0,placeholder:"com_nav_theme_system",placeholderCode:!0,range:{min:Yo.maxOutputTokens.min,max:Yo.maxOutputTokens.max,step:Yo.maxOutputTokens.step},optionType:"model",columnSpan:2},temperature:Cw(Nw.temperature,{default:Yo.temperature.default,range:{min:Yo.temperature.min,max:Yo.temperature.max,step:Yo.temperature.step}}),topP:Cw(Nw.topP,{default:Yo.topP.default,range:{min:Yo.topP.min,max:Yo.topP.max,step:Yo.topP.step}}),topK:{key:"topK",label:"com_endpoint_top_k",labelCode:!0,description:"com_endpoint_anthropic_topk",descriptionCode:!0,type:"number",default:Yo.topK.default,range:{min:Yo.topK.min,max:Yo.topK.max,step:Yo.topK.step},component:"slider",optionType:"model",columnSpan:4},promptCache:{key:"promptCache",label:"com_endpoint_prompt_cache",labelCode:!0,description:"com_endpoint_anthropic_prompt_cache",descriptionCode:!0,type:"boolean",default:Yo.promptCache.default,component:"switch",optionType:"conversation",showDefault:!1,columnSpan:2},thinking:{key:"thinking",label:"com_endpoint_thinking",labelCode:!0,description:"com_endpoint_anthropic_thinking",descriptionCode:!0,type:"boolean",default:Yo.thinking.default,component:"switch",optionType:"conversation",showDefault:!1,columnSpan:2},thinkingBudget:{key:"thinkingBudget",label:"com_endpoint_thinking_budget",labelCode:!0,description:"com_endpoint_anthropic_thinking_budget",descriptionCode:!0,type:"number",component:"input",default:Yo.thinkingBudget.default,range:{min:Yo.thinkingBudget.min,max:Yo.thinkingBudget.max,step:Yo.thinkingBudget.step},optionType:"conversation",columnSpan:2}},Rw={system:{key:"system",label:"com_endpoint_prompt_prefix",labelCode:!0,type:"string",default:"",component:"textarea",placeholder:"com_endpoint_openai_prompt_prefix_placeholder",placeholderCode:!0,optionType:"model"},region:{key:"region",type:"string",label:"com_ui_region",labelCode:!0,component:"combobox",optionType:"conversation",selectPlaceholder:"com_ui_select_region",searchPlaceholder:"com_ui_select_search_region",searchPlaceholderCode:!0,selectPlaceholderCode:!0,columnSpan:2},maxTokens:{key:"maxTokens",label:"com_endpoint_max_output_tokens",labelCode:!0,type:"number",component:"input",placeholder:"com_endpoint_anthropic_maxoutputtokens",placeholderCode:!0,optionType:"model",columnSpan:2},temperature:Cw(Nw.temperature,{default:1,range:{min:0,max:1,step:.01}}),topK:Cw(Tw.topK,{range:{min:0,max:500,step:1}}),topP:Cw(Nw.topP,{default:.999,range:{min:0,max:1,step:.01}})},Iw={temperature:Cw(Nw.temperature,{default:.7,range:{min:0,max:1,step:.01}}),topP:Cw(Nw.topP,{range:{min:0,max:1,step:.01}})},Ew={temperature:Cw(Nw.temperature,{default:.3,range:{min:0,max:1,step:.01}}),topP:Cw(Nw.topP,{default:.75,range:{min:.01,max:.99,step:.01}})},Pw={temperature:Cw(Nw.temperature,{default:.5,range:{min:0,max:1,step:.01}}),topP:Cw(Nw.topP,{default:.9,range:{min:0,max:1,step:.01}})},Lw={temperature:Cw(Nw.temperature,{default:qo.temperature.default,range:{min:qo.temperature.min,max:qo.temperature.max,step:qo.temperature.step}}),topP:Cw(Nw.topP,{default:qo.topP.default,range:{min:qo.topP.min,max:qo.topP.max,step:qo.topP.step}}),topK:{key:"topK",label:"com_endpoint_top_k",labelCode:!0,description:"com_endpoint_google_topk",descriptionCode:!0,type:"number",default:qo.topK.default,range:{min:qo.topK.min,max:qo.topK.max,step:qo.topK.step},component:"slider",optionType:"model",columnSpan:4},maxOutputTokens:{key:"maxOutputTokens",label:"com_endpoint_max_output_tokens",labelCode:!0,type:"number",component:"input",description:"com_endpoint_google_maxoutputtokens",descriptionCode:!0,placeholder:"com_nav_theme_system",placeholderCode:!0,default:qo.maxOutputTokens.default,range:{min:qo.maxOutputTokens.min,max:qo.maxOutputTokens.max,step:qo.maxOutputTokens.step},optionType:"model",columnSpan:2}},Mw=[kw.modelLabel,kw.promptPrefix,kw.maxContextTokens,Lw.maxOutputTokens,Lw.temperature,Lw.topP,Lw.topK,kw.resendFiles],Aw=[Nw.model,kw.modelLabel,kw.promptPrefix],Ow=[kw.maxContextTokens,Lw.maxOutputTokens,Lw.temperature,Lw.topP,Lw.topK,kw.resendFiles],Dw=[Sw.chatGptLabel,kw.promptPrefix,kw.maxContextTokens,Sw.max_tokens,Sw.temperature,Sw.top_p,Sw.frequency_penalty,Sw.presence_penalty,Nw.stop,kw.resendFiles,Nw.imageDetail,Sw.reasoning_effort],Fw=[Nw.model,Sw.chatGptLabel,kw.promptPrefix,kw.maxContextTokens],zw=[Sw.max_tokens,Sw.temperature,Sw.top_p,Sw.frequency_penalty,Sw.presence_penalty,Nw.stop,Sw.reasoning_effort,kw.resendFiles,Nw.imageDetail],Uw=[kw.modelLabel,kw.promptPrefix,kw.maxContextTokens,Tw.maxOutputTokens,Tw.temperature,Tw.topP,Tw.topK,kw.resendFiles,Tw.promptCache,Tw.thinking,Tw.thinkingBudget],Vw=[Nw.model,kw.modelLabel,kw.promptPrefix],Bw=[kw.maxContextTokens,Tw.maxOutputTokens,Tw.temperature,Tw.topP,Tw.topK,kw.resendFiles,Tw.promptCache,Tw.thinking,Tw.thinkingBudget],$w=[kw.modelLabel,Rw.system,kw.maxContextTokens,Rw.maxTokens,Rw.temperature,Rw.topP,Rw.topK,Nw.stop,Rw.region,kw.resendFiles],Hw=[kw.modelLabel,kw.promptPrefix,kw.maxContextTokens,Rw.maxTokens,Iw.temperature,Iw.topP,Rw.region,kw.resendFiles],Gw=[kw.modelLabel,kw.promptPrefix,kw.maxContextTokens,Rw.maxTokens,Ew.temperature,Ew.topP,Rw.region,kw.resendFiles],Kw=[kw.modelLabel,kw.promptPrefix,kw.maxContextTokens,Pw.temperature,Pw.topP,Rw.region,kw.resendFiles],Ww=[Nw.model,kw.modelLabel,Rw.system,Nw.stop],Qw=[kw.maxContextTokens,Rw.maxTokens,Rw.temperature,Rw.topP,Rw.topK,Rw.region,kw.resendFiles],qw=[Nw.model,kw.modelLabel,kw.promptPrefix],Zw=[kw.maxContextTokens,Rw.maxTokens,Iw.temperature,Iw.topP,Rw.region,kw.resendFiles],Yw=[Nw.model,kw.modelLabel,kw.promptPrefix],Jw=[kw.maxContextTokens,Rw.maxTokens,Ew.temperature,Ew.topP,Rw.region,kw.resendFiles],Xw=[Nw.model,kw.modelLabel,kw.promptPrefix],eN=[kw.maxContextTokens,Pw.temperature,Pw.topP,Rw.region,kw.resendFiles],tN={[Ro.openAI]:Dw,[Ro.azureOpenAI]:Dw,[Ro.custom]:Dw,[Ro.anthropic]:Uw,[`${Ro.bedrock}-${Eo.Anthropic}`]:$w,[`${Ro.bedrock}-${Eo.MistralAI}`]:Hw,[`${Ro.bedrock}-${Eo.Cohere}`]:Gw,[`${Ro.bedrock}-${Eo.Meta}`]:Kw,[`${Ro.bedrock}-${Eo.AI21}`]:Kw,[`${Ro.bedrock}-${Eo.Amazon}`]:Kw,[Ro.google]:Mw},nN={col1:Fw,col2:zw},aN={col1:Xw,col2:eN},sN={[Ro.openAI]:nN,[Ro.azureOpenAI]:nN,[Ro.custom]:nN,[Ro.anthropic]:{col1:Vw,col2:Bw},[`${Ro.bedrock}-${Eo.Anthropic}`]:{col1:Ww,col2:Qw},[`${Ro.bedrock}-${Eo.MistralAI}`]:{col1:qw,col2:Zw},[`${Ro.bedrock}-${Eo.Cohere}`]:{col1:Yw,col2:Jw},[`${Ro.bedrock}-${Eo.Meta}`]:aN,[`${Ro.bedrock}-${Eo.AI21}`]:aN,[`${Ro.bedrock}-${Eo.Amazon}`]:aN,[Ro.google]:{col1:Aw,col2:Ow}},rN=Object.entries(sN).reduce(((e,[t,n])=>(n&&(e[t]=n.col2),e)),{});function oN({conversation:e,setOption:t,models:a,readonly:s}){const r=n.useMemo((()=>{const[t,n]=Ao((null==e?void 0:e.endpointType)??(null==e?void 0:e.endpoint)??"",(null==e?void 0:e.model)??"");return sN[t]??sN[n]}),[e]);if(!r)return null;const o=n=>{if(!n)return null;const r=ww[n.component];if(!r)return null;const{key:o,default:i,...l}=n,d={key:o,settingKey:o,defaultValue:i,...l,readonly:s,setOption:t,conversation:e};return"model"===o?c.jsx(r,{...d,options:a}):c.jsx(r,{...d})};return c.jsx("div",{className:"h-auto max-w-full overflow-x-hidden p-3",children:c.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-5",children:[c.jsx("div",{className:"flex flex-col gap-6 md:col-span-3",children:r.col1.map(o)}),c.jsx("div",{className:"flex flex-col gap-6 md:col-span-2",children:r.col2.map(o)})]})})}function iN({conversation:e,setOption:t,models:n,readonly:a}){const s=kg(),r=Xo[Ro.google],{model:o,modelLabel:i,promptPrefix:l,temperature:d,topP:u,topK:m,maxContextTokens:p,maxOutputTokens:g}=e??{},[f,x]=Rv({setOption:t,optionKey:"maxContextTokens",initialValue:p});if(!e)return null;const h=t("model"),v=t("modelLabel"),b=t("promptPrefix"),y=t("temperature"),_=t("topP"),j=t("topK"),w=t("maxOutputTokens");return c.jsxs("div",{className:"grid grid-cols-5 gap-6",children:[c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 sm:col-span-3",children:[c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(sj,{value:o??"",setValue:h,availableValues:n,disabled:a,className:rm(fm,"flex w-full resize-none",pm),containerClassName:"flex w-full resize-none"})}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"modelLabel",className:"text-left text-sm font-medium",children:[s("com_endpoint_custom_name")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default_blank"),")"]})]}),c.jsx(m_,{id:"modelLabel",disabled:a,value:i||"",onChange:e=>v(e.target.value??null),placeholder:s("com_endpoint_google_custom_name_placeholder"),className:rm(fm,"flex h-10 max-h-10 w-full resize-none px-3 py-2",mm)})]}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"promptPrefix",className:"text-left text-sm font-medium",children:[s("com_endpoint_prompt_prefix")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:"promptPrefix",disabled:a,value:l||"",onChange:e=>b(e.target.value??null),placeholder:s("com_endpoint_prompt_prefix_placeholder"),className:rm(fm,"flex max-h-[138px] min-h-[100px] w-full resize-none px-3 py-2 ")})]})]}),c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 px-3 sm:col-span-2",children:[c.jsxs(l_,{openDelay:300,children:[c.jsx(c_,{className:"grid w-full items-center gap-2",children:c.jsxs("div",{className:"mt-1 flex w-full justify-between",children:[c.jsxs(g_,{htmlFor:"max-context-tokens",className:"text-left text-sm font-medium",children:[s("com_endpoint_context_tokens")," "]}),c.jsx(p_,{id:"max-context-tokens",stringMode:!1,disabled:a,value:x,onChange:f,placeholder:s("com_nav_theme_system"),min:10,max:2e6,step:1e3,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200","w-1/3"))})]})}),c.jsx(jw,{description:"com_endpoint_context_info",langCode:!0,side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"temp-int",className:"text-left text-sm font-medium",children:[s("com_endpoint_temperature")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default"),": ",r.temperature.default,")"]})]}),c.jsx(p_,{id:"temp-int",disabled:a,value:d,onChange:e=>y(e??r.temperature.default),max:r.temperature.max,min:r.temperature.min,step:r.temperature.step,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:a,value:[d??r.temperature.default],onValueChange:e=>y(e[0]),onDoubleClick:()=>y(r.temperature.default),max:r.temperature.max,min:r.temperature.min,step:r.temperature.step,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"temp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"top-p-int",className:"text-left text-sm font-medium",children:[s("com_endpoint_top_p")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default_with_num",{0:r.topP.default+""}),")"]})]}),c.jsx(p_,{id:"top-p-int",disabled:a,value:u,onChange:e=>_(e??r.topP.default),max:r.topP.max,min:r.topP.min,step:r.topP.step,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:a,value:[u??r.topP.default],onValueChange:e=>_(e[0]),onDoubleClick:()=>_(r.topP.default),max:r.topP.max,min:r.topP.min,step:r.topP.step,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"topp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"top-k-int",className:"text-left text-sm font-medium",children:[s("com_endpoint_top_k")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default_with_num",{0:r.topK.default+""}),")"]})]}),c.jsx(p_,{id:"top-k-int",disabled:a,value:m,onChange:e=>j(e??r.topK.default),max:r.topK.max,min:r.topK.min,step:r.topK.step,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:a,value:[m??r.topK.default],onValueChange:e=>j(e[0]),onDoubleClick:()=>j(r.topK.default),max:r.topK.max,min:r.topK.min,step:r.topK.step,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"topk",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"max-tokens-int",className:"text-left text-sm font-medium",children:[s("com_endpoint_max_output_tokens")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default_with_num",{0:r.maxOutputTokens.default+""}),")"]})]}),c.jsx(p_,{id:"max-tokens-int",disabled:a,value:g,onChange:e=>w(Number(e)),max:r.maxOutputTokens.max,min:r.maxOutputTokens.min,step:r.maxOutputTokens.step,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:a,value:[g??r.maxOutputTokens.default],onValueChange:e=>w(e[0]),onDoubleClick:()=>w(r.maxOutputTokens.default),max:r.maxOutputTokens.max,min:r.maxOutputTokens.min,step:r.maxOutputTokens.step,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"maxoutputtokens",side:Kr.Left})]})]})]})}function lN({conversation:e,setOption:t,setTools:a,checkPluginSelection:s,models:r,readonly:o}){const i=kg(),l=I(_p.availableTools),{data:d}=fh({select:Yr}),u=n.useMemo((()=>(null==e?void 0:e.tools)?Jr(e.tools,null==d?void 0:d.map):[]),[e,d]),m=n.useMemo((()=>l?Object.values(l):[]),[l]),{model:p,modelLabel:g,chatGptLabel:f,promptPrefix:x,temperature:h,top_p:v,frequency_penalty:b,presence_penalty:y,maxContextTokens:_}=e??{},[j,w]=Rv({setOption:t,optionKey:"chatGptLabel",initialValue:g??f}),[N,C]=Rv({setOption:t,optionKey:"promptPrefix",initialValue:x}),[k,S]=Rv({setOption:t,optionKey:"temperature",initialValue:h}),[T,R]=Rv({setOption:t,optionKey:"top_p",initialValue:v}),[E,P]=Rv({setOption:t,optionKey:"frequency_penalty",initialValue:b}),[L,M]=Rv({setOption:t,optionKey:"presence_penalty",initialValue:y}),[A,O]=Rv({setOption:t,optionKey:"maxContextTokens",initialValue:_}),D=t("model");return e?c.jsxs("div",{className:"grid grid-cols-5 gap-6",children:[c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 sm:col-span-3",children:[c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(sj,{title:i("com_endpoint_completion_model"),value:p??"",setValue:D,availableValues:r,disabled:o,className:rm(fm,"flex w-full resize-none",pm),containerClassName:"flex w-full resize-none"})}),c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"chatGptLabel",className:"text-left text-sm font-medium",children:[i("com_endpoint_custom_name")," ",c.jsx("small",{className:"opacity-40",children:i("com_endpoint_default_empty")})]}),c.jsx(m_,{id:"chatGptLabel",disabled:o,value:w||"",onChange:e=>j(e.target.value??null),placeholder:i("com_endpoint_openai_custom_name_placeholder"),className:rm(fm,"flex h-10 max-h-10 w-full resize-none px-3 py-2",mm)})]}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:"promptPrefix",className:"text-left text-sm font-medium",children:[i("com_endpoint_prompt_prefix")," ",c.jsx("small",{className:"opacity-40",children:i("com_endpoint_default_empty")})]}),c.jsx(Ce,{id:"promptPrefix",disabled:o,value:C||"",onChange:e=>N(e.target.value??null),placeholder:i("com_endpoint_plug_set_custom_instructions_for_gpt_placeholder"),className:rm(fm,"flex max-h-[138px] min-h-[100px] w-full resize-none px-3 py-2 ")})]})]})]}),c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 px-3 sm:col-span-2",children:[c.jsx(uj,{showAbove:!1,showLabel:!1,setSelected:a,value:u,optionValueKey:"pluginKey",availableValues:m,isSelected:s,searchPlaceholder:i("com_ui_select_search_plugin"),className:rm(fm,"flex w-full resize-none",mm),optionsClassName:"w-full max-h-[275px] dark:bg-gray-700 z-10 border dark:border-gray-600",containerClassName:"flex w-full resize-none border border-transparent",labelClassName:"dark:text-white"}),c.jsxs(l_,{openDelay:300,children:[c.jsx(c_,{className:"grid w-full items-center gap-2",children:c.jsxs("div",{className:"mt-1 flex w-full justify-between",children:[c.jsxs(g_,{htmlFor:"max-context-tokens",className:"text-left text-sm font-medium",children:[i("com_endpoint_context_tokens")," "]}),c.jsx(p_,{id:"max-context-tokens",stringMode:!1,disabled:o,value:O,onChange:A,placeholder:i("com_nav_theme_system"),min:10,max:2e6,step:1e3,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200","w-1/3"))})]})}),c.jsx(jw,{description:"com_endpoint_context_info",langCode:!0,side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"temp-int",className:"text-left text-sm font-medium",children:[i("com_endpoint_temperature")," ",c.jsxs("small",{className:"opacity-40",children:["(",i("com_endpoint_default_with_num",{0:"0.8"}),")"]})]}),c.jsx(p_,{id:"temp-int",disabled:o,value:S,onChange:e=>k(Number(e)),max:2,min:0,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:o,value:[S??.8],onValueChange:e=>k(e[0]),onDoubleClick:()=>k(.8),max:2,min:0,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"temp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"top-p-int",className:"text-left text-sm font-medium",children:[i("com_endpoint_top_p")," ",c.jsxs("small",{className:"opacity-40",children:["(",i("com_endpoint_default_with_num",{0:"1"}),")"]})]}),c.jsx(p_,{id:"top-p-int",disabled:o,value:R,onChange:e=>T(Number(e)),max:1,min:0,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:o,value:[R??1],onValueChange:e=>T(e[0]),onDoubleClick:()=>T(1),max:1,min:0,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"topp",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"freq-penalty-int",className:"text-left text-sm font-medium",children:[i("com_endpoint_frequency_penalty")," ",c.jsxs("small",{className:"opacity-40",children:["(",i("com_endpoint_default_with_num",{0:"0"}),")"]})]}),c.jsx(p_,{id:"freq-penalty-int",disabled:o,value:P,onChange:e=>E(Number(e)),max:2,min:-2,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:o,value:[P??0],onValueChange:e=>E(e[0]),onDoubleClick:()=>E(0),max:2,min:-2,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"freq",side:Kr.Left})]}),c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"pres-penalty-int",className:"text-left text-sm font-medium",children:[i("com_endpoint_presence_penalty")," ",c.jsxs("small",{className:"opacity-40",children:["(",i("com_endpoint_default_with_num",{0:"0"}),")"]})]}),c.jsx(p_,{id:"pres-penalty-int",disabled:o,value:M,onChange:e=>L(Number(e)),max:2,min:-2,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:o,value:[M??0],onValueChange:e=>L(e[0]),onDoubleClick:()=>L(0),max:2,min:-2,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"pres",side:Kr.Left})]})]})]}):null}function cN({readonly:e,examples:t,setExample:n,addExample:a,removeExample:s}){const r=kg();return c.jsxs(c.Fragment,{children:[c.jsx("div",{id:"examples-grid",className:"grid gap-6 sm:grid-cols-2",children:t.map(((a,s)=>c.jsxs(_.Fragment,{children:[c.jsx("div",{className:`col-span-${1===t.length?"1":"full"} flex flex-col items-center justify-start gap-6 sm:col-span-1`,children:c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:`input-${s}`,className:"text-left text-sm font-medium",children:[r("com_ui_input")," ",c.jsxs("small",{className:"opacity-40",children:["(",r("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:`input-${s}`,disabled:e,value:a.input.content||"",onChange:e=>n(s,"input",e.target.value??null),placeholder:"Set example input. Example is ignored if empty.",className:rm(fm,"flex max-h-[138px] min-h-[75px] w-full resize-none px-3 py-2 ")})]})}),c.jsx("div",{className:`col-span-${1===t.length?"1":"full"} flex flex-col items-center justify-start gap-6 sm:col-span-1`,children:c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsxs(g_,{htmlFor:`output-${s}`,className:"text-left text-sm font-medium",children:[r("com_endpoint_output")," ",c.jsxs("small",{className:"opacity-40",children:["(",r("com_endpoint_default_blank"),")"]})]}),c.jsx(Ce,{id:`output-${s}`,disabled:e,value:a.output.content||"",onChange:e=>n(s,"output",e.target.value??null),placeholder:"Set example output. Example is ignored if empty.",className:rm(fm,"flex max-h-[300px] min-h-[75px] w-full resize-none px-3 py-2 ")})]})})]},s)))}),c.jsxs("div",{className:"flex justify-center",children:[c.jsx(By,{type:"button",className:"mr-2 mt-1 h-auto items-center justify-center bg-transparent px-3 py-2 text-xs font-medium font-normal text-black hover:bg-gray-100 hover:text-black focus:ring-0 focus:ring-offset-0 dark:bg-transparent dark:text-white dark:hover:bg-gray-700 dark:hover:text-white dark:focus:outline-none dark:focus:ring-offset-0",onClick:s,children:c.jsx(Me,{className:"w-[16px]"})}),c.jsx(By,{type:"button",className:"mt-1 h-auto items-center justify-center bg-transparent px-3 py-2 text-xs font-medium font-normal text-black hover:bg-gray-100 hover:text-black focus:ring-0 focus:ring-offset-0 dark:bg-transparent dark:text-white dark:hover:bg-gray-700 dark:hover:text-white dark:focus:outline-none dark:focus:ring-offset-0",onClick:a,children:c.jsx(Ze,{className:"w-[16px]"})})]})]})}function dN({conversation:e,setOption:t,models:n,readonly:a}){const s=kg();if(!e)return null;const{agent:r,skipCompletion:o,model:i,temperature:l}=e.agentOptions??{},d=t("model"),u=t("temperature"),m=t("agent"),p=t("skipCompletion");return c.jsxs("div",{className:"grid grid-cols-5 gap-6",children:[c.jsx("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 sm:col-span-3",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(sj,{title:s("com_endpoint_agent_model"),value:i??"",setValue:d,availableValues:n,disabled:a,className:rm(fm,"flex w-full resize-none",pm),containerClassName:"flex w-full resize-none"})})}),c.jsxs("div",{className:"col-span-5 flex flex-col items-center justify-start gap-6 px-3 sm:col-span-2",children:[c.jsxs(l_,{openDelay:300,children:[c.jsxs(c_,{className:"grid w-full items-center gap-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs(g_,{htmlFor:"temp-int",className:"text-left text-sm font-medium",children:[s("com_endpoint_temperature")," ",c.jsxs("small",{className:"opacity-40",children:["(",s("com_endpoint_default"),": 0)"]})]}),c.jsx(p_,{id:"temp-int",disabled:a,value:l,onChange:e=>u(Number(e)),max:2,min:0,step:.01,controls:!1,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]}),c.jsx(C_,{disabled:a,value:[l??0],onValueChange:e=>u(e[0]),onDoubleClick:()=>u(1),max:2,min:0,step:.01,className:"flex h-4 w-full"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"temp",side:Kr.Left})]}),c.jsxs("div",{className:"grid w-full grid-cols-2 items-center gap-10",children:[c.jsxs(l_,{openDelay:500,children:[c.jsxs(c_,{className:"flex w-[100px] flex-col items-center space-y-4 text-center",children:[c.jsx("label",{htmlFor:"functions-agent",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:c.jsx("small",{children:s("com_endpoint_plug_use_functions")})}),c.jsx(R_,{id:"functions-agent",checked:"functions"===r,onCheckedChange:e=>{m(e?"functions":"classic")},disabled:a,className:"ml-4 mt-2"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"func",side:Kr.Bottom})]}),c.jsxs(l_,{openDelay:500,children:[c.jsxs(c_,{className:"ml-[-60px] flex w-[100px] flex-col items-center space-y-4 text-center",children:[c.jsx("label",{htmlFor:"skip-completion",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:c.jsx("small",{children:s("com_endpoint_plug_skip_completion")})}),c.jsx(R_,{id:"skip-completion",checked:!0===o,onCheckedChange:e=>{p(e)},disabled:a,className:"ml-4 mt-2"})]}),c.jsx(vw,{endpoint:e.endpoint??"",type:"skip",side:Kr.Bottom})]})]})]})]})}function uN({conversation:e,models:t,isPreset:n=!1}){var a,s;const{optionSettings:r}=bh(),{setOption:o,setExample:i,addExample:l,removeExample:d}=Ev(n?e:null);if(!e)return null;const{examples:u,model:m}=e,p=null==(a=null==m?void 0:m.toLowerCase())?void 0:a.includes("gemini"),g=!p&&(null==(s=null==m?void 0:m.toLowerCase())?void 0:s.includes("chat")),f=!p&&!g&&/code|text/.test(m??""),{showExamples:x}=r;return x&&g&&!f?c.jsx(cN,{examples:u??[{input:{content:""},output:{content:""}}],setExample:i,addExample:l,removeExample:d}):c.jsx(iN,{conversation:e,setOption:o,models:t})}function mN({conversation:e,models:t,isPreset:n=!1}){const{showAgentSettings:a}=bh(),{setOption:s,setTools:r,setAgentOption:o,checkPluginSelection:i}=Ev(n?e:null);return e?a?c.jsx(dN,{conversation:e,setOption:o,models:t}):c.jsx(lN,{conversation:e,setOption:s,setTools:r,checkPluginSelection:i,models:t}):null}const pN={[Ro.assistants]:yw,[Ro.azureAssistants]:yw,[Ro.agents]:oN,[Ro.openAI]:oN,[Ro.custom]:oN,[Ro.azureOpenAI]:oN,[Ro.anthropic]:function({conversation:e,setOption:t,models:a,readonly:s}){const r=n.useMemo((()=>{const[t,n]=Ao((null==e?void 0:e.endpointType)??(null==e?void 0:e.endpoint)??"",(null==e?void 0:e.model)??"");return sN[t]??sN[n]}),[e]);if(!r)return null;const o=n=>{if(!n)return null;const r=ww[n.component];if(!r)return null;const{key:o,default:i,...l}=n,d={key:o,settingKey:o,defaultValue:i,...l,readonly:s,setOption:t,conversation:e};return"model"===o?c.jsx(r,{...d,options:a}):c.jsx(r,{...d})};return c.jsx("div",{className:"h-auto max-w-full overflow-x-hidden p-3",children:c.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-5",children:[c.jsx("div",{className:"flex flex-col gap-6 md:col-span-3",children:r.col1.map(o)}),c.jsx("div",{className:"flex flex-col gap-6 md:col-span-2",children:r.col2.map(o)})]})})},[Ro.bedrock]:function({conversation:e,setOption:t,models:a,readonly:s}){const r=n.useMemo((()=>{const[t,n]=Ao((null==e?void 0:e.endpointType)??(null==e?void 0:e.endpoint)??"",(null==e?void 0:e.model)??"");return sN[t]??sN[n]}),[e]);if(!r)return null;const o=n=>{if(!n)return null;const r=ww[n.component];if(!r)return null;const{key:o,default:i,...l}=n,d={key:o,settingKey:o,defaultValue:i,...l,readonly:s,setOption:t,conversation:e};return"model"===o?c.jsx(r,{...d,options:a}):c.jsx(r,{...d})};return c.jsx("div",{className:"h-auto max-w-full overflow-x-hidden p-3",children:c.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-5",children:[c.jsx("div",{className:"flex flex-col gap-6 md:col-span-3",children:r.col1.map(o)}),c.jsx("div",{className:"flex flex-col gap-6 md:col-span-2",children:r.col2.map(o)})]})})}},gN=()=>({settings:pN,multiViewSettings:{[Ro.google]:uN,[Ro.gptPlugins]:mN}});function fN({conversation:e,setOption:t,isPreset:n=!1,className:a=""}){var s;const r=mh(),{data:o}=Mp(),i=I(_p.currentSettingsView),l=Hu(o,(null==e?void 0:e.endpoint)??"","type")??(null==e?void 0:e.endpoint)??"";if(!l||i!==il.default)return null;const{settings:d,multiViewSettings:u}=gN(),{endpoint:m}=e,p=(null==(s=r.data)?void 0:s[m??""])??[],g=d[l];if(g)return c.jsx("div",{className:rm("h-[500px] overflow-y-auto md:mb-2 md:h-[350px]",a),children:c.jsx(g,{conversation:e,setOption:t,models:p,isPreset:n})});const f=u[l];return null==f?null:c.jsx("div",{className:rm("hide-scrollbar h-[500px] overflow-y-auto md:mb-2 md:h-[350px]",a),children:c.jsx(f,{conversation:e,models:p,isPreset:n})})}const xN=({open:e,onOpenChange:t,preset:a})=>{const[s,r]=n.useState(a.title??"My Preset"),o=ph(),{showToast:i}=Ng(),l=kg(),d=()=>{const e=cm({preset:{...a,title:s}}),n=e.title?`\`${e.title}\``:l("com_endpoint_preset_title");o.mutate(e,{onSuccess:()=>{i({message:`${n} ${l("com_ui_saved")}`}),t(!1)},onError:()=>{i({message:l("com_endpoint_preset_save_error"),severity:Wr.ERROR})}})};n.useEffect((()=>{r(a.title??l("com_endpoint_my_preset"))}),[e]);return c.jsx(f_,{open:e,onOpenChange:t,children:c.jsx(ij,{title:l("com_endpoint_save_as_preset"),className:"z-[90] w-11/12 sm:w-1/4",overlayClassName:"z-[80]",showCloseButton:!1,main:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"preset-custom-name",className:"text-left text-sm font-medium",children:l("com_endpoint_preset_name")}),c.jsx(m_,{id:"preset-custom-name",value:s||"",onChange:e=>r(e.target.value||""),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),d())},placeholder:l("com_endpoint_preset_custom_name_placeholder"),"aria-label":l("com_endpoint_preset_name"),className:rm(fm,"flex h-10 max-h-10 w-full resize-none border-border-medium px-3 py-2 ",mm)})]})}),selection:{selectHandler:d,selectClasses:"bg-green-500 hover:bg-green-600 dark:hover:bg-green-600 text-white",selectText:l("com_ui_save")}})})};function hN({conversation:e,setOption:t,isPreset:n=!1,className:a=""}){const s=I(_p.currentSettingsView);return(null==e?void 0:e.endpoint)&&s!==il.default?c.jsx("div",{className:rm("hide-scrollbar h-[500px] overflow-y-auto md:mb-2 md:h-[350px]",a),children:c.jsx(bw,{conversation:e,setOption:t,isPreset:n})}):null}const vN={[ji.openai]:Ro.openAI,[ji.azure]:Ro.azureOpenAI},bN={[ji.openai]:"bg-white/75 dark:bg-black/65",[ji.azure]:"azure-bg-color opacity-85"};function yN({source:e,className:t="absolute right-0 bottom-0 rounded-full p-[0.15rem] text-gray-600 transition-colors"}){if(e===ji.local||e===ji.firebase)return null;const n=vN[e??""];return n?c.jsx("button",{type:"button",className:rm(t,bN[e??""]??""),children:c.jsx("span",{className:"flex items-center justify-center",children:c.jsx(ow,{endpoint:n,size:14,isCreatedByUser:!1,iconClassName:"h-3 w-3"})})}):null}const _N=({file:e,fileType:t,className:n=""})=>{const a=2*Math.PI*55,s=ob((null==e?void 0:e.progress)??1,.001,(null==e?void 0:e.size)??1),r=a-s*a;return c.jsxs("div",{className:rm("size-10 shrink-0 overflow-hidden rounded-xl",n),children:[c.jsx(Qj,{file:e,fileType:t}),c.jsx(yN,{source:null==e?void 0:e.source}),s<1&&c.jsx(qj,{circumference:a,offset:r,circleCSSProperties:{transition:"stroke-dashoffset 0.5s linear"}})]})},jN=({artifact:e})=>{const t=kg(),n=R(_p.artifactsVisible),a=R(_p.currentArtifactId);if(null==e)return null;const s=tu("artifact");return c.jsxs("div",{className:"group relative my-4 rounded-xl text-sm text-text-primary",children:[c.jsx("button",{type:"button",onClick:()=>{a(e.id),n(!0)},className:"relative overflow-hidden rounded-xl border border-border-medium transition-all duration-300 hover:border-border-xheavy hover:shadow-lg",children:c.jsx("div",{className:"w-fit bg-surface-tertiary p-2 ",children:c.jsxs("div",{className:"flex flex-row items-center gap-2",children:[c.jsx(_N,{fileType:s,className:"relative"}),c.jsxs("div",{className:"overflow-hidden text-left",children:[c.jsx("div",{className:"truncate font-medium",children:e.title}),c.jsx("div",{className:"truncate text-text-secondary",children:t("com_ui_artifact_click")})]})]})})}),c.jsx("br",{})]})},wN=()=>e=>{_t(e,["textDirective","leafDirective","containerDirective"],(e=>{if("artifact"===e.name)return e.data={hName:e.name,hProperties:e.attributes,...e.data},e}))};function NN({node:e,...t}){const{messageId:a}=gv(),{getNextIndex:s,resetCounter:r}=n.useContext(jv),o=n.useRef(s(!1)).current,i=R(ym),[l,d]=n.useState(null),u=n.useRef(K((e=>{e()}),25)),m=n.useCallback((()=>{const e=vm(t.children);om.log("artifacts","updateArtifact: content.length",e.length);const n=t.title??"Untitled Artifact",s=t.type??"unknown",r=t.identifier??"no-identifier",l=`${r}_${s}_${n}_${a}`.replace(/\s+/g,"_").toLowerCase();u.current((()=>{const t=Date.now(),c={id:l,identifier:r,title:n,type:s,content:e,messageId:a,index:o,lastUpdateTime:t};i((t=>null!=(null==t?void 0:t[l])&&t[l].content===e?t:{...t,[l]:c})),d(c)}))}),[t.type,t.title,i,t.children,t.identifier,a,o]);return n.useEffect((()=>{r(),m()}),[m,r]),c.jsx(jN,{artifact:l})}function CN({src:e="",width:t=1920,height:n=1080}){return c.jsx(Wa,{children:c.jsxs(Qa,{className:"radix-state-open:animate-show fixed inset-0 z-[100] flex items-center justify-center overflow-hidden bg-black/90 dark:bg-black/80",style:{pointerEvents:"auto"},children:[c.jsx(Za,{asChild:!0,children:c.jsx("button",{className:"absolute right-4 top-4 text-gray-50 transition hover:text-gray-200",type:"button",children:c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})}),c.jsx(qa,{className:"radix-state-open:animate-contentShow relative max-h-[85vh] max-w-[90vw] shadow-xl focus:outline-none",tabIndex:-1,style:{pointerEvents:"auto",aspectRatio:n>t?1/1.75:1.75},children:c.jsx("img",{src:e,alt:"Uploaded image",className:"h-full w-full object-contain"})})]})})}const kN=({imagePath:e,altText:t,height:a,width:s,placeholderDimensions:r})=>{const[o,i]=n.useState(!1),l=n.useRef(null),{width:d,height:u}=n.useMemo((()=>{var e,t;return(({originalWidth:e,originalHeight:t,containerRef:n})=>{var a;const s=(null==(a=n.current)?void 0:a.offsetWidth)??0;if(0===s||null==e||null==t)return{width:"auto",height:"auto"};const r=e/t,o=Math.min(s,e);return{width:`${o}px`,height:o/r+"px"}})({originalWidth:Number((null==(e=null==r?void 0:r.width)?void 0:e.split("px")[0])??s),originalHeight:Number((null==(t=null==r?void 0:r.height)?void 0:t.split("px")[0])??a),containerRef:l})}),[r,a,s]);return c.jsxs(Xa,{children:[c.jsx("div",{ref:l,children:c.jsx("div",{className:"relative mt-1 flex h-auto w-full max-w-lg items-center justify-center overflow-hidden bg-gray-200 text-gray-500 dark:bg-gray-700 dark:text-gray-400",children:c.jsx(es,{asChild:!0,children:c.jsx("button",{type:"button","aria-haspopup":"dialog","aria-expanded":"false",children:c.jsx(jt.LazyLoadImage,{alt:t,onLoad:()=>i(!0),visibleByDefault:!0,className:rm("opacity-100 transition-opacity duration-100",o?"opacity-100":"opacity-0"),src:e,style:{width:d,height:"auto",color:"transparent"},placeholder:c.jsx("div",{style:{width:d,height:u}})})})})})}),o&&c.jsx(CN,{src:e,height:a,width:s})]})},SN=({href:e,filename:t,children:n})=>{const{showToast:a}=Ng(),{refetch:s}=((e="")=>nr([Xc.fileDownload,e],(async()=>{if(!e)return void console.warn("No user ID provided for file download");const t=(await zd.getCodeOutputDownload(e)).data;return window.URL.createObjectURL(t)}),{enabled:!1,retry:!1}))(e);return c.jsx("a",{href:e,onClick:async e=>{e.preventDefault();try{const e=await s();if(null==e.data||""===e.data)return console.error("Error downloading file: No data found"),void a({status:"error",message:"Error downloading file"});const n=document.createElement("a");n.href=e.data,n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e.data)}catch(n){console.error("Error downloading file:",n)}},target:"_blank",rel:"noopener noreferrer",className:"!text-blue-400 visited:!text-purple-400 hover:underline",children:n})},TN=({output:e="",renderImages:t,attachments:a})=>{const s=kg(),r=n.useMemo((()=>{if(!e)return"";return e.split("Generated files:")[0].trim()}),[e]),{imageAttachments:o,nonImageAttachments:i}=n.useMemo((()=>{const e=[],n=[];return null==a||a.forEach((t=>{const{width:a,height:s,filepath:r=null}=t;Oi.test(t.filename)&&null!=a&&null!=s&&null!=r?e.push(t):n.push(t)})),{imageAttachments:!0===t?e:null,nonImageAttachments:n}}),[a,t]),l=e=>{const t=new Date,n="number"==typeof e.expiresAt?new Date(e.expiresAt):null;return!!n&&wt(t,n)?`${e.filename} ${s("com_download_expired")}`:c.jsxs(SN,{href:e.filepath,filename:e.filename,children:["- ",e.filename," ",s("com_click_to_download")]})};return c.jsxs(c.Fragment,{children:[r&&c.jsx("div",{children:r}),i.length>0&&c.jsxs("div",{children:[c.jsx("p",{children:s("com_generated_files")}),i.map(((e,t)=>c.jsxs(_.Fragment,{children:[l(e),t<i.length-1&&", "]},e.filepath)))]}),null==o?void 0:o.map(((e,t)=>{const{width:n,height:a,filepath:s}=e;return c.jsx(kN,{altText:e.filename,imagePath:s,height:a,width:n},t)}))]})},RN=({currentIndex:e,totalCount:t,onPrevious:n,onNext:a})=>t<=1?null:c.jsxs("div",{className:"flex items-center justify-start gap-1 self-center bg-gray-700 pb-2 text-xs",children:[c.jsx("button",{className:"hover-button rounded-md p-1 text-gray-400 hover:bg-gray-700 hover:text-gray-200 disabled:hover:text-gray-400",type:"button",onClick:n,disabled:0===e,children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"15 18 9 12 15 6"})})}),c.jsxs("span",{className:"flex-shrink-0 tabular-nums",children:[e+1," / ",t]}),c.jsx("button",{className:"hover-button rounded-md p-1 text-gray-400 hover:bg-gray-700 hover:text-gray-200 disabled:hover:text-gray-400",type:"button",onClick:a,disabled:e===t-1,children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"9 18 15 12 9 6"})})})]});function IN({isOpen:e,onSubmit:t,onRevoke:n,onOpenChange:a,isUserProvided:s,isToolAuthenticated:r,register:o,handleSubmit:i}){const l=kg();return c.jsx(f_,{open:e,onOpenChange:a,children:c.jsx(ij,{className:"w-11/12 sm:w-[450px]",title:"",main:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-4 text-center font-medium",children:l("com_ui_librechat_code_api_title")}),c.jsx("div",{className:"mb-4 text-center text-sm",children:l("com_ui_librechat_code_api_subtitle")}),c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"mx-auto mb-4 flex max-w-[400px] flex-wrap justify-center gap-3",children:["python.svg","nodedotjs.svg","tsnode.svg","rust.svg","go.svg","c.svg","cplusplus.svg","php.svg","fortran.svg","r.svg"].map((e=>c.jsx("div",{className:"h-6 w-6",children:c.jsx("img",{src:`/assets/${e}`,alt:"",className:"h-full w-full object-contain opacity-[0.85] dark:invert"})},e)))}),c.jsx("a",{href:"https://code.librechat.ai/pricing",target:"_blank",rel:"noopener noreferrer",className:"block text-center text-[15px] font-medium text-blue-500 underline decoration-1 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300",children:l("com_ui_librechat_code_api_key")})]}),c.jsx("form",{onSubmit:i(t),children:c.jsx(m_,{type:"password",placeholder:l("com_ui_enter_api_key"),autoComplete:"one-time-code",readOnly:!0,onFocus:e=>e.target.readOnly=!1,...o("apiKey",{required:!0})})})]}),selection:{selectHandler:i(t),selectClasses:"bg-green-500 hover:bg-green-600 text-white",selectText:l("com_ui_save")},buttons:s&&r&&c.jsx(By,{onClick:n,className:"bg-destructive text-white transition-all duration-200 hover:bg-destructive/80",children:l("com_ui_revoke")}),showCancelButton:!0})})}const EN=_.memo((({lang:e,codeRef:t,blockIndex:a})=>{const s=kg(),{showToast:r}=Ng(),o=((e,t)=>{const n=ar();return sr((t=>zd.callTool({toolId:e,toolParams:t})),{onMutate:e=>{var n;return null==(n=null==t?void 0:t.onMutate)?void 0:n.call(t,e)},onError:(e,n,a)=>{var s;return null==(s=null==t?void 0:t.onError)?void 0:s.call(t,e,n,a)},onSuccess:(e,a,s)=>{var r;return n.setQueryData([Xc.toolCalls,a.conversationId],(t=>[...t??[],{user:"",toolId:so.execute_code,partIndex:a.partIndex,messageId:a.messageId,blockIndex:a.blockIndex,conversationId:a.conversationId,result:e.result,attachments:e.attachments}])),null==(r=null==t?void 0:t.onSuccess)?void 0:r.call(t,e,a,s)}})})(so.execute_code,{onError:()=>{r({message:s("com_ui_run_code_error"),status:"error"})}}),{messageId:i,conversationId:l,partIndex:d}=gv(),u=n.useMemo((()=>function(e){const t=e.toLowerCase().trim(),n=Vu[t];return n||""}(e)),[e]),{data:m}=Vp({toolId:so.execute_code},{retry:1}),p=n.useMemo((()=>(null==m?void 0:m.message)??!1),[null==m?void 0:m.message]),g=n.useMemo((()=>(null==m?void 0:m.authenticated)??!1),[null==m?void 0:m.authenticated]),{methods:f,onSubmit:x,isDialogOpen:h,setIsDialogOpen:v,handleRevokeApiKey:b}=xb({}),y=n.useCallback((async()=>{var e;if(!g)return void v(!0);const n=(null==(e=t.current)?void 0:e.textContent)??"";"string"==typeof n&&0!==n.length&&"string"==typeof u&&0!==u.length&&o.mutate({partIndex:d,messageId:i,blockIndex:a,conversationId:l??"",lang:u,code:n})}),[t,o,d,i,a,l,u,v,g]),_=n.useMemo((()=>$(y,1e3,{leading:!0})),[y]);return n.useEffect((()=>()=>{_.cancel()}),[_]),"string"!=typeof u||0===u.length?null:c.jsxs(c.Fragment,{children:[c.jsxs("button",{type:"button",className:rm("ml-auto flex gap-2"),onClick:_,disabled:o.isLoading,children:[o.isLoading?c.jsx(Nt,{className:"animate-spin",size:18}):c.jsx(re,{size:18}),s("com_ui_run_code")]}),c.jsx(IN,{onSubmit:x,isOpen:h,register:f.register,onRevoke:b,onOpenChange:v,handleSubmit:f.handleSubmit,isToolAuthenticated:g,isUserProvided:p===So.USER_PROVIDED})]})})),PN=_.memo((({lang:e,error:t,codeRef:a,blockIndex:s,plugin:r=null,allowExecution:o=!0})=>{const i=kg(),[l,d]=n.useState(!1);return c.jsxs("div",{className:"relative flex items-center justify-between rounded-tl-md rounded-tr-md bg-gray-700 px-4 py-2 font-sans text-xs text-gray-200 dark:bg-gray-700",children:[c.jsx("span",{className:"",children:e}),!0===r?c.jsx(Ct,{className:"ml-auto flex h-4 w-4 gap-2 text-white/50"}):c.jsxs("div",{className:"flex items-center justify-center gap-4",children:[!0===o&&c.jsx(EN,{lang:e,codeRef:a,blockIndex:s}),c.jsx("button",{type:"button",className:rm("ml-auto flex gap-2",!0===t?"h-4 w-4 items-start text-white/50":""),onClick:async()=>{var e;const t=null==(e=a.current)?void 0:e.textContent;null!=t&&(d(!0),te(t.trim(),{format:"text/plain"}),setTimeout((()=>{d(!1)}),3e3))},children:l?c.jsxs(c.Fragment,{children:[c.jsx(Kb,{className:"h-[18px] w-[18px]"}),!0===t?"":i("com_ui_copied")]}):c.jsxs(c.Fragment,{children:[c.jsx(Gb,{}),!0===t?"":i("com_ui_copy_code")]})})]})]})})),LN=({lang:e,blockIndex:t,codeChildren:a,classProp:s="",allowExecution:r=!0,plugin:o=null,error:i})=>{const l=n.useRef(null),d=n.useContext(kv),{messageId:u,partIndex:m}=gv(),p=r?`${u}_${m??0}_${t??0}_${so.execute_code}`:"",[g,f]=n.useState(0),x=null==d?void 0:d[p],[h,v]=n.useState((null==d?void 0:d[p])??null);n.useEffect((()=>{x&&(v(x),f(x.length-1))}),[x]);const b=n.useMemo((()=>null==h?void 0:h[g]),[h,g]),y=!(!0!==o&&!0!==i),_=y?"json":e;return c.jsxs("div",{className:"w-full rounded-md bg-gray-900 text-xs text-white/80",children:[c.jsx(PN,{lang:e,error:i,codeRef:l,blockIndex:t,plugin:!0===o,allowExecution:r}),c.jsx("div",{className:rm(s,"overflow-y-auto p-4"),children:c.jsx("code",{ref:l,className:rm(y?"!whitespace-pre-wrap":`hljs language-${_} !whitespace-pre`),children:a})}),!0===r&&h&&h.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-gray-700 p-4 text-xs",children:c.jsx("div",{className:"prose flex flex-col-reverse text-white",style:{color:"white"},children:c.jsx("pre",{className:"shrink-0",children:c.jsx(TN,{output:(null==b?void 0:b.result)??"",attachments:(null==b?void 0:b.attachments)??[],renderImages:!0})})})}),h.length>1&&c.jsx(RN,{currentIndex:g,totalCount:h.length,onPrevious:()=>{g>0&&f(g-1)},onNext:()=>{h&&g<h.length-1&&f(g+1)}})]})]})},MN=n.memo((({className:e,children:t})=>{const a=Jv({permissionType:Zc.RUN_CODE,permission:Yc.USE}),s=/language-(\w+)/.exec(e??""),r=s&&s[1],o="math"===r,i="string"==typeof t&&1===t.split("\n").length,{getNextIndex:l,resetCounter:d}=n.useContext(Nv),u=n.useRef(l(o||i)).current;return n.useEffect((()=>{d()}),[t,d]),o?c.jsx(c.Fragment,{children:t}):i?c.jsx("code",{onDoubleClick:hm,className:e,children:t}):c.jsx(LN,{lang:r??"text",codeChildren:t,blockIndex:u,allowExecution:a})})),AN=n.memo((({className:e,children:t})=>{const n=/language-(\w+)/.exec(e??""),a=n&&n[1];return"math"===a?t:"string"==typeof t&&1===t.split("\n").length?c.jsx("code",{onDoubleClick:hm,className:e,children:t}):c.jsx(LN,{lang:a??"text",codeChildren:t,allowExecution:!1})})),ON=n.memo((({href:e,children:t})=>{const a=I(_p.user),{showToast:s}=Ng(),r=kg(),{file_id:o="",filename:i="",filepath:l}=n.useMemo((()=>{const t=new RegExp(`(?:files|outputs)/${null==a?void 0:a.id}/([^\\s]+)`),n=e.match(t);if(n&&n[0]){const e=n[0],t=e.split("/"),a=t.pop();return{file_id:t.pop(),filename:a,filepath:e}}return{file_id:"",filename:"",filepath:""}}),[null==a?void 0:a.id,e]),{refetch:d}=((e,t)=>{const n=ar();return nr([Xc.fileDownload,t],(async()=>{if(!e||!t)return void console.warn("No user ID provided for file download");const a=await zd.getFileDownload(e,t),s=a.data,r=window.URL.createObjectURL(s);try{const e=JSON.parse(a.headers["x-file-metadata"]);if(!e)return console.warn("No metadata found for file download",a.headers),r;au(n,e)}catch(Bg){console.error("Error parsing file metadata, skipped updating file query cache",Bg)}return r}),{enabled:!1,retry:!1})})((null==a?void 0:a.id)??"",o),u={target:"_new"};if(!o||!i)return c.jsx("a",{href:e,...u,children:t});return u.onClick=async e=>{e.preventDefault();try{const e=await d();if(null==e.data||""===e.data)return console.error("Error downloading file: No data found"),void s({status:"error",message:r("com_ui_download_error")});const t=document.createElement("a");t.href=e.data,t.setAttribute("download",i),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e.data)}catch(t){console.error("Error downloading file:",t)}},u.target="_blank",c.jsx("a",{href:l.startsWith("files/")?`/api/${l}`:`/api/files/${l}`,...u,children:t})})),DN=n.memo((({children:e})=>c.jsx("p",{className:"mb-2 whitespace-pre-wrap",children:e}))),FN=n.memo((({content:e="",showCursor:t,isLatestMessage:a})=>{const s=I(_p.LaTeXParsing),r=""===e,o=n.useMemo((()=>r?"":s?function(e){const t=[];e=e.replace(/(```[\s\S]*?```|`[^`\n]+`)/g,((e,n)=>(t.push(n),`<<CODE_BLOCK_${t.length-1}>>`)));const n=[];return e=function(e){const t=/(```[\S\s]*?```|`.*?`)|\\\[([\S\s]*?[^\\])\\]|\\\((.*?)\\\)/g;return e.replace(t,((e,t,n,a)=>null!=t?t:null!=n?`$$${n}$$`:null!=a?`$${a}$`:e))}(e=(e=(e=(e=e.replace(/(\$\$[\s\S]*?\$\$|\\\[[\s\S]*?\\\]|\\\(.*?\\\))/g,(e=>(n.push(e),`<<LATEX_${n.length-1}>>`)))).replace(/\$(?=\d)/g,"\\$")).replace(/<<LATEX_(\d+)>>/g,((e,t)=>n[parseInt(t)]))).replace(/<<CODE_BLOCK_(\d+)>>/g,((e,n)=>t[parseInt(n)]))),e.replaceAll("$\\ce{","$\\\\ce{").replaceAll("$\\pu{","$\\\\pu{")}(e):e),[e,s,r]),i=n.useMemo((()=>[[kt,{output:"mathml"}],[St,{detect:!0,ignoreMissing:!0,subset:Uu}]]),[]),l=n.useMemo((()=>[Tt,Rt,It,wN,[Et,{singleDollarTextMath:!0}]]),[]);return r?c.jsx("div",{className:"absolute",children:c.jsx("p",{className:"relative",children:c.jsx("span",{className:a?"result-thinking":""})})}):c.jsx(wv,{children:c.jsx(Cv,{children:c.jsx(Pt,{remarkPlugins:l,rehypePlugins:i,components:{code:MN,a:ON,p:DN,artifact:NN},children:a&&t?o+" ":o})})})})),zN=e=>{const t=e.trim();if(t.includes(":")){const[e,n]=t.split(":");if(n&&n.includes("|"))return{variable:e.trim(),type:"select",options:n.split("|").map((e=>e.trim()))}}return{variable:t,type:"text"}};function UN({group:e,onClose:t}){var a;const s=kg(),{user:r}=Wh(),o=n.useMemo((()=>{var t;return Ru({text:(null==(t=e.productionPrompt)?void 0:t.prompt)??"",user:r})}),[null==(a=e.productionPrompt)?void 0:a.prompt,r]),{allVariables:i,uniqueVariables:l,variableIndexMap:d}=n.useMemo((()=>(e=>{const t=/{{(.*?)}}/g;let n;const a=[],s=[],r=new Set,o=new Map,i=new Map;for(;null!==(n=t.exec(e));){const e=n[1];a.push(e);const t=o.get(e)??0;o.set(e,t+1),t>0?r.add(e):(s.push(e),i.set(e,s.length-1))}return{allVariables:a,uniqueVariables:s,repeatedVariables:r,variableIndexMap:i}})(o)),[o]),{submitPrompt:u}=lb(),{control:m,handleSubmit:p}=ne({defaultValues:{fields:l.map((e=>({variable:Eu(e),value:"",config:zN(e)})))}}),{fields:g}=Lt({control:m,name:"fields"}),f=Mt({control:m,name:"fields"});if(!l.length)return null;return c.jsx("div",{className:"mx-auto p-1 md:container",children:c.jsxs("form",{onSubmit:p((e=>{let n=o;e.fields.forEach((({variable:e,value:t})=>{if(!t)return;const a=e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),s=new RegExp(a,"g");n=n.replace(s,t)})),u(n),t()})),className:"space-y-4",children:[c.jsx("div",{className:"mb-6 max-h-screen max-w-[90vw] overflow-auto rounded-md bg-gray-100 p-4 text-text-secondary dark:bg-gray-700/50 sm:max-w-full md:max-h-80",children:c.jsx(Pt,{remarkPlugins:[Tt,Rt,[Et,{singleDollarTextMath:!0}]],rehypePlugins:[[kt,{output:"mathml"}],[St,{ignoreMissing:!0}]],components:{code:AN},className:"prose dark:prose-invert light dark:text-gray-70 my-1 max-h-[50vh] break-words",children:(()=>{let e=o;return i.forEach((t=>{const n=`{{${t}}}`,a=d.get(t),s=f[a].value,r=""!==s?s:n;e=e.replaceAll(n,`**${r}**`)})),e})()})}),c.jsx("div",{className:"space-y-4",children:g.map(((e,t)=>c.jsx("div",{className:"flex flex-col space-y-2",children:c.jsx(tt,{name:`fields.${t}.value`,control:m,render:({field:{onChange:n,onBlur:a,value:r,ref:o}})=>"select"===e.config.type?c.jsx(S_,{options:e.config.options||[],placeholder:s("com_ui_enter_var",{0:e.config.variable}),className:rm(fm,"rounded px-3 py-2 focus:bg-surface-tertiary"),value:r,onChange:n,onBlur:a}):c.jsx(F_,{ref:o,value:r,onChange:n,onBlur:a,id:`fields.${t}.value`,className:rm(fm,"rounded px-3 py-2 focus:bg-surface-tertiary"),placeholder:s("com_ui_enter_var",{0:e.config.variable}),maxRows:8})})},e.id)))}),c.jsx("div",{className:"flex justify-end",children:c.jsx(By,{type:"submit",variant:"submit",children:s("com_ui_submit")})})]})})}const VN=({open:e,onClose:t,group:a})=>{var s;const r=n.useMemo((()=>{var e;return Iu((null==(e=null==a?void 0:a.productionPrompt)?void 0:e.prompt)??"")}),[null==(s=null==a?void 0:a.productionPrompt)?void 0:s.prompt]);return a&&r?c.jsx(f_,{open:e,onOpenChange:e=>{e||t()},children:c.jsxs(y_,{className:"max-w-full bg-white dark:border-gray-700 dark:bg-gray-850 dark:text-gray-300 md:max-w-3xl",children:[c.jsx(w_,{children:a.name}),c.jsx(UN,{group:a,onClose:t})]})}):null},BN=({children:e})=>c.jsx("code",{onDoubleClick:hm,className:"rounded-md bg-surface-primary-alt p-1 text-xs text-text-secondary md:text-sm",children:e}),$N=/{{(.*?)}}/g,HN=({children:e})=>c.jsx("p",{children:_.Children.map(e,(e=>(e=>"object"==typeof e&&null!==e||"string"!=typeof e?e:e.split($N).map(((e,t)=>t%2==1?c.jsx("b",{className:"rounded-md bg-yellow-100/90 p-1 text-gray-700",children:`{{${e}}}`},t):e)))(e)))}),GN={current_date:!0,current_user:!0},KN=({promptText:e,showInfo:t=!0})=>{const a=kg(),s=n.useMemo((()=>(e=>{const t=/{{(.*?)}}/g;let n;const a=new Set;for(;null!==(n=t.exec(e));)a.add(n[1]);return Array.from(a)})(e||"")),[e]);return c.jsxs("div",{className:"rounded-xl border border-border-light bg-transparent p-4 shadow-md",children:[c.jsxs("h3",{className:"flex items-center gap-2 py-2 text-lg font-semibold text-text-primary",children:[c.jsx(At,{className:"icon-sm","aria-hidden":"true"}),a("com_ui_variables")]}),c.jsxs("div",{className:"flex flex-col space-y-4",children:[s.length?c.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(((e,t)=>c.jsx("span",{className:rm("rounded-full border border-border-light px-3 py-1 text-text-primary",null!=GN[e.toLowerCase()]?"bg-yellow-500/25 text-yellow-600 dark:border-yellow-500/50 dark:bg-transparent dark:text-yellow-500/90":""),children:null!=GN[e.toLowerCase()]?e.toLowerCase():e},t)))}):c.jsx("div",{className:"text-sm text-text-secondary",children:c.jsx(Pt,{components:{code:BN},children:a("com_ui_variables_info")})}),c.jsx(k_,{className:"my-3 text-text-primary"}),t&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-text-primary",children:a("com_ui_special_variables")}),c.jsx("span",{className:"text-sm text-text-secondary",children:c.jsx(Pt,{components:{code:BN},children:a("com_ui_special_variables_info")})})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-text-primary",children:a("com_ui_dropdown_variables")}),c.jsx("span",{className:"text-sm text-text-secondary",children:c.jsx(Pt,{components:{code:BN},children:a("com_ui_dropdown_variables_info")})})]})]})]})]})},WN=({initialValue:e,onValueChange:t,disabled:a,tabIndex:s})=>{const r=kg(),[o,i]=n.useState(e||""),[l,d]=n.useState((null==e?void 0:e.length)||0);n.useEffect((()=>{i(e||""),d((null==e?void 0:e.length)||0)}),[e]),n.useEffect((()=>{d(o.length)}),[o]);return a&&!o?null:c.jsx("div",{className:"rounded-xl border border-border-light shadow-md",children:c.jsxs("h3",{className:"flex h-10 items-center gap-1 pl-4 text-sm text-text-secondary",children:[c.jsx(Ct,{className:"icon-sm","aria-hidden":"true"}),c.jsx(m_,{type:"text",tabIndex:s,disabled:a,placeholder:r("com_ui_description_placeholder"),value:o,onChange:e=>{e.target.value.length<=120&&(i(e.target.value),null==t||t(e.target.value))},className:"border-none"}),!a&&c.jsx("span",{className:"mr-4 w-10 text-xs text-text-secondary md:text-sm",children:`${l}/120`})]})})},QN=({initialValue:e,onValueChange:t,disabled:a,tabIndex:s})=>{const r=kg(),[o,i]=n.useState(e||""),[l,d]=n.useState((null==e?void 0:e.length)||0);n.useEffect((()=>{i(e||""),d((null==e?void 0:e.length)||0)}),[e]),n.useEffect((()=>{d(o.length)}),[o]);return!0!==a||o?c.jsx("div",{className:"rounded-xl border border-border-light shadow-md",children:c.jsxs("h3",{className:"flex h-10 items-center gap-1 pl-4 text-sm text-text-secondary",children:[c.jsx(Ot,{className:"icon-sm","aria-hidden":"true"}),c.jsx(m_,{type:"text",tabIndex:s,disabled:a,placeholder:r("com_ui_command_placeholder"),value:o,onChange:e=>{let n=e.target.value.toLowerCase();n=n.replace(/\s/g,"-").replace(/[^a-z0-9-]/g,""),n.length<=dc.COMMANDS_MAX_LENGTH&&(i(n),null==t||t(n))},className:"border-none"}),!0!==a&&c.jsx("span",{className:"mr-4 w-10 text-xs text-text-secondary md:text-sm",children:`${l}/${dc.COMMANDS_MAX_LENGTH}`})]})}):null},qN=({group:e})=>{var t,a;const s=kg(),{user:r}=Wh(),o=n.useMemo((()=>{var t;return Ru({text:(null==(t=null==e?void 0:e.productionPrompt)?void 0:t.prompt)??"",user:r})}),[null==(t=null==e?void 0:e.productionPrompt)?void 0:t.prompt,r]);return e?c.jsxs("div",{children:[c.jsx("div",{className:"flex flex-col items-center justify-between p-4 text-text-primary sm:flex-row",children:c.jsx("div",{className:"mb-1 flex flex-row items-center font-bold sm:text-xl md:mb-0 md:text-2xl",children:c.jsxs("div",{className:"mb-1 flex items-center md:mb-0",children:[c.jsx("div",{className:"rounded pr-2",children:((null==(a=e.category)?void 0:a.length)??0)>0?c.jsx(yb,{category:e.category??""}):null}),c.jsx(g_,{className:"text-2xl font-bold",children:e.name})]})})}),c.jsx("div",{className:"flex h-full max-h-screen flex-col overflow-y-auto md:flex-row",children:c.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-0 md:max-h-[calc(100vh-150px)] md:p-2",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"flex items-center justify-between rounded-t-lg border border-border-light py-2 pl-4 text-base font-semibold text-text-primary ",children:s("com_ui_prompt_text")}),c.jsx("div",{className:"group relative min-h-32 rounded-b-lg border border-border-light p-4 transition-all duration-150",children:c.jsx(Pt,{remarkPlugins:[Tt,Rt,[Et,{singleDollarTextMath:!0}]],rehypePlugins:[[kt,{output:"mathml"}],[St,{ignoreMissing:!0}]],components:{p:HN,code:AN},className:"prose dark:prose-invert light dark:text-gray-70 my-1",children:o})})]}),c.jsx(KN,{promptText:o,showInfo:!1}),c.jsx(WN,{initialValue:e.oneliner,disabled:!0}),c.jsx(QN,{initialValue:e.command,disabled:!0})]})})]}):null},ZN=({group:e,open:t,onOpenChange:n})=>c.jsx(f_,{open:t,onOpenChange:n,children:c.jsx(y_,{className:"w-11/12 max-w-5xl",children:c.jsx("div",{className:"p-2",children:c.jsx(qN,{group:e})})})});function YN({category:e,name:t,snippet:n,onClick:a,children:s}){return c.jsxs("div",{onClick:a,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),null==a||a(e))},className:"relative my-2 flex w-full cursor-pointer flex-col gap-2 rounded-xl border border-border-light px-3 pb-4 pt-3 text-start\n          align-top text-[15px] shadow-sm transition-all duration-300 ease-in-out hover:bg-surface-tertiary hover:shadow-lg",role:"button",tabIndex:0,"aria-labelledby":`card-title-${t}`,"aria-describedby":`card-snippet-${t}`,"aria-label":`Card for ${t}`,children:[c.jsxs("div",{className:"flex w-full justify-between gap-2",children:[c.jsxs("div",{className:"flex flex-row gap-2",children:[c.jsx(yb,{category:e,className:"icon-md","aria-hidden":"true"}),c.jsx(g_,{id:`card-title-${t}`,className:"break-word select-none text-balance text-sm font-semibold text-text-primary",title:t,children:t})]}),c.jsx("div",{children:s})]}),c.jsx("div",{id:`card-snippet-${t}`,className:"ellipsis max-w-full select-none text-balance text-sm text-text-secondary",children:n})]})}const JN=n.memo((function({group:e,instanceProjectId:t}){var a;const s=kg(),{user:r}=Wh(),{submitPrompt:o}=lb(),[i,l]=n.useState(!1),[u,m]=n.useState(!1),p=Vv(`/d/prompts/${e._id}`),g=n.useMemo((()=>{var n;return null!=t&&(null==(n=e.projectIds)?void 0:n.includes(t))}),[e,t]),f=n.useMemo((()=>(null==r?void 0:r.id)===e.author),[r,e]);return c.jsxs(c.Fragment,{children:[c.jsx(YN,{name:e.name,category:e.category??"",onClick:()=>{var t;const n=null==(t=e.productionPrompt)?void 0:t.prompt;(null==n?void 0:n.trim())&&(Iu(n)?m(!0):o(n))},snippet:"string"==typeof e.oneliner&&e.oneliner.length>0?e.oneliner:(null==(a=e.productionPrompt)?void 0:a.prompt)??"",children:c.jsxs("div",{className:"flex flex-row items-center gap-2",children:[!0===g&&c.jsx(d,{className:"icon-md text-green-400","aria-label":"Global prompt group"}),c.jsxs(Hy,{modal:!1,children:[c.jsx(Gy,{asChild:!0,children:c.jsxs("button",{id:`prompt-actions-${e._id}`,"aria-label":`${e.name} - Actions Menu`,"aria-expanded":"false","aria-controls":`prompt-menu-${e._id}`,"aria-haspopup":"menu",onClick:e=>{e.stopPropagation()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||e.stopPropagation()},className:"z-50 inline-flex h-8 w-8 items-center justify-center rounded-lg border border-border-medium bg-transparent p-0 text-sm font-medium transition-all duration-300 ease-in-out hover:border-border-heavy hover:bg-surface-hover focus:border-border-heavy focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:[c.jsx(Dt,{className:"icon-md text-text-secondary","aria-hidden":"true"}),c.jsxs("span",{className:"sr-only",children:["Open actions menu for ",e.name]})]})}),c.jsxs(Wy,{id:`prompt-menu-${e._id}`,"aria-label":`Available actions for ${e.name}`,className:"z-50 w-fit rounded-xl",collisionPadding:2,align:"end",children:[c.jsxs(Qy,{role:"menuitem",onClick:e=>{e.stopPropagation(),l(!0)},className:"w-full cursor-pointer rounded-lg text-text-secondary hover:bg-surface-hover focus:bg-surface-hover disabled:cursor-not-allowed",children:[c.jsx(Ft,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),c.jsx("span",{children:s("com_ui_preview")})]}),f&&c.jsx(Ky,{children:c.jsxs(Qy,{disabled:!f,className:"cursor-pointer rounded-lg text-text-secondary hover:bg-surface-hover focus:bg-surface-hover disabled:cursor-not-allowed",onClick:e=>{e.stopPropagation(),p(e)},children:[c.jsx(zt,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),c.jsx("span",{children:s("com_ui_edit")})]})})]})]})]})}),c.jsx(ZN,{group:e,open:i,onOpenChange:l}),c.jsx(VN,{open:u,onClose:()=>m(!1),group:e})]})}));function XN({groups:e=[],isChatRoute:t,isLoading:n}){const a=D(),s=kg(),{data:r={}}=Ap(),{instanceProjectId:o}=r,i=Jv({permissionType:Zc.PROMPTS,permission:Yc.CREATE});return c.jsxs("div",{className:"flex h-full flex-col",children:[i&&c.jsx("div",{className:"flex w-full justify-end",children:c.jsxs(By,{variant:"outline",className:"w-full bg-transparent "+(t?"":"mx-2"),onClick:()=>a("/d/prompts/new"),children:[c.jsx(Ze,{className:"size-4","aria-hidden":!0}),s("com_ui_create_prompt")]})}),c.jsx("div",{className:"flex-grow overflow-y-auto",children:c.jsxs("div",{className:"overflow-y-auto overflow-x-hidden",children:[n&&t&&c.jsx(T_,{className:"my-2 flex h-[84px] w-full rounded-2xl border-0 px-3 pb-4 pt-3"}),n&&!t&&Array.from({length:10}).map(((e,t)=>c.jsx(T_,{className:"w-100 mx-2 my-2 flex h-14 rounded-lg border-0 p-4"},t))),!n&&0===e.length&&t&&c.jsx("div",{className:"my-2 flex h-[84px] w-full items-center justify-center rounded-2xl border border-border-light bg-transparent px-3 pb-4 pt-3 text-text-primary",children:s("com_ui_nothing_found")}),!n&&0===e.length&&!t&&c.jsx("div",{className:"my-12 flex w-full items-center justify-center text-lg font-semibold text-text-primary",children:s("com_ui_nothing_found")}),e.map((e=>t?c.jsx(JN,{group:e,instanceProjectId:o},e._id):c.jsx(Wj,{group:e,instanceProjectId:o},e._id)))]})})]})}function eC({children:e,isDetailView:t,className:a="",nextPage:s,prevPage:r,isFetching:o,hasNextPage:i,groupsQuery:l,promptGroups:d,hasPreviousPage:u}){const m=z(),p=Ib("(max-width: 1024px)"),g=n.useMemo((()=>m.pathname.startsWith("/c/")),[m.pathname]);return c.jsxs("div",{className:rm("mr-2 flex h-auto w-auto min-w-72 flex-col gap-2 lg:w-1/4 xl:w-1/4",!0===t&&p?"hidden":"",a),children:[e,c.jsx("div",{className:"flex-grow overflow-y-auto",children:c.jsx(XN,{groups:d,isChatRoute:g,isLoading:!!l.isLoading})}),c.jsx(Kj,{nextPage:s,prevPage:r,isFetching:o,hasNextPage:i,isChatRoute:g,hasPreviousPage:u})]})}function tC(){const e=B(),t=D(),a=Nb(),s=n.useMemo((()=>!(!e.promptId&&"new"!==e["*"])),[e]),r=Jv({permissionType:Zc.PROMPTS,permission:Yc.USE});return n.useEffect((()=>{let e;return r||(e=setTimeout((()=>{t("/c/new")}),1e3)),()=>{clearTimeout(e)}}),[r,t]),r?c.jsxs("div",{className:"flex h-screen w-full flex-col bg-surface-primary p-0 lg:p-2",children:[c.jsx(Gj,{}),c.jsxs("div",{className:"flex w-full flex-grow flex-row divide-x overflow-hidden dark:divide-gray-600",children:[c.jsx(eC,{isDetailView:s,...a,children:c.jsx("div",{className:"mx-2 mt-1 flex flex-row items-center justify-between",children:c.jsx(Dj,{setName:a.setName})})}),c.jsx("div",{className:rm("scrollbar-gutter-stable w-full overflow-y-auto lg:w-3/4 xl:w-3/4",s?"block":"hidden md:block"),children:c.jsx(rt,{context:a})})]})]}):null}function nC({onCheckedChange:e,className:t=""}){const[n,a]=T(_p.alwaysMakeProd),s=kg();return c.jsxs("div",{className:rm("flex select-none items-center justify-end gap-2 text-xs",t),children:[c.jsx(R_,{id:"alwaysMakeProd",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},"data-testid":"alwaysMakeProd","aria-label":"Always make prompt production"}),c.jsxs("div",{children:[s("com_nav_always_make_prod")," "]})]})}const{promptsEditorMode:aC}=_p,sC=n.memo((({name:e,isEditing:t,setIsEditing:a})=>{const s=kg(),{control:r}=Ut(),o=I(aC),{dirtyFields:i}=Vt({control:r}),{prompt:l}=i,d=n.useMemo((()=>t&&null==(null==l?void 0:l.length)?Wb:t?Ry:zt),[t,l]),u=[[kt,{output:"mathml"}],[St,{detect:!0,ignoreMissing:!0,subset:Uu}]];return c.jsxs("div",{className:"flex max-h-[85vh] flex-col sm:max-h-[85vh]",children:[c.jsxs("h2",{className:"flex items-center justify-between rounded-t-xl border border-border-light py-1.5 pl-3 text-sm font-semibold text-text-primary sm:py-2 sm:pl-4 sm:text-base",children:[c.jsx("span",{className:"max-w-[200px] truncate sm:max-w-none",children:s("com_ui_prompt_text")}),c.jsxs("div",{className:"flex flex-shrink-0 flex-row gap-3 sm:gap-6",children:[o===zr.ADVANCED&&c.jsx(nC,{className:"hidden sm:flex"}),c.jsx("button",{type:"button",onClick:()=>a((e=>!e)),"aria-label":s(t?"com_ui_save":"com_ui_edit"),className:"mr-1 rounded-lg p-1.5 sm:mr-2 sm:p-1",children:c.jsx(d,{className:rm("h-5 w-5 sm:h-6 sm:w-6",t?"p-[0.05rem]":"text-secondary-alt hover:text-text-primary")})})]})]}),c.jsxs("div",{role:"button",className:rm("w-full flex-1 overflow-auto rounded-b-xl border border-border-light p-2 shadow-md transition-all duration-150 sm:p-4",{"cursor-pointer bg-surface-primary hover:bg-surface-secondary active:bg-surface-tertiary":!t}),onClick:()=>!t&&a(!0),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||!t&&a(!0)},tabIndex:0,children:[!t&&c.jsx(zt,{className:"icon-xl absolute inset-0 m-auto hidden h-6 w-6 text-text-primary opacity-25 group-hover:block sm:h-8 sm:w-8"}),c.jsx(tt,{name:e,control:r,render:({field:e})=>t?c.jsx(F_,{...e,autoFocus:!0,className:"w-full resize-none overflow-y-auto rounded bg-transparent text-sm text-text-primary focus:outline-none sm:text-base",minRows:3,maxRows:14,onBlur:()=>a(!1),onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),a(!1))}}):c.jsx("div",{className:rm("overflow-y-auto text-sm sm:text-base"),style:{minHeight:"4.5em",maxHeight:"21em",overflow:"auto"},children:c.jsx(Pt,{remarkPlugins:[Tt,Rt,[Et,{singleDollarTextMath:!0}]],rehypePlugins:u,components:{p:HN,code:AN},className:"markdown prose dark:prose-invert light my-1 w-full break-words text-text-primary",children:e.value})})})]})]})})),rC=({currentCategory:e,onValueChange:t,className:a=""})=>{const s=Ut(),{categories:r,emptyCategory:o}=wb(),i=s.control,l=s.watch,d=s.setValue,u=l?l("category"):e,m=n.useMemo((()=>(r??[]).find((t=>t.value===(u??e)))??o),[u,r,e,o]);return s?c.jsx(tt,{name:"category",control:i,render:()=>c.jsx(q_,{value:m.value??"",onChange:e=>{d("category",e,{shouldDirty:!1}),localStorage.setItem(uc.LAST_PROMPT_CATEGORY,e),null==t||t(e)},"aria-labelledby":"category-selector-label",ariaLabel:"Prompt's category selector",className:a,options:r||[],renderValue:e=>c.jsxs("div",{className:"flex items-center space-x-2",children:[null!=e.icon&&c.jsx("span",{children:e.icon}),c.jsx("span",{children:e.label})]})})}):c.jsx(q_,{value:e??"",onChange:e=>{localStorage.setItem(uc.LAST_PROMPT_CATEGORY,e),null==t||t(e)},"aria-labelledby":"category-selector-label",ariaLabel:"Prompt's category selector",className:a,options:r||[],renderValue:e=>c.jsxs("div",{className:"flex items-center space-x-2",children:[null!=e.icon&&c.jsx("span",{children:e.icon}),c.jsx("span",{children:e.label})]})})};function oC(){const e=D(),t=kg();return c.jsx("div",{className:"relative min-h-full w-full px-4",children:c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsxs("div",{className:"text-center font-bold dark:text-gray-200",children:[c.jsx("h1",{className:"text-lg font-bold dark:text-gray-200 md:text-2xl",children:t("com_ui_prompt_preview_not_shared")}),c.jsx(By,{className:"mt-4",onClick:()=>{e("/d/prompts")},children:t("com_ui_back_to_prompts")})]})})})}const iC=({description:e})=>c.jsx(z_,{description:e,"aria-label":e,render:c.jsx("div",{className:"flex items-center justify-center",children:c.jsx(Ht,{className:"h-4 w-4 text-amber-500"})})}),lC=({tags:e})=>{const t=kg();return e.includes("latest")&&e.includes("production")?c.jsx("span",{className:"absolute bottom-3 right-3",children:c.jsx(iC,{description:t("com_ui_latest_production_version")})}):c.jsx("span",{className:"flex gap-1 text-sm",children:e.map(((e,n)=>c.jsx(z_,{description:t("production"===e?"com_ui_currently_production":"com_ui_latest_version"),"aria-label":t("production"===e?"com_ui_currently_production":"com_ui_latest_version"),render:c.jsx(D_,{label:e,className:rm("w-24 justify-center border border-transparent","production"===e?"bg-green-100 text-green-500 dark:border-green-500 dark:bg-transparent dark:text-green-500":"bg-blue-100 text-blue-500 dark:border-blue-500 dark:bg-transparent dark:text-blue-500"),labelClassName:"flex items-center m-0 justify-center gap-1",LabelNode:"production"===e?c.jsx("div",{className:"flex items-center",children:c.jsx("span",{className:"slow-pulse size-2 rounded-full bg-green-400"})}):"latest"===e?c.jsx("div",{className:"flex items-center",children:c.jsx($t,{className:"size-4"})}):null})},`${e}-${n}`)))})},cC=({prompt:e,index:t,isSelected:n,totalVersions:a,onClick:s,authorName:r,tags:o})=>{const i=kg();return c.jsx("button",{type:"button",className:rm("group relative w-full rounded-lg border border-border-light p-4 transition-all duration-300",n?"bg-surface-hover shadow-xl":"bg-surface-primary shadow-sm hover:bg-surface-secondary"),onClick:s,"aria-selected":n,role:"tab","aria-label":i("com_ui_version_var",{0:""+(a-t)}),children:c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-start justify-between lg:flex-col xl:flex-row",children:[c.jsx("h3",{className:"font-bold text-text-primary",children:i("com_ui_version_var",{0:""+(a-t)})}),c.jsx("time",{className:"text-xs text-text-secondary",dateTime:e.createdAt,children:h(new Date(e.createdAt),"yyyy-MM-dd HH:mm")})]}),c.jsxs("div",{className:"flex items-center gap-1 lg:flex-col xl:flex-row",children:[r&&c.jsxs(g_,{className:"text-left text-xs text-text-secondary",children:["by ",r]}),o.length>0&&c.jsx(lC,{tags:o})]})]})})},dC=({prompts:e,group:t,selectionIndex:n,setSelectionIndex:a})=>{const s=kg();return c.jsxs("section",{className:"my-6","aria-label":"Prompt Versions",children:[c.jsx("header",{className:"mb-6",children:c.jsxs("h2",{className:"flex items-center gap-2 text-base font-semibold text-text-primary",children:[c.jsx(Bt,{className:"h-5 w-5 text-green-500"}),s("com_ui_versions")]})}),c.jsx("div",{className:"flex flex-col gap-3",role:"tablist","aria-label":"Version history",children:e.map(((s,r)=>{const o=[];return 0===r&&o.push("latest"),s._id===(null==t?void 0:t.productionId)&&o.push("production"),c.jsx(cC,{prompt:s,index:r,isSelected:r===n,totalVersions:e.length,onClick:()=>a(r),authorName:null==t?void 0:t.authorName,tags:o},s._id)}))})]})},uC=({name:e,disabled:t,selectHandler:n})=>{const a=kg();return c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"destructive",size:"sm","aria-label":"Delete version",className:"h-10 w-10 p-0.5",disabled:t,onClick:e=>{e.stopPropagation()},children:c.jsx(Gt,{className:"size-5 cursor-pointer text-white"})})}),c.jsx(ij,{showCloseButton:!1,title:a("com_ui_delete_prompt"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(g_,{htmlFor:"dialog-delete-confirm-prompt",className:"text-left text-sm font-medium",children:a("com_ui_delete_confirm_prompt_version_var",{0:e})})})})}),selection:{selectHandler:n,selectClasses:"bg-surface-destructive hover:bg-surface-destructive-hover transition-colors duration-200 text-white",selectText:a("com_ui_delete")}})]})};function mC(){return c.jsxs("div",{children:[c.jsx("div",{className:"flex flex-col items-center justify-between px-4 dark:text-gray-200 sm:flex-row",children:c.jsx(T_,{className:"mb-1 flex h-10 w-32 flex-row items-center font-bold sm:text-xl md:mb-0 md:h-12 md:text-2xl"})}),c.jsx("div",{className:"flex h-full w-full flex-col md:flex-row",children:c.jsx("div",{className:"flex-1 overflow-y-auto border-border-medium-alt p-4 md:max-h-[calc(100vh-150px)] md:border-r",children:c.jsx(T_,{className:"h-96"})})})]})}const pC=({group:e,disabled:t})=>{const a=kg(),{showToast:s}=Ng(),r=bg(),{data:o={},isFetching:i}=Ap(),{instanceProjectId:l}=o,d=n.useMemo((()=>((null==e?void 0:e.projectIds)??[]).includes(l)),[e,l]),{control:u,setValue:m,handleSubmit:p,formState:{isSubmitting:g}}=ne({mode:"onChange",defaultValues:{[Yc.SHARED_GLOBAL]:d}});if(n.useEffect((()=>{m(Yc.SHARED_GLOBAL,d)}),[d,m]),null==e||!l)return null;return c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"default",size:"sm","aria-label":"Share prompt",className:"h-10 w-10 border border-transparent bg-blue-500/90 p-0.5 transition-all hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-800",disabled:t,children:c.jsx(lt,{className:"size-5 cursor-pointer text-white"})})}),c.jsxs(y_,{className:"w-11/12 max-w-lg",role:"dialog","aria-labelledby":"dialog-title",children:[c.jsx(w_,{id:"dialog-title",className:"truncate pr-2",title:e.name,children:a("com_ui_share_var",{0:`"${e.name}"`})}),c.jsxs("form",{className:"p-2",onSubmit:p((t=>{const n=e._id??"";if(""===n||!l)return;if(!0===t[Yc.SHARED_GLOBAL]&&d)return void s({message:a("com_ui_prompt_already_shared_to_all"),status:"info"});const i={};!0===t[Yc.SHARED_GLOBAL]?i.projectIds=[o.instanceProjectId]:i.removeProjectIds=[o.instanceProjectId],r.mutate({id:n,payload:i})})),"aria-describedby":"form-description",children:[c.jsx("div",{id:"form-description",className:"sr-only",children:a("com_ui_share_form_description")}),c.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2 py-4",children:[c.jsx("div",{className:"flex items-center",id:"share-to-all-users",children:a("com_ui_share_to_all_users")}),c.jsx(tt,{name:Yc.SHARED_GLOBAL,control:u,disabled:!0===i||r.isLoading||!l,render:({field:e})=>c.jsx(R_,{...e,checked:e.value,onCheckedChange:e.onChange,value:e.value.toString(),"aria-labelledby":"share-to-all-users"})})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx(v_,{asChild:!0,children:c.jsx(By,{type:"submit",disabled:g||i,variant:"submit","aria-label":a("com_ui_save"),children:a("com_ui_save")})})})]})]})]})},gC=()=>{const e=B(),t=kg(),{user:a}=Wh(),s=I(_p.alwaysMakeProd),{showToast:r}=Ng(),o=e.promptId||"",[i,l]=n.useState(0),d=I(_p.promptsEditorMode),u=n.useRef(!1),[m,p]=n.useState(!1),[g,f]=n.useState(!0),[x,h]=n.useState(!1),v="320px",{data:b,isLoading:y}=(_=o,nr([Xc.promptGroup,_],(()=>zd.getPromptGroup(_)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...j,enabled:!0}));var _,j;const{data:w=[],isLoading:N}=((e,t)=>nr([Xc.prompts,e.groupId??""],(()=>zd.getPrompts(e)),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...t,enabled:void 0===(null==t?void 0:t.enabled)||t.enabled}))({groupId:o},{enabled:!!o}),C=n.useMemo((()=>!(!a||!b)&&a.id===b.author),[a,b]),k=ne({defaultValues:{prompt:"",promptName:b?b.name:"",category:b?b.category:""}}),{handleSubmit:S,setValue:T,reset:R,watch:E}=k,P=E("prompt"),L=n.useMemo((()=>w.length>0?w[i]:void 0),[w,i]),{groupsQuery:M}=pe(),A=Jv({permissionType:Zc.PROMPTS,permission:Yc.SHARED_GLOBAL}),O=bg({onError:()=>{r({status:"error",message:t("com_ui_prompt_update_error")})}}),D=(e=>{const t=ar(),{onSuccess:n,onError:a,onMutate:s}={},r=I(_p.promptsName),o=I(_p.promptsPageSize),i=I(_p.promptsCategory);return sr({mutationFn:e=>zd.makePromptProduction(e.id),onMutate:e=>{const n=JSON.parse(JSON.stringify(t.getQueryData([Xc.promptGroup,e.groupId]))),a=t.getQueryData([Xc.promptGroups,r,i,o]),l=JSON.parse(JSON.stringify(a));if(a){const n=tm(a,{_id:e.groupId,productionId:e.id,productionPrompt:e.productionPrompt},(n=>t.setQueryData([Xc.promptGroup,e.groupId],n)));t.setQueryData([Xc.promptGroups,r,i,o],n)}return s&&s(e),{group:n,previousListData:l}},onError:(e,n,s)=>{(null==s?void 0:s.group)&&t.setQueryData([Xc.promptGroups,n.groupId],s.group),(null==s?void 0:s.previousListData)&&t.setQueryData([Xc.promptGroups,r,i,o],s.previousListData),a&&a(e,n,s)},onSuccess:(e,a,s)=>{am(t,{_id:a.groupId,productionId:a.id,productionPrompt:a.productionPrompt}),n&&n(e,a,s)}})})(),F=(e=>{const t=ar(),{onSuccess:n,...a}={},s=I(_p.promptsName),r=I(_p.promptsPageSize),o=I(_p.promptsCategory);return sr({mutationFn:e=>zd.deletePrompt(e),...a,onSuccess:(e,a,i)=>{if(e.promptGroup){const n=e.promptGroup.id;t.setQueryData([Xc.promptGroups,s,o,r],(e=>e?em(e,n):e)),sm(t,n)}else t.setQueryData([Xc.prompts,a.groupId],(e=>{const n=e?e.filter((e=>e._id!==a._id)):[];return t.setQueryData([Xc.promptGroup,a.groupId],(e=>{if(!e)return e;e.productionId===a._id&&(e.productionId=n[0]._id,e.productionPrompt=n[0])})),n}));n&&n(e,a,i)}})})(),z=yg({onMutate:e=>{R({prompt:e.prompt.prompt,category:e.group?e.group.category:""},{keepDirtyValues:!0})},onSuccess(e){s&&null!=e.prompt._id&&e.prompt._id&&e.prompt.groupId&&D.mutate({id:e.prompt._id,groupId:e.prompt.groupId,productionPrompt:{prompt:e.prompt.prompt}}),R({prompt:e.prompt.prompt,promptName:e.group?e.group.name:"",category:e.group?e.group.category:""})}}),U=n.useCallback((e=>{if(!e)return;if(!L)return;const t={prompt:{type:L.type??"text",groupId:L.groupId??"",prompt:e}};e!==L.prompt&&z.mutate(t)}),[L,z]),V=n.useCallback((()=>{y||N||f(!1)}),[y,N]);n.useEffect((()=>{u.current&&!m&&S((e=>U(e.prompt)))(),u.current=m}),[m,U,S]),n.useEffect((()=>{V()}),[e.promptId,d,null==b?void 0:b.productionId,w,V]),n.useEffect((()=>{T("prompt",L?L.prompt:"",{shouldDirty:!1}),T("category",b?b.category:"",{shouldDirty:!1})}),[L,b,T]),n.useEffect((()=>{const e=()=>{window.matchMedia("(min-width: 1022px)").matches&&h(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const H=n.useCallback($((e=>{if(!b||!b._id)return console.warn("Group not found");O.mutate({id:b._id,payload:{oneliner:e}})}),950),[O,b]),G=n.useCallback($((e=>{if(!b||!b._id)return console.warn("Group not found");O.mutate({id:b._id,payload:{command:e}})}),950),[O,b]);if(g)return c.jsx(mC,{});if(!C&&M.data&&(null==a?void 0:a.role)!==qc.ADMIN){const t=nm(M.data,(t=>t._id===e.promptId));return t?c.jsx(qN,{group:t}):c.jsx(oC,{})}if(!b||null==b._id)return null;const K=b._id,W=b.name,Q=b.category,q=()=>c.jsxs("div",{className:"h-full w-full overflow-y-auto bg-surface-primary px-4",style:{maxHeight:"calc(100vh - 100px)"},children:[c.jsxs("div",{className:"mb-2 flex flex-col lg:flex-row lg:items-center lg:justify-center lg:gap-x-2 xl:flex-row xl:space-y-0",children:[c.jsx(rC,{currentCategory:Q,onValueChange:e=>O.mutate({id:K,payload:{name:W,category:e}})}),c.jsxs("div",{className:"mt-2 flex flex-row items-center justify-center gap-x-2 lg:mt-0",children:[A&&c.jsx(pC,{group:b,disabled:y}),d===zr.ADVANCED&&c.jsx(By,{variant:"submit",size:"sm","aria-label":"Make prompt production",className:"h-10 w-10 border border-transparent p-0.5 transition-all",onClick:()=>{if(!L)return void console.warn("No prompt is selected");const{_id:e="",prompt:t}=L;D.mutate({id:e,groupId:K,productionPrompt:{prompt:t}})},disabled:y||!L||L._id===b.productionId||D.isLoading,children:c.jsx(Wt,{className:"size-5 cursor-pointer text-white"})}),c.jsx(uC,{name:W,disabled:y,selectHandler:()=>{L&&L._id?F.mutate({_id:L._id,groupId:K}):console.warn("No prompt is selected or prompt _id is missing")}})]})]}),d===zr.ADVANCED&&(N?Array.from({length:6}).map(((e,t)=>c.jsx("div",{className:"my-2",children:c.jsx(T_,{className:"h-[72px] w-full"})},t))):w.length>0&&c.jsx(dC,{group:b,prompts:w,selectionIndex:i,setSelectionIndex:l}))]});return c.jsx(Kt,{...k,children:c.jsx("form",{className:"mt-4 flex w-full",onSubmit:S((e=>U(e.prompt))),children:c.jsxs("div",{className:"relative w-full",children:[c.jsx("div",{className:"h-full w-full",style:{transform:`translateX(${x?`-${v}`:"0"})`,transition:"transform 0.3s ease-in-out"},children:c.jsxs("div",{className:"flex h-full",children:[c.jsxs("div",{className:"flex-1 overflow-hidden px-4",children:[c.jsx("div",{className:"mb-4 flex items-center gap-2 text-text-primary",children:y?c.jsx(T_,{className:"mb-1 flex h-10 w-32 font-bold sm:text-xl md:mb-0 md:h-12 md:text-2xl"}):c.jsxs(c.Fragment,{children:[c.jsx(Oj,{name:W,onSave:e=>{b._id&&O.mutate({id:b._id,payload:{name:e}})}}),c.jsx("div",{className:"flex-1"}),c.jsx(By,{type:"button",variant:"ghost",className:"h-10 w-10 border border-border-light p-0 lg:hidden",onClick:()=>h(!0),"aria-label":t("com_endpoint_open_menu"),children:c.jsx(Dt,{className:"size-5"})}),c.jsx("div",{className:"hidden lg:block",children:d===zr.SIMPLE&&c.jsx(q,{})})]})}),N?c.jsx(T_,{className:"h-96","aria-live":"polite"}):c.jsxs("div",{className:"mb-2 flex h-full flex-col gap-4",children:[c.jsx(sC,{name:"prompt",isEditing:m,setIsEditing:p}),c.jsx(KN,{promptText:P}),c.jsx(WN,{initialValue:b.oneliner??"",onValueChange:H}),c.jsx(QN,{initialValue:b.command??"",onValueChange:G})]})]}),d===zr.ADVANCED&&c.jsx("div",{className:"hidden w-1/4 border-l border-border-light lg:block",children:c.jsx(q,{})})]})}),c.jsx("button",{type:"button",className:rm("absolute inset-0 z-40 cursor-default",x?"opacity-100":"pointer-events-none opacity-0"),style:{transition:"opacity 0.3s ease-in-out"},onClick:()=>h(!1),"aria-hidden":!x,tabIndex:x?0:-1,"aria-label":t("com_ui_close_menu")}),c.jsx("div",{className:"absolute inset-y-0 right-0 z-50 lg:hidden",style:{width:v,transform:`translateX(${x?"0":"100%"})`,transition:"transform 0.3s ease-in-out"},role:"dialog","aria-modal":"true","aria-label":"Mobile navigation panel",children:c.jsx("div",{className:"h-full",children:c.jsx("div",{className:"h-full overflow-auto",children:c.jsx(q,{})})})})]})})})};function fC(){return c.jsx("div",{className:"h-full w-full content-center text-center font-bold dark:text-gray-200",children:"Select or Create a Prompt"})}const xC={name:"",prompt:"",type:"text",category:"",oneliner:void 0,command:void 0},hC=({defaultValues:e=xC})=>{const t=kg(),a=D(),s=Jv({permissionType:Zc.PROMPTS,permission:Yc.CREATE});n.useEffect((()=>{let e;return s||(e=setTimeout((()=>{a("/c/new")}),1e3)),()=>{clearTimeout(e)}}),[s,a]);const r=ne({defaultValues:{...e,category:localStorage.getItem(uc.LAST_PROMPT_CATEGORY)??""}}),{watch:o,control:i,handleSubmit:l,formState:{isDirty:d,isSubmitting:u,errors:m,isValid:p}}=r,g=yg({onSuccess:e=>{a(`/d/prompts/${e.prompt.groupId}`,{replace:!0})}}),f=o("prompt");return s?c.jsx(Kt,{...r,children:c.jsxs("form",{onSubmit:l((e=>{const{name:t,category:n,oneliner:a,command:s,...r}=e,o={name:t,category:n};((null==a?void 0:a.length)??0)>0&&(o.oneliner=a),((null==s?void 0:s.length)??0)>0&&(o.command=s),g.mutate({prompt:r,group:o})})),className:"w-full px-4 py-2",children:[c.jsx("div",{className:"mb-1 flex flex-col items-center justify-between font-bold sm:text-xl md:mb-0 md:text-2xl",children:c.jsxs("div",{className:"flex w-full flex-col items-center justify-between sm:flex-row",children:[c.jsx(tt,{name:"name",control:i,rules:{required:t("com_ui_prompt_name_required")},render:({field:e})=>c.jsxs("div",{className:"mb-1 flex items-center md:mb-0",children:[c.jsx(m_,{...e,type:"text",className:"mr-2 w-full border border-border-medium p-2 text-2xl text-text-primary placeholder:text-text-tertiary dark:placeholder:text-text-secondary",placeholder:`${t("com_ui_prompt_name")}*`,tabIndex:0}),c.jsx("div",{className:rm("mt-1 w-56 text-sm text-red-500",m.name?"visible h-auto":"invisible h-0"),children:m.name?m.name.message:" "})]})}),c.jsx(rC,{})]})}),c.jsxs("div",{className:"flex w-full flex-col gap-4 md:mt-[1.075rem]",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"flex items-center justify-between rounded-t-lg border border-border-medium py-2 pl-4 pr-1 text-base font-semibold dark:text-gray-200",children:[t("com_ui_prompt_text"),"*"]}),c.jsx("div",{className:"min-h-32 rounded-b-lg border border-border-medium p-4 transition-all duration-150",children:c.jsx(tt,{name:"prompt",control:i,rules:{required:t("com_ui_prompt_text_required")},render:({field:e})=>c.jsxs("div",{children:[c.jsx(F_,{...e,className:"w-full rounded border border-border-medium px-2 py-1 focus:outline-none dark:bg-transparent dark:text-gray-200",minRows:6,tabIndex:0}),c.jsx("div",{className:"mt-1 text-sm text-red-500 "+(m.prompt?"visible h-auto":"invisible h-0"),children:m.prompt?m.prompt.message:" "})]})})})]}),c.jsx(KN,{promptText:f}),c.jsx(WN,{onValueChange:e=>r.setValue("oneliner",e),tabIndex:0}),c.jsx(QN,{onValueChange:e=>r.setValue("command",e),tabIndex:0}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(By,{"aria-label":t("com_ui_create_prompt"),tabIndex:0,type:"submit",disabled:!d||u||!p,children:t("com_ui_create_prompt")})})]})]})}):null};function vC(){const e=ar(),{isAuthenticated:t}=Wh(),a=(()=>{const e=z(),t=n.useRef();return n.useEffect((()=>{var n;t.current=null==(n=e.state)?void 0:n.prevLocation}),[e]),t})(),s=_p.useClearConvoState(),[r,o]=n.useState("");return n.useEffect((()=>{var e;o((null==(e=a.current)?void 0:e.pathname)||"")}),[a]),n.useEffect((()=>{e.removeQueries([Xc.messages,"new"]),s()}),[e,s]),t?c.jsx(fv.Provider,{value:{prevLocationPath:r},children:c.jsx("div",{className:"h-screen w-full",children:c.jsx(rt,{})})}):null}const bC={path:"d/*",element:c.jsx(vC,{}),children:[{path:"prompts/*",element:c.jsx(tC,{}),children:[{index:!0,element:c.jsx(fC,{})},{path:"new",element:c.jsx(hC,{})},{path:":promptId",element:c.jsx(gC,{})}]},{path:"*",element:c.jsx(Qt,{to:"/d/files",replace:!0})}]};function yC({message:e}){const t=kg(),[a,s]=n.useState(!1),r=cb({text:e.text,content:e.content});return c.jsx("div",{className:"visible mt-0 flex justify-center gap-1 self-end text-gray-400 lg:justify-start",children:c.jsx("button",{className:"ml-0 flex items-center gap-1.5 rounded-md p-1 text-xs hover:text-gray-900 dark:text-gray-400/70 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible",onClick:()=>r(s),type:"button",title:t(a?"com_ui_copied_to_clipboard":"com_ui_copy_to_clipboard"),children:a?c.jsx(Kb,{className:"h-[18px] w-[18px]"}):c.jsx(Gb,{})})})}const _C={[sc.MODERATION]:"com_error_moderation",[sc.NO_USER_KEY]:"com_error_no_user_key",[sc.INVALID_USER_KEY]:"com_error_invalid_user_key",[sc.NO_BASE_URL]:"com_error_no_base_url",[sc.INVALID_ACTION]:`com_error_${sc.INVALID_ACTION}`,[sc.INVALID_REQUEST]:`com_error_${sc.INVALID_REQUEST}`,[sc.NO_SYSTEM_MESSAGES]:`com_error_${sc.NO_SYSTEM_MESSAGES}`,[sc.EXPIRED_USER_KEY]:(e,t)=>{const{expiredAt:n,endpoint:a}=e;return t("com_error_expired_user_key",{0:a,1:n})},[sc.INPUT_LENGTH]:(e,t)=>{const{info:n}=e;return t("com_error_input_length",{0:n})},[sc.GOOGLE_ERROR]:e=>{const{info:t}=e;return t},[ac.BAN]:"Your account has been temporarily banned due to violations of our service.",invalid_api_key:'Invalid API key. Please check your API key and try again. You can do this by clicking on the model logo in the left corner of the textbox and selecting "Set Token" for the current selected endpoint. Thank you for your understanding.',insufficient_quota:'We apologize for any inconvenience caused. The default API key has reached its limit. To continue using this service, please set up your own API key. You can do this by clicking on the model logo in the left corner of the textbox and selecting "Set Token" for the current selected endpoint. Thank you for your understanding.',concurrent:e=>{const{limit:t}=e;return`Only ${t} message${t>1?"s":""} at a time. Please allow any other responses to complete before sending another message, or wait one minute.`},message_limit:e=>{const{max:t,windowInMinutes:n}=e;return`You hit the message limit. You have a cap of ${t} message${t>1?"s":""} per ${n>1?`${n} minutes`:"minute"}.`},token_balance:e=>{const{balance:t,tokenCost:n,promptTokens:a,generations:s}=e,r=`Insufficient Funds! Balance: ${t}. Prompt tokens: ${a}. Cost: ${n}.`;return c.jsxs(c.Fragment,{children:[r,s&&c.jsxs(c.Fragment,{children:[c.jsx("br",{}),c.jsx("br",{})]}),s&&c.jsx(LN,{lang:"Generations",error:!0,codeChildren:eo(JSON.stringify(s))})]})}},jC=({text:e})=>{const t=kg(),n=function(e){let t=0,n=-1;for(let a=0;a<e.length;a++)if("{"===e[a])0===t&&(n=a),t++;else if("}"===e[a]&&(t--,0===t&&-1!==n))return e.slice(n,a+1);return""}(e),a=`Something went wrong. Here's the specific error message we encountered: ${e.length>512&&!n?e.slice(0,512)+"...":e}`;if(!Xr(n))return a;const s=JSON.parse(n),r=s.code||s.type,o=r&&_C[r];return o&&"function"==typeof _C[r]?_C[r](s,t):o&&o.startsWith("com_error")?t(_C[r]):o?_C[r]:a},wC="group mt-3 flex w-fit items-center justify-center rounded-xl bg-surface-tertiary px-3 py-2 text-xs leading-[18px] animate-thinking-appear",NC="icon-sm ml-1.5 transform-gpu text-text-primary transition-transform duration-200",CC="relative pl-3 text-text-secondary",kC="absolute left-0 h-[calc(100%-10px)] border-l-2 border-border-medium dark:border-border-heavy",SC="absolute left-0 h-[calc(100%)] border-l-2 border-border-medium dark:border-border-heavy",TC="whitespace-pre-wrap leading-[26px]",RC=n.memo((({isPart:e,children:t})=>c.jsxs("div",{className:CC,children:[c.jsx("div",{className:!0===e?SC:kC}),c.jsx("p",{className:TC,children:t})]}))),IC=n.memo((({isExpanded:e,onClick:t,label:n})=>c.jsxs("button",{type:"button",onClick:t,className:wC,children:[c.jsx(qt,{size:14,className:"mr-1.5 text-text-secondary"}),n,c.jsx(vt,{className:`${NC} ${e?"rotate-180":""}`})]}))),EC=n.memo((({children:e})=>{const t=kg(),a=I(_p.showThinking),[s,r]=n.useState(a),o=n.useCallback((e=>{e.preventDefault(),r((e=>!e))}),[]),i=n.useMemo((()=>t("com_ui_thoughts")),[t]);return null==e?null:c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-5",children:c.jsx(IC,{isExpanded:s,onClick:o,label:i})}),c.jsx("div",{className:rm("grid transition-all duration-300 ease-out",s&&"mb-8"),style:{gridTemplateRows:s?"1fr":"0fr"},children:c.jsx("div",{className:"overflow-hidden",children:c.jsx(RC,{isPart:!0,children:e})})})]})}));IC.displayName="ThinkingButton",RC.displayName="ThinkingContent",EC.displayName="Thinking";const PC=n.memo(EC),LC=n.memo((({content:e="",codeExecution:t=!0})=>{const n=[[kt,{output:"mathml"}],[St,{detect:!0,ignoreMissing:!0,subset:Uu}]];return c.jsx(wv,{children:c.jsx(Cv,{children:c.jsx(Pt,{remarkPlugins:[Tt,Rt,[Et,{singleDollarTextMath:!0}]],rehypePlugins:n,components:{code:t?MN:AN,a:ON,p:DN},children:e})})})}));function MC({onRemove:e}){return c.jsx("button",{type:"button",className:"absolute right-1 top-1 -translate-y-1/2 translate-x-1/2 rounded-full bg-surface-secondary p-0.5 transition-colors duration-200 hover:bg-surface-primary z-50",onClick:e,children:c.jsx("span",{children:c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"icon-sm",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})}const AC=({file:e,onDelete:t})=>{const n=tu(e.type);return c.jsxs("div",{className:"group relative inline-block text-sm text-text-primary",children:[c.jsx("div",{className:"relative overflow-hidden rounded-2xl border border-border-light",children:c.jsx("div",{className:"w-56 bg-surface-hover-alt p-1.5",children:c.jsxs("div",{className:"flex flex-row items-center gap-2",children:[c.jsx(_N,{file:e,fileType:n,className:"relative"}),c.jsxs("div",{className:"overflow-hidden",children:[c.jsx("div",{className:"truncate font-medium",title:e.filename,children:e.filename}),c.jsx("div",{className:"truncate text-text-secondary",title:n.title,children:n.title})]})]})})}),t&&c.jsx(MC,{onRemove:t})]})},OC=n.memo((({message:e})=>{const t=n.useMemo((()=>{var t;return(null==(t=null==e?void 0:e.files)?void 0:t.filter((e=>{var t;return null==(t=e.type)?void 0:t.startsWith("image/")})))||[]}),[null==e?void 0:e.files]),a=n.useMemo((()=>{var t;return(null==(t=null==e?void 0:e.files)?void 0:t.filter((e=>{var t;return!(!0===(null==(t=e.type)?void 0:t.startsWith("image/")))})))||[]}),[null==e?void 0:e.files]);return c.jsxs(c.Fragment,{children:[a.length>0&&a.map((e=>c.jsx(AC,{file:e},e.file_id))),t.length>0&&t.map((e=>c.jsx(kN,{imagePath:e.preview??e.filepath??"",height:e.height??1920,width:e.width??1080,altText:e.filename??"Uploaded Image",placeholderDimensions:{height:`${e.height??1920}px`,width:`${e.height??1080}px`}},e.file_id)))]})})),DC=({children:e,message:t})=>c.jsxs("div",{className:"text-message flex min-h-[20px] flex-col items-start gap-3 overflow-visible [.text-message+&]:mt-5",dir:"auto",children:[!0===(null==t?void 0:t.isCreatedByUser)&&c.jsx(OC,{message:t}),e]}),FC=({text:e,message:t,isSubmitting:a,ask:s,enterEdit:r,siblingIdx:o,setSiblingIdx:i})=>{const{addedIndex:l}=rv(),d=n.useRef(null),u=n.useRef(null),{getMessages:m,setMessages:p,conversation:g}=bh(),[f,x]=T(_p.latestMessageFamily(l)),h=n.useRef(null),{conversationId:v,parentMessageId:b,messageId:y}=t,_=(j=v??"",w=ar(),sr((function(e){return function(e){var t=e.conversationId,n=e.messageId,a=e.text;if(!t)throw new Error("conversationId is required");return nh.put(Wx(t,n),{text:a})}(e)}),{onSuccess:function(){w.invalidateQueries([ah.messages,j])}}));var j,w;const N=kg(),C="rtl"===I(_p.chatDirection).toLowerCase(),{register:k,handleSubmit:S,setValue:R}=ne({defaultValues:{text:e??""}});n.useEffect((()=>{const e=h.current;if(e){const t=e.value.length;e.focus(),e.setSelectionRange(t,t)}}),[]);const E=n.useCallback((e=>{var t,n;"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),null==(t=u.current)||t.click()),"s"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),null==(n=d.current)||n.click()),"Escape"===e.key&&(e.preventDefault(),r(!0))}),[r]),{ref:P,...L}=k("text",{required:!0,onChange:e=>{R("text",e.target.value,{shouldValidate:!0})}});return c.jsxs(DC,{message:t,children:[c.jsx("div",{className:"bg-token-main-surface-primary relative flex w-full flex-grow flex-col overflow-hidden rounded-2xl border border-border-medium text-text-primary [&:has(textarea:focus)]:border-border-heavy [&:has(textarea:focus)]:shadow-[0_2px_6px_rgba(0,0,0,.05)]",children:c.jsx(F_,{...L,ref:e=>{P(e),h.current=e},onKeyDown:E,"data-testid":"message-text-editor",className:rm("markdown prose dark:prose-invert light whitespace-pre-wrap break-words pl-3 md:pl-4","m-0 w-full resize-none border-0 bg-transparent py-[10px]","placeholder-text-secondary focus:ring-0 focus-visible:ring-0 md:py-3.5",C?"text-right":"text-left","max-h-[65vh] pr-3 md:max-h-[75vh] md:pr-4",pm),dir:C?"rtl":"ltr"})}),c.jsxs("div",{className:"mt-2 flex w-full justify-center text-center",children:[c.jsx(z_,{description:"Ctrl + Enter / ⌘ + Enter",render:c.jsx("button",{ref:u,className:"btn btn-primary relative mr-2",disabled:a,onClick:S((e=>{if(t.isCreatedByUser)s({text:e.text,parentMessageId:b,conversationId:v},{resubmitFiles:!0}),i((o??0)-1);else{const t=m(),n=null==t?void 0:t.find((e=>e.messageId===b));if(!n)return;s({...n},{editedText:e.text,editedMessageId:y,isRegenerate:!0,isEdited:!0}),i((o??0)-1)}r(!0)})),children:N("com_ui_save_submit")})}),c.jsx(z_,{description:"Shift + Enter",render:c.jsx("button",{ref:d,className:"btn btn-secondary relative mr-2",disabled:a,onClick:S((e=>{const n=m();if(!n)return;_.mutate({conversationId:v??"",model:(null==g?void 0:g.model)??"gpt-3.5-turbo",text:e.text,messageId:y}),t.messageId===(null==f?void 0:f.messageId)&&x({...f,text:e.text});n.some((e=>e.messageId===y))?p(n.map((t=>t.messageId===y?{...t,text:e.text}:t))):t.text=e.text,r(!0)})),children:N("com_ui_save")})}),c.jsx(z_,{description:"Esc",render:c.jsx("button",{className:"btn btn-neutral relative",onClick:()=>r(!0),children:N("com_ui_cancel")})})]})]})},zC=({text:e,message:t,className:a=""})=>{const s=kg();return"Error connecting to server, try refreshing the page."===e?(console.log("error message",t),c.jsx(n.Suspense,{fallback:c.jsx("div",{className:"text-message mb-[0.625rem] flex min-h-[20px] flex-col items-start gap-3 overflow-visible",children:c.jsx("div",{className:"markdown prose dark:prose-invert light w-full break-words dark:text-gray-100",children:c.jsx("div",{className:"absolute",children:c.jsx("p",{className:"submitting relative",children:c.jsx("span",{className:"result-thinking"})})})})}),children:c.jsx(J_,{delay:5500,children:c.jsx(DC,{message:t,children:c.jsx("div",{className:rm("rounded-md border border-red-500 bg-red-500/10 px-3 py-2 text-sm text-gray-600 dark:text-gray-200",a),children:s("com_ui_error_connection")})})})})):c.jsx(DC,{message:t,children:c.jsx("div",{role:"alert","aria-live":"assertive",className:rm("rounded-xl border border-red-500/20 bg-red-500/5 px-3 py-2 text-sm text-gray-600 dark:text-gray-200",a),children:c.jsx(jC,{text:e})})})},UC=({text:e,isCreatedByUser:t,message:a,showCursor:s})=>{const{isSubmitting:r,latestMessage:o}=bh(),i=I(_p.enableUserMsgMarkdown),l=n.useMemo((()=>!0===s&&r),[s,r]),d=n.useMemo((()=>a.messageId===(null==o?void 0:o.messageId)),[a.messageId,null==o?void 0:o.messageId]);let u;return u=t?i?c.jsx(LC,{content:e}):c.jsx(c.Fragment,{children:e}):c.jsx(FN,{content:e,showCursor:l,isLatestMessage:d}),c.jsx(DC,{message:a,children:c.jsx("div",{className:rm(r?"submitting":"",l&&e.length?"result-streaming":"","markdown prose message-content dark:prose-invert light w-full break-words",t&&!i&&"whitespace-pre-wrap",t?"dark:text-gray-20":"dark:text-gray-100"),children:u})})},VC=({message:e})=>c.jsx(zC,{message:e,text:"The response is incomplete; it's either still processing, was cancelled, or censored. Refresh or try a different prompt."}),BC=n.memo((({text:e,edit:t,error:a,unfinished:s,isSubmitting:r,isLast:o,...i})=>{const{message:l}=i,{messageId:d}=l,{thinkingContent:u,regularContent:m}=n.useMemo((()=>{const t=e.match(/:::thinking([\s\S]*?):::/);return{thinkingContent:t?t[1].trim():"",regularContent:t?e.replace(/:::thinking[\s\S]*?:::/,"").trim():e}}),[e]),p=n.useMemo((()=>o&&r),[o,r]),g=n.useMemo((()=>!r&&s?c.jsx(n.Suspense,{children:c.jsx(J_,{delay:250,children:c.jsx(VC,{message:l})})}):null),[r,s,l]);return a?c.jsx(zC,{message:i.message,text:e}):t?c.jsx(FC,{text:e,isSubmitting:r,...i}):c.jsxs(c.Fragment,{children:[u.length>0&&c.jsx(PC,{children:u},`thinking-${d}`),c.jsx(UC,{showCursor:p,text:m,...i},`display-${d}`),g]})})),$C="progress-text-wrapper text-token-text-secondary relative -mt-[0.75px] h-5 w-full leading-5",HC=({popover:e,children:t})=>e?c.jsx("div",{className:$C,children:c.jsx(As,{asChild:!0,children:c.jsx("div",{className:"progress-text-content absolute left-0 top-0 line-clamp-1 overflow-visible",style:{opacity:1,transform:"none"},"data-projection-id":"78",children:t})})}):c.jsx("div",{className:$C,children:c.jsx("div",{className:"progress-text-content absolute left-0 top-0 line-clamp-1 overflow-visible",style:{opacity:1,transform:"none"},"data-projection-id":"78",children:t})});function GC({progress:e,onClick:t,inProgressText:n,finishedText:a,authText:s,hasInput:r=!0,popover:o=!1,isExpanded:i=!1}){const l=e<1?s??n:a;return c.jsx(HC,{popover:o,children:c.jsxs("button",{type:"button",className:rm("inline-flex items-center gap-1",r?"":"pointer-events-none"),disabled:!r,onClick:t,children:[l,c.jsx("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",className:i?"rotate-180":"rotate-0",children:c.jsx("path",{className:r?"":"stroke-transparent",d:"M11.3346 7.83203L8.00131 11.1654L4.66797 7.83203",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})}function KC(){return c.jsx("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-brand-purple text-white",style:{opacity:1,transform:"none"},"data-projection-id":"162",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 9",fill:"none",width:"8",height:"9",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.66607 0.376042C8.01072 0.605806 8.10385 1.07146 7.87408 1.4161L3.54075 7.9161C3.40573 8.11863 3.18083 8.24304 2.93752 8.24979C2.69421 8.25654 2.46275 8.1448 2.31671 7.95008L0.150044 5.06119C-0.098484 4.72982 -0.0313267 4.25972 0.300044 4.01119C0.631415 3.76266 1.10152 3.82982 1.35004 4.16119L2.88068 6.20204L6.62601 0.584055C6.85577 0.239408 7.32142 0.146278 7.66607 0.376042Z",fill:"currentColor"})})})}function WC({radius:e,circumference:t,offset:n}){return c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",children:[c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 stroke-brand-purple/25 dark:stroke-brand-purple/50",strokeWidth:"7.826086956521739",fill:"transparent",r:e,cx:"60",cy:"60"}),c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 transition-[stroke-dashoffset]",stroke:"currentColor",strokeWidth:"7.826086956521739",strokeDasharray:`${t} ${t}`,strokeDashoffset:n,fill:"transparent",r:e,cx:"60",cy:"60"})]})}function QC(){return c.jsx("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-gray-300 text-white",style:{opacity:1,transform:"none"},children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8 9",fill:"none",width:"8",height:"9",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.32256 1.48447C7.59011 1.16827 7.55068 0.695034 7.23447 0.427476C6.91827 0.159918 6.44503 0.199354 6.17748 0.515559L4.00002 3.08892L1.82256 0.515559C1.555 0.199354 1.08176 0.159918 0.765559 0.427476C0.449355 0.695034 0.409918 1.16827 0.677476 1.48447L3.01755 4.25002L0.677476 7.01556C0.409918 7.33176 0.449354 7.805 0.765559 8.07256C1.08176 8.34011 1.555 8.30068 1.82256 7.98447L4.00002 5.41111L6.17748 7.98447C6.44503 8.30068 6.91827 8.34011 7.23447 8.07256C7.55068 7.805 7.59011 7.33176 7.32256 7.01556L4.98248 4.25002L7.32256 1.48447Z",fill:"currentColor"})})})}const qC=({offset:e,circumference:t,radius:n,isSubmitting:a,progress:s})=>s<1&&!a?c.jsx(QC,{}):c.jsxs("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-transparent text-white",style:{opacity:1,transform:"none"},"data-projection-id":"77",children:[c.jsx("div",{className:"absolute bottom-[1.5px] right-[1.5px]",children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20",width:"20",height:"20",style:{transform:"translate3d(0px, 0px, 0px)"},preserveAspectRatio:"xMidYMid meet",children:[c.jsx("defs",{children:c.jsx("clipPath",{id:"__lottie_element_11",children:c.jsx("rect",{width:"20",height:"20",x:"0",y:"0"})})}),c.jsxs("g",{clipPath:"url(#__lottie_element_11)",children:[c.jsx("g",{style:{display:"block",transform:"matrix(1,0,0,1,-2,-2)",opacity:1},className:"slide-from-left",children:c.jsxs("g",{opacity:"1",transform:"matrix(1,0,0,1,7.026679992675781,8.834091186523438)",children:[c.jsx("path",{fill:"rgb(177,98,253)",fillOpacity:"1",d:" M1.2870399951934814,0.2207774966955185 C0.992609977722168,-0.07359249889850616 0.5152599811553955,-0.07359249889850616 0.22082999348640442,0.2207774966955185 C-0.07361000031232834,0.5151575207710266 -0.07361000031232834,0.992437481880188 0.22082999348640442,1.2868175506591797 C0.8473266959190369,1.9131841659545898 1.4738233089447021,2.53955078125 2.1003201007843018,3.16591739654541 C1.4738233089447021,3.7922842502593994 0.8473266959190369,4.4186506271362305 0.22082999348640442,5.045017719268799 C-0.07361000031232834,5.339417457580566 -0.07361000031232834,5.816617488861084 0.22082999348640442,6.11101770401001 C0.5152599811553955,6.405417442321777 0.992609977722168,6.405417442321777 1.2870399951934814,6.11101770401001 C2.091266632080078,5.306983947753906 2.895493268966675,4.502950668334961 3.6997199058532715,3.6989173889160156 C3.994119882583618,3.404517412185669 3.994119882583618,2.927217483520508 3.6997199058532715,2.6329174041748047 C2.895493268966675,1.8288708925247192 2.091266632080078,1.0248241424560547 1.2870399951934814,0.2207774966955185 C1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 C1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",fillOpacity:"0",stroke:"rgb(177,98,253)",strokeOpacity:"1",strokeWidth:"0.201031",d:" M1.2870399951934814,0.2207774966955185 C0.992609977722168,-0.07359249889850616 0.5152599811553955,-0.07359249889850616 0.22082999348640442,0.2207774966955185 C-0.07361000031232834,0.5151575207710266 -0.07361000031232834,0.992437481880188 0.22082999348640442,1.2868175506591797 C0.8473266959190369,1.9131841659545898 1.4738233089447021,2.53955078125 2.1003201007843018,3.16591739654541 C1.4738233089447021,3.7922842502593994 0.8473266959190369,4.4186506271362305 0.22082999348640442,5.045017719268799 C-0.07361000031232834,5.339417457580566 -0.07361000031232834,5.816617488861084 0.22082999348640442,6.11101770401001 C0.5152599811553955,6.405417442321777 0.992609977722168,6.405417442321777 1.2870399951934814,6.11101770401001 C2.091266632080078,5.306983947753906 2.895493268966675,4.502950668334961 3.6997199058532715,3.6989173889160156 C3.994119882583618,3.404517412185669 3.994119882583618,2.927217483520508 3.6997199058532715,2.6329174041748047 C2.895493268966675,1.8288708925247192 2.091266632080078,1.0248241424560547 1.2870399951934814,0.2207774966955185 C1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 C1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185 1.2870399951934814,0.2207774966955185"})]})}),c.jsx("g",{style:{display:"block",transform:"matrix(1,0,0,1,-2,-2)",opacity:1},className:"slide-to-down",children:c.jsxs("g",{opacity:"1",transform:"matrix(1,0,0,1,11.79640007019043,13.512199401855469)",children:[c.jsx("path",{fill:"rgb(177,98,253)",fillOpacity:"1",d:" M4.3225998878479,0 C3.1498000621795654,0 1.9769999980926514,0 0.8041999936103821,0 C0.36010000109672546,0 0,0.36000001430511475 0,0.804099977016449 C0,1.2482000589370728 0.36010000109672546,1.6081000566482544 0.8041999936103821,1.6081000566482544 C1.9769999980926514,1.6081000566482544 3.1498000621795654,1.6081000566482544 4.3225998878479,1.6081000566482544 C4.7667999267578125,1.6081000566482544 5.126800060272217,1.2482000589370728 5.126800060272217,0.804099977016449 C5.126800060272217,0.36000001430511475 4.7667999267578125,0 4.3225998878479,0 C4.3225998878479,0 4.3225998878479,0 4.3225998878479,0 C4.3225998878479,0 4.3225998878479,0 4.3225998878479,0"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",fillOpacity:"0",stroke:"rgb(177,98,253)",strokeOpacity:"1",strokeWidth:"0.100515",d:" M4.3225998878479,0 C3.1498000621795654,0 1.9769999980926514,0 0.8041999936103821,0 C0.36010000109672546,0 0,0.36000001430511475 0,0.804099977016449 C0,1.2482000589370728 0.36010000109672546,1.6081000566482544 0.8041999936103821,1.6081000566482544 C1.9769999980926514,1.6081000566482544 3.1498000621795654,1.6081000566482544 4.3225998878479,1.6081000566482544 C4.7667999267578125,1.6081000566482544 5.126800060272217,1.2482000589370728 5.126800060272217,0.804099977016449 C5.126800060272217,0.36000001430511475 4.7667999267578125,0 4.3225998878479,0 C4.3225998878479,0 4.3225998878479,0 4.3225998878479,0 C4.3225998878479,0 4.3225998878479,0 4.3225998878479,0"})]})})]})]})}),c.jsx(WC,{radius:n,circumference:t,offset:e})]});function ZC({attachment:e}){if(!e)return null;const{width:t,height:n,filepath:a=null}=e;return Oi.test(e.filename)&&null!=t&&null!=n&&null!=a?c.jsx(kN,{altText:e.filename,imagePath:a,height:n,width:t}):null}const YC=56.08695652173913,JC=2*Math.PI*YC;function XC({initialProgress:e=.1,args:t,output:a="",isSubmitting:s,attachments:r}){const o=kg(),i=I(_p.showCode),[l,d]=n.useState(i),{lang:u,code:m}=function(e){return n.useMemo((()=>{const t=e.match(/"lang"\s*:\s*"(\w+)"/),n=e.match(/"code"\s*:\s*"(.+?)(?="\s*,\s*"args"|$)/s);let a="";return n&&(a=n[1],a.endsWith('"}')&&(a=a.slice(0,-2)),a=a.replace(/\\n/g,"\n").replace(/\\/g,"")),{lang:t?t[1]:"",code:a}}),[e])}(t),p=ob(e),g=JC-p*JC;return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[c.jsx("div",{className:"relative h-5 w-5 shrink-0",children:p<1?c.jsx(qC,{offset:g,radius:YC,progress:p,isSubmitting:s,circumference:JC}):c.jsx(KC,{})}),c.jsx(GC,{progress:p,onClick:()=>d((e=>!e)),inProgressText:o("com_ui_analyzing"),finishedText:o("com_ui_analyzing_finished"),hasInput:!!m.length,isExpanded:l})]}),l&&c.jsxs("div",{className:"code-analyze-block mb-3 mt-0.5 overflow-hidden rounded-xl bg-black",children:[c.jsx(LC,{content:m?`\`\`\`${u}\n${m}\n\`\`\``:"",codeExecution:!1}),a.length>0&&c.jsx("div",{className:"bg-gray-700 p-4 text-xs",children:c.jsx("div",{className:"prose flex flex-col-reverse text-white",style:{color:"white"},children:c.jsx("pre",{className:"shrink-0",children:c.jsx(TN,{output:a,attachments:r})})})})]}),null==r?void 0:r.map(((e,t)=>c.jsx(ZC,{attachment:e},t)))]})}function ek({error:e,isSubmitting:t,progress:n,children:a}){return!t&&n<1||!0===e?c.jsx(QC,{}):c.jsx(c.Fragment,{children:a})}function tk(){return c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20",width:"20",height:"20",style:{width:"100%",height:"100%",transform:"translate3d(0px, 0px, 0px)"},preserveAspectRatio:"xMidYMid meet",children:[c.jsxs("defs",{children:[c.jsx("clipPath",{id:"__lottie_element_258",children:c.jsx("rect",{width:"20",height:"20",x:"0",y:"0"})}),c.jsx("clipPath",{id:"__lottie_element_263",children:c.jsx("path",{d:"M0,0 L20000,0 L20000,20000 L0,20000z"})}),c.jsx("clipPath",{id:"__lottie_element_270",children:c.jsx("path",{d:"M0,0 L20000,0 L20000,20000 L0,20000z"})})]}),c.jsx("g",{clipPath:"url(#__lottie_element_258)",children:c.jsxs("g",{clipPath:"url(#__lottie_element_263)",style:{display:"block"},transform:"matrix(0.9999999403953552,0,0,0.9999999403953552,-10000,-10000)",opacity:"1",children:[c.jsxs("g",{clipPath:"url(#__lottie_element_270)",style:{display:"block"},transform:"matrix(0.9999988675117493,0,0,0.9999988675117493,10.01171875,10.01171875)",opacity:"1",children:[c.jsx("g",{style:{display:"block"},transform:"matrix(1,0,0,1,10000,10000)",opacity:"1",children:c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,-3.25,-2.125)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:" M0,0.75 C0,0.3357900083065033 0.3357900083065033,8.881784197001252e-16 0.75,8.881784197001252e-16 C2.4166667461395264,8.881784197001252e-16 4.083333492279053,8.881784197001252e-16 5.75,8.881784197001252e-16 C6.1641998291015625,8.881784197001252e-16 6.5,0.3357900083065033 6.5,0.75 C6.5,1.1642099618911743 6.1641998291015625,1.5 5.75,1.5 C4.083333492279053,1.5 2.4166667461395264,1.5 0.75,1.5 C0.3357900083065033,1.5 0,1.1642099618911743 0,0.75 C0,0.75 0,0.75 0,0.75 C0,0.75 0,0.75 0,0.75"})})}),c.jsx("g",{style:{display:"block"},transform:"matrix(1,0,0,1,10000,10000)",opacity:"1",children:c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,-3.25,0.625)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:" M0,0.75 C0,0.3357999920845032 0.3357900083065033,0 0.75,0 C1.9166666269302368,0 3.0833332538604736,0 4.25,0 C4.6641998291015625,0 5,0.3357999920845032 5,0.75 C5,1.164199948310852 4.6641998291015625,1.5 4.25,1.5 C3.0833332538604736,1.5 1.9166666269302368,1.5 0.75,1.5 C0.3357900083065033,1.5 0,1.164199948310852 0,0.75 C0,0.75 0,0.75 0,0.75 C0,0.75 0,0.75 0,0.75"})})})]}),c.jsx("g",{style:{display:"block"},transform:"matrix(1,0,0,1,10000,10000)",opacity:"1",children:c.jsxs("g",{opacity:"1",transform:"matrix(1,0,0,1,10,10)",children:[c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:" M-3.13,-5.25 C-3.09,-5.25 -3.04,-5.25 -3,-5.25 C-2.59,-5.25 -2.25,-4.91 -2.25,-4.5 C-2.25,-4.09 -2.59,-3.75 -3,-3.75 C-3.03,-3.75 -3.07,-3.75 -3.1,-3.75 C-3.53,-3.75 -3.81,-3.75 -4.02,-3.73 C-4.23,-3.72 -4.3,-3.69 -4.34,-3.67 C-4.48,-3.6 -4.6,-3.48 -4.67,-3.34 C-4.69,-3.3 -4.72,-3.23 -4.73,-3.02 C-4.75,-2.81 -4.75,-2.53 -4.75,-2.1 C-4.75,-2.07 -4.75,-2.03 -4.75,-2 C-4.75,-1.59 -5.09,-1.25 -5.5,-1.25 C-5.91,-1.25 -6.25,-1.59 -6.25,-2 C-6.25,-2.04 -6.25,-2.09 -6.25,-2.13 C-6.25,-2.52 -6.25,-2.87 -6.23,-3.15 C-6.2,-3.44 -6.15,-3.74 -6,-4.02 C-5.79,-4.44 -5.44,-4.79 -5.02,-5 C-4.74,-5.15 -4.44,-5.2 -4.15,-5.23 C-3.87,-5.25 -3.52,-5.25 -3.13,-5.25 C-3.13,-5.25 -3.13,-5.25 -3.13,-5.25 C-3.13,-5.25 -3.13,-5.25 -3.13,-5.25 M6.25,-2.13 C6.25,-2.09 6.25,-2.04 6.25,-2 C6.25,-1.59 5.91,-1.25 5.5,-1.25 C5.09,-1.25 4.75,-1.59 4.75,-2 C4.75,-2.03 4.75,-2.07 4.75,-2.1 C4.75,-2.53 4.75,-2.81 4.73,-3.02 C4.72,-3.23 4.69,-3.3 4.67,-3.34 C4.6,-3.48 4.48,-3.6 4.34,-3.67 C4.3,-3.69 4.23,-3.72 4.02,-3.73 C3.81,-3.75 3.53,-3.75 3.1,-3.75 C3.07,-3.75 3.03,-3.75 3,-3.75 C2.59,-3.75 2.25,-4.09 2.25,-4.5 C2.25,-4.91 2.59,-5.25 3,-5.25 C3.04,-5.25 3.09,-5.25 3.13,-5.25 C3.52,-5.25 3.87,-5.25 4.15,-5.23 C4.44,-5.2 4.74,-5.15 5.02,-5 C5.44,-4.79 5.79,-4.44 6,-4.02 C6.15,-3.74 6.2,-3.44 6.23,-3.15 C6.25,-2.87 6.25,-2.52 6.25,-2.13 C6.25,-2.13 6.25,-2.13 6.25,-2.13 C6.25,-2.13 6.25,-2.13 6.25,-2.13 M-3.13,5.25 C-3.09,5.25 -3.04,5.25 -3,5.25 C-2.59,5.25 -2.25,4.91 -2.25,4.5 C-2.25,4.09 -2.59,3.75 -3,3.75 C-3.03,3.75 -3.07,3.75 -3.1,3.75 C-3.53,3.75 -3.81,3.75 -4.02,3.73 C-4.23,3.72 -4.3,3.69 -4.34,3.67 C-4.48,3.6 -4.6,3.48 -4.67,3.34 C-4.69,3.3 -4.72,3.23 -4.73,3.02 C-4.75,2.81 -4.75,2.53 -4.75,2.1 C-4.75,2.07 -4.75,2.03 -4.75,2 C-4.75,1.59 -5.09,1.25 -5.5,1.25 C-5.91,1.25 -6.25,1.59 -6.25,2 C-6.25,2.04 -6.25,2.09 -6.25,2.13 C-6.25,2.52 -6.25,2.87 -6.23,3.15 C-6.2,3.44 -6.15,3.74 -6,4.02 C-5.79,4.44 -5.44,4.79 -5.02,5 C-4.74,5.15 -4.44,5.2 -4.15,5.23 C-3.87,5.25 -3.52,5.25 -3.13,5.25 C-3.13,5.25 -3.13,5.25 -3.13,5.25 C-3.13,5.25 -3.13,5.25 -3.13,5.25 M6.25,2.13 C6.25,2.09 6.25,2.04 6.25,2 C6.25,1.59 5.91,1.25 5.5,1.25 C5.09,1.25 4.75,1.59 4.75,2 C4.75,2.03 4.75,2.07 4.75,2.1 C4.75,2.53 4.75,2.81 4.73,3.02 C4.72,3.23 4.69,3.3 4.67,3.34 C4.6,3.48 4.48,3.6 4.34,3.67 C4.3,3.69 4.23,3.72 4.02,3.73 C3.81,3.75 3.53,3.75 3.1,3.75 C3.07,3.75 3.03,3.75 3,3.75 C2.59,3.75 2.25,4.09 2.25,4.5 C2.25,4.91 2.59,5.25 3,5.25 C3.04,5.25 3.09,5.25 3.13,5.25 C3.52,5.25 3.87,5.25 4.15,5.23 C4.44,5.2 4.74,5.15 5.02,5 C5.44,4.79 5.79,4.44 6,4.02 C6.15,3.74 6.2,3.44 6.23,3.15 C6.25,2.87 6.25,2.52 6.25,2.13 C6.25,2.13 6.25,2.13 6.25,2.13 C6.25,2.13 6.25,2.13 6.25,2.13"}),c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,-6.250000476837158,-5.250000476837158)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:"M0 0"})}),c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,2.25,-5.250000476837158)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:"M0 0"})}),c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,-6.250000476837158,1.25)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:"M0 0"})}),c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,2.25,1.25)",children:c.jsx("path",{fill:"rgb(177,97,253)",fillOpacity:"1",d:"M0 0"})})]})})]})})]})}function nk({initialProgress:e=.1,isSubmitting:t}){const n=ob(e),a=56.08695652173913,s=2*Math.PI*a,r=s-n*s,o=n>=2;return c.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[c.jsx("div",{className:"relative h-5 w-5 shrink-0",children:n<1?c.jsx(ek,{progress:n,isSubmitting:t,error:o,children:c.jsxs("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-transparent text-white",style:{opacity:1,transform:"none"},children:[c.jsx("div",{children:c.jsx(tk,{})}),c.jsx(WC,{radius:a,circumference:s,offset:r})]})}):o?c.jsx(QC,{}):c.jsx(KC,{})}),c.jsx(GC,{progress:n,onClick:()=>({}),inProgressText:"Searching my knowledge",finishedText:"Used Retrieval",hasInput:!1,popover:!1})]})}const ak=n.memo((({reasoning:e})=>{const{isExpanded:t,nextType:a}=gv(),s=n.useMemo((()=>e.replace(/^<think>\s*/,"").replace(/\s*<\/think>$/,"").trim()),[e]);return s?c.jsx("div",{className:rm("grid transition-all duration-300 ease-out",a!==to.THINK&&t&&"mb-8"),style:{gridTemplateRows:t?"1fr":"0fr"},children:c.jsx("div",{className:"overflow-hidden",children:c.jsx(RC,{isPart:!0,children:s})})}):null})),sk=56.08695652173913,rk=2*Math.PI*sk;function ok({initialProgress:e=.1,code:t,outputs:a=[],isSubmitting:s}){const r=kg(),o=ob(e),i=I(_p.showCode),[l,d]=n.useState(i),u=rk-o*rk,m=a.reduce(((e,t)=>t.logs?e+t.logs+"\n":e),"");return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[c.jsx("div",{className:"relative h-5 w-5 shrink-0",children:o<1?c.jsx(qC,{offset:u,radius:sk,progress:o,isSubmitting:s,circumference:rk}):c.jsx(KC,{})}),c.jsx(GC,{progress:o,onClick:()=>d((e=>!e)),inProgressText:r("com_ui_analyzing"),finishedText:r("com_ui_analyzing_finished"),hasInput:!!t.length,isExpanded:l})]}),l&&c.jsxs("div",{className:"code-analyze-block mb-3 mt-0.5 overflow-hidden rounded-xl bg-black",children:[c.jsx(LC,{content:t?`\`\`\`python\n${t}\n\`\`\``:""}),m&&c.jsxs("div",{className:"bg-gray-700 p-4 text-xs",children:[c.jsx("div",{className:"mb-1 text-gray-400",children:r("com_ui_result")}),c.jsx("div",{className:"prose flex flex-col-reverse text-white",style:{color:"white"},children:c.jsx("pre",{className:"shrink-0",children:m})})]})]})]})}function ik({input:e,output:t,domain:n,function_name:a,pendingAuth:s}){const r=kg(),o=e=>{try{return JSON.stringify(JSON.parse(e),null,2)}catch{return e}};let i=null!=n&&n?r("com_assistants_domain_info",{0:n}):r("com_assistants_function_use",{0:a});return!0===s&&(i=null!=n&&n?r("com_assistants_action_attempt",{0:n}):r("com_assistants_attempt_info")),c.jsx(Os,{children:c.jsx(Ds,{side:"bottom",align:"start",sideOffset:12,alignOffset:-5,className:"w-18 min-w-[180px]  max-w-sm rounded-lg bg-surface-primary px-1",children:c.jsx("div",{tabIndex:-1,children:c.jsxs("div",{className:"bg-token-surface-primary max-w-sm rounded-md p-2 shadow-[0_0_24px_0_rgba(0,0,0,0.05),inset_0_0.5px_0_0_rgba(0,0,0,0.05),0_2px_8px_0_rgba(0,0,0,0.05)]",children:[c.jsx("div",{className:"mb-2 text-sm font-medium text-text-primary",children:i}),c.jsx("div",{className:"bg-token-surface-secondary text-token-text-primary dark rounded-md text-xs",children:c.jsx("div",{className:"max-h-32 overflow-y-auto rounded-md bg-surface-tertiary p-2",children:c.jsx("code",{className:"!whitespace-pre-wrap ",children:o(e)})})}),null!=t&&t&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-2 mt-2 text-sm font-medium text-text-primary",children:r("com_ui_result")}),c.jsx("div",{className:"bg-token-surface-secondary text-token-text-primary dark rounded-md text-xs",children:c.jsx("div",{className:"max-h-32 overflow-y-auto rounded-md bg-surface-tertiary p-2",children:c.jsx("code",{className:"!whitespace-pre-wrap ",children:o(t)})})})]})]})})})})}function lk(){const[e,t]=n.useState(!1);return n.useEffect((()=>{const e=setInterval((()=>{t((e=>!e))}),2e3);return()=>clearInterval(e)}),[]),c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24",width:"24",height:"24",style:{width:"100%",height:"100%",transform:"rotate(30deg)"},preserveAspectRatio:"xMidYMid meet",children:[c.jsx("defs",{children:c.jsx("clipPath",{id:"__lottie_element_28",children:c.jsx("rect",{width:"24",height:"24",x:"0",y:"0"})})}),c.jsx("g",{clipPath:"url(#__lottie_element_28)",children:c.jsx("g",{style:{display:"block",transform:"matrix(1,0,0,1,0,0)"},opacity:"1",className:"rotate-adjust-and-back",children:c.jsx("g",{opacity:"1",transform:"matrix(0.8995603322982788,-0.8114914894104004,0.8114914894104004,0.8995603322982788,1.0572385787963867,13.542327880859375)",children:c.jsx("path",{fill:"rgb(178,98,254)",fillOpacity:"1",d:" M8.648597717285156,0.11783526837825775 C9.091397285461426,0.2144152671098709 9.200997352600098,0.7544552683830261 8.880497932434082,1.0749353170394897 C8.137197494506836,1.8182452917099 7.393897533416748,2.5615553855895996 6.65059757232666,3.3048653602600098 C5.901897430419922,4.053555488586426 5.901897430419922,5.267405033111572 6.65059757232666,6.0161051750183105 C7.399197578430176,6.764805316925049 8.613097190856934,6.764805316925049 9.361797332763672,6.0161051750183105 C10.105097770690918,5.2727952003479 10.848397254943848,4.52948522567749 11.591697692871094,3.78617525100708 C11.91219711303711,3.465695381164551 12.452197074890137,3.5752952098846436 12.548797607421875,4.018115043640137 C12.907397270202637,5.6623053550720215 12.44759750366211,7.449105262756348 11.169297218322754,8.727405548095703 C9.65219783782959,10.244504928588867 7.418797492980957,10.608805656433105 5.557697296142578,9.820205688476562 C4.796051025390625,10.581838607788086 4.034404277801514,11.34347152709961 3.2727575302124023,12.10510540008545 C2.5240674018859863,12.853805541992188 1.310207486152649,12.853805541992188 0.5615174770355225,12.10510540008545 C-0.18717250227928162,11.356505393981934 -0.18717250227928162,10.14260482788086 0.5615174770355225,9.393905639648438 C1.3231642246246338,8.632271766662598 2.084810733795166,7.870638370513916 2.8464574813842773,7.109005451202393 C2.0579075813293457,5.247905254364014 2.4221975803375244,3.014495372772217 3.939307451248169,1.497375249862671 C5.217597484588623,0.21908527612686157 7.004397392272949,-0.24075473845005035 8.648597717285156,0.11783526837825775 "})})})})]})}const ck=56.08695652173913,dk=2*Math.PI*ck;function uk({initialProgress:e=.1,isSubmitting:t,name:a,args:s="",output:r,attachments:o,auth:i}){const l=kg(),{function_name:d,domain:u,isMCPToolCall:m}=n.useMemo((()=>{if("string"!=typeof a)return{function_name:"",domain:null,isMCPToolCall:!1};if(a.includes(dc.mcp_delimiter)){const[e,t]=a.split(dc.mcp_delimiter);return{function_name:e||"",domain:t&&(t.replaceAll("---",".")||null),isMCPToolCall:!0}}const[e,t]=a.includes(_o)?a.split(_o):[a,""];return{function_name:e||"",domain:t&&(t.replaceAll("---",".")||null),isMCPToolCall:!1}}),[a]),p="string"==typeof r&&r.toLowerCase().includes("error processing tool"),g=n.useMemo((()=>{if("string"==typeof s)return s;try{return JSON.stringify(s,null,2)}catch(Bg){return om.error("client/src/components/Chat/Messages/Content/ToolCall.tsx - Failed to stringify args",Bg),""}}),[s]),f=n.useMemo((()=>((null==g?void 0:g.length)??0)>0||((null==r?void 0:r.length)??0)>0),[g,r]),x=n.useMemo((()=>{const e=i??"";if(!e)return"";try{return new URL(e).hostname}catch(Bg){return""}}),[i]),h=ob(!0===p?1:e),v=!t&&h<1||!0===p,b=dk-h*dk;return c.jsxs(Ms,{children:[c.jsxs("div",{className:"my-2.5 flex flex-wrap items-center gap-2.5",children:[c.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[c.jsx("div",{className:"relative h-5 w-5 shrink-0",children:h<1&&x.length>0?c.jsx("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-transparent text-text-secondary",style:{opacity:1,transform:"none"},"data-projection-id":"849",children:c.jsx("div",{children:c.jsx(Yt,{})})}):h<1?c.jsx(ek,{progress:h,isSubmitting:t,error:p,children:c.jsxs("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-transparent text-white",style:{opacity:1,transform:"none"},"data-projection-id":"849",children:[c.jsx("div",{children:c.jsx(lk,{})}),c.jsx(WC,{radius:ck,circumference:dk,offset:b})]})}):v?c.jsx(QC,{}):c.jsx(KC,{})}),c.jsx(GC,{progress:v?1:h,inProgressText:l("com_assistants_running_action"),authText:!v&&x.length>0?l("com_ui_requires_auth"):void 0,finishedText:v?l("com_ui_error"):!0===m?l("com_assistants_completed_function",{0:d}):null!=u&&u&&u.length!==dc.ENCODED_DOMAIN_LENGTH?l("com_assistants_completed_action",{0:u}):l("com_assistants_completed_function",{0:d}),hasInput:f,popover:!0}),f&&c.jsx(ik,{input:g??"",output:r,domain:x||(u??""),function_name:d,pendingAuth:x.length>0&&!v&&h<1})]}),null!=i&&i&&h<1&&!v&&c.jsxs("div",{className:"flex w-full flex-col gap-2.5",children:[c.jsx("div",{className:"mb-1 mt-2",children:c.jsx("a",{className:"inline-flex items-center justify-center gap-2 rounded-3xl bg-surface-tertiary px-4 py-2 text-sm font-medium hover:bg-surface-hover",href:i,target:"_blank",rel:"noopener noreferrer",children:l("com_ui_sign_in_to_domain",{0:x})})}),c.jsxs("p",{className:"flex items-center text-xs text-text-secondary",children:[c.jsx(Zt,{className:"mr-1.5 inline-block h-4 w-4"}),l("com_assistants_allow_sites_you_trust")]})]})]}),null==o?void 0:o.map(((e,t)=>c.jsx(ZC,{attachment:e},t)))]})}function mk({initialProgress:e=.1,args:t=""}){const a=ob(e),s=56.08695652173913,r=2*Math.PI*s,o=r-a*r,[i,l]=n.useState(!1);return c.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[c.jsx("div",{className:"relative h-5 w-5 shrink-0",children:c.jsxs("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full bg-transparent text-white",style:{opacity:1,transform:"none"},"data-projection-id":"106",children:[c.jsx("div",{children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20",width:"20",height:"20",style:{width:"100%",height:"100%",transform:"translate3d(0px, 0px, 0px)"},preserveAspectRatio:"xMidYMid meet",children:[c.jsx("g",{className:"move-up",children:c.jsx("path",{fill:"rgb(177,98,253)",fillOpacity:"1",d:"M11.812616,5.914505C11.535567,5.360465,10.744857,5.360465,10.467807,5.914505C9.369731,8.110632,8.271654,10.306758,7.173676,12.502885C6.923041,13.002725,7.286122,13.590845,7.844972,13.590845C10.041112,13.590845,12.237252,13.590845,14.433392,13.590845C14.992292,13.590845,15.355792,13.002725,15.105892,12.502885C14.007888,10.306758,12.909805,8.110632,11.812616,5.914505C11.812616,5.914505,11.812616,5.914505,11.812616,5.914505C11.812616,5.914505,11.812616,5.914505,11.812616,5.914505M7.216073,8.914505C6.939024,8.360465,6.148304,8.360465,5.871264,8.914505C5.274365,10.10828,4.677499,11.302055,4.080601,12.495835C3.83003,12.99568,4.193122,13.58379,4.751975,13.58379C5.946767,13.58379,7.14156,13.58379,8.336353,13.58379C8.895213,13.58379,9.258683,12.99568,9.008763,12.495835C8.411867,11.302055,7.81497,10.10828,7.216073,8.914505C7.216073,8.914505,7.216073,8.914505,7.216073,8.914505C7.216073,8.914505,7.216073,8.914505,7.216073,8.914505"})}),c.jsx("g",{style:{display:"block"},transform:"matrix(-1,0,0,-1,10,10)",opacity:"1",className:"moon-rise",children:c.jsx("g",{opacity:"1",transform:"matrix(1,0,0,1,3.75,5.5)",children:c.jsx("path",{fill:"rgb(177,98,253)",fillOpacity:"1",d:" M2.660290002822876,2.2502501010894775 C2.7567598819732666,2.2502501010894775 2.850860118865967,2.241950035095215 2.9425699710845947,2.225330114364624 C3.034290075302124,2.208709955215454 3.1081299781799316,2.1867599487304688 3.164109945297241,2.1594600677490234 C3.239150047302246,2.120300054550171 3.305850028991699,2.100709915161133 3.364219903945923,2.100709915161133 C3.405900001525879,2.100709915161133 3.438659906387329,2.113770008087158 3.462480068206787,2.1398799419403076 C3.487489938735962,2.165990114212036 3.5,2.2009999752044678 3.5,2.2449100017547607 C3.5,2.2698400020599365 3.4958300590515137,2.2983200550079346 3.487489938735962,2.3303699493408203 C3.4803500175476074,2.362410068511963 3.468440055847168,2.3968300819396973 3.4517600536346436,2.433619976043701 C3.3803000450134277,2.5950300693511963 3.287990093231201,2.7410099506378174 3.1748299598693848,2.871570110321045 C3.0628700256347656,3.002120018005371 2.9348299503326416,3.1142799854278564 2.790709972381592,3.2080399990081787 C2.646589994430542,3.3029799461364746 2.4905600547790527,3.375380039215088 2.3226099014282227,3.425230026245117 C2.15585994720459,3.4750800132751465 1.9825600385665894,3.5 1.8027100563049316,3.5 C1.5430500507354736,3.5 1.3036400079727173,3.4554901123046875 1.0844800472259521,3.3664801120758057 C0.8653200268745422,3.2786500453948975 0.6741499900817871,3.1540400981903076 0.5109699964523315,2.9926199913024902 C0.34898999333381653,2.831209897994995 0.22333000600337982,2.641319990158081 0.1340000033378601,2.4229400157928467 C0.04467000067234039,2.2045600414276123 0,1.9660099744796753 0,1.7072700262069702 C0,1.4639699459075928 0.04645000025629997,1.2325400114059448 0.1393599957227707,1.012969970703125 C0.23226000368595123,0.7922199964523315 0.3626900017261505,0.5975800156593323 0.5306299924850464,0.4290440082550049 C0.6997600197792053,0.2593249976634979 0.8968899846076965,0.12877200543880463 1.121999979019165,0.03738600015640259 C1.1541600227355957,0.024329999461770058 1.1833399534225464,0.01483600027859211 1.2095500230789185,0.008901000022888184 C1.2369400262832642,0.0029670000076293945 1.2631399631500244,2.220446049250313e-16 1.288159966468811,2.220446049250313e-16 C1.335800051689148,2.220446049250313e-16 1.3733199834823608,0.014241999946534634 1.4007099866867065,0.042725998908281326 C1.4292999505996704,0.07121100276708603 1.4435900449752808,0.10681600123643875 1.4435900449752808,0.14954200387001038 C1.4435900449752808,0.1780260056257248 1.438230037689209,0.2076980024576187 1.4275100231170654,0.23855499923229218 C1.41798996925354,0.2682270109653473 1.404289960861206,0.2996779978275299 1.3864200115203857,0.3329089879989624 C1.3625999689102173,0.3768230080604553 1.3423500061035156,0.4302310049533844 1.3256800174713135,0.493133008480072 C1.309000015258789,0.5548499822616577 1.296489953994751,0.6225000023841858 1.288159966468811,0.6960800290107727 C1.2798199653625488,0.7684800028800964 1.2756500244140625,0.8414700031280518 1.2756500244140625,0.9150599837303162 C1.2756500244140625,1.1215699911117554 1.3072099685668945,1.3073099851608276 1.3703399896621704,1.4722800254821777 C1.4346599578857422,1.6372499465942383 1.5269700288772583,1.7778899669647217 1.6472699642181396,1.8941999673843384 C1.7675700187683105,2.0093300342559814 1.9128799438476562,2.097749948501587 2.083209991455078,2.1594600677490234 C2.2547199726104736,2.2199900150299072 2.44707989692688,2.2502501010894775 2.660290002822876,2.2502501010894775 C2.660290002822876,2.2502501010894775 2.660290002822876,2.2502501010894775 2.660290002822876,2.2502501010894775 C2.660290002822876,2.2502501010894775 2.660290002822876,2.2502501010894775 2.660290002822876,2.2502501010894775"})})})]})}),c.jsx(WC,{radius:s,circumference:r,offset:o})]})}),c.jsx(GC,{progress:a,onClick:()=>l((e=>!e)),inProgressText:"Creating Image",finishedText:"Finished.",hasInput:!1})]})}const pk=n.memo((({text:e,isCreatedByUser:t,showCursor:a})=>{const{messageId:s}=gv(),{isSubmitting:r,latestMessage:o}=bh(),i=I(_p.enableUserMsgMarkdown),l=n.useMemo((()=>a&&r),[a,r]),d=n.useMemo((()=>s===(null==o?void 0:o.messageId)),[s,null==o?void 0:o.messageId]),u=n.useMemo((()=>t?i?c.jsx(LC,{content:e}):c.jsx(c.Fragment,{children:e}):c.jsx(FN,{content:e,showCursor:l,isLatestMessage:d})),[t,i,e,l,d]);return c.jsx("div",{className:rm(r?"submitting":"",l&&e.length?"result-streaming":"","markdown prose message-content dark:prose-invert light w-full break-words",t&&!i&&"whitespace-pre-wrap",t?"dark:text-gray-20":"dark:text-gray-100"),children:u})})),gk=n.memo((({part:e,isSubmitting:t,attachments:n,showCursor:a,isCreatedByUser:s})=>{if(!e)return null;if(e.type===to.ERROR)return c.jsx(zC,{text:e[to.TEXT].value,className:"my-2"});if(e.type===to.TEXT){const t="string"==typeof e.text?e.text:e.text.value;return"string"!=typeof t?null:null==e.tool_call_ids||t?c.jsx(DC,{children:c.jsx(pk,{text:t,isCreatedByUser:s,showCursor:a})}):null}if(e.type===to.THINK){const t="string"==typeof e.think?e.think:e.think.value;return"string"!=typeof t?null:c.jsx(ak,{reasoning:t})}if(e.type===to.TOOL_CALL){const r=e[to.TOOL_CALL];if(!r)return null;const o="args"in r&&(!r.type||r.type===ao.TOOL_CALL);if(o&&r.name===so.execute_code)return c.jsx(XC,{args:"string"==typeof r.args?r.args:"",output:r.output??"",initialProgress:r.progress??.1,isSubmitting:t,attachments:n});if(o)return c.jsx(uk,{args:r.args??"",name:r.name||"",output:r.output??"",initialProgress:r.progress??.1,isSubmitting:t,attachments:n,auth:r.auth,expires_at:r.expires_at});if(r.type===ao.CODE_INTERPRETER){const e=r[ao.CODE_INTERPRETER];return c.jsx(ok,{initialProgress:r.progress??.1,code:e.input,outputs:e.outputs??[],isSubmitting:t})}if(r.type===ao.RETRIEVAL||r.type===ao.FILE_SEARCH)return c.jsx(nk,{initialProgress:r.progress??.1,isSubmitting:t});if(r.type===ao.FUNCTION&&ao.FUNCTION in r&&hc.has(r.function.name))return c.jsx(mk,{initialProgress:r.progress??.1,args:r.function.arguments});if(r.type===ao.FUNCTION&&ao.FUNCTION in r)return Wo(r)?t&&a?c.jsx(DC,{children:c.jsx(pk,{text:"",isCreatedByUser:s,showCursor:a})}):null:c.jsx(uk,{initialProgress:r.progress??.1,isSubmitting:t,args:r.function.arguments,name:r.function.name,output:r.function.output})}else if(e.type===to.IMAGE_FILE){const t=e[to.IMAGE_FILE],n=t.height??1920,a=t.width??1080;return c.jsx(kN,{imagePath:t.filepath,height:n,width:a,altText:t.filename??"Uploaded Image",placeholderDimensions:{height:n+"px",width:a+"px"}})}return null})),fk=({message:e})=>{const t=I(_p.enableUserMsgMarkdown),{messageId:a}=e;return Array.isArray(e.content)&&e.content.length>0?c.jsxs(c.Fragment,{children:[e.content.filter((e=>e)).map(((t,n)=>t?c.jsx(gk,{showCursor:!1,isSubmitting:!1,isCreatedByUser:e.isCreatedByUser,messageId:e.messageId,part:t},`display-${a}-${n}`):null)),!0===e.unfinished&&c.jsx(n.Suspense,{children:c.jsx(J_,{delay:250,children:c.jsx(VC,{message:e},`unfinished-${a}`)})})]}):c.jsx("div",{className:rm("markdown prose dark:prose-invert light w-full break-words",e.isCreatedByUser&&!t&&"whitespace-pre-wrap",e.isCreatedByUser?"dark:text-gray-20":"dark:text-gray-70"),dir:"auto",children:c.jsx(LC,{content:e.text||""})})};function xk({siblingIdx:e,siblingCount:t,setSiblingIdx:n}){if(void 0===e)return null;if(void 0===t)return null;return t>1?c.jsxs("div",{className:"visible flex items-center justify-center gap-1 self-center pt-0 text-xs",children:[c.jsx("button",{className:rm("hover-button rounded-md p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible"),type:"button",onClick:()=>{n&&n(e-1)},disabled:0==e,children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"15 18 9 12 15 6"})})}),c.jsxs("span",{className:"flex-shrink-0 flex-grow tabular-nums",children:[e+1," / ",t]}),c.jsx("button",{className:rm("hover-button rounded-md p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible"),type:"button",onClick:()=>{n&&n(e+1)},disabled:e==t-1,children:c.jsx("svg",{stroke:"currentColor",fill:"none",strokeWidth:"1.5",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}):null}function hk(e){var t;let n="";for(let a=0;a<e.length;a++){n+=eo(`${(null==(t=e[a])?void 0:t.inputStr)??e[a]}`),e.length>1&&a!==e.length-1&&(n+=",\n")}return n}const vk=n.memo((({plugin:e})=>{const{isSharedConvo:t}=n.useContext(Xh),{data:a={}}=Mp({enabled:!t,select:e=>{var t;return null==(t=null==e?void 0:e.gptPlugins)?void 0:t.plugins}}),s=n.useCallback((e=>e?"n/a"===e||"self reflection"===e?e:a[e]??"self reflection":null),[a]);if(!e||!e.latest)return null;const r=s(e.latest);if(!r||r&&"n/a"===r)return null;return c.jsx("div",{className:"my-2 flex flex-col items-start",children:c.jsx(Tr,{children:({open:t})=>{const n={className:rm(t?"rotate-180 transform":"","h-4 w-4")};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:rm(e.loading?"bg-green-100":"bg-gray-20","my-1 flex items-center rounded p-3 text-xs text-gray-800"),children:[c.jsx("div",{children:c.jsx("div",{className:"flex items-center gap-3",children:c.jsx("div",{children:e.loading||"self reflection"!==r?"self reflection"===r?"I'm  thinking...":c.jsxs(c.Fragment,{children:[e.loading?"Using":"Used"," ",c.jsx("b",{children:r}),e.loading?"...":""]}):"Finished"})})}),e.loading&&c.jsx(Hb,{className:"ml-1 text-black"}),c.jsx(Rr,{className:"ml-12 flex items-center gap-2",children:c.jsx(vt,{...n})})]}),c.jsxs(Ir,{className:"mt-3 flex max-w-full flex-col gap-3",children:[c.jsx(LN,{lang:r?`REQUEST TO ${r.toUpperCase()}`:"REQUEST",codeChildren:hk(e.inputs??[]),plugin:!0,classProp:"max-h-[450px]"}),e.outputs&&e.outputs.length>0&&c.jsx(LN,{lang:r?`RESPONSE FROM ${r.toUpperCase()}`:"RESPONSE",codeChildren:eo(e.outputs??""),plugin:!0,classProp:"max-h-[450px]"})]})]})}})})}));function bk({children:e,classes:t="",onClick:n}){return c.jsx("div",{className:rm("mt-1 flex justify-start gap-3 empty:hidden lg:flex",t),onClick:n,children:e})}function yk(e){var t,a;const{message:s,conversation:r,assistant:o,agent:i}=e,l=o?o.name:"",d=o?null==(t=o.metadata)?void 0:t.avatar:"",u=i?i.name:"",m=i?null==(a=i.metadata)?void 0:a.avatar:"",p=n.useMemo((()=>({...r??{},...{...s,iconURL:(null==s?void 0:s.iconURL)??""}})),[r,s]),g=p.iconURL??"";let f=p.endpoint;return f=Zu({endpointsConfig:void 0,iconURL:g,endpoint:f}),!0!==(null==s?void 0:s.isCreatedByUser)&&g&&g.includes("http")?c.jsx(pw,{iconURL:g,modelLabel:p.chatGptLabel??p.modelLabel??"",context:"message",assistantAvatar:d,assistantName:l,agentAvatar:m,agentName:u}):!0===(null==s?void 0:s.isCreatedByUser)?c.jsx("div",{style:{backgroundColor:"rgb(121, 137, 255)",width:"20px",height:"20px",boxShadow:"rgba(240, 246, 252, 0.1) 0px 0px 0px 1px"},className:"relative flex h-9 w-9 items-center justify-center rounded-sm p-1 text-white",children:c.jsx(jy,{})}):c.jsx(aw,{...p,endpoint:f,iconURL:null==o?void 0:d,model:(null==s?void 0:s.model)??(null==r?void 0:r.model),assistantName:l,agentName:u,size:28.8})}function _k(e){const t=I(_p.fontSize),{message:n,siblingIdx:a,siblingCount:s,conversation:r,setSiblingIdx:o,currentEditId:i,setCurrentEditId:l}=e;if(!n)return null;const{text:d="",children:u,error:m=!1,messageId:p="",unfinished:g=!1,isCreatedByUser:f=!0}=n;let x="";return x=f?"anonymous":n.sender??"",c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-token-text-primary w-full border-0 bg-transparent dark:border-0 dark:bg-transparent",children:c.jsx("div",{className:"m-auto justify-center p-4 py-2 md:gap-6 ",children:c.jsxs("div",{className:"final-completion group mx-auto flex flex-1 gap-3 md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5",children:[c.jsx("div",{className:"relative flex flex-shrink-0 flex-col items-end",children:c.jsx("div",{children:c.jsx("div",{className:"pt-0.5",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(yk,{message:n,conversation:r})})})})}),c.jsxs("div",{className:rm("relative flex w-11/12 flex-col",f?"":"agent-turn"),children:[c.jsx("div",{className:rm("select-none font-semibold",t),children:x}),c.jsx("div",{className:"flex-col gap-1 md:gap-3",children:c.jsx("div",{className:"flex max-w-full flex-grow flex-col gap-0",children:c.jsxs(pv.Provider,{value:{messageId:p,conversationId:null==r?void 0:r.conversationId},children:[n.plugin&&c.jsx(vk,{plugin:n.plugin}),n.content?c.jsx(fk,{message:n}):c.jsx(BC,{edit:!1,error:m,isLast:!1,ask:()=>({}),text:d||"",message:n,isSubmitting:!1,enterEdit:()=>({}),unfinished:g,siblingIdx:a??0,isCreatedByUser:f,setSiblingIdx:o??(()=>({}))})]})})}),c.jsxs(bk,{classes:"text-xs",children:[c.jsx(xk,{siblingIdx:a,siblingCount:s,setSiblingIdx:o}),c.jsx(yC,{message:n})]})]})]})})}),c.jsx(jk,{messageId:p,messagesTree:u??[],currentEditId:i,setCurrentEditId:l},p)]})}function jk({messageId:e,messagesTree:t,currentEditId:a,setCurrentEditId:s}){const[r,o]=T(_p.messagesSiblingIdxFamily(e));if(n.useEffect((()=>{o(0)}),[null==t?void 0:t.length]),n.useEffect((()=>{null!=(null==t?void 0:t.length)&&r>=t.length&&o(0)}),[r,null==t?void 0:t.length,o]),!t||!t.length)return null;const i=t[t.length-r-1];return i?c.jsx(_k,{message:i,currentEditId:a,setCurrentEditId:s,siblingIdx:t.length-r-1,siblingCount:t.length,setSiblingIdx:e=>{o(((null==t?void 0:t.length)??0)-e-1)}},i.messageId):null}function wk({messagesTree:e,conversationId:t}){const[a,s]=n.useState(-1);return c.jsx("div",{className:"flex-1 pb-[50px]",children:c.jsx("div",{className:"dark:gpt-dark-gray relative h-full",children:c.jsx("div",{style:{height:"100%",overflowY:"auto",width:"100%"},children:c.jsxs("div",{className:"flex flex-col pb-9 text-sm dark:bg-transparent",children:[e&&0==e.length||null===e?c.jsx("div",{className:"flex w-full items-center justify-center gap-1 bg-gray-50 p-3 text-sm text-gray-500 dark:border-gray-800/50 dark:bg-gray-800 dark:text-gray-300",children:"Nothing found"}):c.jsx(c.Fragment,{children:c.jsx("div",{children:c.jsx(jk,{messagesTree:e,messageId:t??null,setCurrentEditId:s,currentEditId:a??null},t)})}),c.jsx("div",{className:"dark:gpt-dark-gray group h-0 w-full flex-shrink-0 dark:border-gray-800/50"})]})})})})}function Nk({className:e}){var t,a;const{data:s}=Ap(),r=kg(),o=null==(t=null==s?void 0:s.interface)?void 0:t.privacyPolicy,i=null==(a=null==s?void 0:s.interface)?void 0:a.termsOfService,l=null!=(null==o?void 0:o.externalUrl)&&c.jsx("a",{className:"text-text-secondary underline",href:o.externalUrl,target:!0===o.openNewTab?"_blank":void 0,rel:"noreferrer",children:r("com_ui_privacy_policy")}),d=null!=(null==i?void 0:i.externalUrl)&&c.jsx("a",{className:"text-text-secondary underline",href:i.externalUrl,target:!0===i.openNewTab?"_blank":void 0,rel:"noreferrer",children:r("com_ui_terms_of_service")}),u=("string"==typeof(null==s?void 0:s.customFooter)?s.customFooter:"[LibreChat "+dc.VERSION+"](https://librechat.ai) - "+r("com_ui_latest_footer")).split("|");n.useEffect((()=>{if(null!=(null==s?void 0:s.analyticsGtmId)&&void 0===window.google_tag_manager){const e={gtmId:s.analyticsGtmId};F.initialize(e)}}),[null==s?void 0:s.analyticsGtmId]);const m=[...u.map(((e,t)=>c.jsx(_.Fragment,{children:c.jsx(Pt,{components:{a:({node:e,href:t,children:n,...a})=>c.jsx("a",{className:"text-text-secondary underline",href:t,target:"_blank",rel:"noreferrer",...a,children:n}),p:({node:e,...t})=>c.jsx("span",{...t})},children:e.trim()})},`main-content-part-${t}`))),l,d].filter(Boolean);return c.jsx("div",{className:e??"relative flex items-center justify-center gap-2 px-2 py-2 text-center text-xs text-text-primary md:px-[60px]",role:"contentinfo",children:m.map(((e,t)=>{const n=t===m.length-1;return c.jsxs(_.Fragment,{children:[e,!n&&c.jsx("div",{className:"h-2 border-r-[1px] border-border-medium"},`separator-${t}`)]},`footer-element-${t}`)}))})}const Ck=n.memo((function(){const e=kg(),{data:t}=Ap(),{shareId:a}=B(),{data:s,isLoading:r}=oh(a??""),o=s&&im({messages:s.messages}),i=0===(null==o?void 0:o.length)?null:o??null;let l="";var d;let u;return l=null!=(null==t?void 0:t.appTitle)&&null!=(null==s?void 0:s.title)?`${s.title} | ${t.appTitle}`:(null==s?void 0:s.title)??(null==t?void 0:t.appTitle)??document.title,d=l,n.useEffect((()=>{document.title=d}),[d]),u=r?c.jsx("div",{className:"flex h-screen items-center justify-center",children:c.jsx(Hb,{className:""})}):s&&i&&0!==i.length?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"final-completion group mx-auto flex min-w-[40rem] flex-col gap-3 pb-6 pt-4 md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5",children:[c.jsx("h1",{className:"text-4xl font-bold",children:s.title}),c.jsx("div",{className:"border-b border-border-medium pb-6 text-base text-text-secondary",children:new Date(s.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),c.jsx(wk,{messagesTree:i,conversationId:s.conversationId})]}):c.jsx("div",{className:"flex h-screen items-center justify-center ",children:e("com_ui_shared_link_not_found")}),c.jsx(Xh.Provider,{value:{isSharedConvo:!0},children:c.jsx("main",{className:"relative flex w-full grow overflow-hidden dark:bg-surface-secondary",style:{paddingBottom:"50px"},children:c.jsx("div",{className:"transition-width relative flex h-full w-full flex-1 flex-col items-stretch overflow-hidden pt-0 dark:bg-surface-secondary",children:c.jsxs("div",{className:"flex h-full flex-col text-text-primary",role:"presentation",children:[u,c.jsx("div",{className:"w-full border-t-0 pl-0 pt-2 md:w-[calc(100%-.5rem)] md:border-t-0 md:border-transparent md:pl-0 md:pt-0 md:dark:border-transparent",children:c.jsx(Nk,{className:"fixed bottom-0 left-0 right-0 z-50 flex items-center justify-center gap-2 bg-gradient-to-t from-surface-secondary to-transparent px-2 pb-2 pt-8 text-xs text-text-secondary md:px-[60px]"})})]})})})})}));function kk(){return c.jsx(Ck,{})}function Sk({scrollHandler:e}){return c.jsx("button",{onClick:e,className:"absolute bottom-5 right-1/2 cursor-pointer rounded-full border border-gray-200 bg-white bg-clip-padding text-gray-600 dark:border-white/10 dark:bg-gray-850/90 dark:text-gray-200","aria-label":"Scroll to bottom",children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",className:"m-1 text-black dark:text-white",children:c.jsx("path",{d:"M17 13L12 18L7 13M12 6L12 17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})}const Tk=({text:e,index:t,messageId:a,isSubmitting:s,enterEdit:r})=>{const o=kg(),{addedIndex:i}=rv(),{getMessages:l,setMessages:d,conversation:u}=bh(),[m,p]=T(_p.latestMessageFamily(i)),{conversationId:g=""}=u??{},f=n.useMemo((()=>{var e;return null==(e=l())?void 0:e.find((e=>e.messageId===a))}),[l,a]),x=n.useRef(null),h=(v=g??"",b=ar(),sr((function(e){return function(e){var t=e.conversationId,n=e.messageId,a=e.index,s=e.text;if(!t)throw new Error("conversationId is required");return nh.put(Wx(t,n),{text:s,index:a})}(e)}),{onSuccess:function(){b.invalidateQueries([ah.messages,v])}}));var v,b;const y="rtl"===I(_p.chatDirection).toLowerCase(),{register:_,handleSubmit:j,setValue:w}=ne({defaultValues:{text:e??""}});n.useEffect((()=>{const e=x.current;if(e){const t=e.value.length;e.focus(),e.setSelectionRange(t,t)}}),[]);const N=n.useCallback((e=>{"Escape"===e.key&&(e.preventDefault(),r(!0))}),[r]),{ref:C,...k}=_("text",{required:!0,onChange:e=>{w("text",e.target.value,{shouldValidate:!0})}});return c.jsxs(DC,{message:f,children:[c.jsx("div",{className:"bg-token-main-surface-primary relative flex w-full flex-grow flex-col overflow-hidden rounded-2xl border border-border-medium text-text-primary [&:has(textarea:focus)]:border-border-heavy [&:has(textarea:focus)]:shadow-[0_2px_6px_rgba(0,0,0,.05)]",children:c.jsx(F_,{...k,ref:e=>{C(e),x.current=e},onKeyDown:N,"data-testid":"message-text-editor",className:rm("markdown prose dark:prose-invert light whitespace-pre-wrap break-words pl-3 md:pl-4","m-0 w-full resize-none border-0 bg-transparent py-[10px]","placeholder-text-secondary focus:ring-0 focus-visible:ring-0 md:py-3.5",y?"text-right":"text-left","max-h-[65vh] pr-3 md:max-h-[75vh] md:pr-4",pm),dir:y?"rtl":"ltr"})}),c.jsxs("div",{className:"mt-2 flex w-full justify-center text-center",children:[c.jsx("button",{className:"btn btn-secondary relative mr-2",disabled:s,onClick:j((e=>{var n;const s=l();if(!s)return;h.mutate({index:t,conversationId:g??"",text:e.text,messageId:a}),a===(null==m?void 0:m.messageId)&&p({...m,text:e.text});if(!s.some((e=>e.messageId===a)))return r(!0);const o=null==(n=null==f?void 0:f.content)?void 0:n.map(((n,a)=>n.type===to.TEXT&&a===t?{...n,text:e.text}:n));d(s.map((e=>e.messageId===a?{...e,content:o}:e))),r(!0)})),children:o("com_ui_save")}),c.jsx("button",{className:"btn btn-neutral relative",onClick:()=>r(!0),children:o("com_ui_cancel")})]})]})},Rk=n.memo((({content:e,messageId:t,conversationId:a,attachments:s,isCreatedByUser:r,isLast:o,isSubmitting:i,edit:l,enterEdit:d,siblingIdx:u,setSiblingIdx:m})=>{const p=kg(),[g,f]=T(_p.showThinking),[x,h]=n.useState(g),v=I(_p.messageAttachmentsMap),b=n.useMemo((()=>function(e){const t={};for(const n of e){if(null==n)continue;const e=n.toolCallId||"";0!==e.length&&(t[e]||(t[e]=[]),t[e].push(n))}return t}(s??v[t]??[])),[s,v,t]),y=n.useMemo((()=>{const t=(null==e?void 0:e.some((e=>(null==e?void 0:e.type)===to.THINK)))??!1,n=(null==e?void 0:e.every((e=>{if((null==e?void 0:e.type)!==to.THINK)return!0;if("string"==typeof e.think){return e.think.replace(/<\/?think>/g,"").trim().length>0}return!1})))??!1;return t&&n}),[e]);return e?!0===l&&d&&m?c.jsx(c.Fragment,{children:e.map(((e,n)=>(null==e?void 0:e.type)!==to.TEXT||"string"!=typeof e.text?null:c.jsx(Tk,{index:n,text:e.text,messageId:t,isSubmitting:i,enterEdit:d,siblingIdx:u??null,setSiblingIdx:m},`edit-${t}-${n}`)))}):c.jsxs(c.Fragment,{children:[y&&c.jsx("div",{className:"mb-5",children:c.jsx(IC,{isExpanded:x,onClick:()=>h((e=>{const t=!e;return f(t),t})),label:p(i?"com_ui_thinking":"com_ui_thoughts")})}),e.filter((e=>e)).map(((n,s)=>{var l,d;const u=(null==(l=null==n?void 0:n[to.TOOL_CALL])?void 0:l.id)??"",m=b[u];return c.jsx(pv.Provider,{value:{messageId:t,conversationId:a,partIndex:s,isExpanded:x,nextType:null==(d=e[s+1])?void 0:d.type},children:c.jsx(gk,{part:n,attachments:m,isSubmitting:i,isCreatedByUser:r,showCursor:s===e.length-1&&o},`part-${t}-${s}`)},`provider-${t}-${s}`)}))]}):null})),Ik=n.memo((({isCard:e})=>e?c.jsx("div",{className:"mt-1 h-[27px] bg-transparent"}):null)),Ek={[mc.DIRECT_PATH]:"com_ui_fork_visible",[mc.INCLUDE_BRANCHES]:"com_ui_fork_branches",[mc.TARGET_LEVEL]:"com_ui_fork_all_target",[mc.DEFAULT]:"com_ui_fork_from_message"},Pk=({children:e,setting:t,onClick:n,setActiveSetting:a,sideOffset:s=30,timeoutRef:r,hoverInfo:o,hoverTitle:i,hoverDescription:l})=>c.jsxs(l_,{openDelay:200,children:[c.jsx(Fs,{onClick:()=>n(t),onMouseEnter:()=>{r.current&&(clearTimeout(r.current),r.current=null),a(Ek[t])},onMouseLeave:()=>{r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{a(Ek[mc.DEFAULT])}),175)},className:"mx-1 max-w-14 flex-1 rounded-lg border-2 bg-white text-gray-700 transition duration-300 ease-in-out hover:bg-gray-200 hover:text-gray-900 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600 dark:hover:text-gray-100",type:"button",children:e}),(null!=o&&""!==o||null!=i&&""!==i||null!=l&&""!==l)&&c.jsx(d_,{children:c.jsx(u_,{side:"right",className:"z-[999] w-80 dark:bg-gray-700",sideOffset:s,children:c.jsx("div",{className:"space-y-2",children:c.jsxs("p",{className:"flex flex-col gap-2 text-sm text-gray-600 dark:text-gray-300",children:[o&&o,i&&c.jsx("span",{className:"flex flex-wrap gap-1 font-bold",children:i}),l&&l]})})})})]});function Lk({isLast:e=!1,messageId:t,conversationId:a,forkingSupported:s=!1,latestMessageId:r}){const o=kg(),{showToast:i}=Ng(),[l,d]=n.useState(!1),{navigateToConvo:u}=Iv(),m=n.useRef(null),[p,g]=T(_p.forkSetting),[f,x]=n.useState(Ek.default),[h,v]=T(_p.splitAtTarget),[b,y]=T(_p.rememberDefaultFork),_=cg({onSuccess:e=>{u(e.conversation),i({message:o("com_ui_fork_success"),status:"success"})},onMutate:()=>{i({message:o("com_ui_fork_processing"),status:"info"})},onError:()=>{i({message:o("com_ui_fork_error"),status:"error"})}}),j=a??"";if(!s||!j||!t)return null;const w=e=>{l&&(y(!0),g(e)),_.mutate({messageId:t,conversationId:j,option:e,splitAtTarget:h,latestMessageId:r})};return c.jsxs(Ms,{children:[c.jsx(As,{asChild:!0,children:c.jsx("button",{className:rm("hover-button active rounded-md p-1 text-gray-500 hover:bg-gray-100 hover:text-gray-500 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:invisible md:group-hover:visible ","data-[state=open]:active focus:opacity-100 data-[state=open]:bg-gray-100 data-[state=open]:text-gray-500 data-[state=open]:dark:bg-gray-700  data-[state=open]:dark:text-gray-200",e?"":"data-[state=open]:opacity-100 md:opacity-0 md:group-hover:opacity-100"),onClick:e=>{b&&(e.preventDefault(),_.mutate({messageId:t,splitAtTarget:h,conversationId:j,option:p,latestMessageId:r}))},type:"button",title:o("com_ui_fork"),children:c.jsx(Jt,{className:"h-4 w-4 hover:text-gray-500 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400"})})}),c.jsx(Os,{children:c.jsx("div",{dir:"ltr",children:c.jsxs(Ds,{side:"top",role:"menu",className:"bg-token-surface-primary flex min-h-[120px] min-w-[215px] flex-col gap-3 overflow-hidden rounded-lg bg-white p-2 px-3 shadow-lg dark:bg-gray-700",style:{outline:"none",pointerEvents:"auto",boxSizing:"border-box"},tabIndex:-1,sideOffset:5,align:"center",children:[c.jsxs("div",{className:"flex h-6 w-full items-center justify-center text-sm dark:text-gray-200",children:[o(f),c.jsxs(l_,{openDelay:50,children:[c.jsx(c_,{asChild:!0,children:c.jsx(Ct,{className:"ml-auto flex h-4 w-4 gap-2 text-gray-500 dark:text-white/50"})}),c.jsx(d_,{children:c.jsx(u_,{side:"right",className:"z-[999] w-80 dark:bg-gray-700",sideOffset:19,children:c.jsxs("div",{className:"flex flex-col gap-2 space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[c.jsx("span",{children:o("com_ui_fork_info_1")}),c.jsx("span",{children:o("com_ui_fork_info_2")}),c.jsx("span",{children:o("com_ui_fork_info_3",{0:o("com_ui_fork_split_target")})})]})})})]})]}),c.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-1",children:[c.jsx(Pk,{sideOffset:155,setActiveSetting:x,timeoutRef:m,onClick:w,setting:mc.DIRECT_PATH,hoverTitle:c.jsxs(c.Fragment,{children:[c.jsx(Xt,{className:"h-5 w-5 rotate-90"}),o(Ek[mc.DIRECT_PATH])]}),hoverDescription:o("com_ui_fork_info_visible"),children:c.jsx(c_,{asChild:!0,children:c.jsx(Xt,{className:"h-full w-full rotate-90 p-2"})})}),c.jsx(Pk,{sideOffset:90,setActiveSetting:x,timeoutRef:m,onClick:w,setting:mc.INCLUDE_BRANCHES,hoverTitle:c.jsxs(c.Fragment,{children:[c.jsx(en,{className:"h-4 w-4 rotate-180"}),o(Ek[mc.INCLUDE_BRANCHES])]}),hoverDescription:o("com_ui_fork_info_branches"),children:c.jsx(c_,{asChild:!0,children:c.jsx(en,{className:"h-full w-full rotate-180 p-2"})})}),c.jsx(Pk,{sideOffset:25,setActiveSetting:x,timeoutRef:m,onClick:w,setting:mc.TARGET_LEVEL,hoverTitle:c.jsxs(c.Fragment,{children:[c.jsx(tn,{className:"h-5 w-5"}),`${o(Ek[mc.TARGET_LEVEL])} (${o("com_endpoint_default")})`]}),hoverDescription:o("com_ui_fork_info_target"),children:c.jsx(c_,{asChild:!0,children:c.jsx(tn,{className:"h-full w-full p-2"})})})]}),c.jsxs(l_,{openDelay:50,children:[c.jsx(c_,{asChild:!0,children:c.jsxs("div",{className:"flex h-6 w-full items-center justify-start text-sm dark:text-gray-300 dark:hover:text-gray-200",children:[c.jsx($y,{checked:h,onCheckedChange:e=>v(e),className:"m-2 transition duration-300 ease-in-out"}),o("com_ui_fork_split_target")]})}),c.jsx(jw,{side:Kr.Right,description:"com_ui_fork_info_start",langCode:!0,sideOffset:20})]}),c.jsxs(l_,{openDelay:50,children:[c.jsx(c_,{asChild:!0,children:c.jsxs("div",{className:"flex h-6 w-full items-center justify-start text-sm dark:text-gray-300 dark:hover:text-gray-200",children:[c.jsx($y,{checked:l,onCheckedChange:e=>{e&&i({message:o("com_ui_fork_remember_checked"),status:"info"}),d(e)},className:"m-2 transition duration-300 ease-in-out"}),o("com_ui_fork_remember")]})}),c.jsx(jw,{side:Kr.Right,description:"com_ui_fork_info_remember",langCode:!0,sideOffset:20})]})]})})})]})}function Mk({conversationId:e,retainView:t,title:a}){const s=kg(),r=D(),o=ar(),{newConversation:i}=Qh(),{conversationId:l}=B(),d=lg({onSuccess:()=>{l!==e&&"new"!==l||(i(),r("/c/new",{replace:!0})),t()}}),u=n.useCallback((()=>{var t,n;const a=o.getQueryData([Xc.messages,e]),s=null==(t=null==a?void 0:a[a.length-1])?void 0:t.thread_id,r=null==(n=null==a?void 0:a[a.length-1])?void 0:n.endpoint;d.mutate({conversationId:e,thread_id:s,endpoint:r,source:"button"})}),[e,d,o]);return c.jsx(ij,{showCloseButton:!1,title:s("com_ui_delete_conversation"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsxs(g_,{htmlFor:"dialog-confirm-delete",className:"text-left text-sm font-medium",children:[s("com_ui_delete_confirm")," ",c.jsx("strong",{children:a})]})})})}),selection:{selectHandler:u,selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 text-white",selectText:s("com_ui_delete")}})}function Ak({conversationId:e,retainView:t,title:n,showDeleteDialog:a,setShowDeleteDialog:s,triggerRef:r}){return void 0===a&&void 0===s?null:e?c.jsx(f_,{open:a,onOpenChange:s,triggerRef:r,children:c.jsx(Mk,{conversationId:e,retainView:t,title:n})}):null}function Ok({share:e,conversationId:t,setShareDialogOpen:a,showQR:s,setShowQR:r,setSharedLink:o}){const i=kg(),{showToast:l}=Ng(),[d,u]=n.useState(!1),m=(null==e?void 0:e.shareId)??"",{mutateAsync:p,isLoading:g}=ag({onError:()=>{l({message:i("com_ui_share_error"),severity:Wr.ERROR,showIcon:!0})}}),{mutateAsync:f,isLoading:x}=sg({onError:()=>{l({message:i("com_ui_share_error"),severity:Wr.ERROR,showIcon:!0})}}),h=rg({onSuccess:async()=>{u(!1),a(!1)}}),v=n.useCallback((e=>`${window.location.protocol}//${window.location.host}/share/${e}`),[]);return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"flex gap-2",children:[!m&&c.jsxs(By,{disabled:g,variant:"submit",onClick:async()=>{const e=await p({conversationId:t}),n=v(e.shareId);o(n)},children:[!g&&i("com_ui_create_link"),g&&c.jsx(Hb,{className:"size-4"})]}),m&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(z_,{description:i("com_ui_refresh_link"),render:e=>c.jsx(By,{...e,onClick:()=>(async()=>{if(!m)return;const e=await f({shareId:m}),t=v(e.shareId);o(t)})(),variant:"outline",disabled:x,children:x?c.jsx(Hb,{className:"size-4"}):c.jsx(nn,{className:"size-4"})})}),c.jsx(z_,{description:i(s?"com_ui_hide_qr":"com_ui_show_qr"),render:e=>c.jsx(By,{...e,onClick:()=>r(!s),variant:"outline",children:c.jsx(an,{className:"size-4"})})}),c.jsx(z_,{description:i("com_ui_delete"),render:e=>c.jsx(By,{...e,onClick:()=>u(!0),variant:"destructive",children:c.jsx(Gt,{className:"size-4"})})})]}),c.jsx(f_,{open:d,onOpenChange:u,children:c.jsx(ij,{showCloseButton:!1,title:i("com_ui_delete_shared_link"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsxs(g_,{htmlFor:"dialog-confirm-delete",className:"text-left text-sm font-medium",children:[i("com_ui_delete_confirm")," ",c.jsxs("strong",{children:['"',m,'"']})]})})})}),selection:{selectHandler:async()=>{if(m)try{await h.mutateAsync({shareId:m}),l({message:i("com_ui_shared_link_delete_success"),severity:Wr.SUCCESS})}catch(e){console.error("Failed to delete shared link:",e),l({message:i("com_ui_share_delete_error"),severity:Wr.ERROR})}},selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 text-white",selectText:i("com_ui_delete")}})})]})})}function Dk({conversationId:e,open:t,onOpenChange:a,triggerRef:s,children:r}){const o=kg(),[i,l]=n.useState(!1),[d,u]=n.useState(""),[m,p]=n.useState(!1),{data:g,isLoading:f}=ih(e),x=cb({text:d});n.useEffect((()=>{if(void 0!==(null==g?void 0:g.shareId)){const e=`${window.location.protocol}//${window.location.host}/share/${g.shareId}`;u(e)}}),[g]);const h=!0===f?null:c.jsx(Ok,{share:g,conversationId:e,setShareDialogOpen:a,showQR:i,setShowQR:l,setSharedLink:u}),v=(null==g?void 0:g.shareId)??"";return c.jsxs(f_,{open:t,onOpenChange:a,triggerRef:s,children:[r,c.jsx(ij,{buttons:h,showCloseButton:!0,showCancelButton:!1,title:o("com_ui_share_link_to_chat"),className:"max-w-[550px]",main:c.jsxs("div",{children:[c.jsx("div",{className:"h-full py-2 text-text-primary",children:!0===f?c.jsx(Hb,{className:"m-auto h-14 animate-spin"}):!0===(null==g?void 0:g.success)?o("com_ui_share_update_message"):o("com_ui_share_create_message")}),c.jsxs("div",{className:"relative items-center rounded-lg p-2",children:[i&&c.jsx("div",{className:"mb-4 flex flex-col items-center",children:c.jsx(sn,{value:d,size:200,marginSize:2,className:"rounded-2xl"})}),v&&c.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-surface-secondary p-2",children:[c.jsx("div",{className:"flex-1 break-all text-sm text-text-secondary",children:d}),c.jsx(By,{size:"sm",variant:"outline",onClick:()=>{m||x(p)},className:rm("shrink-0",m?"cursor-default":""),children:m?c.jsx(rn,{className:"size-4"}):c.jsx(on,{className:"size-4"})})]})]})]})})]})}const Fk=n.memo((function({conversationId:e,title:t,retainView:a,renameHandler:s,isPopoverActive:r,setIsPopoverActive:o,isActiveConvo:i}){const l=kg(),{index:d}=bh(),{data:u}=Ap(),m=function(e,t,n){const a=kg(),s=D(),{showToast:r}=Ng(),{newConversation:o}=Qh(),{conversationId:i}=B(),l=tg(e??"");return async c=>{c&&c.preventDefault();const d=e??"";d&&l.mutate({conversationId:d,isArchived:t},{onSuccess:()=>{i!==d&&"new"!==i||(o(),s("/c/new",{replace:!0})),n()},onError:()=>{r({message:a("com_ui_archive_error"),severity:Wr.ERROR,showIcon:!0})}})}}(e,!0,a),{navigateToConvo:p}=Iv(d),{showToast:g}=Ng(),f=n.useRef(null),x=n.useRef(null),[h,v]=n.useState(!1),[b,y]=n.useState(!1),_=(e=>{const t=ar(),{onSuccess:n,...a}=e??{};return sr((e=>zd.duplicateConversation(e)),{onSuccess:(e,a,s)=>{0!==(a.conversationId??"").length&&(t.setQueryData([Xc.conversation,e.conversation.conversationId],e.conversation),t.setQueryData([Xc.allConversations],(t=>t?_u(t,e.conversation):t)),t.setQueryData([Xc.messages,e.conversation.conversationId],e.messages),null==n||n(e,a,s))},...a})})({onSuccess:e=>{p(e.conversation),g({message:l("com_ui_duplication_success"),status:"success"})},onMutate:()=>{g({message:l("com_ui_duplication_processing"),status:"info"})},onError:()=>{g({message:l("com_ui_duplication_error"),status:"error"})}}),j=[{label:l("com_ui_share"),onClick:()=>{v(!0)},icon:c.jsx(lt,{className:"icon-sm mr-2 text-text-primary"}),show:u&&u.sharedLinksEnabled,hideOnClick:!1,ref:f,render:e=>c.jsx("button",{...e})},{label:l("com_ui_rename"),onClick:s,icon:c.jsx(gt,{className:"icon-sm mr-2 text-text-primary"})},{label:l("com_ui_duplicate"),onClick:()=>{o(!1),_.mutate({conversationId:e??""})},icon:c.jsx(on,{className:"icon-sm mr-2 text-text-primary"})},{label:l("com_ui_archive"),onClick:m,icon:c.jsx(ln,{className:"icon-sm mr-2 text-text-primary"})},{label:l("com_ui_delete"),onClick:()=>{y(!0)},icon:c.jsx(cn,{className:"icon-sm mr-2 text-text-primary"}),hideOnClick:!1,ref:x,render:e=>c.jsx("button",{...e})}],w=n.useId();return c.jsxs(c.Fragment,{children:[c.jsx(Y_,{isOpen:r,setIsOpen:o,trigger:c.jsx(dt,{id:`conversation-menu-${e}`,"aria-label":l("com_nav_convo_menu_options"),className:rm("z-30 inline-flex h-7 w-7 items-center justify-center gap-2 rounded-md border-none p-0 text-sm font-medium ring-ring-primary transition-all duration-200 ease-in-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",!0===i?"opacity-100":"opacity-0 focus:opacity-100 group-focus-within:opacity-100 group-hover:opacity-100 data-[open]:opacity-100"),children:c.jsx(dn,{className:"icon-md text-text-secondary","aria-hidden":!0})}),items:j,menuId:w}),h&&c.jsx(Dk,{conversationId:e??"",open:h,onOpenChange:v,triggerRef:f}),b&&c.jsx(Ak,{title:t??"",retainView:a,conversationId:e??"",showDeleteDialog:b,setShowDeleteDialog:y,triggerRef:x})]})}));function zk({conversation:e,retainView:t,toggleNav:a,isLatestConvo:s}){const r=B(),o=n.useMemo((()=>r.conversationId),[r.conversationId]),i=(e=>{const t=ar();return sr((e=>zd.updateConversation(e)),{onSuccess:n=>{t.setQueryData([Xc.conversation,e],n),t.setQueryData([Xc.allConversations],(e=>e?wu(e,n):e))}})})(o??""),l=I(_p.allConversationsSelector),{data:d}=Mp(),{navigateWithLastTools:u}=Iv(),{showToast:m}=Ng(),{conversationId:p,title:g}=e,f=n.useRef(null),[x,h]=n.useState(g),[v,b]=n.useState(!1),[y,_]=n.useState(!1),j=Ib("(max-width: 768px)"),w=kg(),N=n.useCallback((()=>{_(!1),h(g),b(!0)}),[g]);n.useEffect((()=>{v&&f.current&&f.current.focus()}),[v]);const C=n.useCallback((e=>{e.preventDefault(),b(!1),x!==g&&"string"==typeof p&&""!==p&&i.mutate({conversationId:p,title:x??""},{onError:()=>{h(g),m({message:"Failed to rename conversation",severity:Wr.ERROR,showIcon:!0})}})}),[g,x,p,m,i]),k=n.useCallback((e=>{"Escape"===e.key?(h(g),b(!1)):"Enter"===e.key&&C(e)}),[g,C]),S=n.useCallback((e=>{e.preventDefault(),h(g),b(!1)}),[g]),T=n.useMemo((()=>o===p||s&&"new"===o&&null!=l[0]&&"new"!==l[0]),[o,p,s,l]);return c.jsxs("div",{className:rm("group relative mt-2 flex h-9 w-full items-center rounded-lg hover:bg-surface-active-alt",T?"bg-surface-active-alt":"",j?"h-12":""),children:[v?c.jsxs("div",{className:"absolute inset-0 z-20 flex w-full items-center rounded-lg bg-surface-active-alt p-1.5",children:[c.jsx("input",{ref:f,type:"text",className:"w-full rounded bg-transparent p-0.5 text-sm leading-tight focus-visible:outline-none",value:x??"",onChange:e=>h(e.target.value),onKeyDown:k,"aria-label":`${w("com_ui_rename")} ${w("com_ui_chat")}`}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:S,"aria-label":`${w("com_ui_cancel")} ${w("com_ui_rename")}`,children:c.jsx(ve,{"aria-hidden":!0,className:"h-4 w-4 transition-colors duration-200 ease-in-out hover:opacity-70"})}),c.jsx("button",{onClick:C,"aria-label":`${w("com_ui_submit")} ${w("com_ui_rename")}`,children:c.jsx(xe,{"aria-hidden":!0,className:"h-4 w-4 transition-colors duration-200 ease-in-out hover:opacity-70"})})]})]}):c.jsxs("a",{href:`/c/${p}`,"data-testid":"convo-item",onClick:async t=>{0!==t.button||!t.ctrlKey&&!t.metaKey?(t.preventDefault(),o===p||y||(a(),"string"==typeof g&&g.length>0&&(document.title=g),u(e,!p||p===dc.NEW_CONVO))):a()},className:rm("flex grow cursor-pointer items-center gap-2 overflow-hidden whitespace-nowrap break-all rounded-lg px-2 py-2",T?"bg-surface-active-alt":""),title:g??"",children:[c.jsx(fw,{conversation:e,endpointsConfig:d,size:20,context:"menu-item"}),c.jsx("div",{className:"relative line-clamp-1 flex-1 grow overflow-hidden",onDoubleClick:e=>{e.preventDefault(),e.stopPropagation(),h(g),b(!0)},children:g}),T?c.jsx("div",{className:"absolute bottom-0 right-0 top-0 w-20 rounded-r-lg bg-gradient-to-l"}):c.jsx("div",{className:"absolute bottom-0 right-0 top-0 w-20 rounded-r-lg bg-gradient-to-l from-surface-primary-alt from-0% to-transparent group-hover:from-surface-active-alt group-hover:from-40%"})]}),c.jsx("div",{className:rm("mr-2",y||T?"flex":"hidden group-focus-within:flex group-hover:flex"),children:!v&&c.jsx(Fk,{title:g,retainView:t,renameHandler:N,isActiveConvo:T,conversationId:p,isPopoverActive:y,setIsPopoverActive:_})})]})}const Uk=n.memo((({conversations:e,moveToTop:t,toggleNav:a})=>{const s=kg(),r=n.useMemo((()=>yu(e)),[e]),o=n.useMemo((()=>{var t;return null==(t=e.find((e=>e&&e.updatedAt&&m(u(e.updatedAt)))))?void 0:t.conversationId}),[e]);return c.jsx("div",{className:"text-token-text-primary flex flex-col gap-2 pb-2 text-sm",children:c.jsx("div",{children:c.jsx("span",{children:r.map((([e,n])=>c.jsxs("div",{children:[c.jsx("div",{className:"text-text-secondary",style:{fontSize:"0.7rem",marginTop:"20px",marginBottom:"5px",paddingLeft:"10px"},children:s(e)||e}),n.map(((n,s)=>c.jsx(zk,{isLatestConvo:n.conversationId===o,conversation:n,retainView:t,toggleNav:a},`${e}-${n.conversationId}-${s}`))),c.jsx("div",{style:{marginTop:"5px",marginBottom:"5px"}})]},e)))})})})}));function Vk({isLast:e,index:t,messageId:a,content:s,className:r}){var o,i;const l=kg(),d=I(_p.playbackRate),{toggleSpeech:u,isSpeaking:m,audioRef:p}=Ig({isLast:e,index:t,content:s});return n.useEffect((()=>{const e=document.getElementById(`audio-${a}`);e&&null!=d&&d>0&&e.playbackRate!==d&&(e.playbackRate=d)}),[p,m,d,a]),om.log("MessageAudio: audioRef.current?.src, audioRef.current",null==(o=p.current)?void 0:o.src,p.current),c.jsxs(c.Fragment,{children:[c.jsx("button",{className:r,onClickCapture:()=>{p.current&&(p.current.muted=!1),u()},type:"button",title:l(!0===m?"com_ui_stop":"com_ui_read_aloud"),children:(g="19",!0===m?c.jsx(_y,{size:g}):c.jsx(yy,{size:g}))}),c.jsx("audio",{ref:p,controls:!0,preload:"none",controlsList:"nodownload nofullscreen noremoteplayback",style:{position:"absolute",overflow:"hidden",display:"none",height:"0px",width:"0px"},src:null==(i=p.current)?void 0:i.src,onError:e=>{om.error("Error fetching audio:",e)},id:`audio-${a}`,autoPlay:!0})]});var g}function Bk({isLast:e,index:t,messageId:a,content:s,className:r}){var o,i;const l=kg(),d=I(_p.playbackRate),u=n.useMemo((()=>"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported("audio/mpeg")),[]),{showToast:m}=Ng(),{toggleSpeech:p,isSpeaking:g,audioRef:f}=Eg({isLast:e,index:t,content:s});return n.useEffect((()=>{const e=document.getElementById(`audio-${a}`);e&&null!=d&&d>0&&e.playbackRate!==d&&(e.playbackRate=d)}),[f,g,d,a]),om.log("MessageAudio: audioRef.current?.src, audioRef.current",null==(o=f.current)?void 0:o.src,f.current),c.jsxs(c.Fragment,{children:[c.jsx("button",{className:r,onClickCapture:()=>{u?(f.current&&(f.current.muted=!1),p()):m({message:l("com_nav_tts_unsupported_error"),status:"error"})},type:"button",title:l(!0===g?"com_ui_stop":"com_ui_read_aloud"),children:(x="19",!0===g?c.jsx(_y,{size:x}):c.jsx(yy,{size:x}))}),u?c.jsx("audio",{ref:f,controls:!0,preload:"none",controlsList:"nodownload nofullscreen noremoteplayback",style:{position:"absolute",overflow:"hidden",display:"none",height:"0px",width:"0px"},src:null==(i=f.current)?void 0:i.src,onError:e=>{om.error("Error fetching audio:",e)},id:`audio-${a}`,autoPlay:!0}):null]});var x}function $k({isLast:e,index:t,messageId:a,content:s,className:r}){var o,i;const l=kg(),d=I(_p.playbackRate),{toggleSpeech:u,isSpeaking:m,isLoading:p,audioRef:g}=Rg({isLast:e,index:t,messageId:a,content:s});return n.useEffect((()=>{const e=document.getElementById(`audio-${a}`);e&&null!=d&&d>0&&e.playbackRate!==d&&(e.playbackRate=d)}),[g,m,d,a]),om.log("MessageAudio: audioRef.current?.src, audioRef.current",null==(o=g.current)?void 0:o.src,g.current),c.jsxs(c.Fragment,{children:[c.jsx("button",{className:r,onClickCapture:()=>{g.current&&(g.current.muted=!1),u()},type:"button",title:l(!0===m?"com_ui_stop":"com_ui_read_aloud"),children:(f="19",!0===p?c.jsx(Hb,{size:f}):!0===m?c.jsx(_y,{size:f}):c.jsx(yy,{size:f}))}),c.jsx("audio",{ref:g,controls:!0,preload:"none",controlsList:"nodownload nofullscreen noremoteplayback",style:{position:"absolute",overflow:"hidden",display:"none",height:"0px",width:"0px"},src:null==(i=g.current)?void 0:i.src,onError:e=>{om.error("Error fetching audio:",e)},id:`audio-${a}`,autoPlay:!0})]});var f}const Hk=n.memo((function(e){const t=I(_p.engineTTS),n={[Ur.edge]:Bk,[Ur.browser]:Vk,[Ur.external]:$k}[t];return c.jsx(n,{...e})}));function Gk({index:e,isEditing:t,enterEdit:a,copyToClipboard:s,conversation:r,isSubmitting:o,message:i,regenerate:l,handleContinue:d,latestMessage:u,isLast:m}){const p=kg(),{endpoint:g,endpointType:f}=r??{},x=f??g,[h,v]=n.useState(!1),[b]=T(_p.textToSpeech),{hideEditButton:y,regenerateEnabled:_,continueSupported:j,forkingSupported:w,isEditableEndpoint:N}=function({error:e=!1,endpoint:t,messageId:n,isEditing:a=!1,isSubmitting:s,searchResult:r=!1,finish_reason:o="",latestMessageId:i,isCreatedByUser:l=!1}){const c=Boolean([Ro.openAI,Ro.custom,Ro.google,Ro.agents,Ro.bedrock,Ro.anthropic,Ro.gptPlugins,Ro.azureOpenAI].find((e=>e===t))),d=i===n&&o&&"stop"!==o&&!a&&!r&&c,u=Boolean([Ro.azureOpenAI,Ro.openAI,Ro.custom,Ro.agents,Ro.bedrock,Ro.chatGPTBrowser,Ro.google,Ro.gptPlugins,Ro.anthropic].find((e=>e===t))),m=!l&&!r&&!a&&!s&&u,p=s||e||r||!u||!c&&!l;return{forkingSupported:!Oo(t)&&!r,continueSupported:d,regenerateEnabled:m,isEditableEndpoint:c,hideEditButton:p}}({isEditing:t,isSubmitting:o,error:i.error,endpoint:x??"",messageId:i.messageId,searchResult:i.searchResult,finish_reason:i.finish_reason,isCreatedByUser:i.isCreatedByUser,latestMessageId:null==u?void 0:u.messageId});if(!r)return null;const{isCreatedByUser:C,error:k}=i,S=()=>_?c.jsx("button",{className:rm("hover-button active rounded-md p-1 hover:bg-gray-100 hover:text-gray-500 focus:opacity-100 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:invisible md:group-hover:visible md:group-[.final-completion]:visible",m?"":"md:opacity-0 md:group-hover:opacity-100"),onClick:l,type:"button",title:p("com_ui_regenerate"),children:c.jsx(Jb,{className:"hover:text-gray-500 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400",size:"19"})}):null;if(!0===k)return c.jsx("div",{className:"visible mt-0 flex justify-center gap-1 self-end text-gray-500 lg:justify-start",children:S()});return c.jsxs("div",{className:"visible mt-0 flex justify-center gap-1 self-end text-gray-500 lg:justify-start",children:[b&&c.jsx(Hk,{index:e,messageId:i.messageId,content:i.content??i.text,isLast:m,className:rm("ml-0 flex items-center gap-1.5 rounded-md p-1 text-xs hover:bg-gray-100 hover:text-gray-500 focus:opacity-100 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible")}),N&&c.jsx("button",{id:`edit-${i.messageId}`,className:rm("hover-button rounded-md p-1 hover:bg-gray-100 hover:text-gray-500 focus:opacity-100 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible",C?"":"active",y?"opacity-0":"",t?"active text-gray-700 dark:text-gray-200":"",m?"":"md:opacity-0 md:group-hover:opacity-100"),onClick:()=>{if(t)return a(!0);a()},type:"button",title:p("com_ui_edit"),disabled:y,children:c.jsx(Bb,{size:"19"})}),c.jsx("button",{className:rm("ml-0 flex items-center gap-1.5 rounded-md p-1 text-xs hover:bg-gray-100 hover:text-gray-500 focus:opacity-100 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:group-hover:visible md:group-[.final-completion]:visible",o&&C?"md:opacity-0 md:group-hover:opacity-100":"",m?"":"md:opacity-0 md:group-hover:opacity-100"),onClick:()=>s(v),type:"button",title:p(h?"com_ui_copied_to_clipboard":"com_ui_copy_to_clipboard"),children:h?c.jsx(Kb,{className:"h-[18px] w-[18px]"}):c.jsx(Gb,{size:"19"})}),S(),c.jsx(Lk,{isLast:m,messageId:i.messageId,conversationId:r.conversationId,forkingSupported:w,latestMessageId:null==u?void 0:u.messageId}),!0===j?c.jsx("button",{className:rm("hover-button active rounded-md p-1 hover:bg-gray-100 hover:text-gray-500 focus:opacity-100 dark:text-gray-400/70 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400 md:invisible md:group-hover:visible",m?"":"md:opacity-0 md:group-hover:opacity-100"),onClick:d,type:"button",title:p("com_ui_continue"),children:c.jsx(Xb,{className:"h-4 w-4 hover:text-gray-500 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400"})}):null]})}const Kk=n.memo((({iconData:e,assistant:t,agent:a})=>{om.log("icon_data",e,t,a);const{data:s}=Mp(),r=n.useMemo((()=>(null==a?void 0:a.name)??""),[a]),o=n.useMemo((()=>{var e;return(null==(e=null==a?void 0:a.avatar)?void 0:e.filepath)??""}),[a]),i=n.useMemo((()=>(null==t?void 0:t.name)??""),[t]),l=n.useMemo((()=>{var e;return(null==(e=null==t?void 0:t.metadata)?void 0:e.avatar)??""}),[t]),d=n.useMemo((()=>{let e="";return t?e=l:a&&(e=o),e}),[t,a,l,o]),u=null==e?void 0:e.iconURL,m=n.useMemo((()=>Zu({endpointsConfig:s,iconURL:u,endpoint:null==e?void 0:e.endpoint})),[s,u,null==e?void 0:e.endpoint]),p=n.useMemo((()=>Hu(s,m,"iconURL")),[s,m]);return!0!==(null==e?void 0:e.isCreatedByUser)&&null!=u&&u.includes("http")?c.jsx(pw,{iconURL:u,modelLabel:null==e?void 0:e.modelLabel,context:"message",assistantAvatar:l,agentAvatar:o,endpointIconURL:p,assistantName:i,agentName:r}):c.jsx(rw,{isCreatedByUser:(null==e?void 0:e.isCreatedByUser)??!1,endpoint:m,iconURL:d||p,model:null==e?void 0:e.model,assistantName:i,agentName:r,size:28.8})}));Kk.displayName="MessageIcon";const Wk=n.memo((({isCard:e,siblingIdx:t,siblingCount:a,message:s,setSiblingIdx:r,currentEditId:o,isMultiMessage:i,setCurrentEditId:l,isSubmittingFamily:d})=>{var u;const{edit:m,index:p,agent:g,assistant:f,enterEdit:x,conversation:h,messageLabel:v,isSubmitting:b,latestMessage:y,handleContinue:_,copyToClipboard:j,setLatestMessage:w,regenerateMessage:N}=db({message:s,currentEditId:o,isMultiMessage:i,setCurrentEditId:l}),C=I(_p.maximizeChatSpace),k=I(_p.fontSize),S=n.useCallback((()=>N()),[N]),T=n.useMemo((()=>{var e;return!(null==(e=null==s?void 0:s.children)?void 0:e.length)&&((null==s?void 0:s.depth)===(null==y?void 0:y.depth)||-1===(null==s?void 0:s.depth))}),[null==s?void 0:s.children,null==s?void 0:s.depth,null==y?void 0:y.depth]),R=n.useMemo((()=>({endpoint:(null==s?void 0:s.endpoint)??(null==h?void 0:h.endpoint),model:(null==s?void 0:s.model)??(null==h?void 0:h.model),iconURL:(null==s?void 0:s.iconURL)??(null==h?void 0:h.iconURL),modelLabel:v,isCreatedByUser:null==s?void 0:s.isCreatedByUser})),[v,null==h?void 0:h.endpoint,null==h?void 0:h.iconURL,null==h?void 0:h.model,null==s?void 0:s.model,null==s?void 0:s.iconURL,null==s?void 0:s.endpoint,null==s?void 0:s.isCreatedByUser]);if(!s)return null;const E=s.messageId===(null==y?void 0:y.messageId),P=T&&!(!0===d)&&!0===e,L=!0===e&&!(!0===d)&&E,M=P&&!E?()=>{om.log(`Message Card click: Setting ${s.messageId} as latest message`),om.dir(s),w(s)}:void 0,A=C?"w-full max-w-full md:px-5 lg:px-1 xl:px-5":"md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5",O={latestCard:L?"bg-surface-secondary":"",cardRender:P?"cursor-pointer transition-colors duration-300":"",focus:"focus:outline-none focus:ring-2 focus:ring-border-xheavy"};return c.jsxs("div",{id:s.messageId,"aria-label":`message-${s.depth}-${s.messageId}`,className:rm("final-completion group mx-auto flex flex-1 gap-3 transition-all duration-300 transform-gpu",!0===e?"relative w-full gap-1 rounded-lg border border-border-medium bg-surface-primary-alt p-2 md:w-1/2 md:gap-3 md:p-4":A,O.latestCard,O.cardRender,O.focus,"message-render"),onClick:M,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||!M||M()},role:P?"button":void 0,tabIndex:P?0:void 0,children:[!0===L&&c.jsx("div",{className:"absolute right-0 top-0 m-2 h-3 w-3 rounded-full bg-text-primary"}),c.jsx("div",{className:"relative flex flex-shrink-0 flex-col items-end",children:c.jsx("div",{children:c.jsx("div",{className:"pt-0.5",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(Kk,{iconData:R,assistant:f,agent:g})})})})}),c.jsxs("div",{className:rm("relative flex w-11/12 flex-col",!0===s.isCreatedByUser?"":"agent-turn"),children:[c.jsx("h2",{className:rm("select-none font-semibold",k),children:v}),c.jsx("div",{className:"flex-col gap-1 md:gap-3",children:c.jsx("div",{className:"flex max-w-full flex-grow flex-col gap-0",children:c.jsx(Rk,{edit:m,isLast:T,enterEdit:x,siblingIdx:t,messageId:s.messageId,isSubmitting:b,setSiblingIdx:r,attachments:s.attachments,isCreatedByUser:s.isCreatedByUser,conversationId:null==h?void 0:h.conversationId,content:s.content})})}),(null==(u=s.children)?void 0:u.length)||!0!==d&&!b?c.jsxs(bk,{classes:"text-xs",children:[c.jsx(xk,{siblingIdx:t,siblingCount:a,setSiblingIdx:r}),c.jsx(Gk,{index:p,isEditing:m,message:s,enterEdit:x,isSubmitting:b,conversation:h??null,regenerate:S,copyToClipboard:j,handleContinue:_,latestMessage:y,isLast:T})]}):c.jsx(Ik,{isCard:e})]})]})})),Qk=_.memo((({handleScroll:e,children:t})=>c.jsx("div",{className:"text-token-text-primary w-full border-0 bg-transparent dark:border-0 dark:bg-transparent",onWheel:e,onTouchMove:e,children:t})));function qk(e){const{showSibling:t,conversation:n,handleScroll:a,siblingMessage:s,latestMultiMessage:r,isSubmittingFamily:o}=ub({message:e.message}),{message:i,currentEditId:l,setCurrentEditId:d}=e;if(!i||"object"!=typeof i)return null;const{children:u,messageId:m=null}=i;return c.jsxs(c.Fragment,{children:[c.jsx(Qk,{handleScroll:a,children:t?c.jsx("div",{className:"m-auto my-2 flex justify-center p-4 py-2 md:gap-6",children:c.jsxs("div",{className:"flex w-full flex-row flex-wrap justify-between gap-1 md:max-w-5xl md:flex-nowrap md:gap-2 lg:max-w-5xl xl:max-w-6xl",children:[c.jsx(Wk,{...e,message:i,isSubmittingFamily:o,isCard:!0}),c.jsx(Wk,{...e,isMultiMessage:!0,isCard:!0,message:s??r??void 0,isSubmittingFamily:o})]})}):c.jsx("div",{className:"m-auto justify-center p-4 py-2 md:gap-6 ",children:c.jsx(Wk,{...e})})}),c.jsx(eS,{messageId:m,conversation:n,messagesTree:u??[],currentEditId:l,setCurrentEditId:d},m)]})}function Zk(e){const t=kg(),{message:a,siblingIdx:s,siblingCount:r,setSiblingIdx:o,currentEditId:i,setCurrentEditId:l}=e,{edit:d,index:u,agent:m,isLast:p,enterEdit:g,assistant:f,handleScroll:x,conversation:h,isSubmitting:v,latestMessage:b,handleContinue:y,copyToClipboard:_,regenerateMessage:j}=function(e){const t=n.useRef(""),{message:a,currentEditId:s,setCurrentEditId:r}=e,{ask:o,index:i,regenerate:l,isSubmitting:c,conversation:d,latestMessage:u,setAbortScroll:m,handleContinue:p,setLatestMessage:g}=bh(),f=vv(),x=Nh(),{text:h,content:v,children:b,messageId:y=null,isCreatedByUser:_}=a??{},j=y===s,w=0===(null==b?void 0:b.length)||void 0===(null==b?void 0:b.length);n.useEffect((()=>{const e=null==d?void 0:d.conversationId;if(e===dc.NEW_CONVO)return;if(!a)return;if(!w)return;const n=Fu(a,e),s={textKey:n,"latestText.current":t.current,messageId:a.messageId,convoId:e};n!==t.current||t.current&&e!==t.current.split(dc.COMMON_DIVIDER)[2]?(om.log("[useMessageHelpers] Setting latest message: ",s),t.current=n,g({...a})):om.log("No change in latest message",s)}),[w,a,g,null==d?void 0:d.conversationId]);const N=n.useCallback((e=>r&&r(!0===e?-1:y)),[y,r]),C=n.useCallback((e=>{K((()=>{om.log("message_scrolling",`useMessageHelpers: setting abort scroll to ${c}, handleScroll event`,e),m(!!c)}),500)()}),[c,m]),k=n.useMemo((()=>{if(!Oo(null==d?void 0:d.endpoint))return;const e=(null==d?void 0:d.endpoint)??"",t=(null==a?void 0:a.model)??"";return(null==f?void 0:f[e])?f[e][t]:void 0}),[null==d?void 0:d.endpoint,null==a?void 0:a.model,f]),S=n.useMemo((()=>{if(!Do(null==d?void 0:d.endpoint))return;const e=(null==a?void 0:a.model)??"";return x?x[e]:void 0}),[x,null==d?void 0:d.endpoint,null==a?void 0:a.model]),T=cb({text:h,content:v});return{ask:o,edit:j,agent:S,index:i,isLast:w,assistant:k,enterEdit:N,conversation:d,isSubmitting:c,handleScroll:C,latestMessage:u,handleContinue:p,copyToClipboard:T,regenerateMessage:()=>{c&&!0===_||!a||l(a)}}}(e),w=I(_p.fontSize),{children:N,messageId:C=null,isCreatedByUser:k}=a??{},S=n.useMemo((()=>{let e="";return!0===k?e=t("com_user_message"):f?e=f.name??t("com_ui_assistant"):m&&(e=m.name??t("com_ui_agent")),e}),[f,m,k,t]),T=n.useMemo((()=>({endpoint:(null==a?void 0:a.endpoint)??(null==h?void 0:h.endpoint),model:(null==a?void 0:a.model)??(null==h?void 0:h.model),iconURL:(null==a?void 0:a.iconURL)??(null==h?void 0:h.iconURL),modelLabel:S,isCreatedByUser:null==a?void 0:a.isCreatedByUser})),[S,null==h?void 0:h.endpoint,null==h?void 0:h.iconURL,null==h?void 0:h.model,null==a?void 0:a.model,null==a?void 0:a.iconURL,null==a?void 0:a.endpoint,null==a?void 0:a.isCreatedByUser]);return a?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-token-text-primary w-full border-0 bg-transparent dark:border-0 dark:bg-transparent",onWheel:x,onTouchMove:x,children:c.jsx("div",{className:"m-auto justify-center p-4 py-2 md:gap-6 ",children:c.jsxs("div",{className:"group mx-auto flex flex-1 gap-3 md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5",children:[c.jsx("div",{className:"relative flex flex-shrink-0 flex-col items-end",children:c.jsx("div",{children:c.jsx("div",{className:"pt-0.5",children:c.jsx("div",{className:"shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(Kk,{iconData:T,assistant:f,agent:m})})})})}),c.jsxs("div",{className:rm("relative flex w-full flex-col",!0===k?"":"agent-turn"),children:[c.jsx("div",{className:rm("select-none font-semibold",w),children:S}),c.jsx("div",{className:"flex-col gap-1 md:gap-3",children:c.jsx("div",{className:"flex max-w-full flex-grow flex-col gap-0",children:c.jsx(Rk,{isLast:p,isSubmitting:v,messageId:a.messageId,isCreatedByUser:a.isCreatedByUser,conversationId:null==h?void 0:h.conversationId,content:a.content})})}),p&&v?c.jsx("div",{className:"mt-1 h-[27px] bg-transparent"}):c.jsxs(bk,{classes:"text-xs",children:[c.jsx(xk,{siblingIdx:s,siblingCount:r,setSiblingIdx:o}),c.jsx(Gk,{index:u,isEditing:d,message:a,enterEdit:g,isSubmitting:v,conversation:h??null,regenerate:()=>j(),copyToClipboard:_,handleContinue:y,latestMessage:b,isLast:p})]})]})]})})}),c.jsx(eS,{messageId:C,conversation:h,messagesTree:N??[],currentEditId:i,setCurrentEditId:l},C)]}):null}const Yk=n.memo((({isCard:e,siblingIdx:t,siblingCount:a,message:s,setSiblingIdx:r,currentEditId:o,isMultiMessage:i,setCurrentEditId:l,isSubmittingFamily:d})=>{var u;const{ask:m,edit:p,index:g,assistant:f,enterEdit:x,conversation:h,messageLabel:v,isSubmitting:b,latestMessage:y,handleContinue:_,copyToClipboard:j,setLatestMessage:w,regenerateMessage:N}=db({message:s,currentEditId:o,isMultiMessage:i,setCurrentEditId:l}),C=I(_p.fontSize),k=I(_p.maximizeChatSpace),S=n.useCallback((()=>N()),[N]),{isCreatedByUser:T,error:R,unfinished:E}=s??{},P=!(null==(u=null==s?void 0:s.children)?void 0:u.length),L=n.useMemo((()=>P&&((null==s?void 0:s.depth)===(null==y?void 0:y.depth)||-1===(null==s?void 0:s.depth))),[P,null==s?void 0:s.depth,null==y?void 0:y.depth]),M=n.useMemo((()=>({endpoint:(null==s?void 0:s.endpoint)??(null==h?void 0:h.endpoint),model:(null==s?void 0:s.model)??(null==h?void 0:h.model),iconURL:(null==s?void 0:s.iconURL)??(null==h?void 0:h.iconURL),modelLabel:v,isCreatedByUser:null==s?void 0:s.isCreatedByUser})),[v,null==h?void 0:h.endpoint,null==h?void 0:h.iconURL,null==h?void 0:h.model,null==s?void 0:s.model,null==s?void 0:s.iconURL,null==s?void 0:s.endpoint,null==s?void 0:s.isCreatedByUser]);if(!s)return null;const A=s.messageId===(null==y?void 0:y.messageId),O=L&&!(!0===d)&&!0===e,D=!0===e&&!(!0===d)&&A,F=O&&!A?()=>{om.log(`Message Card click: Setting ${s.messageId} as latest message`),om.dir(s),w(s)}:void 0;let z="";z=e?"relative w-full gap-1 rounded-lg border border-border-medium bg-surface-primary-alt p-2 md:w-1/2 md:gap-3 md:p-4":k?"md:max-w-full md:px-5":"md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5";const U=D?"bg-surface-secondary":"",V=O?"cursor-pointer transition-colors duration-300":"";return c.jsxs("div",{id:s.messageId,"aria-label":`message-${s.depth}-${s.messageId}`,className:rm("final-completion group mx-auto flex flex-1 gap-3 transition-all duration-300 transform-gpu",z,U,V,"message-render focus:outline-none focus:ring-2 focus:ring-border-xheavy"),onClick:F,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||!F||F()},role:O?"button":void 0,tabIndex:O?0:void 0,children:[!0===D&&c.jsx("div",{className:"absolute right-0 top-0 m-2 h-3 w-3 rounded-full bg-text-primary"}),c.jsx("div",{className:"relative flex flex-shrink-0 flex-col items-end",children:c.jsx("div",{children:c.jsx("div",{className:"pt-0.5",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(Kk,{iconData:M,assistant:f})})})})}),c.jsxs("div",{className:rm("relative flex w-11/12 flex-col",!0===s.isCreatedByUser?"":"agent-turn"),children:[c.jsx("h2",{className:rm("select-none font-semibold",C),children:v}),c.jsx("div",{className:"flex-col gap-1 md:gap-3",children:c.jsx("div",{className:"flex max-w-full flex-grow flex-col gap-0",children:c.jsxs(pv.Provider,{value:{messageId:s.messageId,conversationId:null==h?void 0:h.conversationId},children:[s.plugin&&c.jsx(vk,{plugin:s.plugin}),c.jsx(BC,{ask:m,edit:p,isLast:L,text:s.text||"",message:s,enterEdit:x,error:!!R,isSubmitting:b,unfinished:E??!1,isCreatedByUser:T??!0,siblingIdx:t??0,setSiblingIdx:r??(()=>({}))})]})})}),P&&(!0===d||b)?c.jsx(Ik,{isCard:e}):c.jsxs(bk,{classes:"text-xs",children:[c.jsx(xk,{siblingIdx:t,siblingCount:a,setSiblingIdx:r}),c.jsx(Gk,{index:g,isEditing:p,message:s,enterEdit:x,isSubmitting:b,conversation:h??null,regenerate:S,copyToClipboard:j,handleContinue:_,latestMessage:y,isLast:L})]})]})]})})),Jk=_.memo((({handleScroll:e,children:t})=>c.jsx("div",{className:"text-token-text-primary w-full border-0 bg-transparent dark:border-0 dark:bg-transparent",onWheel:e,onTouchMove:e,children:t})));function Xk(e){const{showSibling:t,conversation:n,handleScroll:a,siblingMessage:s,latestMultiMessage:r,isSubmittingFamily:o}=ub({message:e.message}),{message:i,currentEditId:l,setCurrentEditId:d}=e,u=I(_p.maximizeChatSpace);if(!i||"object"!=typeof i)return null;const{children:m,messageId:p=null}=i;return c.jsxs(c.Fragment,{children:[c.jsx(Jk,{handleScroll:a,children:t?c.jsx("div",{className:"m-auto my-2 flex justify-center p-4 py-2 md:gap-6",children:c.jsxs("div",{className:rm("flex w-full flex-row flex-wrap justify-between gap-1 md:flex-nowrap md:gap-2",u?"w-full max-w-full":"md:max-w-5xl xl:max-w-6xl"),children:[c.jsx(Yk,{...e,message:i,isSubmittingFamily:o,isCard:!0}),c.jsx(Yk,{...e,isMultiMessage:!0,isCard:!0,message:s??r??void 0,isSubmittingFamily:o})]})}):c.jsx("div",{className:"m-auto justify-center p-4 py-2 md:gap-6 ",children:c.jsx(Yk,{...e})})}),c.jsx(eS,{messageId:p,conversation:n,messagesTree:m??[],currentEditId:l,setCurrentEditId:d},p)]})}function eS({messageId:e,messagesTree:t,currentEditId:a,setCurrentEditId:s}){const[r,o]=T(_p.messagesSiblingIdxFamily(e)),i=n.useCallback((e=>{o(((null==t?void 0:t.length)??0)-e-1)}),[null==t?void 0:t.length,o]);if(n.useEffect((()=>{o(0)}),[null==t?void 0:t.length]),n.useEffect((()=>{(null==t?void 0:t.length)&&r>=t.length&&o(0)}),[r,null==t?void 0:t.length,o]),!t||!t.length)return null;const l=t[t.length-r-1];return l?Oo(l.endpoint)&&l.content?c.jsx(Zk,{message:l,currentEditId:a,setCurrentEditId:s,siblingIdx:t.length-r-1,siblingCount:t.length,setSiblingIdx:i},l.messageId):l.content?c.jsx(qk,{message:l,currentEditId:a,setCurrentEditId:s,siblingIdx:t.length-r-1,siblingCount:t.length,setSiblingIdx:i},l.messageId):c.jsx(Xk,{message:l,currentEditId:a,setCurrentEditId:s,siblingIdx:t.length-r-1,siblingCount:t.length,setSiblingIdx:i},l.messageId):null}function tS({messagesTree:e,Header:t}){const a=kg(),s=I(_p.showScrollButton),r=I(_p.fontSize),{screenshotTargetRef:o}=Dv(),[i,l]=n.useState(-1),{conversation:d,scrollableRef:u,messagesEndRef:m,showScrollButton:p,handleSmoothToRef:g,debouncedHandleScroll:f}=gb(e),{conversationId:x}=d??{};return c.jsx("div",{className:"flex-1 overflow-hidden overflow-y-auto",children:c.jsxs("div",{className:"relative h-full",children:[c.jsx("div",{className:"scrollbar-gutter-stable",onScroll:f,ref:u,style:{height:"100%",overflowY:"auto",width:"100%"},children:c.jsxs("div",{className:"flex flex-col pb-9 dark:bg-transparent",children:[e&&0==e.length||null===e?c.jsx("div",{className:rm("flex w-full items-center justify-center p-3 text-text-secondary",r),children:a("com_ui_nothing_found")}):c.jsxs(c.Fragment,{children:[null!=t&&t,c.jsx("div",{ref:o,children:c.jsx(eS,{messagesTree:e,messageId:x??null,setCurrentEditId:l,currentEditId:i??null},x)})]}),c.jsx("div",{id:"messages-end",className:"group h-0 w-full flex-shrink-0",ref:m})]})}),c.jsx(un,{in:p,timeout:400,classNames:"scroll-down",unmountOnExit:!1,children:()=>p&&s&&c.jsx(Sk,{scrollHandler:g})})]})})}function nS(){return c.jsxs("div",{className:"bg-surface-primary/85 fixed inset-0 z-[9999] flex flex-col items-center justify-center\n        gap-2 text-text-primary\n        backdrop-blur-[4px] transition-all duration-200\n        ease-in-out animate-in fade-in\n        zoom-in-95 hover:backdrop-blur-sm",children:[c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 132 108",fill:"none",width:"132",height:"108",children:[c.jsx("g",{clipPath:"url(#clip0_3605_64419)",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.2025 29.3514C10.778 33.2165 8.51524 37.1357 11.8281 49.4995L13.4846 55.6814C16.7975 68.0453 20.7166 70.308 35.1411 66.443L43.3837 64.2344C57.8082 60.3694 60.0709 56.4502 56.758 44.0864L55.1016 37.9044C51.7887 25.5406 47.8695 23.2778 33.445 27.1428L29.3237 28.2471L25.2025 29.3514ZM18.1944 42.7244C18.8572 41.5764 20.325 41.1831 21.4729 41.8459L27.3517 45.24C28.4996 45.9027 28.8929 47.3706 28.2301 48.5185L24.836 54.3972C24.1733 55.5451 22.7054 55.9384 21.5575 55.2757C20.4096 54.613 20.0163 53.1451 20.6791 51.9972L22.8732 48.1969L19.0729 46.0028C17.925 45.3401 17.5317 43.8723 18.1944 42.7244ZM29.4091 56.3843C29.066 55.104 29.8258 53.7879 31.1062 53.4449L40.3791 50.9602C41.6594 50.6172 42.9754 51.377 43.3184 52.6573C43.6615 53.9376 42.9017 55.2536 41.6214 55.5967L32.3485 58.0813C31.0682 58.4244 29.7522 57.6646 29.4091 56.3843Z",fill:"#AFC1FF"})}),c.jsx("g",{clipPath:"url(#clip1_3605_64419)",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M86.8124 13.4036C81.0973 11.8722 78.5673 13.2649 77.0144 19.0603L68.7322 49.97C67.1793 55.7656 68.5935 58.2151 74.4696 59.7895L97.4908 65.958C103.367 67.5326 105.816 66.1184 107.406 60.1848L115.393 30.379C115.536 29.8456 115.217 29.2959 114.681 29.16C113.478 28.8544 112.435 28.6195 111.542 28.4183C106.243 27.2253 106.22 27.2201 109.449 20.7159C109.73 20.1507 109.426 19.4638 108.816 19.3004L86.8124 13.4036ZM87.2582 28.4311C86.234 28.1567 85.1812 28.7645 84.9067 29.7888C84.6323 30.813 85.2401 31.8658 86.2644 32.1403L101.101 36.1158C102.125 36.3902 103.178 35.7824 103.453 34.7581C103.727 33.7339 103.119 32.681 102.095 32.4066L87.2582 28.4311ZM82.9189 37.2074C83.1934 36.1831 84.2462 35.5753 85.2704 35.8497L100.107 39.8252C101.131 40.0996 101.739 41.1524 101.465 42.1767C101.19 43.201 100.137 43.8088 99.1132 43.5343L84.2766 39.5589C83.2523 39.2844 82.6445 38.2316 82.9189 37.2074ZM83.2826 43.2683C82.2584 42.9939 81.2056 43.6017 80.9311 44.626C80.6567 45.6502 81.2645 46.703 82.2888 46.9775L89.7071 48.9652C90.7313 49.2396 91.7841 48.6318 92.0586 47.6076C92.333 46.5833 91.7252 45.5305 90.7009 45.256L83.2826 43.2683Z",fill:"#7989FF"})}),c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40.4004 71.8426C40.4004 57.2141 44.0575 53.5569 61.1242 53.5569H66.0004H70.8766C87.9432 53.5569 91.6004 57.2141 91.6004 71.8426V79.1569C91.6004 93.7855 87.9432 97.4426 70.8766 97.4426H61.1242C44.0575 97.4426 40.4004 93.7855 40.4004 79.1569V71.8426ZM78.8002 67.4995C78.8002 70.1504 76.6512 72.2995 74.0002 72.2995C71.3492 72.2995 69.2002 70.1504 69.2002 67.4995C69.2002 64.8485 71.3492 62.6995 74.0002 62.6995C76.6512 62.6995 78.8002 64.8485 78.8002 67.4995ZM60.7204 70.8597C60.2672 70.2553 59.5559 69.8997 58.8004 69.8997C58.045 69.8997 57.3337 70.2553 56.8804 70.8597L47.2804 83.6597C46.4851 84.72 46.7 86.2244 47.7604 87.0197C48.8208 87.8149 50.3251 87.6 51.1204 86.5397L58.8004 76.2997L66.4804 86.5397C66.8979 87.0962 67.5363 87.4443 68.2303 87.4936C68.9243 87.5429 69.6055 87.2887 70.0975 86.7967L74.8004 82.0938L79.5034 86.7967C80.4406 87.734 81.9602 87.734 82.8975 86.7967C83.8347 85.8595 83.8347 84.3399 82.8975 83.4026L76.4975 77.0026C75.5602 76.0653 74.0406 76.0653 73.1034 77.0026L68.6601 81.4459L60.7204 70.8597Z",fill:"#3C46FF"}),c.jsxs("defs",{children:[c.jsx("clipPath",{id:"clip0_3605_64419",children:c.jsx("rect",{width:"56",height:"56",fill:"white",transform:"translate(0 26.9939) rotate(-15)"})}),c.jsx("clipPath",{id:"clip1_3605_64419",children:c.jsx("rect",{width:"64",height:"64",fill:"white",transform:"translate(69.5645 0.5) rotate(15)"})})]})]}),c.jsx("h3",{children:"Add anything"}),c.jsx("h4",{children:"Drop any file here to add it to the conversation"})]})}const aS=({onOptionSelect:e,setShowModal:t,files:a,isVisible:s})=>{const r=kg(),{data:o}=Mp(),i=n.useMemo((()=>{var e;return(null==(e=null==o?void 0:o[Ro.agents])?void 0:e.capabilities)??[]}),[o]),l=n.useMemo((()=>{const e=[{label:r("com_ui_upload_image_input"),value:void 0,icon:c.jsx(mn,{className:"icon-md"}),condition:a.every((e=>e.type.startsWith("image/")))}];for(const t of i)t===ro.file_search?e.push({label:r("com_ui_upload_file_search"),value:ro.file_search,icon:c.jsx(pn,{className:"icon-md"})}):t===ro.execute_code&&e.push({label:r("com_ui_upload_code_files"),value:ro.execute_code,icon:c.jsx(re,{className:"icon-md"})});return e}),[i,a,r]);return s?c.jsx(f_,{open:s,onOpenChange:t,children:c.jsx(ij,{title:r("com_ui_upload_type"),className:"w-11/12 sm:w-[440px] md:w-[400px] lg:w-[360px]",main:c.jsx("div",{className:"flex flex-col gap-2",children:l.map(((t,n)=>!1!==t.condition&&c.jsxs("button",{onClick:()=>e(t.value),className:"flex items-center gap-2 rounded-lg p-2 hover:bg-surface-active-alt",children:[t.icon,c.jsx("span",{children:t.label})]},n)))})})}):null};function sS({children:e,className:t}){const{isOver:a,canDrop:s,drop:r,showModal:o,setShowModal:i,draggedFiles:l,handleOptionSelect:d}=function(){const e=ar(),{handleFiles:t}=Gv(),[a,s]=n.useState(!1),[r,o]=n.useState([]),i=I(_p.conversationByIndex(0))||void 0,l=n.useMemo((()=>Do(null==i?void 0:i.endpoint)),[null==i?void 0:i.endpoint]),[{canDrop:c,isOver:d},u]=W((()=>({accept:[Q],drop(n){var a,r;if(console.log("drop",n.files),!l)return void t(n.files);const i=e.getQueryData([Xc.endpoints]),c=null==i?void 0:i[Ro.agents],d=!0===(null==(a=null==c?void 0:c.capabilities)?void 0:a.includes(hl.execute_code)),u=!0===(null==(r=null==c?void 0:c.capabilities)?void 0:r.includes(hl.file_search));d||u?(o(n.files),s(!0)):t(n.files)},canDrop:()=>!0,collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})})),[]);return{canDrop:c,isOver:d,drop:u,showModal:a,setShowModal:s,draggedFiles:r,handleOptionSelect:e=>{t(r,e),s(!1),o([])}}}(),u=s&&a;return c.jsxs("div",{ref:r,className:rm("relative flex h-full w-full",t),children:[e,u&&c.jsx(nS,{}),c.jsx(aS,{files:l,isVisible:o,setShowModal:i,onOptionSelect:d})]})}const rS=A('import React, { useEffect, useRef, useState } from "react";\nimport {\n  TransformWrapper,\n  TransformComponent,\n  ReactZoomPanPinchRef,\n} from "react-zoom-pan-pinch";\nimport mermaid from "mermaid";\nimport { ZoomIn, ZoomOut, RefreshCw } from "lucide-react";\nimport { Button } from "/components/ui/button";\n\ninterface MermaidDiagramProps {\n  content: string;\n}\n\nconst MermaidDiagram: React.FC<MermaidDiagramProps> = ({ content }) => {\n  const mermaidRef = useRef<HTMLDivElement>(null);\n  const transformRef = useRef<ReactZoomPanPinchRef>(null);\n  const [isRendered, setIsRendered] = useState(false);\n\n  useEffect(() => {\n    mermaid.initialize({\n      startOnLoad: false,\n      theme: "base",\n      themeVariables: {\n        background: "#282C34",\n        primaryColor: "#333842",\n        secondaryColor: "#333842",\n        tertiaryColor: "#333842",\n        primaryTextColor: "#ABB2BF",\n        secondaryTextColor: "#ABB2BF",\n        lineColor: "#636D83",\n        fontSize: "16px",\n        nodeBorder: "#636D83",\n        mainBkg: \'#282C34\',\n        altBackground: \'#282C34\',\n        textColor: \'#ABB2BF\',\n        edgeLabelBackground: \'#282C34\',\n        clusterBkg: \'#282C34\',\n        clusterBorder: "#636D83",\n        labelBoxBkgColor: "#333842",\n        labelBoxBorderColor: "#636D83",\n        labelTextColor: "#ABB2BF",\n      },\n      flowchart: {\n        curve: "basis",\n        nodeSpacing: 50,\n        rankSpacing: 50,\n        diagramPadding: 8,\n        htmlLabels: true,\n        useMaxWidth: true,\n        padding: 15,\n        wrappingWidth: 200,\n      },\n    });\n\n    const renderDiagram = async () => {\n      if (mermaidRef.current) {\n        try {\n          const { svg } = await mermaid.render("mermaid-diagram", content);\n          mermaidRef.current.innerHTML = svg;\n\n          const svgElement = mermaidRef.current.querySelector("svg");\n          if (svgElement) {\n            svgElement.style.width = "100%";\n            svgElement.style.height = "100%";\n\n            const pathElements = svgElement.querySelectorAll("path");\n            pathElements.forEach((path) => {\n              path.style.strokeWidth = "1.5px";\n            });\n\n            const rectElements = svgElement.querySelectorAll("rect");\n            rectElements.forEach((rect) => {\n              const parent = rect.parentElement;\n              if (parent && parent.classList.contains("node")) {\n                rect.style.stroke = "#636D83";\n                rect.style.strokeWidth = "1px";\n              } else {\n                rect.style.stroke = "none";\n              }\n            });\n          }\n          setIsRendered(true);\n        } catch (error) {\n          console.error("Mermaid rendering error:", error);\n          mermaidRef.current.innerHTML = "Error rendering diagram";\n        }\n      }\n    };\n\n    renderDiagram();\n  }, [content]);\n\n  const centerAndFitDiagram = () => {\n    if (transformRef.current && mermaidRef.current) {\n      const { centerView, zoomToElement } = transformRef.current;\n      zoomToElement(mermaidRef.current as HTMLElement);\n      centerView(1, 0);\n    }\n  };\n\n  useEffect(() => {\n    if (isRendered) {\n      centerAndFitDiagram();\n    }\n  }, [isRendered]);\n\n  const handlePanning = () => {\n    if (transformRef.current) {\n      const { state, instance } = transformRef.current;\n      if (!state) {\n        return;\n      }\n      const { scale, positionX, positionY } = state;\n      const { wrapperComponent, contentComponent } = instance;\n\n      if (wrapperComponent && contentComponent) {\n        const wrapperRect = wrapperComponent.getBoundingClientRect();\n        const contentRect = contentComponent.getBoundingClientRect();\n        const maxX = wrapperRect.width - contentRect.width * scale;\n        const maxY = wrapperRect.height - contentRect.height * scale;\n\n        let newX = positionX;\n        let newY = positionY;\n\n        if (newX > 0) {\n          newX = 0;\n        }\n        if (newY > 0) {\n          newY = 0;\n        }\n        if (newX < maxX) {\n          newX = maxX;\n        }\n        if (newY < maxY) {\n          newY = maxY;\n        }\n\n        if (newX !== positionX || newY !== positionY) {\n          instance.setTransformState(scale, newX, newY);\n        }\n      }\n    }\n  };\n\n  return (\n    <div className="relative h-screen w-screen cursor-move bg-[#282C34] p-5">\n      <TransformWrapper\n        ref={transformRef}\n        initialScale={1}\n        minScale={0.1}\n        maxScale={10}\n        limitToBounds={false}\n        centerOnInit={true}\n        initialPositionY={0}\n        wheel={{ step: 0.1 }}\n        panning={{ velocityDisabled: true }}\n        alignmentAnimation={{ disabled: true }}\n        onPanning={handlePanning}\n      >\n        {({ zoomIn, zoomOut }) => (\n          <>\n            <TransformComponent\n              wrapperStyle={{\n                width: "100%",\n                height: "100%",\n                overflow: "hidden",\n              }}\n            >\n              <div\n                ref={mermaidRef}\n                style={{\n                  width: "auto",\n                  height: "auto",\n                  minWidth: "100%",\n                  minHeight: "100%",\n                }}\n              />\n            </TransformComponent>\n            <div className="absolute bottom-2 right-2 flex space-x-2">\n              <Button onClick={() => zoomIn(0.1)} variant="outline" size="icon">\n                <ZoomIn className="h-4 w-4" />\n              </Button>\n              <Button\n                onClick={() => zoomOut(0.1)}\n                variant="outline"\n                size="icon"\n              >\n                <ZoomOut className="h-4 w-4" />\n              </Button>\n              <Button\n                onClick={centerAndFitDiagram}\n                variant="outline"\n                size="icon"\n              >\n                <RefreshCw className="h-4 w-4" />\n              </Button>\n            </div>\n          </>\n        )}\n      </TransformWrapper>\n    </div>\n  );\n};\n\nexport default MermaidDiagram;'),oS=e=>A(`import React from 'react';\nimport MermaidDiagram from '/components/ui/MermaidDiagram';\n\nexport default App = () => (\n  <MermaidDiagram content={\`${e}\`} />\n);\n`),iS=e=>({"App.tsx":oS(e),"index.tsx":A('import React, { StrictMode } from "react";\nimport { createRoot } from "react-dom/client";\nimport "./styles.css";\n\nimport App from "./App";\n\nconst root = createRoot(document.getElementById("root"));\nroot.render(<App />);\n;'),"/components/ui/MermaidDiagram.tsx":rS});function lS({artifact:e}){const[t,a]=n.useMemo((()=>{if(Mh(e.type??"",e.language).includes("mermaid"))return["App.tsx",iS(e.content??"")];const t=function(e,t){const n=Mh(e,t);return Ph[n]??Ph.default}(e.type??"",e.language);return[t,bi({[t]:e.content})]}),[e.type,e.content,e.language]);return{files:a,fileKey:t,template:n.useMemo((()=>function(e,t){const n=Mh(e,t);return Lh[n]??Lh.default}(e.type??"",e.language)),[e.type,e.language]),sharedProps:n.useMemo((()=>({customSetup:{dependencies:Dh(e.type??"")}})),[e.type])}}const cS=({artifact:e,className:t=""})=>{const a=kg(),{currentCode:s}=lv(),[r,o]=n.useState(!1),{fileKey:i}=lS({artifact:e});return c.jsx("button",{className:`mr-2 text-text-secondary ${t}`,onClick:()=>{try{const t=s??e.content??"";if(!t)return;const n=new Blob([t],{type:"text/plain"}),a=window.URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download=i,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a),o(!0),setTimeout((()=>o(!1)),3e3)}catch(t){console.error("Download failed:",t)}},"aria-label":a("com_ui_download_artifact"),children:r?c.jsx(Kb,{className:"h-4 w-4"}):c.jsx(gn,{className:"h-4 w-4"})})},dS=({ref:e,content:t,isSubmitting:a})=>{const[s,r]=n.useState(!1);return n.useEffect((()=>{const t=e.current;if(!t)return;const n=()=>{const{scrollTop:e,scrollHeight:n,clientHeight:a}=t;r(!(n-e-a<50))};return t.addEventListener("scroll",n),()=>{t.removeEventListener("scroll",n)}}),[e]),n.useEffect((()=>{const t=e.current;t&&a&&!s&&(t.scrollTop=t.scrollHeight)}),[t,a,s,e]),{userScrolled:s}},uS=({fileKey:e,readOnly:t,artifact:a,editorRef:s})=>{const{sandpack:r}=xn(),{isMutating:o,setIsMutating:i,setCurrentCode:l}=lv(),d=(e=>{const t=ar(),{onSuccess:n,...a}=e??{};return sr({mutationFn:e=>zd.editArtifact(e),onSuccess:(e,a,s)=>{t.setQueryData([Xc.messages,e.conversationId],(t=>{if(!t)return t;const n=[...t];let s;for(let e=n.length-1;e>=0;e--)if(n[e].messageId===a.messageId){s=e;break}return null==s?t:(n[s]={...n[s],content:e.content,text:e.text},n)})),null==n||n(e,a,s)},...a})})({onMutate:()=>{i(!0)},onSuccess:()=>{i(!1)},onError:()=>{i(!1)}}),u=n.useCallback((e=>{d.mutate(e)}),[d]),m=n.useMemo((()=>$(u,500)),[u]);return n.useEffect((()=>{if(t)return;if(o)return;const n=r.files["/"+e].code;return n&&null!=a.content&&n.trim()!==a.content.trim()&&(l(n),m({index:a.index,messageId:a.messageId??"",original:a.content,updated:n})),()=>{m.cancel()}}),[e,a.index,a.content,a.messageId,t,o,r.files,i,l,m]),c.jsx(hn,{ref:s,showTabs:!1,readOnly:t,showRunButton:!1,showLineNumbers:!0,showInlineErrors:!0,className:"hljs language-javascript bg-black"})},mS=n.memo((function({files:e,fileKey:t,template:n,artifact:a,editorRef:s,sharedProps:r,isSubmitting:o}){return 0===Object.keys(e).length?null:c.jsx(fn,{theme:"dark",files:{...e,...zh},options:{...Fh},...r,template:n,children:c.jsx(uS,{editorRef:s,fileKey:t,readOnly:o,artifact:a})})})),pS=n.memo((function({files:e,fileKey:t,previewRef:a,sharedProps:s,template:r}){const{currentCode:o}=lv(),i=n.useMemo((()=>{if(0===Object.keys(e).length)return e;const n=o??"";return n?{...e,[t]:{code:n}}:e}),[o,e,t]);return 0===Object.keys(i).length?null:c.jsx(vn,{files:{...i,...zh},options:{...Fh},...s,template:r,children:c.jsx(bn,{showOpenInCodeSandbox:!1,showRefreshButton:!1,tabIndex:0,ref:a})})}));function gS({artifact:e,isMermaid:t,editorRef:a,previewRef:s,isSubmitting:r}){const o=e.content??"",i=n.useRef(null);dS({ref:i,content:o,isSubmitting:r});const{files:l,fileKey:d,template:u,sharedProps:m}=lS({artifact:e});return c.jsxs(c.Fragment,{children:[c.jsx(fs,{ref:i,value:"code",id:"artifacts-code",className:rm("flex-grow overflow-auto"),children:c.jsx(mS,{files:l,fileKey:d,template:u,artifact:e,editorRef:a,sharedProps:m,isSubmitting:r})}),c.jsx(fs,{value:"preview",className:rm("flex-grow overflow-auto",t?"bg-[#282C34]":"bg-white"),children:c.jsx(pS,{files:l,fileKey:d,template:u,previewRef:s,sharedProps:m})})]})}const fS=n.memo((({inline:e,className:t,children:n})=>{const a=/language-(\w+)/.exec(t??""),s=a&&a[1];return e?c.jsx("code",{onDoubleClick:hm,className:t,children:n}):c.jsx("code",{className:`hljs language-${s} !whitespace-pre`,children:n})}));n.memo((({content:e="",isSubmitting:t})=>{const a=n.useRef(null),[s,r]=n.useState(!1),o=e,i=[[kt,{output:"mathml"}],[St,{detect:!0,ignoreMissing:!0,subset:Uu}]];return n.useEffect((()=>{const e=a.current;if(!e)return;const t=()=>{const{scrollTop:t,scrollHeight:n,clientHeight:a}=e;r(!(n-t-a<50))};return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}}),[]),n.useEffect((()=>{const e=a.current;e&&t&&!s&&(e.scrollTop=e.scrollHeight)}),[e,t,s]),c.jsx("div",{ref:a,className:"max-h-full overflow-y-auto",children:c.jsx(Pt,{rehypePlugins:i,components:{code:fS},children:o})})}));const xS=({content:e})=>{const t=kg(),[a,s]=n.useState(!1);return c.jsx("button",{className:"mr-2 text-text-secondary",onClick:()=>{te(e,{format:"text/plain"}),s(!0),setTimeout((()=>s(!1)),3e3)},"aria-label":t(a?"com_ui_copied":"com_ui_copy_code"),children:a?c.jsx(Kb,{className:"h-[18px] w-[18px]"}):c.jsx(Gb,{})})};function hS(){const e=kg(),{isMutating:t}=lv(),a=n.useRef(),s=n.useRef(),[r,o]=n.useState(!1),[i,l]=n.useState(!1),d=R(_p.artifactsVisible);n.useEffect((()=>{o(!0)}),[]);const{activeTab:u,isMermaid:m,setActiveTab:p,currentIndex:g,isSubmitting:f,cycleArtifact:x,currentArtifact:h,orderedArtifactIds:v}=function(){const[e,t]=n.useState("preview"),{isSubmitting:a,latestMessage:s,conversation:r}=bh(),o=I(_p.artifactsState),i=P(_p.artifactsState),l=P(_p.currentArtifactId),[c,d]=T(_p.currentArtifactId),u=n.useMemo((()=>Object.keys(o??{}).sort(((e,t)=>{var n,a;return((null==(n=null==o?void 0:o[e])?void 0:n.lastUpdateTime)??0)-((null==(a=null==o?void 0:o[t])?void 0:a.lastUpdateTime)??0)}))),[o]),m=n.useRef(null),p=n.useRef(!1),g=n.useRef(!1),f=n.useRef(null),x=n.useRef(null);n.useEffect((()=>{const e=()=>{i(),l(),x.current=(null==r?void 0:r.conversationId)??null,f.current=null,m.current=null,p.current=!1};(r&&r.conversationId!==x.current&&null!=x.current||r&&r.conversationId===dc.NEW_CONVO)&&e(),x.current=(null==r?void 0:r.conversationId)??null}),[r,i,l]),n.useEffect((()=>{if(u.length>0){const e=u[u.length-1];d(e)}}),[d,u]),n.useEffect((()=>{var e;if(a&&u.length>0&&s){const n=u[u.length-1],a=null==o?void 0:o[n];if((null==a?void 0:a.content)!==m.current){d(n),m.current=(null==a?void 0:a.content)??null;const r=Ou(s);if(/:::artifact[\s\S]*?(```|:::)\s*$/.test(r.trim())&&!p.current)t("preview"),p.current=!0,g.current=!1;else if(!p.current&&!g.current){const n=(null==(e=null==a?void 0:a.content)?void 0:e.slice(0,50))??"";n.length>0&&r.includes(n)&&(t("code"),g.current=!0)}}}}),[d,a,u,o,s]),n.useEffect((()=>{(null==s?void 0:s.messageId)!==f.current&&(f.current=(null==s?void 0:s.messageId)??null,p.current=!1,g.current=!1)}),[s]);const h=null!=c?null==o?void 0:o[c]:null,v=u.indexOf(c??"");return{activeTab:e,isMermaid:n.useMemo((()=>null!=(null==h?void 0:h.type)&&Mh(h.type,h.language).includes("mermaid")),[null==h?void 0:h.type,null==h?void 0:h.language]),setActiveTab:t,currentIndex:v,isSubmitting:a,cycleArtifact:e=>{let t;t="next"===e?(v+1)%u.length:(v-1+u.length)%u.length,d(u[t])},currentArtifact:h,orderedArtifactIds:u}}();if(null==h)return null;return c.jsx(zs,{value:u,onValueChange:p,asChild:!0,children:c.jsx("div",{className:"flex h-full w-full items-center justify-center",children:c.jsxs("div",{className:"flex h-full w-full flex-col overflow-hidden border border-border-medium bg-surface-primary text-xl text-text-primary shadow-xl transition-all duration-300 ease-in-out "+(r?"translate-x-0 scale-100 opacity-100":"translate-x-full scale-95 opacity-0"),children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-border-medium bg-surface-primary-alt p-2",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{className:"mr-2 text-text-secondary",onClick:()=>{o(!1),setTimeout((()=>d(!1)),300)},children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 256 256",children:c.jsx("path",{d:"M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"})})}),c.jsx("h3",{className:"truncate text-sm text-text-primary",children:h.title})]}),c.jsxs("div",{className:"flex items-center",children:["preview"===u&&c.jsx("button",{className:"mr-2 text-text-secondary transition-transform duration-500 ease-in-out "+(i?"rotate-180":""),onClick:()=>{var e;l(!0);const t=null==(e=s.current)?void 0:e.getClient();null!=t&&t.dispatch({type:"refresh"}),setTimeout((()=>l(!1)),750)},disabled:i,"aria-label":"Refresh",children:c.jsx(yn,{size:16,className:"transform "+(i?"animate-spin":"")})}),"preview"!==u&&t&&c.jsx(yn,{size:16,className:"mr-2 animate-spin text-text-secondary"}),c.jsxs(ps,{className:"mr-2 inline-flex h-7 rounded-full border border-border-medium bg-surface-tertiary",children:[c.jsx(gs,{value:"preview",disabled:t,className:"border-0.5 flex items-center gap-1 rounded-full border-transparent py-1 pl-2.5 pr-2.5 text-xs font-medium text-text-secondary data-[state=active]:border-border-light data-[state=active]:bg-surface-primary-alt data-[state=active]:text-text-primary",children:e("com_ui_preview")}),c.jsx(gs,{value:"code",className:"border-0.5 flex items-center gap-1 rounded-full border-transparent py-1 pl-2.5 pr-2.5 text-xs font-medium text-text-secondary data-[state=active]:border-border-light data-[state=active]:bg-surface-primary-alt data-[state=active]:text-text-primary",children:e("com_ui_code")})]}),c.jsx("button",{className:"text-text-secondary",onClick:()=>{o(!1),setTimeout((()=>d(!1)),300)},children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 256 256",children:c.jsx("path",{d:"M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"})})})]})]}),c.jsx(gS,{isMermaid:m,artifact:h,isSubmitting:f,editorRef:a,previewRef:s}),c.jsxs("div",{className:"flex items-center justify-between border-t border-border-medium bg-surface-primary-alt p-2 text-sm text-text-secondary",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>x("prev"),className:"mr-2 text-text-secondary",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 256 256",children:c.jsx("path",{d:"M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"})})}),c.jsx("span",{className:"text-xs",children:`${g+1} / ${v.length}`}),c.jsx("button",{onClick:()=>x("next"),className:"ml-2 text-text-secondary",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 256 256",children:c.jsx("path",{d:"M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"})})})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(xS,{content:h.content??""}),c.jsx(cS,{artifact:h})]})]})]})})})}const vS=({className:e="",...t})=>c.jsx(Nn,{className:rm("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t}),bS=_n,yS=({withHandle:e,className:t="",...n})=>c.jsx(jn,{className:rm("bg-border focus-visible:ring-ring group relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...n,children:e&&c.jsx("div",{className:"bg-border invisible z-10 flex h-4 w-3 items-center justify-center rounded-sm border group-hover:visible group-active:visible",children:c.jsx(wn,{className:"h-2.5 w-2.5"})})});function _S({disableOAuth:e}){const t=kg(),[a,s]=n.useState(!1),{watch:r,setValue:o,trigger:i}=Ut(),l=r("type");return c.jsxs(f_,{open:a,onOpenChange:s,children:[c.jsx(x_,{asChild:!0,children:c.jsxs("div",{className:"relative mb-4",children:[c.jsx("div",{className:"mb-1.5 flex items-center",children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:t("com_ui_authentication")})}),c.jsxs("div",{className:"border-token-border-medium flex rounded-lg border text-sm hover:cursor-pointer",children:[c.jsx("div",{className:"h-9 grow px-3 py-2",children:t(wS(l))}),c.jsx("div",{className:"bg-token-border-medium w-px"}),c.jsx("button",{type:"button",color:"neutral",className:"flex items-center gap-2 px-3",children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-sm",children:[c.jsx("path",{d:"M11.6439 3C10.9352 3 10.2794 3.37508 9.92002 3.98596L9.49644 4.70605C8.96184 5.61487 7.98938 6.17632 6.93501 6.18489L6.09967 6.19168C5.39096 6.19744 4.73823 6.57783 4.38386 7.19161L4.02776 7.80841C3.67339 8.42219 3.67032 9.17767 4.01969 9.7943L4.43151 10.5212C4.95127 11.4386 4.95127 12.5615 4.43151 13.4788L4.01969 14.2057C3.67032 14.8224 3.67339 15.5778 4.02776 16.1916L4.38386 16.8084C4.73823 17.4222 5.39096 17.8026 6.09966 17.8083L6.93502 17.8151C7.98939 17.8237 8.96185 18.3851 9.49645 19.294L9.92002 20.014C10.2794 20.6249 10.9352 21 11.6439 21H12.3561C13.0648 21 13.7206 20.6249 14.08 20.014L14.5035 19.294C15.0381 18.3851 16.0106 17.8237 17.065 17.8151L17.9004 17.8083C18.6091 17.8026 19.2618 17.4222 19.6162 16.8084L19.9723 16.1916C20.3267 15.5778 20.3298 14.8224 19.9804 14.2057L19.5686 13.4788C19.0488 12.5615 19.0488 11.4386 19.5686 10.5212L19.9804 9.7943C20.3298 9.17767 20.3267 8.42219 19.9723 7.80841L19.6162 7.19161C19.2618 6.57783 18.6091 6.19744 17.9004 6.19168L17.065 6.18489C16.0106 6.17632 15.0382 5.61487 14.5036 4.70605L14.08 3.98596C13.7206 3.37508 13.0648 3 12.3561 3H11.6439Z",stroke:"currentColor",strokeWidth:"2",strokeLinejoin:"round"}),c.jsx("circle",{cx:"12",cy:"12",r:"2.5",stroke:"currentColor",strokeWidth:"2"})]})})]})]})}),c.jsxs(y_,{className:"w-full max-w-md border-none bg-surface-primary text-text-primary",children:[c.jsx(__,{className:"border-b border-border-light sm:p-3",children:c.jsx(w_,{children:t("com_ui_authentication")})}),c.jsxs("div",{className:"p-4 sm:p-6 sm:pt-0",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:t("com_ui_authentication_type")}),c.jsxs(Us,{defaultValue:ho.None,onValueChange:e=>o("type",e),value:l,role:"radiogroup","aria-required":"false",dir:"ltr",className:"flex gap-4",style:{outline:"none"},children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rf8:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:ho.None,id:":rf8:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),t("com_ui_none")]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rfa:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:ho.ServiceHttp,id:":rfa:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),t("com_ui_api_key")]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rfc:",className:rm("flex items-center gap-1",!0===e?"cursor-not-allowed":"cursor-pointer"),children:[c.jsx(Vs,{type:"button",role:"radio",disabled:e,value:ho.OAuth,id:":rfc:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary",!0===e?"cursor-not-allowed":""),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),t("com_ui_oauth")]})})]})]}),"none"===l?null:"service_http"===l?c.jsx(jS,{}):c.jsx(NS,{}),c.jsxs("div",{className:"mt-5 flex flex-col gap-3 sm:mt-4 sm:flex-row-reverse",children:[c.jsx("button",{className:"btn relative bg-surface-submit text-primary-foreground hover:bg-surface-submit-hover",onClick:async()=>{const e=await i(void 0,{shouldFocus:!0});o("saved_auth_fields",e),s(!e)},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2 text-white",children:t("com_ui_save")})}),c.jsx(v_,{className:"btn btn-neutral relative",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:t("com_ui_cancel")})})]})]})]})]})}const jS=()=>{const e=kg(),{register:t,watch:n,setValue:a}=Ut(),s=n("authorization_type"),r=n("type");return c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_api_key")}),c.jsx("input",{placeholder:"<HIDDEN>",type:"new-password",autoComplete:"new-password",className:rm("mb-2 h-9 w-full resize-none overflow-y-auto rounded-lg border px-3 py-2 text-sm","border-border-medium bg-surface-primary outline-none","focus:ring-2 focus:ring-ring"),...t("api_key",{required:r===ho.ServiceHttp})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_auth_type")}),c.jsxs(Us,{defaultValue:vo.Basic,onValueChange:e=>a("authorization_type",e),value:s,role:"radiogroup","aria-required":"true",dir:"ltr",className:"mb-2 flex gap-6 overflow-hidden rounded-lg",style:{outline:"none"},children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rfu:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:vo.Basic,id:":rfu:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),e("com_ui_basic")]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rg0:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:vo.Bearer,id:":rg0:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),e("com_ui_bearer")]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rg2:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:vo.Custom,id:":rg2:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),e("com_ui_custom")]})})]}),s===vo.Custom&&c.jsxs("div",{className:"mt-2",children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_custom_header_name")}),c.jsx("input",{className:rm("mb-2 h-9 w-full resize-none overflow-y-auto rounded-lg border px-3 py-2 text-sm","border-border-medium bg-surface-primary outline-none","focus:ring-2 focus:ring-ring"),placeholder:"X-Api-Key",...t("custom_auth_header",{required:s===vo.Custom})})]})]})};function wS(e){switch(e){case ho.ServiceHttp:return"com_ui_api_key";case ho.OAuth:return"com_ui_oauth";default:return"com_ui_none"}}const NS=()=>{const e=kg(),{register:t,watch:n,setValue:a}=Ut(),s=n("token_exchange_method"),r=n("type"),o=rm("mb-2 h-9 w-full resize-none overflow-y-auto rounded-lg border px-3 py-2 text-sm","border-border-medium bg-surface-primary outline-none","focus:ring-2 focus:ring-ring");return c.jsxs(c.Fragment,{children:[c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_client_id")}),c.jsx("input",{placeholder:"<HIDDEN>",type:"password",autoComplete:"new-password",className:o,...t("oauth_client_id",{required:!1})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_client_secret")}),c.jsx("input",{placeholder:"<HIDDEN>",type:"password",autoComplete:"new-password",className:o,...t("oauth_client_secret",{required:!1})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_auth_url")}),c.jsx("input",{className:o,...t("authorization_url",{required:r===ho.OAuth})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_token_url")}),c.jsx("input",{className:o,...t("client_url",{required:r===ho.OAuth})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_scope")}),c.jsx("input",{className:o,...t("scope",{required:r===ho.OAuth})}),c.jsx("label",{className:"mb-1 block text-sm font-medium",children:e("com_ui_token_exchange_method")}),c.jsxs(Us,{defaultValue:vo.Basic,onValueChange:e=>a("token_exchange_method",e),value:s,role:"radiogroup","aria-required":"true",dir:"ltr",style:{outline:"none"},children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rj1:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:bo.DefaultPost,id:":rj1:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),e("com_ui_default_post_request")]})}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("label",{htmlFor:":rj3:",className:"flex cursor-pointer items-center gap-1",children:[c.jsx(Vs,{type:"button",role:"radio",value:bo.BasicAuthHeader,id:":rj3:",className:rm("mr-1 flex h-5 w-5 items-center justify-center rounded-full border","border-border-heavy bg-surface-primary"),children:c.jsx(Bs,{className:"h-2 w-2 rounded-full bg-text-primary"})}),e("com_ui_basic_auth_header")]})})]})]})};function CS({action_id:e}){const t=kg(),{watch:a}=Ut(),{showToast:s}=Ng(),[r,o]=n.useState(!1),i=`${window.location.protocol}//${window.location.host}/api/actions/${e}/oauth/callback`,l=cb({text:i});if(!e)return null;return a("type")!==ho.OAuth?null:c.jsxs("div",{className:"mb-1.5 flex flex-col space-y-2",children:[c.jsx("label",{className:"font-semibold",children:t("com_ui_callback_url")}),c.jsx("div",{className:"relative flex items-center",children:c.jsxs("div",{className:"border-token-border-medium bg-token-surface-primary hover:border-token-border-hover flex h-10 w-full rounded-lg border",children:[c.jsx("div",{className:"flex-1 overflow-hidden",children:c.jsx("div",{className:"relative w-full",children:c.jsx("input",{type:"text",readOnly:!0,value:i,className:"w-full border-0 bg-transparent px-3 py-2 pr-12 text-sm text-text-secondary-alt focus:outline-none",style:{direction:"rtl"}})})}),c.jsx("div",{className:"absolute right-0 flex h-full items-center pr-1",children:c.jsx(By,{size:"sm",variant:"ghost",type:"button",onClick:()=>{r||(s({message:t("com_ui_copied_to_clipboard")}),l(o))},className:rm("h-8 rounded-md px-2",r?"cursor-default":""),"aria-label":t("com_ui_copy_link"),children:r?c.jsx(rn,{className:"size-4"}):c.jsx(on,{className:"size-4"})})})]})})]})}function kS({columns:e,data:t}){const n=or({columns:e,data:t,getCoreRowModel:lr()});return c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:n.getHeaderGroups().map(((e,t)=>c.jsx("tr",{className:"border-token-border-light text-token-text-tertiary border-b text-left text-xs",children:e.headers.map(((e,t)=>c.jsx("th",{className:"py-1 font-normal text-text-secondary-alt",children:e.isPlaceholder?null:ir(e.column.columnDef.header,e.getContext())},t)))},t)))}),c.jsx("tbody",{children:n.getRowModel().rows.map(((e,t)=>c.jsx("tr",{className:"border-token-border-light border-b",children:e.getVisibleCells().map(((e,t)=>c.jsx("td",{className:"py-2",children:ir(e.column.columnDef.cell,e.getContext())},t)))},t)))})]})}const SS=[{header:"Name",accessorKey:"name"},{header:"Method",accessorKey:"method"},{header:"Path",accessorKey:"path"}],TS=$(((e,t)=>{t(qd(e))}),800);function RS({action:e,agent_id:t,setAction:a}){const s=e=>{e.status||(f(null),h(null)),u(e)},r=kg(),{showToast:o}=Ng(),{handleSubmit:i,reset:l}=Ut(),[d,u]=n.useState(null),[m,p]=n.useState(""),[g,f]=n.useState(null),[x,h]=n.useState(null);n.useEffect((()=>{const t=(null==e?void 0:e.metadata.raw_spec)??"";t&&(p(t),TS(t,s))}),[null==e?void 0:e.metadata.raw_spec]),n.useEffect((()=>{if(!d||!d.status||!d.spec)return;const{functionSignatures:e,requestBuilders:t}=Qd(d.spec),n=Object.entries(t).map((([e,t])=>({name:e,method:t.method,path:t.path,domain:t.domain})));f(n),u(null),h(e.map((e=>e.toObjectTool())))}),[d]);const v=Pp({onSuccess(e){o({message:r("com_assistants_update_actions_success"),status:"success"}),l(),a(e[1])},onError(e){o({message:e.message||r("com_assistants_update_actions_error"),status:"error"})}}),b=i((n=>{om.log("actions","saving action",n);const a=t??"";if(!a)return;if(!x)return;if(!g)return;let{metadata:s={}}=e??{};const r=null==e?void 0:e.action_id;s.raw_spec=m;const o=new URL(g[0].domain).hostname;if(!o)return;s.domain=o;const{type:i,saved_auth_fields:l}=n,c=e=>{delete e.auth,delete e.api_key,delete e.oauth_client_id,delete e.oauth_client_secret};l&&i===ho.ServiceHttp?s={...s,api_key:n.api_key,auth:{type:i,authorization_type:n.authorization_type,custom_auth_header:n.custom_auth_header}}:l&&i===ho.OAuth?s={...s,auth:{type:i,authorization_url:n.authorization_url,client_url:n.client_url,scope:n.scope,token_exchange_method:n.token_exchange_method},oauth_client_id:n.oauth_client_id,oauth_client_secret:n.oauth_client_secret}:l?(c(s),s.auth={type:i}):c(s),v.mutate({action_id:r,metadata:s,functions:x,agent_id:a})}));return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"",children:[c.jsxs("div",{className:"mb-1 flex flex-wrap items-center justify-between gap-4",children:[c.jsx("label",{htmlFor:"schemaInput",className:"text-token-text-primary whitespace-nowrap font-medium",children:"Schema"}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("select",{onChange:e=>om.log("actions","selecting example action",e.target.value),className:"border-token-border-medium h-8 min-w-[100px] rounded-lg border bg-transparent px-2 py-0 text-sm",children:[c.jsx("option",{value:"label",children:r("com_ui_examples")}),c.jsx("option",{value:"0",children:"Weather (JSON)"}),c.jsx("option",{value:"1",children:"Pet Store (YAML)"}),c.jsx("option",{value:"2",children:"Blank Template"})]})})]}),c.jsxs("div",{className:"border-token-border-medium bg-token-surface-primary hover:border-token-border-hover mb-4 w-full overflow-hidden rounded-lg border ring-0",children:[c.jsx("div",{className:"relative",children:c.jsx("textarea",{id:"schemaInput",value:m,onChange:e=>{const t=e.target.value;if(p(t),!t)return f(null),h(null),u(null);TS(t,s)},spellCheck:"false",placeholder:r("com_ui_enter_openapi_schema"),className:"text-token-text-primary block h-96 w-full bg-transparent p-2 font-mono text-xs outline-none focus:ring-1 focus:ring-border-light"})}),d&&"OpenAPI spec is valid."!==d.message&&c.jsx("div",{className:"border-token-border-light border-t p-2 text-red-500",children:d.message.split("\n").map(((e,t)=>c.jsx("div",{children:e},t)))})]})]}),!!g&&c.jsxs("div",{className:"my-2",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:r("com_assistants_available_actions")})}),c.jsx(kS,{columns:SS,data:g})]}),c.jsxs("div",{className:"relative my-1",children:[c.jsx(CS,{action_id:null==e?void 0:e.action_id}),c.jsx("div",{className:"mb-1.5 flex items-center",children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:r("com_ui_privacy_policy_url")})}),c.jsx("div",{className:"border-token-border-medium bg-token-surface-primary hover:border-token-border-hover flex h-9 w-full rounded-lg border",children:c.jsx("input",{type:"text",placeholder:"https://api.example-weather-app.com/privacy",className:"flex-1 rounded-lg bg-transparent px-3 py-1.5 text-sm outline-none placeholder:text-text-secondary-alt focus:ring-1 focus:ring-border-light"})})]}),c.jsx("div",{className:"flex items-center justify-end",children:c.jsx("button",{disabled:!x||!x.length,onClick:b,className:"focus:shadow-outline mt-1 flex min-w-[100px] items-center justify-center rounded bg-green-500 px-4 py-2 font-semibold text-white hover:bg-green-400 focus:border-green-500 focus:outline-none focus:ring-0 disabled:bg-green-400",type:"button",children:v.isLoading?c.jsx(Hb,{className:"icon-md"}):null!=(null==e?void 0:e.action_id)&&e.action_id?r("com_ui_update"):r("com_ui_create")})})]})}function IS({action:e,setAction:t,agent_id:a,setActivePanel:s}){const r=kg(),{showToast:o}=Ng(),i=Lp({onSuccess:()=>{o({message:r("com_assistants_delete_actions_success"),status:"success"}),s(Hr.builder),t(void 0)},onError(e){o({message:e.message??r("com_assistants_delete_actions_error"),status:"error"})}}),l=ne({defaultValues:{type:ho.None,saved_auth_fields:!1,api_key:"",authorization_type:vo.Basic,custom_auth_header:"",oauth_client_id:"",oauth_client_secret:"",authorization_url:"",client_url:"",scope:"",token_exchange_method:bo.DefaultPost}}),{reset:d,watch:u}=l;return n.useEffect((()=>{(null==e?void 0:e.metadata.auth)&&d({type:e.metadata.auth.type||ho.None,saved_auth_fields:!1,api_key:e.metadata.api_key??"",authorization_type:e.metadata.auth.authorization_type||vo.Basic,oauth_client_id:e.metadata.oauth_client_id??"",oauth_client_secret:e.metadata.oauth_client_secret??"",authorization_url:e.metadata.auth.authorization_url??"",client_url:e.metadata.auth.client_url??"",scope:e.metadata.auth.scope??"",token_exchange_method:e.metadata.auth.token_exchange_method??bo.DefaultPost})}),[e,d]),c.jsx(Kt,{...l,children:c.jsx("form",{className:"h-full grow overflow-hidden",children:c.jsxs("div",{className:"h-full overflow-auto px-2 pb-12 text-sm",children:[c.jsxs("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[c.jsx("div",{className:"absolute left-0 top-6",children:c.jsx("button",{type:"button",className:"btn btn-neutral relative",onClick:()=>{s(Hr.builder),t(void 0)},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:c.jsx(Cn,{})})})}),!!e&&c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx("div",{className:"absolute right-0 top-6",children:c.jsx("button",{type:"button",disabled:!a||!e.action_id,className:"btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",children:c.jsx(uy,{className:"text-red-500"})})})}),c.jsx(ij,{showCloseButton:!1,title:r("com_ui_delete_action"),className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:r("com_ui_delete_action_confirm")}),selection:{selectHandler:()=>{if(!a)return o({message:"No agent_id found, is the agent created?",status:"error"});i.mutate({action_id:e.action_id,agent_id:a})},selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 transition-color duration-200 text-white",selectText:r("com_ui_delete")}})]}),c.jsx("div",{className:"text-xl font-medium",children:(e?"Edit":"Add")+" actions"}),c.jsx("div",{className:"text-xs text-text-secondary",children:r("com_assistants_actions_info")})]}),c.jsx(_S,{}),c.jsx(RS,{action:e,agent_id:a,setAction:t})]})})})}function ES(){return c.jsxs("div",{className:"h-auto bg-white px-4 pb-8 pt-3 dark:bg-transparent",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("div",{className:"flex w-full items-center justify-center gap-4",children:c.jsx(T_,{className:"relative h-20 w-20 rounded-full"})}),c.jsx(T_,{className:"mb-2 h-5 w-1/5 rounded-lg"}),c.jsx(T_,{className:"mb-1 h-[40px] w-full rounded-lg"}),c.jsx(T_,{className:"h-3 w-1/4 rounded-lg"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx(T_,{className:"mb-2 h-5 w-1/4 rounded-lg"}),c.jsx(T_,{className:"h-[40px] w-full rounded-lg"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx(T_,{className:"mb-2 h-5 w-1/4 rounded-lg"}),c.jsx(T_,{className:"h-[100px] w-full rounded-lg"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx(T_,{className:"mb-2 h-5 w-1/4 rounded-lg"}),c.jsx(T_,{className:"h-[40px] w-full rounded-lg"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx(T_,{className:"mb-2 h-5 w-1/4 rounded-lg"}),c.jsx(T_,{className:"mb-2 h-5 w-36 rounded-lg"}),c.jsx(T_,{className:"mb-4 h-[35px] w-full rounded-lg"}),c.jsx(T_,{className:"mb-2 h-5 w-24 rounded-lg"}),c.jsx(T_,{className:"h-[35px] w-full rounded-lg"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx(T_,{className:"mb-2 h-5 w-1/4 rounded-lg"}),c.jsx(T_,{className:"mb-2 h-[35px] w-full rounded-lg"}),c.jsx(T_,{className:"mb-2 h-[35px] w-full rounded-lg"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx(T_,{className:"h-8 w-1/2 rounded-lg"}),c.jsx(T_,{className:"h-8 w-1/2 rounded-lg"})]})]}),c.jsx("div",{className:"mb-6",children:c.jsx(T_,{className:"h-[35px] w-full rounded-lg"})}),c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(T_,{className:"h-[35px] w-16 rounded-lg"}),c.jsx(T_,{className:"h-[35px] w-16 rounded-lg"}),c.jsx(T_,{className:"h-[35px] w-16 rounded-lg"}),c.jsx(T_,{className:"h-[35px] w-full rounded-lg"})]})]})}function PS({action:e,onClick:t}){const[a,s]=n.useState(!1);return c.jsxs("div",{role:"button",tabIndex:0,onClick:t,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||t()},className:"group flex w-full rounded-lg border border-border-medium text-sm hover:cursor-pointer focus:outline-none focus:ring-2 focus:ring-text-primary",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),"aria-label":`Action for ${e.metadata.domain}`,children:[c.jsx("div",{className:"h-9 grow overflow-hidden text-ellipsis whitespace-nowrap px-3 py-2",style:{wordBreak:"break-all"},children:e.metadata.domain}),c.jsx("div",{className:rm("h-9 w-9 min-w-9 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-surface-tertiary focus:outline-none focus:ring-2 focus:ring-text-primary group-focus:flex",a?"flex":"hidden"),"aria-label":"Settings",children:c.jsx(cy,{className:"icon-sm","aria-hidden":"true"})})]})}function LS({tool:e,onAddTool:t,onRemoveTool:n,isInstalled:a=!1}){const s=kg(),r=()=>{a?n():t()};return c.jsxs("div",{className:"flex flex-col gap-4 rounded border border-border-medium bg-transparent p-6",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"h-[70px] w-[70px] shrink-0",children:c.jsxs("div",{className:"relative h-full w-full",children:[null!=e.icon&&e.icon?c.jsx("img",{src:e.icon,alt:s("com_ui_logo",{0:e.name}),className:"h-full w-full rounded-[5px] bg-white"}):c.jsx("div",{className:"flex h-full w-full items-center justify-center rounded-[5px] border border-border-medium bg-transparent",children:c.jsx(qe,{className:"h-8 w-8 text-text-secondary"})}),c.jsx("div",{className:"absolute inset-0 rounded-[5px] ring-1 ring-inset ring-black/10"})]})}),c.jsxs("div",{className:"flex min-w-0 flex-col items-start justify-between",children:[c.jsx("div",{className:"mb-2 line-clamp-1 max-w-full text-lg leading-5 text-text-primary",children:e.name}),a?c.jsx("button",{className:"btn relative bg-gray-300 hover:bg-gray-400 dark:bg-gray-50 dark:hover:bg-gray-200",onClick:r,"aria-label":`${s("com_nav_tool_remove")} ${e.name}`,children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[s("com_nav_tool_remove"),c.jsx(Xe,{className:"flex h-4 w-4 items-center stroke-2"})]})}):c.jsx("button",{className:"btn btn-primary relative","aria-label":`${s("com_ui_add")} ${e.name}`,onClick:r,children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[s("com_ui_add"),c.jsx(kn,{className:"flex h-4 w-4 items-center stroke-2"})]})})]})]}),c.jsx("div",{className:"line-clamp-3 h-[60px] text-sm text-text-secondary",children:e.description})]})}function MS({isOpen:e,endpoint:t,setIsOpen:a,toolsFormKey:s}){const r=kg(),{getValues:o,setValue:i}=Ut(),{data:l}=Qp(t),d=Do(t),{maxPage:u,setMaxPage:m,currentPage:p,setCurrentPage:g,itemsPerPage:f,searchChanged:x,setSearchChanged:h,searchValue:v,setSearchValue:b,gridRef:y,handleSearch:_,handleChangePage:j,error:w,setError:N,errorMessage:C,setErrorMessage:k,showPluginAuthForm:S,setShowPluginAuthForm:T,selectedPlugin:R,setSelectedPlugin:I}=hb(),E=xh(),P=e=>{var t,n;N(!0);const a=(null==(n=null==(t=e.response)?void 0:t.data)?void 0:n.message)??"";a&&k(a),setTimeout((()=>{N(!1),k("")}),5e3)},L=e=>{const t=()=>{const t=o(s).slice();t.push(e.pluginKey),i(s,t)};if(!e.auth)return t();E.mutate(e,{onError:e=>{P(e)},onSuccess:t}),T(!1)},M=null==l?void 0:l.filter((e=>e.name.toLowerCase().includes(v.toLowerCase())));return n.useEffect((()=>{M&&(m(Math.ceil(M.length/f)),x&&(g(1),h(!1)))}),[l,f,v,M,x,m,g,h]),c.jsxs(Cr,{open:e,onClose:()=>{a(!1),g(1),b("")},className:"relative z-[102]",children:[c.jsx("div",{className:"fixed inset-0 bg-surface-primary opacity-60 transition-opacity dark:opacity-80"}),c.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:c.jsxs(kr,{className:"relative w-full transform overflow-hidden overflow-y-auto rounded-lg bg-surface-secondary text-left shadow-xl transition-all max-sm:h-full sm:mx-7 sm:my-8 sm:max-w-2xl lg:max-w-5xl xl:max-w-7xl",style:{minHeight:"610px"},children:[c.jsxs("div",{className:"flex items-center justify-between border-b-[1px] border-border-medium px-4 pb-4 pt-5 sm:p-6",children:[c.jsx("div",{className:"flex items-center",children:c.jsxs("div",{className:"text-center sm:text-left",children:[c.jsx(Sr,{className:"text-lg font-medium leading-6 text-text-primary",children:r(d?"com_nav_tool_dialog_agents":"com_nav_tool_dialog")}),c.jsx(Er,{className:"text-sm text-text-secondary",children:r("com_nav_tool_dialog_description")})]})}),c.jsx("div",{children:c.jsx("div",{className:"sm:mt-0",children:c.jsx("button",{onClick:()=>{a(!1),g(1)},className:"inline-block rounded-full text-text-secondary transition-colors hover:text-text-primary","aria-label":"Close dialog",type:"button",children:c.jsx(ve,{"aria-hidden":"true"})})})})]}),w&&c.jsxs("div",{className:"relative m-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",role:"alert",children:[r("com_nav_plugin_auth_error")," ",C]}),S&&c.jsx("div",{className:"p-4 sm:p-6 sm:pt-4",children:c.jsx(yj,{plugin:R,onSubmit:e=>L(e),isEntityTool:!0})}),c.jsxs("div",{className:"p-4 sm:p-6 sm:pt-4",children:[c.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[c.jsx(Qe,{className:"h-6 w-6 text-text-tertiary"}),c.jsx("input",{type:"text",value:v,onChange:_,placeholder:r("com_nav_tool_search"),className:"w-64 rounded border border-border-medium bg-transparent px-2 py-1 text-text-primary focus:outline-none"})]}),c.jsx("div",{ref:y,className:"grid grid-cols-1 grid-rows-2 gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",style:{minHeight:"410px"},children:M&&M.slice((p-1)*f,p*f).map(((e,t)=>c.jsx(LS,{tool:e,isInstalled:o(s).includes(e.pluginKey),onAddTool:()=>(e=>{T(!1);const t=null==l?void 0:l.find((t=>t.pluginKey===e));I(t);const{authConfig:n,authenticated:a=!1}=t??{};n&&n.length>0&&!a?T(!0):L({pluginKey:e,action:"install",auth:null})})(e.pluginKey),onRemoveTool:()=>(e=>{T(!1),E.mutate({pluginKey:e,action:"uninstall",auth:null,isEntityTool:!0},{onError:e=>{P(e)},onSuccess:()=>{const t=o(s).filter((t=>t!==e));i(s,t)}})})(e.pluginKey)},t)))})]}),c.jsx("div",{className:"mt-2 flex flex-col items-center gap-2 sm:flex-row sm:justify-between",children:u>0?c.jsx(hj,{currentPage:p,maxPage:u,onChangePage:j}):c.jsx("div",{style:{height:"21px"}})})]})]})})]})}function AS({agent_id:e}){const t=kg(),{showToast:n}=Ng(),a=Ip({onSuccess:()=>{n({message:t("com_ui_agent_duplicated"),status:"success"})},onError:e=>{console.error(e),n({message:t("com_ui_agent_duplicate_error"),status:"error"})}});if(!e)return null;return c.jsx("button",{className:rm("btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",mm),"aria-label":t("com_ui_duplicate")+" "+t("com_ui_agent"),type:"button",onClick:()=>{a.mutate({agent_id:e})},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2 text-primary",children:c.jsx(on,{className:"size-4"})})})}const OS=({control:e,agentPerm:t,label:n,getValues:a,setValue:s})=>c.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2",children:[c.jsx("button",{className:"cursor-pointer select-none",type:"button",onClick:()=>s(t,!a(t),{shouldDirty:!0}),tabIndex:0,children:n}),c.jsx(tt,{name:t,control:e,render:({field:e})=>c.jsx(R_,{...e,checked:e.value,onCheckedChange:e.onChange,value:e.value.toString()})})]}),DS=()=>{const e=kg(),{user:t,roles:a}=Wh(),{showToast:s}=Ng(),{mutate:r,isLoading:o}=(e=>{const t=ar(),{onMutate:n,onSuccess:a,onError:s}=e??{};return sr((e=>(td.partial().parse(e.updates),zd.updateAgentPermissions(e))),{onSuccess:(e,n,s)=>{t.invalidateQueries([Xc.roles,n.roleName]),null!=a&&a(e,n,s)},onError:(...e)=>{const t=e[0];null!=t&&console.error("Failed to update prompt permissions:",t),null!=s&&s(...e)},onMutate:n})})({onSuccess:()=>{s({status:"success",message:e("com_ui_saved")})},onError:()=>{s({status:"error",message:e("com_ui_error_save_admin_settings")})}}),[i,l]=n.useState(!1),[d,u]=n.useState(qc.USER),m=n.useMemo((()=>(null==a?void 0:a[d])?a[d][Zc.AGENTS]:ld[d][Zc.AGENTS]),[a,d]),{reset:p,control:g,setValue:f,getValues:x,handleSubmit:h,formState:{isSubmitting:v}}=ne({mode:"onChange",defaultValues:m});if(n.useEffect((()=>{var e;(null==(e=null==a?void 0:a[d])?void 0:e[Zc.AGENTS])?p(a[d][Zc.AGENTS]):p(ld[d][Zc.AGENTS])}),[a,d,p]),(null==t?void 0:t.role)!==qc.ADMIN)return null;const b=[{agentPerm:Yc.SHARED_GLOBAL,label:e("com_ui_agents_allow_share_global")},{agentPerm:Yc.CREATE,label:e("com_ui_agents_allow_create")},{agentPerm:Yc.USE,label:e("com_ui_agents_allow_use")}],y=[{label:qc.USER,onClick:()=>{u(qc.USER)}},{label:qc.ADMIN,onClick:()=>{u(qc.ADMIN)}}];return c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsxs(By,{size:"sm",variant:"outline",className:"btn btn-neutral border-token-border-light relative mb-4 h-9 w-full gap-1 rounded-lg font-medium",children:[c.jsx(ct,{className:"cursor-pointer","aria-hidden":"true"}),e("com_ui_admin_settings")]})}),c.jsxs(y_,{className:"w-1/4 border-border-light bg-surface-primary text-text-primary",children:[c.jsx(w_,{children:`${e("com_ui_admin_settings")} - ${e("com_ui_agents")}`}),c.jsxs("div",{className:"p-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"font-medium",children:[e("com_ui_role_select"),":"]}),c.jsx(Y_,{menuId:"role-dropdown",isOpen:i,setIsOpen:l,trigger:c.jsx(dt,{className:"inline-flex w-1/4 items-center justify-center rounded-lg border border-border-light bg-transparent px-2 py-1 text-text-primary transition-all ease-in-out hover:bg-surface-tertiary",children:d}),items:y,itemClassName:"items-center justify-center",sameWidth:!0})]}),c.jsxs("form",{onSubmit:h((e=>{r({roleName:d,updates:e})})),children:[c.jsx("div",{className:"py-5",children:b.map((({agentPerm:t,label:n})=>c.jsxs("div",{children:[c.jsx(OS,{control:g,agentPerm:t,label:n,getValues:x,setValue:f}),d===qc.ADMIN&&t===Yc.USE&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"mb-2 max-w-full whitespace-normal break-words text-sm text-red-600",children:[c.jsx("span",{children:e("com_ui_admin_access_warning")}),"\n",c.jsx("a",{href:"https://www.librechat.ai/docs/configuration/librechat_yaml/object_structure/interface",target:"_blank",rel:"noreferrer",className:"text-blue-500 underline",children:e("com_ui_more_info")})]})})]},t)))}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"submit",disabled:v||o,className:"btn rounded bg-green-500 font-bold text-white transition-all hover:bg-green-600",children:e("com_ui_save")})})]})]})]})]})};function FS({agent_id:e,setCurrentAgentId:t,createMutation:n}){const a=kg(),{showToast:s}=Ng(),{conversation:r}=bh(),{setOption:o}=Ev(),i=Rp({onSuccess:(e,i,l)=>{var c;const d=l;if(!d)return;s({message:a("com_ui_agent_deleted"),status:"success"}),(null==(c=n.data)?void 0:c.id)&&(om.log("agents","resetting createMutation"),n.reset());const u=d[0];if(!u)return o("agent_id")("");if(i.agent_id===(null==r?void 0:r.agent_id))return o("model")(""),o("agent_id")(u.id);const m=d.find((e=>e.id===(null==r?void 0:r.agent_id)));m&&t(m.id),t(u.id)},onError:e=>{console.error(e),s({message:a("com_ui_agent_delete_error"),status:"error"})}});return e?c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx("button",{className:rm("btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",mm),"aria-label":a("com_ui_delete")+" "+a("com_ui_agent"),type:"button",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2 text-red-500",children:c.jsx(uy,{})})})}),c.jsx(ij,{title:a("com_ui_delete")+" "+a("com_ui_agent"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(g_,{htmlFor:"delete-agent",className:"text-left text-sm font-medium",children:a("com_ui_delete_agent_confirm")})})})}),selection:{selectHandler:()=>i.mutate({agent_id:e}),selectClasses:"bg-red-600 hover:bg-red-700 dark:hover:bg-red-800 text-white",selectText:a("com_ui_delete")}})]}):null}function zS(){return c.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-black",children:c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"text-4xl",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})}const US=({url:e,progress:t=1})=>{const n=2*Math.PI*55,a=n-t*n;return c.jsx("div",{children:c.jsxs("div",{className:"relative h-20 w-20 overflow-hidden rounded-full",children:[c.jsx("img",{src:e,className:"bg-token-surface-secondary dark:bg-token-surface-tertiary h-full w-full rounded-full object-cover",alt:"GPT",width:"80",height:"80",style:{opacity:t<1?.4:1}}),t<1&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",className:"h-6 w-6",children:[c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 stroke-gray-400",strokeWidth:"10",fill:"transparent",r:"55",cx:"60",cy:"60"}),c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 transition-[stroke-dashoffset]",stroke:"currentColor",strokeWidth:"10",strokeDasharray:`${n} ${n}`,strokeDashoffset:a,fill:"transparent",r:"55",cx:"60",cy:"60",style:{transition:"stroke-dashoffset 0.3s linear"}})]})})]})})};function VS({handleFileChange:e}){const t=kg(),a=n.useRef(null);return c.jsx(Os,{children:c.jsxs(Ds,{className:"flex min-w-[100px] max-w-xs flex-col rounded-xl border border-gray-400 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-850 dark:text-white",sideOffset:5,children:[c.jsx("div",{role:"menuitem",className:"group m-1.5 flex cursor-pointer gap-2 rounded p-2.5 text-sm hover:bg-gray-100 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 dark:hover:bg-gray-800 dark:hover:bg-white/5",tabIndex:-1,"data-orientation":"vertical",onClick:()=>{var e;a.current&&(a.current.value=""),null==(e=a.current)||e.click()},children:t("com_ui_upload_image")}),c.jsx("input",{accept:"image/png,.png,image/jpeg,.jpg,.jpeg,image/gif,.gif,image/webp,.webp",multiple:!1,type:"file",style:{display:"none"},onChange:e,ref:a,tabIndex:-1})]})})}function BS({agent_id:e="",avatar:t,createMutation:a}){const s=ar(),[r,o]=n.useState(!1),[i,l]=n.useState(""),[d,u]=n.useState(1),[m,p]=n.useState(null),g=n.useRef(null),{data:f=Gi}=Dp({select:e=>Zi(e)}),x=kg(),{showToast:h}=Ng(),{mutate:v}=Ep({onMutate:()=>{u(.4)},onSuccess:(t,n)=>{var r,o,i;!1===n.postCreation?h({message:x("com_ui_upload_success")}):g.current!==(null==(r=a.data)?void 0:r.id)&&(g.current=(null==(o=a.data)?void 0:o.id)??""),p(null);const c=(null==(i=t.avatar)?void 0:i.filepath)??"";l(c);const d=s.getQueryData([Xc.agents,To]);if(!(null==d?void 0:d.data))return;const m=d.data.map((n=>n.id===e?{...n,...t}:n));s.setQueryData([Xc.agents,To],{...d,data:m}),u(1)},onError:e=>{console.error("Error:",e),p(null),l(""),h({message:x("com_ui_upload_error"),status:"error"}),u(1)}});n.useEffect((()=>{if(m){const e=new FileReader;e.onloadend=()=>{l(e.result)},e.readAsDataURL(m)}}),[m]),n.useEffect((()=>{t&&t.filepath?l(t.filepath):l("")}),[t]),n.useEffect((()=>{const e=!!(a.isSuccess&&m&&i&&i.includes("base64"));if((!e||g.current!==a.data.id)&&e&&a.data.id){const e=new FormData;e.append("file",m,m.name),e.append("agent_id",a.data.id),v({agent_id:a.data.id,postCreation:!0,formData:e})}}),[a.data,a.isSuccess,m,i,v]);return c.jsxs(Ms,{open:r,onOpenChange:o,children:[c.jsx("div",{className:"flex w-full items-center justify-center gap-4",children:c.jsx(As,{asChild:!0,children:c.jsx("button",{type:"button",className:"h-20 w-20",children:i?c.jsx(US,{url:i,progress:d}):c.jsx(zS,{})})})}),c.jsx(VS,{handleFileChange:n=>{var a;const s=null==(a=n.target.files)?void 0:a[0],r=f.avatarSizeLimit??0;if(r&&s&&s.size<=r){p(s),o(!1);const n=e??"";if(!n)return;const a=new FormData;a.append("file",s,s.name),a.append("agent_id",n),"object"==typeof t&&a.append("avatar",JSON.stringify(t)),v({agent_id:n,formData:a})}else{const e=r?su(r):2;h({message:x("com_ui_upload_invalid_var",{0:e+""}),status:"error"})}o(!1)}})]})}const $S=({imageBase64:e,url:t,progress:a=1,className:s="",source:r,alt:o="Preview image"})=>{const[i,l]=n.useState(!1),[d,u]=n.useState(!1),[m,p]=n.useState(null),g=n.useCallback((()=>{p(document.activeElement),l(!0)}),[]),f=n.useCallback((e=>{l(!1),e.stopPropagation(),e.preventDefault(),m instanceof HTMLElement&&!m.closest('[data-skip-refocus="true"]')&&m.focus()}),[m]),x=n.useCallback((e=>{"Escape"===e.key&&f(e)}),[f]);n.useEffect((()=>{if(i){document.addEventListener("keydown",x),document.body.style.overflow="hidden";const e=document.querySelector('[aria-label="Close full view"]');e&&setTimeout((()=>e.focus()),0)}return()=>{document.removeEventListener("keydown",x),document.body.style.overflow="unset"}}),[i,x]);const h={backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},v=e??t??"",b=v?{...h,backgroundImage:`url(${v})`}:h;if("string"!=typeof b.backgroundImage||0===b.backgroundImage.length)return null;const y=2*Math.PI*55,_=y-a*y;return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:rm("relative size-14 rounded-xl",s),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[c.jsx("button",{type:"button",className:"size-full overflow-hidden rounded-xl",style:b,"aria-label":`View ${o} in full size`,"aria-haspopup":"dialog",onClick:e=>{e.preventDefault(),e.stopPropagation(),g()}}),a<1?c.jsx(qj,{circumference:y,offset:_,circleCSSProperties:{transition:"stroke-dashoffset 0.3s linear"},"aria-label":`Loading progress: ${Math.round(100*a)}%`}):c.jsx("div",{className:rm("absolute inset-0 flex transform-gpu cursor-pointer items-center justify-center rounded-xl transition-opacity duration-200 ease-in-out",d?"bg-black/20 opacity-100":"opacity-0"),onClick:e=>{e.stopPropagation(),g()},"aria-hidden":"true",children:c.jsx(Sn,{className:rm("size-5 transform-gpu text-white drop-shadow-lg transition-all duration-200",d?"scale-110":"")})}),c.jsx(yN,{source:r,"aria-label":r?`Source: ${r}`:void 0})]}),c.jsx(f_,{open:i,onOpenChange:l,children:c.jsx(y_,{showCloseButton:!1,className:rm("w-11/12 overflow-x-auto bg-transparent p-0 sm:w-auto"),disableScroll:!1,children:c.jsx("img",{src:v,alt:o,className:"max-w-screen h-full max-h-screen w-full object-contain"})})})]})},HS=({imageBase64:e,url:t,onDelete:n,progress:a=1,source:s=ji.local})=>c.jsxs("div",{className:"group relative inline-block text-sm text-black/70 dark:text-white/90",children:[c.jsx("div",{className:"relative overflow-hidden rounded-2xl border border-gray-200 dark:border-gray-600",children:c.jsx($S,{source:s,imageBase64:e,url:t,progress:a})}),c.jsx(MC,{onRemove:n})]});function GS({files:e,setFiles:t,abortUpload:a,setFilesLoading:s,assistant_id:r,agent_id:o,tool_resource:i,fileFilter:l,isRTL:d=!1,Wrapper:u}){const m=Array.from((null==e?void 0:e.values())??[]).filter((e=>!l||l(e))),{mutateAsync:p}=Fp({onMutate:async()=>om.log("agents","Deleting files: agent_id, assistant_id, tool_resource",o,r,i),onSuccess:()=>{console.log("Files deleted")},onError:e=>{console.log("Error deleting files:",e)}}),{deleteFile:g}=Bv({mutateAsync:p,agent_id:o,assistant_id:r,tool_resource:i});if(n.useEffect((()=>{0!==m.length&&(m.some((e=>e.progress<1))||m.every((e=>1===e.progress))&&s(!1))}),[m]),0===m.length)return null;const f=()=>{const e=d?{display:"flex",flexDirection:"row-reverse",flexWrap:"wrap",gap:"4px",width:"100%",maxWidth:"100%"}:{display:"flex",flexWrap:"wrap",gap:"4px",width:"100%",maxWidth:"100%"};return c.jsx("div",{style:e,children:m.reduce(((e,t)=>(e.map.has(t.file_id)||(e.map.set(t.file_id,!0),e.uniqueFiles.push(t)),e)),{map:new Map,uniqueFiles:[]}).uniqueFiles.map(((e,n)=>{var s;const r=()=>{a&&e.progress<1&&a(),g({file:e,setFiles:t})},o=(null==(s=e.type)?void 0:s.startsWith("image"))??!1;return c.jsx("div",{style:{flexBasis:"70px",flexGrow:0,flexShrink:0},children:o?c.jsx(HS,{url:e.preview??e.filepath,onDelete:r,progress:e.progress,source:e.source}):c.jsx(AC,{file:e,onDelete:r})},n)}))})};return u?c.jsx(u,{children:f()}):f()}function KS(){const e=kg(),t=Ut(),{control:n,setValue:a,getValues:s}=t;return c.jsx(c.Fragment,{children:c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"my-2 flex items-center",children:[c.jsx(tt,{name:hl.file_search,control:n,render:({field:e})=>c.jsx($y,{...e,checked:e.value,onCheckedChange:e.onChange,className:"relative float-left mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString()})}),c.jsxs("button",{type:"button",className:"flex items-center space-x-2",onClick:()=>a(hl.file_search,!s(hl.file_search),{shouldDirty:!0}),children:[c.jsx("label",{className:"form-check-label text-token-text-primary w-full cursor-pointer",htmlFor:hl.file_search,children:e("com_agents_enable_file_search")}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-4 w-4 text-text-tertiary"})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,className:"w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-text-secondary",children:e("com_agents_file_search_info")})})})})]})})})}function WS({agent_id:e,files:t}){const a=kg(),{setFilesLoading:s}=bh(),{watch:r}=Ut(),o=n.useRef(null),[i,l]=n.useState(new Map),{data:d=Gi}=Dp({select:e=>Zi(e)}),{handleFileChange:u}=Gv({overrideEndpoint:Ro.agents,additionalMetadata:{agent_id:e,tool_resource:ro.file_search},fileSetter:l});Kv((()=>{t&&l(new Map(t))}),[t],750);const m=r(hl.file_search);if(d.endpoints[Ro.agents].disabled??!1)return null;return c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"mb-1.5 flex items-center gap-2",children:c.jsx("span",{children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:a("com_assistants_file_search")})})}),c.jsx(KS,{}),c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx(GS,{files:i,setFiles:l,setFilesLoading:s,agent_id:e,tool_resource:ro.file_search,Wrapper:({children:e})=>c.jsx("div",{className:"flex flex-wrap gap-2",children:e})}),c.jsx("div",{children:c.jsx("button",{type:"button",disabled:!e||!1===m,className:"btn btn-neutral border-token-border-light relative h-9 w-full rounded-lg font-medium",onClick:()=>{var e;o.current&&(o.current.value=""),null==(e=o.current)||e.click()},children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-1",children:[c.jsx(Zb,{className:"text-token-text-primary h-4 w-4"}),c.jsx("input",{multiple:!0,type:"file",style:{display:"none"},tabIndex:-1,ref:o,disabled:!e||!1===m,onChange:u}),a("com_ui_upload_file_search")]})})}),e?null:c.jsx("div",{className:"text-xs text-text-secondary",children:a("com_agents_file_search_disabled")})]})]})}function QS({agent_id:e="",agentName:t,projectIds:a=[],isCollaborative:s=!1}){const r=kg(),{showToast:o}=Ng(),{data:i={},isFetching:l}=Ap(),{instanceProjectId:d}=i,u=n.useMemo((()=>!!a.includes(d)),[a,d]),{watch:m,control:p,setValue:g,getValues:f,handleSubmit:x,formState:{isSubmitting:h}}=ne({mode:"onChange",defaultValues:{[Yc.SHARED_GLOBAL]:u,[Yc.UPDATE]:s}}),v=m(Yc.SHARED_GLOBAL);n.useEffect((()=>{v||g(Yc.UPDATE,!1)}),[v,g]),n.useEffect((()=>{g(Yc.SHARED_GLOBAL,u),g(Yc.UPDATE,s)}),[u,s,g]);const b=Tp({onSuccess:e=>{o({message:`${r("com_assistants_update_success")} ${e.name??r("com_ui_agent")}`,status:"success"})},onError:e=>{const t=e;o({message:`${r("com_agents_update_error")}${t.message?` ${r("com_ui_error")}: ${t.message}`:""}`,status:"error"})}});if(!e||!d)return null;const y=t=>{if(!e||!d)return;const n={};t[Yc.UPDATE]!==s&&(n.isCollaborative=t[Yc.UPDATE]),t[Yc.SHARED_GLOBAL]!==u&&(t[Yc.SHARED_GLOBAL]?n.projectIds=[i.instanceProjectId]:(n.removeProjectIds=[i.instanceProjectId],n.isCollaborative=!1)),Object.keys(n).length>0?b.mutate({agent_id:e,data:n}):o({message:r("com_ui_no_changes"),status:"info"})};return c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx("button",{className:rm("btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",mm),"aria-label":r("com_ui_share_var",{0:null!=t&&""!==t?`"${t}"`:r("com_ui_agent")}),type:"button",children:c.jsx("div",{className:"flex items-center justify-center gap-2 text-blue-500",children:c.jsx(lt,{className:"icon-md h-4 w-4"})})})}),c.jsxs(y_,{className:"w-11/12 md:max-w-xl",children:[c.jsx(w_,{children:r("com_ui_share_var",{0:null!=t&&""!==t?`"${t}"`:r("com_ui_agent")})}),c.jsxs("form",{className:"p-2",onSubmit:e=>{e.preventDefault(),e.stopPropagation(),x(y)(e)},children:[c.jsxs("div",{className:"flex items-center justify-between gap-2 py-2",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{type:"button",className:"mr-2 cursor-pointer",disabled:l||b.isLoading||!d,onClick:()=>g(Yc.SHARED_GLOBAL,!f(Yc.SHARED_GLOBAL),{shouldDirty:!0}),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g(Yc.SHARED_GLOBAL,!f(Yc.SHARED_GLOBAL),{shouldDirty:!0}))},"aria-checked":f(Yc.SHARED_GLOBAL),role:"checkbox",children:r("com_ui_share_to_all_users")}),c.jsx("label",{htmlFor:Yc.SHARED_GLOBAL,className:"select-none",children:u&&c.jsx("span",{className:"ml-2 text-xs",children:r("com_ui_agent_shared_to_all")})})]}),c.jsx(tt,{name:Yc.SHARED_GLOBAL,control:p,disabled:l||b.isLoading||!d,render:({field:e})=>c.jsx(R_,{...e,checked:e.value,onCheckedChange:e.onChange,value:e.value.toString()})})]}),c.jsxs("div",{className:"mb-4 flex items-center justify-between gap-2 py-2",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("button",{type:"button",className:"mr-2 cursor-pointer",disabled:l||b.isLoading||!d||!v,onClick:()=>g(Yc.UPDATE,!f(Yc.UPDATE),{shouldDirty:!0}),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g(Yc.UPDATE,!f(Yc.UPDATE),{shouldDirty:!0}))},"aria-checked":f(Yc.UPDATE),role:"checkbox",children:r("com_agents_allow_editing")})}),c.jsx(tt,{name:Yc.UPDATE,control:p,disabled:l||b.isLoading||!d||!v,render:({field:e})=>c.jsx(R_,{...e,checked:e.value,onCheckedChange:e.onChange,value:e.value.toString()})})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx(v_,{asChild:!0,children:c.jsx(By,{variant:"submit",size:"sm",type:"submit",disabled:h||l,children:r("com_ui_save")})})})]})]})]})}function qS(){const e=kg(),t=Ut(),{setValue:n,watch:a}=t,s=a(hl.artifacts),r=void 0!==s&&""!==s,o=s===_c.CUSTOM,i=s===_c.SHADCNUI;return c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"mb-1.5 flex items-center gap-2",children:c.jsx("span",{children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:e("com_ui_artifacts")})})}),c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx(ZS,{id:"artifacts",label:e("com_ui_artifacts_toggle_agent"),checked:r,onCheckedChange:e=>{n(hl.artifacts,e?_c.DEFAULT:"",{shouldDirty:!0})},hoverCardText:e("com_nav_info_code_artifacts_agent")}),c.jsx(ZS,{id:"includeShadcnui",label:e("com_ui_include_shadcnui_agent"),checked:i,onCheckedChange:e=>{n(hl.artifacts,e?_c.SHADCNUI:_c.DEFAULT,{shouldDirty:!0})},hoverCardText:e("com_nav_info_include_shadcnui"),disabled:!r||o}),c.jsx(ZS,{id:"customPromptMode",label:e("com_ui_custom_prompt_mode"),checked:o,onCheckedChange:e=>{n(hl.artifacts,e?_c.CUSTOM:_c.DEFAULT,{shouldDirty:!0})},hoverCardText:e("com_nav_info_custom_prompt_mode"),disabled:!r})]})]})}function ZS({id:e,label:t,checked:n,onCheckedChange:a,hoverCardText:s,disabled:r=!1}){return c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:r?"text-text-tertiary":"",children:t}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-4 w-4 text-text-tertiary"})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,className:"w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-text-secondary",children:s})})})}),c.jsx(R_,{id:e,checked:n,onCheckedChange:a,className:"ml-4","data-testid":e,disabled:r})]})})}function YS({tool:e,allTools:t,agent_id:a=""}){const[s,r]=n.useState(!1),o=kg(),{showToast:i}=Ng(),l=xh(),{getValues:d,setValue:u}=Ut(),m=t.find((t=>t.pluginKey===e));return m?c.jsxs(f_,{children:[c.jsxs("div",{className:rm("flex w-full items-center rounded-lg text-sm",a?"":"opacity-40"),onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[c.jsxs("div",{className:"flex grow items-center",children:[m.icon&&c.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-full",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full bg-center bg-no-repeat dark:bg-white/20",style:{backgroundImage:`url(${m.icon})`,backgroundSize:"cover"}})}),c.jsx("div",{className:"h-9 grow px-3 py-2",style:{textOverflow:"ellipsis",wordBreak:"break-all",overflow:"hidden"},children:m.name})]}),s&&c.jsx(x_,{asChild:!0,children:c.jsx("button",{type:"button",className:"transition-color flex h-9 w-9 min-w-9 items-center justify-center rounded-lg duration-200 hover:bg-gray-200 dark:hover:bg-gray-700",children:c.jsx(uy,{})})})]}),c.jsx(ij,{showCloseButton:!1,title:o("com_ui_delete_tool"),mainClassName:"px-0",className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:o("com_ui_delete_tool_confirm")}),selection:{selectHandler:()=>{var e;(e=m.pluginKey)&&l.mutate({pluginKey:e,action:"uninstall",auth:null,isEntityTool:!0},{onError:e=>{i({message:`Error while deleting the tool: ${e}`,status:"error"})},onSuccess:()=>{const t=d("tools").filter((t=>t!==e));u("tools",t),i({message:"Tool deleted successfully",status:"success"})}})},selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 transition-color duration-200 text-white",selectText:o("com_ui_delete")}})]}):null}function JS({authType:e="",isToolAuthenticated:t=!1}){const n=kg(),a=Ut(),{control:s,setValue:r,getValues:o}=a,{onSubmit:i,isDialogOpen:l,setIsDialogOpen:d,handleRevokeApiKey:u,methods:m}=xb({onSubmit:()=>{r(hl.execute_code,!0,{shouldDirty:!0})},onRevoke:()=>{r(hl.execute_code,!1,{shouldDirty:!0})}}),p=Mt({control:s,name:hl.execute_code}),g=e===So.USER_PROVIDED,f=e=>{t?r(hl.execute_code,e,{shouldDirty:!0}):p?r(hl.execute_code,!1,{shouldDirty:!0}):d(!0)};return c.jsxs(c.Fragment,{children:[c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(tt,{name:hl.execute_code,control:s,render:({field:e})=>c.jsx($y,{...e,checked:p||t&&e.value,onCheckedChange:f,className:"relative float-left mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString(),disabled:!p&&!t})}),c.jsx("button",{type:"button",className:"flex items-center space-x-2",onClick:()=>{const e=!o(hl.execute_code);f(e)},children:c.jsx("label",{className:"form-check-label text-token-text-primary w-full cursor-pointer",htmlFor:hl.execute_code,children:n("com_ui_run_code")})}),c.jsxs("div",{className:"ml-2 flex gap-2",children:[g&&(t||p)&&c.jsx("button",{type:"button",onClick:()=>d(!0),children:c.jsx(Tn,{className:"h-5 w-5 text-text-primary"})}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-4 w-4 text-text-tertiary"})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,className:"w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-text-secondary",children:n("com_agents_code_interpreter")})})})})]})}),c.jsx(IN,{isOpen:l,onSubmit:i,onRevoke:u,onOpenChange:d,register:m.register,isToolAuthenticated:t,handleSubmit:m.handleSubmit,isUserProvided:e===So.USER_PROVIDED})]})}const XS=ro.execute_code;function eT({agent_id:e,files:t}){const a=kg(),{setFilesLoading:s}=bh(),{watch:r}=Ut(),o=n.useRef(null),[i,l]=n.useState(new Map),{data:d=Gi}=Dp({select:e=>Zi(e)}),{abortUpload:u,handleFileChange:m}=Gv({fileSetter:l,overrideEndpoint:Ro.agents,additionalMetadata:{agent_id:e,tool_resource:XS}});Kv((()=>{t&&l(new Map(t))}),[t],750);const p=r(hl.execute_code),g=d.endpoints[Ro.agents];if((null==g?void 0:g.disabled)??!1)return null;return c.jsx("div",{className:"mb-2 w-full",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx("div",{className:"rounded-lg text-xs text-text-secondary",children:a("com_assistants_code_interpreter_files")}),c.jsx(GS,{files:i,setFiles:l,agent_id:e,abortUpload:u,tool_resource:XS,setFilesLoading:s,Wrapper:({children:e})=>c.jsx("div",{className:"flex flex-wrap gap-2",children:e})}),c.jsx("div",{children:c.jsx("button",{type:"button",disabled:!e||!1===p,className:"btn btn-neutral border-token-border-light relative h-9 w-full rounded-lg font-medium",onClick:()=>{var e;o.current&&(o.current.value=""),null==(e=o.current)||e.click()},children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-1",children:[c.jsx("input",{multiple:!0,type:"file",style:{display:"none"},tabIndex:-1,ref:o,disabled:!e||!1===p,onChange:m}),c.jsx(Zb,{className:"text-token-text-primary h-4 w-4"}),a("com_ui_upload_code_files")]})})})]})})}function tT({agent_id:e,files:t}){const n=kg(),{data:a}=Vp({toolId:so.execute_code});return c.jsxs("div",{className:"w-full",children:[c.jsx("div",{className:"mb-1.5 flex items-center gap-2",children:c.jsx("div",{className:"flex flex-row items-center gap-1",children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-token-text-primary block font-medium",children:n("com_agents_code_interpreter_title")}),c.jsx("span",{className:"text-xs text-text-secondary",children:n("com_agents_by_librechat")})]})})}),c.jsxs("div",{className:"flex flex-col items-start gap-2",children:[c.jsx(JS,{authType:null==a?void 0:a.message,isToolAuthenticated:null==a?void 0:a.authenticated}),c.jsx(eT,{agent_id:e,files:t})]})]})}const nT="mb-2 text-token-text-primary block font-medium",aT=rm(fm,"flex w-full px-3 py-2 border-border-light bg-surface-secondary focus-visible:ring-2 focus-visible:ring-ring-primary",mm);function sT({setAction:e,actions:t=[],agentsConfig:a,endpointsConfig:s,setActivePanel:r,setCurrentAgentId:o}){const{user:i}=Wh(),l=av(),d=ar().getQueryData([Xc.tools])??[],{showToast:u}=Ng(),m=kg(),[p,g]=n.useState(!1),f=Ut(),{control:x}=f,h=Mt({control:x,name:"provider"}),v=Mt({control:x,name:"model"}),b=Mt({control:x,name:"agent"}),y=Mt({control:x,name:"tools"}),_=Mt({control:x,name:"id"}),j=Jv({permissionType:Zc.AGENTS,permission:Yc.SHARED_GLOBAL}),w=n.useMemo((()=>null==a?void 0:a.capabilities.includes(hl.tools)),[a]),N=n.useMemo((()=>null==a?void 0:a.capabilities.includes(hl.actions)),[a]),C=n.useMemo((()=>(null==a?void 0:a.capabilities.includes(hl.artifacts))??!1),[a]),k=n.useMemo((()=>(null==a?void 0:a.capabilities.includes(hl.file_search))??!1),[a]),S=n.useMemo((()=>(null==a?void 0:a.capabilities.includes(hl.execute_code))??!1),[a]),T=n.useMemo((()=>{if("string"==typeof b)return[];if((null==b?void 0:b.id)!==_)return[];if(b.knowledge_files)return b.knowledge_files;return du({agent:b,fileMap:l}).knowledge_files??[]}),[b,_,l]),R=n.useMemo((()=>{if("string"==typeof b)return[];if((null==b?void 0:b.id)!==_)return[];if(b.code_files)return b.code_files;return du({agent:b,fileMap:l}).code_files??[]}),[b,_,l]),I=Tp({onSuccess:e=>{u({message:`${m("com_assistants_update_success")} ${e.name??m("com_ui_agent")}`})},onError:e=>{const t=e;u({message:`${m("com_agents_update_error")}${t.message?` ${m("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),E=Sp({onSuccess:e=>{o(e.id),u({message:`${m("com_assistants_create_success")} ${e.name??m("com_ui_agent")}`})},onError:e=>{const t=e;u({message:`${m("com_agents_create_error")}${t.message?` ${m("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),P=n.useCallback((()=>{_?r(Hr.actions):u({message:m("com_assistants_actions_disabled"),status:"warning"})}),[_,r,u,m]),L="string"==typeof h?h:null==h?void 0:h.value;let M,A,O,D;void 0!==L&&(A=Hu(s,L,"type"),O=Hu(s,L,"iconURL"),D=Yu({endpoint:L,endpointsConfig:s,endpointType:A,endpointIconURL:O}),M=lw[D]);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-auto bg-white px-4 pb-8 pt-3 dark:bg-transparent",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx(BS,{createMutation:E,agent_id:_,avatar:(null==b?void 0:b.avatar)??null}),c.jsx("label",{className:nT,htmlFor:"name",children:m("com_ui_name")}),c.jsx(tt,{name:"name",control:x,render:({field:e})=>c.jsx("input",{...e,value:e.value??"",maxLength:256,className:aT,id:"name",type:"text",placeholder:m("com_agents_name_placeholder"),"aria-label":"Agent name"})}),c.jsx(tt,{name:"id",control:x,render:({field:e})=>c.jsx("p",{className:"h-3 text-xs italic text-text-secondary","aria-live":"polite",children:e.value})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:nT,htmlFor:"description",children:m("com_ui_description")}),c.jsx(tt,{name:"description",control:x,render:({field:e})=>c.jsx("input",{...e,value:e.value??"",maxLength:512,className:aT,id:"description",type:"text",placeholder:m("com_agents_description_placeholder"),"aria-label":"Agent description"})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:nT,htmlFor:"instructions",children:m("com_ui_instructions")}),c.jsx(tt,{name:"instructions",control:x,render:({field:e,fieldState:{error:t}})=>c.jsxs(c.Fragment,{children:[c.jsx("textarea",{...e,value:e.value??"",className:rm(aT,"min-h-[100px] resize-y"),id:"instructions",placeholder:m("com_agents_instructions_placeholder"),rows:3,"aria-label":"Agent instructions","aria-required":"true","aria-invalid":t?"true":"false"}),t&&c.jsx("span",{className:"text-sm text-red-500 transition duration-300 ease-in-out",role:"alert",children:m("com_ui_field_required")})]})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:nT,htmlFor:"provider",children:[m("com_ui_model")," ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("button",{type:"button",onClick:()=>r(Hr.model),className:"btn btn-neutral border-token-border-light relative h-10 w-full rounded-lg font-medium","aria-haspopup":"true","aria-expanded":"false",children:c.jsxs("div",{className:"flex w-full items-center gap-2",children:[M&&c.jsx("div",{className:"shadow-stroke relative flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-white text-black dark:bg-white",children:c.jsx(M,{className:"h-2/3 w-2/3",endpoint:L,endpointType:A,iconURL:O})}),c.jsx("span",{children:null!=v&&v?v:m("com_ui_select_model")})]})})]}),(S||k||C)&&c.jsxs("div",{className:"mb-4 flex w-full flex-col items-start gap-3",children:[c.jsx("label",{className:"text-token-text-primary block font-medium",children:m("com_assistants_capabilities")}),S&&c.jsx(tT,{agent_id:_,files:R}),k&&c.jsx(WS,{agent_id:_,files:T}),C&&c.jsx(qS,{})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:nT,children:`${!0===w?m("com_ui_tools"):""}\n              ${!0===w&&!0===N?" + ":""}\n              ${!0===N?m("com_assistants_actions"):""}`}),c.jsxs("div",{className:"space-y-2",children:[null==y?void 0:y.map(((e,t)=>c.jsx(YS,{tool:e,allTools:d,agent_id:_},`${e}-${t}-${_}`))),t.filter((e=>e.agent_id===_)).map(((t,n)=>c.jsx(PS,{action:t,onClick:()=>{e(t),r(Hr.actions)}},n))),c.jsxs("div",{className:"flex space-x-2",children:[(w??!1)&&c.jsx("button",{type:"button",onClick:()=>g(!0),className:"btn btn-neutral border-token-border-light relative h-9 w-full rounded-lg font-medium","aria-haspopup":"dialog",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:m("com_assistants_add_tools")})}),(N??!1)&&c.jsx("button",{type:"button",disabled:!_,onClick:P,className:"btn btn-neutral border-token-border-light relative h-9 w-full rounded-lg font-medium","aria-haspopup":"dialog",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:m("com_assistants_add_actions")})})]})]})]}),(null==i?void 0:i.role)===qc.ADMIN&&c.jsx(DS,{}),c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(FS,{agent_id:_,setCurrentAgentId:o,createMutation:E}),((null==b?void 0:b.author)===(null==i?void 0:i.id)||(null==i?void 0:i.role)===qc.ADMIN)&&j&&c.jsx(QS,{agent_id:_,agentName:(null==b?void 0:b.name)??"",projectIds:(null==b?void 0:b.projectIds)??[],isCollaborative:null==b?void 0:b.isCollaborative}),b&&b.author===(null==i?void 0:i.id)&&c.jsx(AS,{agent_id:_}),c.jsx("button",{className:"btn btn-primary focus:shadow-outline flex h-9 w-full items-center justify-center px-4 py-2 font-semibold text-white hover:bg-green-600 focus:border-green-500",type:"submit",disabled:E.isLoading||I.isLoading,"aria-busy":E.isLoading||I.isLoading,children:E.isLoading||I.isLoading?c.jsx(Hb,{className:"icon-md","aria-hidden":"true"}):m(_?"com_ui_save":"com_ui_create")})]})]}),c.jsx(MS,{isOpen:p,setIsOpen:g,toolsFormKey:"tools",endpoint:Ro.agents})]})}const rT=new Set(Object.keys(Go));function oT({agentQuery:e,selectedAgentId:t=null,setCurrentAgentId:a,createMutation:s}){const r=kg(),o=n.useRef(null),{control:i,reset:l}=Ut(),{data:u}=Ap(),{data:m=null}=Cp(void 0,{select:e=>e.data.map((e=>du({agent:e,instanceProjectId:null==u?void 0:u.instanceProjectId})))}),p=n.useCallback((e=>{var t;const{instanceProjectId:n}=u??{},a=(null!=n&&(null==(t=e.projectIds)?void 0:t.includes(n)))??!1,s={...e,provider:cu(e.provider),label:e.name??"",value:e.id||"",icon:a?c.jsx(d,{className:"icon-lg text-green-400"}):null},r={[hl.file_search]:!1,[hl.execute_code]:!1,[hl.end_after_tools]:!1,[hl.hide_sequential_outputs]:!1},o=[];(e.tools??[]).forEach((e=>{void 0===r[e]?o.push(e):r[e]=!0}));const i={...r,agent:s,model:s.model,tools:o};Object.entries(e).forEach((([e,t])=>{"model_parameters"!==e?rT.has(e)&&"number"!=typeof t&&"object"!=typeof t&&(i[e]=t):i[e]=t})),l(i)}),[l,u]),g=n.useCallback((t=>{const n=!!(t?(m??[]).find((e=>e.id===t)):void 0);if(s.reset(),!n)return a(void 0),l({...Go});a(t);const r=e.data;r?p(r):console.warn("Agent not found")}),[m,s,a,e.data,p,l]);n.useEffect((()=>{e.data&&e.isSuccess&&p(e.data)}),[e.data,e.isSuccess,p]),n.useEffect((()=>{let e=null;if(t!==o.current)return null!=t&&""!==t&&m&&(e=setTimeout((()=>{o.current=t,g(t)}),5)),()=>{e&&clearTimeout(e)}}),[t,m,g]);const f=r("com_ui_create")+" "+r("com_ui_agent");return c.jsx(tt,{name:"agent",control:i,render:({field:e})=>{var t,n,a;return c.jsx(_w,{containerClassName:"px-0",selectedValue:((null==(t=null==e?void 0:e.value)?void 0:t.value)??"")+"",displayValue:(null==(n=null==e?void 0:e.value)?void 0:n.label)??"",selectPlaceholder:f,iconSide:"right",searchPlaceholder:r("com_agents_search_name"),SelectIcon:null==(a=null==e?void 0:e.value)?void 0:a.icon,setValue:g,items:(null==m?void 0:m.map((e=>({label:e.name??"",value:e.id??"",icon:e.icon}))))??[{label:"Loading...",value:""}],className:rm("z-50 flex h-[40px] w-full flex-none items-center justify-center truncate rounded-md bg-transparent font-bold"),ariaLabel:r("com_ui_agent"),isCollapsed:!1,showCarat:!0})}})}function iT({setActivePanel:e,providers:t,models:a}){const s=kg(),{control:r,setValue:o}=Ut(),i=Mt({control:r,name:"model"}),l=Mt({control:r,name:"provider"}),d=Mt({control:r,name:"model_parameters"}),u=n.useMemo((()=>("string"==typeof l?l:null==l?void 0:l.value)??""),[l]),m=n.useMemo((()=>u?a[u]??[]:[]),[a,u]);n.useEffect((()=>{const e=i??"";if(u&&e){if(!m.includes(e)){const e=a[u]??[];o("model",e[0]??"")}}u&&!e&&o("model",m[0]??"")}),[u,m,a,o,i]);const{data:p}=Mp(),g=n.useMemo((()=>{var e;return(null==(e=null==p?void 0:p[u])?void 0:e.availableRegions)??[]}),[p,u]),f=n.useMemo((()=>Hu(p,u,"type")),[u,p]),x=n.useMemo((()=>{const[e,t]=Ao(f??u,i??"");return rN[e]??rN[t]}),[f,i,u]),h=e=>t=>{o(`model_parameters.${e}`,t)};return c.jsxs("div",{className:"scrollbar-gutter-stable h-full min-h-[50vh] overflow-auto pb-12 text-sm",children:[c.jsxs("div",{className:"model-panel relative flex flex-col items-center px-16 py-4 text-center",children:[c.jsx("div",{className:"absolute left-0 top-4",children:c.jsx("button",{type:"button",className:"btn btn-neutral relative",onClick:()=>{e(Hr.builder)},children:c.jsx("div",{className:"model-panel-content flex w-full items-center justify-center gap-2",children:c.jsx(Cn,{})})})}),c.jsx("div",{className:"mb-2 mt-2 text-xl font-medium",children:s("com_ui_model_parameters")})]}),c.jsxs("div",{className:"p-2",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{id:"provider-label",className:"text-token-text-primary model-panel-label mb-2 block font-medium",htmlFor:"provider",children:[s("com_ui_provider")," ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx(tt,{name:"provider",control:r,rules:{required:!0,minLength:1},render:({field:e,fieldState:{error:n}})=>{var a,r;const o="string"==typeof e.value?e.value:(null==(a=e.value)?void 0:a.value)??"",i="string"==typeof e.value?e.value:(null==(r=e.value)?void 0:r.label)??"";return c.jsxs(c.Fragment,{children:[c.jsx(_w,{selectedValue:o,displayValue:Ql[i]??i,selectPlaceholder:s("com_ui_select_provider"),searchPlaceholder:s("com_ui_select_search_provider"),setValue:e.onChange,items:t.map((e=>({label:"string"==typeof e?e:e.label,value:"string"==typeof e?e:e.value}))),className:rm(n?"border-2 border-red-500":""),ariaLabel:s("com_ui_provider"),isCollapsed:!1,showCarat:!0}),n&&c.jsx("span",{className:"model-panel-error text-sm text-red-500 transition duration-300 ease-in-out",children:s("com_ui_field_required")})]})}})]}),c.jsxs("div",{className:"model-panel-section mb-4",children:[c.jsxs("label",{id:"model-label",className:rm("text-token-text-primary model-panel-label mb-2 block font-medium",!u&&"text-gray-500 dark:text-gray-400"),htmlFor:"model",children:[s("com_ui_model")," ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx(tt,{name:"model",control:r,rules:{required:!0,minLength:1},render:({field:e,fieldState:{error:t}})=>c.jsxs(c.Fragment,{children:[c.jsx(_w,{selectedValue:e.value||"",selectPlaceholder:s(u?"com_ui_select_model":"com_ui_select_provider_first"),searchPlaceholder:s("com_ui_select_model"),setValue:e.onChange,items:m.map((e=>({label:e,value:e}))),disabled:!u,className:rm("disabled:opacity-50",t?"border-2 border-red-500":""),ariaLabel:s("com_ui_model"),isCollapsed:!1,showCarat:!0}),u&&t&&c.jsx("span",{className:"text-sm text-red-500 transition duration-300 ease-in-out",children:s("com_ui_field_required")})]})})]})]}),x&&c.jsxs("div",{className:"h-auto max-w-full overflow-x-hidden p-2",children:[c.jsx("div",{className:"grid grid-cols-4 gap-6",children:x.map((e=>{const t=ww[e.component];if(!t)return null;const{key:n,default:a,...s}=e;return"region"===n&&g.length&&(s.options=g),c.jsx(t,{settingKey:n,defaultValue:a,...s,setOption:h,conversation:d},n)}))}),c.jsx("div",{className:"mt-6 flex justify-center",children:c.jsxs("button",{type:"button",onClick:()=>{o("model_parameters",{})},className:"btn btn-neutral flex w-full items-center justify-center gap-2 px-4 py-2 text-sm",children:[c.jsx(Rn,{className:"h-4 w-4","aria-hidden":"true"}),s("com_ui_reset_var",{0:s("com_ui_model_parameters")})]})})]})]})}function lT({setAction:e,activePanel:t,actions:a=[],setActivePanel:s,agent_id:r,setCurrentAgentId:o,agentsConfig:i,endpointsConfig:l}){var d,u,m;const p=kg(),{user:g}=Wh(),{showToast:f}=Ng(),{onSelect:x}=Ch(),h=mh(),v=kp(r??"",{enabled:!!r}),b=n.useMemo((()=>h.data??{}),[h.data]),y=ne({defaultValues:Go}),{control:_,handleSubmit:j,reset:w}=y,N=Mt({control:_,name:"id"}),C=n.useMemo((()=>Object.keys(l??{}).filter((e=>!Oo(e)&&e!==Ro.agents&&e!==Ro.chatGPTBrowser&&e!==Ro.gptPlugins)).map((e=>cu(e)))),[l]),k=Tp({onSuccess:e=>{f({message:`${p("com_assistants_update_success")} ${e.name??p("com_ui_agent")}`})},onError:e=>{const t=e;f({message:`${p("com_agents_update_error")}${t.message?` ${p("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),S=Sp({onSuccess:e=>{o(e.id),f({message:`${p("com_assistants_create_success")} ${e.name??p("com_ui_agent")}`})},onError:e=>{const t=e;f({message:`${p("com_agents_create_error")}${t.message?` ${p("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),T=n.useCallback((e=>{const t=e.tools??[];!0===e.execute_code&&t.push(so.execute_code),!0===e.file_search&&t.push(so.file_search);const{name:n,artifacts:a,description:s,instructions:r,model:o,model_parameters:i,provider:l,agent_ids:c,end_after_tools:d,hide_sequential_outputs:u}=e,m=o??"",g=("string"==typeof l?l:l.value)??"";if(!N)return g&&m?void S.mutate({name:n,artifacts:a,description:s,instructions:r,model:m,tools:t,provider:g,model_parameters:i,agent_ids:c,end_after_tools:d,hide_sequential_outputs:u}):f({message:p("com_agents_missing_provider_model"),status:"error"});k.mutate({agent_id:N,data:{name:n,artifacts:a,description:s,instructions:r,model:m,tools:t,provider:g,model_parameters:i,agent_ids:c,end_after_tools:d,hide_sequential_outputs:u}})}),[N,S,k,f,p]),R=n.useCallback((()=>{N&&x(N)}),[N,x]),I=n.useMemo((()=>{var e,t,n;const a=!!(null==(e=v.data)?void 0:e.isCollaborative)||((null==(t=v.data)?void 0:t.author)===(null==g?void 0:g.id)||(null==g?void 0:g.role)===qc.ADMIN);return null==(null==(n=v.data)?void 0:n.id)||!v.data.id||a}),[null==(d=v.data)?void 0:d.isCollaborative,null==(u=v.data)?void 0:u.author,null==(m=v.data)?void 0:m.id,null==g?void 0:g.id,null==g?void 0:g.role]);return c.jsx(Kt,{...y,children:c.jsxs("form",{onSubmit:j(T),className:"scrollbar-gutter-stable h-auto w-full flex-shrink-0 overflow-x-hidden","aria-label":"Agent configuration form",children:[c.jsxs("div",{className:"mx-1 mt-2 flex w-full flex-wrap gap-2",children:[c.jsx("div",{className:"w-full",children:c.jsx(oT,{createMutation:S,agentQuery:v,setCurrentAgentId:o,selectedAgentId:v.isInitialLoading?null:r??null})}),N&&c.jsxs("div",{className:"flex w-full gap-2",children:[c.jsxs(By,{type:"button",variant:"outline",className:"w-full justify-center",onClick:()=>{w(Go),o(void 0)},disabled:v.isInitialLoading,children:[c.jsx(Ze,{className:"mr-1 h-4 w-4"}),p("com_ui_create")+" "+p("com_ui_new")+" "+p("com_ui_agent")]}),c.jsx(By,{variant:"submit",disabled:!N||v.isInitialLoading,onClick:e=>{e.preventDefault(),R()},"aria-label":p("com_ui_select")+" "+p("com_ui_agent"),children:p("com_ui_select")})]})]}),v.isInitialLoading&&c.jsx(ES,{}),!I&&!v.isInitialLoading&&c.jsx("div",{className:"flex h-[30vh] w-full items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-token-text-primary m-2 text-xl font-semibold",children:p("com_agents_not_available")}),c.jsx("p",{className:"text-token-text-secondary",children:p("com_agents_no_access")})]})}),I&&!v.isInitialLoading&&t===Hr.model&&c.jsx(iT,{setActivePanel:s,agent_id:N,providers:C,models:b}),I&&!v.isInitialLoading&&t===Hr.builder&&c.jsx(sT,{actions:a,setAction:e,agentsConfig:i,setActivePanel:s,endpointsConfig:l,setCurrentAgentId:o})]})})}function cT(){const{conversation:e,index:t}=bh(),[a,s]=n.useState(Hr.builder),[r,o]=n.useState(void 0),[i,l]=n.useState(null==e?void 0:e.agent_id),{data:d=[]}=Zp(null==e?void 0:e.endpoint),{data:u={}}=Mp(),m=n.useMemo((()=>(null==u?void 0:u[Ro.agents])??{}),[u]);if(n.useEffect((()=>{const t=(null==e?void 0:e.agent_id)??"";t&&l(t)}),[null==e?void 0:e.agent_id]),!(null==e?void 0:e.endpoint))return null;const p={index:t,action:r,actions:d,setAction:o,activePanel:a,setActivePanel:s,setCurrentAgentId:l,agent_id:i};return a===Hr.actions?c.jsx(IS,{...p}):c.jsx(lT,{...p,agentsConfig:m,endpointsConfig:u})}const dT=({bookmark:e,tabIndex:t=0,onFocus:a,onBlur:s})=>{const r=kg(),{showToast:o}=Ng(),[i,l]=n.useState(!1),d=ig({onSuccess:()=>{o({message:r("com_ui_bookmarks_delete_success")})},onError:()=>{o({message:r("com_ui_bookmarks_delete_error"),severity:Wr.ERROR})}}),u=n.useCallback((async()=>{await d.mutateAsync(e)}),[e,d]);return c.jsx(c.Fragment,{children:c.jsxs(f_,{open:i,onOpenChange:l,children:[c.jsx(x_,{asChild:!0,children:c.jsx(z_,{role:"button","aria-label":r("com_ui_bookmarks_delete"),description:r("com_ui_delete"),className:"flex size-7 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-surface-hover",tabIndex:t,onFocus:a,onBlur:s,onClick:()=>l(!i),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),l(!i))},children:c.jsx(uy,{className:"size-4"})})}),c.jsx(ij,{showCloseButton:!1,title:r("com_ui_bookmarks_delete"),className:"w-11/12 max-w-lg",main:c.jsxs(g_,{className:"text-left text-sm font-medium",children:[r("com_ui_bookmark_delete_confirm")," ",e]}),selection:{selectHandler:u,selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 text-white",selectText:r("com_ui_delete")}})]})})},uT=({tags:e,bookmark:t,mutation:a,conversationId:s,setOpen:r,formRef:o})=>{const i=kg(),l=ar(),{showToast:d}=Ng(),{bookmarks:u}=mv(),{register:m,handleSubmit:p,setValue:g,getValues:f,control:x,formState:{errors:h}}=ne({defaultValues:{tag:(null==t?void 0:t.tag)??"",description:(null==t?void 0:t.description)??"",conversationId:s??"",addToConversation:!(null==s||!s)}});n.useEffect((()=>{t&&t.tag&&(g("tag",t.tag),g("description",t.description??""))}),[t,g]);return c.jsx("form",{ref:o,className:"mt-6","aria-label":"Bookmark form",method:"POST",onSubmit:p((n=>{if(om.log("tag_mutation","BookmarkForm - onSubmit: data",n),a.isLoading)return;if(n.tag===(null==t?void 0:t.tag)&&n.description===(null==t?void 0:t.description))return;if(null!=n.tag&&(e??[]).includes(n.tag))return void d({message:i("com_ui_bookmarks_create_exists"),status:"warning"});(l.getQueryData([Xc.conversationTags])??[]).some((e=>e.tag===n.tag))?d({message:i("com_ui_bookmarks_create_exists"),status:"warning"}):(a.mutate(n),r(!1))})),children:c.jsxs("div",{className:"flex w-full flex-col items-center gap-2",children:[c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"bookmark-tag",className:"text-left text-sm font-medium",children:i("com_ui_bookmarks_title")}),c.jsx(m_,{type:"text",id:"bookmark-tag","aria-label":"Bookmark",...m("tag",{required:"tag is required",maxLength:{value:128,message:i("com_auth_password_max_length")},validate:e=>e===(null==t?void 0:t.tag)||u.every((t=>t.tag!==e))||"tag must be unique"}),"aria-invalid":!!h.tag,placeholder:"Bookmark"}),h.tag&&c.jsx("span",{className:"text-sm text-red-500",children:h.tag.message})]}),c.jsxs("div",{className:"mt-4 grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"bookmark-description",className:"text-left text-sm font-medium",children:i("com_ui_bookmarks_description")}),c.jsx(F_,{...m("description",{maxLength:{value:1048,message:"Maximum 1048 characters"}}),id:"bookmark-description",disabled:!1,className:rm("flex h-10 max-h-[250px] min-h-[100px] w-full resize-none rounded-lg border border-input bg-transparent px-3 py-2 text-sm ring-offset-background focus-visible:outline-none")})]}),null!=s&&s&&c.jsxs("div",{className:"mt-2 flex w-full items-center",children:[c.jsx(tt,{name:"addToConversation",control:x,render:({field:e})=>{var t;return c.jsx($y,{...e,checked:e.value,onCheckedChange:e.onChange,className:"relative float-left mr-2 inline-flex h-4 w-4 cursor-pointer",value:null==(t=e.value)?void 0:t.toString()})}}),c.jsx("button",{type:"button","aria-label":i("com_ui_bookmarks_add_to_conversation"),className:"form-check-label w-full cursor-pointer text-text-primary",onClick:()=>g("addToConversation",!f("addToConversation"),{shouldDirty:!0}),children:c.jsx("div",{className:"flex select-none items-center",children:i("com_ui_bookmarks_add_to_conversation")})})]})]})})},mT=({open:e,setOpen:t,tags:a,setTags:s,context:r,bookmark:o,children:i,triggerRef:l,conversationId:d})=>{const u=kg(),m=n.useRef(null),{showToast:p}=Ng(),g=og({context:r,tag:null==o?void 0:o.tag,options:{onSuccess:(e,n)=>{if(p({message:u(o?"com_ui_bookmarks_update_success":"com_ui_bookmarks_create_success")}),t(!1),om.log("tag_mutation","tags before setting",a),s&&!0===n.addToConversation){const e=[...a||[],n.tag].filter((e=>void 0!==e));if(s(e),om.log("tag_mutation","tags after",e),null==n.tag||""===n.tag)return;setTimeout((()=>{const e=document.getElementById(n.tag??"");console.log("tagElement",e),e&&e.focus()}),5)}},onError:()=>{p({message:u(o?"com_ui_bookmarks_update_error":"com_ui_bookmarks_create_error"),severity:Wr.ERROR})}}});return c.jsxs(f_,{open:e,onOpenChange:t,triggerRef:l,children:[i,c.jsx(ij,{title:"Bookmark",showCloseButton:!1,className:"w-11/12 md:max-w-2xl",main:c.jsx(uT,{tags:a,setOpen:t,mutation:g,conversationId:d,bookmark:o,formRef:m}),buttons:c.jsx(By,{variant:"submit",type:"submit",disabled:g.isLoading,onClick:()=>{m.current&&m.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},className:"text-white",children:g.isLoading?c.jsx(Hb,{}):u("com_ui_save")})})]})},pT=({bookmark:e,tabIndex:t=0,onFocus:a,onBlur:s})=>{const r=kg(),[o,i]=n.useState(!1);return c.jsx(mT,{context:"EditBookmarkButton",bookmark:e,open:o,setOpen:i,children:c.jsx(x_,{asChild:!0,children:c.jsx(z_,{role:"button","aria-label":r("com_ui_bookmarks_edit"),description:r("com_ui_edit"),tabIndex:t,onFocus:a,onBlur:s,onClick:()=>i(!o),className:"flex size-7 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-surface-hover",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||i(!o)},children:c.jsx(Bb,{})})})})},gT=({tag:e,selected:t,handleSubmit:a,icon:s,...r})=>{const[o,i]=n.useState(!1);return c.jsx(Pr,{"aria-label":e,className:"group flex w-full gap-2 rounded-lg p-2.5 text-sm text-text-primary transition-colors duration-200 focus:outline-none data-[focus]:bg-surface-secondary data-[focus]:ring-2 data-[focus]:ring-primary",...r,as:"button",onClick:async()=>{"New Bookmark"!==e?(i(!0),a(e),i(!1)):a()},children:c.jsx("div",{className:"flex grow items-center justify-between gap-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[null!=s?s:o?c.jsx(Hb,{className:"size-4"}):t?c.jsx($s,{className:"size-4"}):c.jsx(Hs,{className:"size-4"}),c.jsx("div",{style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:e})]})})})},fT=({tags:e,handleSubmit:t,header:n})=>{const{bookmarks:a}=mv();return c.jsxs(c.Fragment,{children:[n,a.length>0&&c.jsx("div",{className:"my-1.5 h-px",role:"none"}),a.map(((n,a)=>c.jsx(gT,{tag:n.tag,selected:e.includes(n.tag),handleSubmit:t},`${n._id??n.tag}-${a}`)))]})},xT=({row:e,moveRow:t,position:a})=>{const s=n.useRef(null),r=og({context:"BookmarkTableRow",tag:e.tag}),o=kg(),{showToast:i}=Ng(),[,l]=W({accept:"bookmark",drop:t=>{r.mutate({...e,position:t.index},{onError:()=>{i({message:o("com_ui_bookmarks_update_error"),severity:Wr.ERROR})}})},hover(e){s.current&&e.index!==a&&(t(e.index,a),e.index=a)}}),[{isDragging:d},u]=In({type:"bookmark",item:{index:a},collect:e=>({isDragging:e.isDragging()})});return u(l(s)),c.jsxs(L_,{ref:s,className:"cursor-move hover:bg-surface-secondary",style:{opacity:d?.5:1},children:[c.jsx(A_,{className:"w-[70%] px-4 py-4",children:c.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:e.tag})}),c.jsx(A_,{className:"w-[10%] px-12 py-4",children:e.count}),c.jsx(A_,{className:"w-[20%] px-4 py-4",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(pT,{bookmark:e,tabIndex:0}),c.jsx(dT,{bookmark:e.tag,tabIndex:0})]})})]})},hT=()=>{const e=kg(),[t,a]=n.useState([]),[s,r]=n.useState(0),[o,i]=n.useState(""),[l,d]=n.useState(!1),{bookmarks:u=[]}=mv();n.useEffect((()=>{const e=(e=>{const t=new Set;return e.filter((e=>{const n=t.has(e._id);return t.add(e._id),!n}))})(u).sort(((e,t)=>e.position-t.position));a(e)}),[u]);const m=n.useCallback(((e,t)=>{a((n=>{const a=[...n],[s]=a.splice(e,1);return a.splice(t,0,s),a.map(((e,t)=>({...e,position:t})))}))}),[]),p=n.useCallback((e=>c.jsx(xT,{moveRow:m,row:e,position:e.position},e._id)),[m]),g=t.filter((e=>e.tag&&e.tag.toLowerCase().includes(o.toLowerCase()))),f=g.slice(10*s,10*(s+1));return c.jsx(uv.Provider,{value:{bookmarks:u},children:c.jsxs("div",{role:"region","aria-label":e("com_ui_bookmarks"),className:"mt-2 space-y-2",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsx(m_,{placeholder:e("com_ui_bookmarks_filter"),value:o,onChange:e=>i(e.target.value),"aria-label":e("com_ui_bookmarks_filter")})}),c.jsx("div",{className:"rounded-lg border border-border-light bg-transparent shadow-sm transition-colors",children:c.jsxs(I_,{className:"w-full table-fixed",children:[c.jsx(E_,{children:c.jsxs(L_,{className:"border-b border-border-light",children:[c.jsx(M_,{className:"w-[70%] bg-surface-secondary py-3 text-left text-sm font-medium text-text-secondary",children:c.jsx("div",{className:"px-4",children:e("com_ui_bookmarks_title")})}),c.jsx(M_,{className:"w-[30%] bg-surface-secondary py-3 text-left text-sm font-medium text-text-secondary",children:c.jsx("div",{className:"px-4",children:e("com_ui_bookmarks_count")})}),c.jsx(M_,{className:"w-[40%] bg-surface-secondary py-3 text-left text-sm font-medium text-text-secondary",children:c.jsx("div",{className:"px-4",children:e("com_assistants_actions")})})]})}),c.jsx(P_,{children:f.length?f.map(p):c.jsx(L_,{children:c.jsx(A_,{colSpan:3,className:"h-24 text-center text-sm text-text-secondary",children:e("com_ui_no_bookmarks")})})})]})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex justify-between gap-2",children:c.jsx(mT,{context:"BookmarkPanel",open:l,setOpen:d,children:c.jsx(x_,{asChild:!0,children:c.jsxs(By,{variant:"outline",size:"sm",className:"w-full gap-2 text-sm",onClick:()=>d(!l),children:[c.jsx(En,{className:"size-4"}),c.jsx("div",{className:"break-all",children:e("com_ui_bookmarks_new")})]})})})}),c.jsxs("div",{className:"flex items-center gap-2",role:"navigation","aria-label":"Pagination",children:[c.jsx(By,{variant:"outline",size:"sm",onClick:()=>r((e=>Math.max(e-1,0))),disabled:0===s,"aria-label":e("com_ui_prev"),children:e("com_ui_prev")}),c.jsx("div",{"aria-live":"polite",className:"text-sm",children:`${s+1} / ${Math.ceil(g.length/10)}`}),c.jsx(By,{variant:"outline",size:"sm",onClick:()=>r((e=>10*(e+1)<g.length?e+1:e)),disabled:10*(s+1)>=g.length,"aria-label":e("com_ui_next"),children:e("com_ui_next")})]})]})]})})},vT=()=>{const{data:e}=Wp();return c.jsx("div",{className:"h-auto max-w-full overflow-x-hidden",children:c.jsx(uv.Provider,{value:{bookmarks:e||[]},children:c.jsx(hT,{})})})},bT=({field:e,inputClass:t,labelClass:a})=>{const s=kg(),r=n.useRef([]),o=n.useRef(null),[i,l]=n.useState(""),d=()=>{if(i.trim()&&e.value.length<dc.MAX_CONVO_STARTERS){const t=[i,...e.value];e.onChange(t),l("")}},u={transition:"opacity 200ms ease-in-out",opacity:0},m={entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0}},p=e.value.length>=dc.MAX_CONVO_STARTERS;return c.jsxs("div",{className:"relative",children:[c.jsx("label",{className:a,htmlFor:"conversation_starters",children:s("com_assistants_conversation_starters")}),c.jsxs("div",{className:"mt-4 space-y-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:e=>r.current[0]=e,value:i,maxLength:64,className:`${t} pr-10`,type:"text",placeholder:s(p?"com_assistants_max_starters_reached":"com_assistants_conversation_starters_placeholder"),onChange:e=>l(e.target.value),onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),p?((t=e.currentTarget).classList.remove("shake"),t.offsetWidth,t.classList.add("shake"),setTimeout((()=>{t.classList.remove("shake")}),200)):d())}}),c.jsx(Pn,{nodeRef:o,in:e.value.length<dc.MAX_CONVO_STARTERS,timeout:200,unmountOnExit:!0,children:e=>c.jsx("div",{ref:o,style:{...u,...m[e],transition:"entering"===e?"none":u.transition},className:"absolute right-1 top-1",children:c.jsx(z_,{side:"top",description:s(p?"com_assistants_max_starters_reached":"com_ui_add"),className:"flex size-7 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-surface-hover",onClick:d,disabled:p,children:c.jsx(Ze,{className:"size-4"})})})})]}),e.value.map(((n,a)=>c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:e=>r.current[a+1]=e,value:n,onChange:t=>{const n=[...e.value];n[a]=t.target.value,e.onChange(n)},className:`${t} pr-10`,type:"text",maxLength:64}),c.jsx(z_,{side:"top",description:s("com_ui_delete"),className:"absolute right-1 top-1 flex size-7 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-surface-hover",onClick:()=>(t=>{const n=e.value.filter(((e,n)=>n!==t));e.onChange(n)})(a),children:c.jsx(ve,{className:"size-4"})})]},a)))]})]})};function yT({control:e,setValue:t}){const n=kg(),a=e=>{t("append_current_datetime",e,{shouldDirty:!0})};return c.jsx("div",{className:"mb-6",children:c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(tt,{name:"append_current_datetime",control:e,render:({field:e})=>c.jsx($y,{...e,id:"append_current_datetime",checked:e.value,onCheckedChange:a,className:"relative float-left mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString(),"aria-labelledby":"append-date-label"})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{id:"append-date-label",htmlFor:"append_current_datetime",className:"form-check-label text-token-text-primary w-full cursor-pointer",children:n("com_assistants_append_date")}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-5 w-5 text-gray-500","aria-label":n("com_assistants_append_date_tooltip")})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,className:"w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:n("com_assistants_append_date_tooltip")})})})})]})})})}function _T(){const e=kg(),t=Ut(),{control:n,setValue:a,getValues:s}=t;return c.jsxs("div",{className:"flex items-center",children:[c.jsx(tt,{name:xl.image_vision,control:n,render:({field:e})=>c.jsx($y,{...e,checked:e.value,onCheckedChange:e.onChange,className:"relative float-left  mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString()})}),c.jsx("label",{className:"form-check-label text-token-text-primary w-full cursor-pointer",htmlFor:xl.image_vision,onClick:()=>a(xl.image_vision,!s(xl.image_vision),{shouldDirty:!0}),children:c.jsx("div",{className:"flex items-center",children:e("com_assistants_image_vision")})})]})}function jT({version:e,retrievalModels:t}){const a=kg(),s=Ut(),{control:r,setValue:o,getValues:i}=s,l=Mt({control:r,name:"model"}),d=Mt({control:r,name:"assistant"});n.useMemo((()=>{var e;return"string"==typeof d?[]:null==(e=d.tool_resources)?void 0:e.file_search}),[d]);const u=n.useMemo((()=>!t.has(l)),[l,t]);return n.useEffect((()=>{l&&u&&o(xl.retrieval,!1)}),[l,o,u]),c.jsx(c.Fragment,{children:c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(tt,{name:xl.retrieval,control:r,render:({field:e})=>c.jsx($y,{...e,checked:e.value,disabled:u,onCheckedChange:e.onChange,className:"relative float-left mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString()})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:rm("form-check-label text-token-text-primary w-full select-none",u?"cursor-no-drop opacity-50":"cursor-pointer"),htmlFor:xl.retrieval,onClick:()=>t.has(l)&&o(xl.retrieval,!i(xl.retrieval),{shouldDirty:!0}),children:a(1==e?"com_assistants_retrieval":"com_assistants_file_search")}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-5 w-5 text-gray-500"})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,disabled:u,className:"ml-16 w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:2==e&&a("com_assistants_file_search_info")})})})}),c.jsx(jw,{side:Kr.Top,disabled:!u,description:"com_assistants_non_retrieval_model",langCode:!0,sideOffset:20,className:"ml-16"})]})})})}const wT=ro.code_interpreter;function NT({endpoint:e,assistant_id:t,files:a}){const s=kg(),{setFilesLoading:r}=bh(),o=n.useRef(null),[i,l]=n.useState(new Map),{data:d=Gi}=Dp({select:e=>Zi(e)}),{handleFileChange:u}=Gv({overrideEndpoint:e,additionalMetadata:{assistant_id:t,tool_resource:wT},fileSetter:l});n.useEffect((()=>{a&&l(new Map(a))}),[a]);const m=d.endpoints[e];if((null==m?void 0:m.disabled)??!1)return null;return c.jsx("div",{className:"mb-2 w-full",children:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"rounded-lg text-xs text-text-secondary",children:s("com_assistants_code_interpreter_files")}),c.jsx(GS,{files:i,setFiles:l,assistant_id:t,tool_resource:wT,setFilesLoading:r,Wrapper:({children:e})=>c.jsx("div",{className:"flex flex-wrap gap-2",children:e})}),c.jsx("div",{children:c.jsx("button",{type:"button",disabled:!t,className:"btn btn-neutral border-token-border-light relative h-9 w-full rounded-lg font-medium",onClick:()=>{var e;o.current&&(o.current.value=""),null==(e=o.current)||e.click()},children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[c.jsx("input",{multiple:!0,type:"file",style:{display:"none"},tabIndex:-1,ref:o,disabled:!t,onChange:u}),s("com_ui_upload_files")]})})})]})})}function CT({version:e}){const t=kg(),n=Ut(),{control:a,setValue:s,getValues:r}=n;return c.jsx(c.Fragment,{children:c.jsx(l_,{openDelay:50,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(tt,{name:xl.code_interpreter,control:a,render:({field:e})=>c.jsx($y,{...e,checked:e.value,onCheckedChange:e.onChange,className:"relative float-left  mr-2 inline-flex h-4 w-4 cursor-pointer",value:e.value.toString()})}),c.jsxs("button",{type:"button",className:"flex items-center space-x-2",onClick:()=>s(xl.code_interpreter,!r(xl.code_interpreter),{shouldDirty:!0}),children:[c.jsx("label",{className:"form-check-label text-token-text-primary w-full cursor-pointer",htmlFor:xl.code_interpreter,children:t("com_assistants_code_interpreter")}),c.jsx(c_,{children:c.jsx(Iy,{className:"h-5 w-5 text-gray-500"})})]}),c.jsx(d_,{children:c.jsx(u_,{side:Kr.Top,className:"w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:2==e&&t("com_assistants_code_interpreter_info")})})})})]})})})}function kT({version:e,endpoint:t,codeEnabled:a,retrievalEnabled:s,assistantsConfig:r}){const o=kg(),i=Ut(),{control:l}=i,d=Mt({control:l,name:"assistant"}),u=Mt({control:l,name:"id"}),m=n.useMemo((()=>"string"==typeof d?[]:d.code_files),[d]),p=n.useMemo((()=>new Set((null==r?void 0:r.retrievalModels)??[])),[r]),g=n.useMemo((()=>{var e;return null==(e=null==r?void 0:r.capabilities)?void 0:e.includes(xl.image_vision)}),[r]);return c.jsxs("div",{className:"mb-4",children:[c.jsx("div",{className:"mb-1.5 flex items-center",children:c.jsx("span",{children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:o("com_assistants_capabilities")})})}),c.jsxs("div",{className:"flex flex-col items-start gap-2",children:[a&&c.jsx(CT,{version:e}),s&&c.jsx(jT,{endpoint:t,version:e,retrievalModels:p}),g&&1==e&&c.jsx(_T,{}),a&&e&&c.jsx(NT,{assistant_id:u,version:e,endpoint:t,files:m})]})]})}function ST(){return c.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-black",children:c.jsxs("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"text-4xl",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})}const TT=({url:e,progress:t=1})=>{const n=2*Math.PI*55,a=n-t*n;return c.jsx("div",{children:c.jsxs("div",{className:"relative h-20 w-20 overflow-hidden rounded-full",children:[c.jsx("img",{src:e,className:"bg-token-surface-secondary dark:bg-token-surface-tertiary h-full w-full rounded-full object-cover",alt:"GPT",width:"80",height:"80",style:{opacity:t<1?.4:1}}),t<1&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",className:"h-6 w-6",children:[c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 stroke-gray-400",strokeWidth:"10",fill:"transparent",r:"55",cx:"60",cy:"60"}),c.jsx("circle",{className:"origin-[50%_50%] -rotate-90 transition-[stroke-dashoffset]",stroke:"currentColor",strokeWidth:"10",strokeDasharray:`${n} ${n}`,strokeDashoffset:a,fill:"transparent",r:"55",cx:"60",cy:"60",style:{transition:"stroke-dashoffset 0.3s linear"}})]})})]})})};function RT({handleFileChange:e}){const t=n.useRef(null);return c.jsx(Os,{children:c.jsxs(Ds,{className:"flex min-w-[100px] max-w-xs flex-col rounded-xl border border-gray-400 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-850 dark:text-white",sideOffset:5,children:[c.jsx("div",{role:"menuitem",className:"group m-1.5 flex cursor-pointer gap-2 rounded p-2.5 text-sm hover:bg-gray-100 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 dark:hover:bg-gray-800 dark:hover:bg-white/5",tabIndex:-1,"data-orientation":"vertical",onClick:()=>{var e;t.current&&(t.current.value=""),null==(e=t.current)||e.click()},children:"Upload Photo"}),c.jsx("input",{accept:"image/png,.png,image/jpeg,.jpg,.jpeg,image/gif,.gif,image/webp,.webp",multiple:!1,type:"file",style:{display:"none"},onChange:e,ref:t,tabIndex:-1})]})})}function IT({endpoint:e,version:t,assistant_id:a,metadata:s,createMutation:r}){const o=ar(),i=vv(),[l,d]=n.useState(!1),[u,m]=n.useState(1),[p,g]=n.useState(null),[f,x]=n.useState(null),h=n.useRef(null),{data:v=Gi}=Dp({select:e=>Zi(e)}),b=kg(),{showToast:y}=Ng(),_=n.useMemo((()=>{var t;return(null==(t=null==i?void 0:i[e][a??""])?void 0:t.model)??""}),[i,e,a]),{mutate:j}=fg({onMutate:()=>{m(.4)},onSuccess:(t,n)=>{var s,i,l;!0!==n.postCreation?y({message:b("com_ui_upload_success")}):h.current!==(null==(s=r.data)?void 0:s.id)&&(h.current=(null==(i=r.data)?void 0:i.id)??""),g(null),x(null==(l=t.metadata)?void 0:l.avatar);const c=o.getQueryData([Xc.assistants,e,To]);if(!(null==c?void 0:c.data)||!c)return;const d=c.data.map((e=>e.id===a?{...e,...t}:e));o.setQueryData([Xc.assistants,e,To],{...c,data:d}),m(1)},onError:e=>{console.error("Error:",e),g(null),x(null),y({message:b("com_ui_upload_error"),status:"error"}),m(1)}});n.useEffect((()=>{if(p){const e=new FileReader;e.onloadend=()=>{x(e.result)},e.readAsDataURL(p)}}),[p]),n.useEffect((()=>{x((null==s?void 0:s.avatar)??null)}),[s]),n.useEffect((()=>{const n=!!(r.isSuccess&&p&&f&&f.includes("base64"));if((!n||h.current!==r.data.id)&&n&&r.data.id){console.log("[AssistantAvatar] Uploading Avatar after Assistant Creation");const n=new FormData;n.append("file",p,p.name),n.append("assistant_id",r.data.id),j({assistant_id:r.data.id,model:_,postCreation:!0,formData:n,endpoint:e,version:t})}}),[r.data,r.isSuccess,p,f,j,_,e,t]);return c.jsxs(Ms,{open:l,onOpenChange:d,children:[c.jsx("div",{className:"flex w-full items-center justify-center gap-4",children:c.jsx(As,{asChild:!0,children:c.jsx("button",{type:"button",className:"h-20 w-20",children:f?c.jsx(TT,{url:f,progress:u}):c.jsx(ST,{})})})}),c.jsx(RT,{handleFileChange:n=>{var s;const r=null==(s=n.target.files)?void 0:s[0];if(v.avatarSizeLimit&&r&&r.size<=v.avatarSizeLimit){if(!r)return void console.error("No file selected");if(g(r),d(!1),!a)return void console.log("[AssistantAvatar] No assistant_id, will wait until form submission + upload");const n=new FormData;n.append("file",r,r.name),n.append("assistant_id",a),j({assistant_id:a,model:_,formData:n,endpoint:e,version:t})}else{const e=v.avatarSizeLimit?su(v.avatarSizeLimit):2;y({message:b("com_ui_upload_invalid_var",{0:e+""}),status:"error"})}d(!1)}})]})}const ET=new Set(["name","id","description","instructions","conversation_starters","model","append_current_datetime"]);function PT({reset:e,value:t,endpoint:a,documentsMap:s,selectedAssistant:r,setCurrentAssistantId:o,createMutation:i,allTools:l}){const d=kg(),u=av(),m=n.useRef(null),[p]=Eb(uc.LAST_MODEL,{}),g=n.useMemo((()=>new Set(null==l?void 0:l.filter((e=>!0===e.toolkit)).map((e=>e.pluginKey)))),[l]),f=qp(a,void 0,{select:e=>e.data.map((e=>{var t,n,r,o;const i=a===Ro.assistants?ji.openai:ji.azure,l={...e,label:e.name??"",value:e.id,files:e.file_ids?[]:void 0,code_files:(null==(n=null==(t=e.tool_resources)?void 0:t.code_interpreter)?void 0:n.file_ids)?[]:void 0},c=(e,t)=>{const n=null==u?void 0:u[e];n?null==t||t.push([e,{file_id:n.file_id,type:n.type,filepath:n.filepath,filename:n.filename,width:n.width,height:n.height,size:n.bytes,preview:n.filepath,progress:1,source:i}]):null==t||t.push([e,{file_id:e,type:"",filename:"",size:1,progress:1,filepath:a,source:i}])};l.files&&e.file_ids&&e.file_ids.forEach((e=>c(e,l.files))),l.code_files&&(null==(o=null==(r=e.tool_resources)?void 0:r.code_interpreter)?void 0:o.file_ids)&&e.tool_resources.code_interpreter.file_ids.forEach((e=>c(e,l.code_files)));const d=null==s?void 0:s.get(e.id);return d&&(l.conversation_starters||(l.conversation_starters=d.conversation_starters),l.append_current_datetime=d.append_current_datetime??!1),l}))}),x=n.useCallback((t=>{var n;const s=null==(n=f.data)?void 0:n.find((e=>e.id===t));if(i.reset(),!s)return o(void 0),e({...Ho,model:(null==p?void 0:p[a])??""});const r={...s,label:s.name??"",value:s.id||""},l={[xl.code_interpreter]:!1,[xl.image_vision]:!1,[xl.retrieval]:!1};(s.tools??[]).filter((e=>"function"!==e.type||Wo(e))).map((e=>{var t;return((null==(t=e.function)?void 0:t.name)??"")||e.type})).forEach((e=>{e===so.file_search&&(l[xl.retrieval]=!0),l[e]=!0}));const c=new Set,d=(s.tools??[]).filter((e=>"function"===e.type&&!Wo(e))).map((e=>{var t;return(null==(t=e.function)?void 0:t.name)??""})).filter((e=>{const t=e.split("_")[0],n=g.has(t);return n&&c.add(t),!n}));c.size>0&&d.push(...Array.from(c));const u={functions:d,...l,assistant:r,model:r.model};Object.entries(s).forEach((([e,t])=>{ET.has(e)&&("append_current_datetime"!==e?("conversation_starters"===e&&Array.isArray(t)&&t.every((e=>"string"==typeof e))||"number"!=typeof t&&"object"!=typeof t)&&(u[e]=t):u[e]=!!t)})),e(u),o(s.id)}),[f.data,e,o,i,a,p,g]);n.useEffect((()=>{let e=null;if(r!==m.current)return""!==r&&null!=r&&f.data&&(e=setTimeout((()=>{m.current=r,x(r)}),5)),()=>{e&&clearTimeout(e)}}),[r,f.data,x]);const h=d("com_ui_create")+" "+d("com_ui_assistant");return c.jsx(sj,{value:t||h,setValue:lu(x),availableValues:f.data??[{label:"Loading...",value:""}],iconSide:"left",showAbove:!1,showLabel:!1,emptyTitle:!0,containerClassName:"flex-grow",searchClassName:"dark:from-gray-850",searchPlaceholder:d("com_assistants_search_name"),optionsClass:"hover:bg-gray-20/50 dark:border-gray-700",optionsListClass:"rounded-lg shadow-lg dark:bg-gray-850 dark:border-gray-700 dark:last:border",currentValueClass:rm("text-md font-semibold text-gray-900 dark:text-white",""===t?"text-gray-500":""),className:rm("mt-1 rounded-md dark:border-gray-700 dark:bg-gray-850","z-50 flex h-[40px] w-full flex-none items-center justify-center px-4 hover:cursor-pointer hover:border-green-500 focus:border-gray-400"),renderOption:()=>c.jsxs("span",{className:"flex items-center gap-1.5 truncate",children:[c.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-2 text-gray-800 dark:text-gray-100",children:c.jsx(Ze,{className:"w-[16px]"})}),c.jsx("span",{className:rm("ml-4 flex h-6 items-center gap-1 text-gray-800 dark:text-gray-100"),children:h})]})})}const LT=n.forwardRef(((e,t)=>{const n=kg(),{title:a,description:s,main:r,buttons:o,leftButtons:i,selection:l,className:d,headerClassName:u,footerClassName:m,showCloseButton:p,showCancelButton:g=!0}=e,{selectHandler:f,selectClasses:x,selectText:h}=l||{},v=n("com_ui_cancel");return c.jsxs(t_,{showCloseButton:p,ref:t,className:rm("shadow-2xl dark:bg-gray-700",d||""),onClick:e=>e.stopPropagation(),children:[c.jsxs(n_,{className:rm(u??""),children:[c.jsx(s_,{className:"text-lg font-medium leading-6 text-gray-800 dark:text-gray-200",children:a}),s&&c.jsx(r_,{className:"text-gray-600 dark:text-gray-300",children:s})]}),c.jsx("div",{className:"px-6",children:r||null}),c.jsxs(a_,{className:m,children:[c.jsx("div",{children:i||null}),c.jsxs("div",{className:"flex h-auto gap-3",children:[g&&c.jsx(o_,{className:"border-gray-100 hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-600",children:v}),o||null,l?c.jsx(o_,{onClick:f,className:`${x||"bg-gray-800 text-white transition-colors hover:bg-gray-700 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-gray-200 dark:text-gray-800 dark:hover:bg-gray-200"} inline-flex h-10 items-center justify-center rounded-lg border-none px-4 py-2 text-sm`,children:h}):null]})]})]})}));function MT({activeModel:e,assistant_id:t,setCurrentAssistantId:n,createMutation:a,endpoint:s}){const r=kg(),{showToast:o}=Ng(),{conversation:i}=bh(),{setOption:l}=Ev(),d=gg({onSuccess:(e,t,s)=>{var c;const d=s;if(!d)return;o({message:r("com_ui_assistant_deleted"),status:"success"}),void 0!==(null==(c=a.data)?void 0:c.id)&&(console.log("[deleteAssistant] resetting createMutation"),a.reset());const u=d[0];if(!u)return l("assistant_id")("");if(t.assistant_id===(null==i?void 0:i.assistant_id))return l("assistant_id")(u.id);const m=d.find((e=>e.id===(null==i?void 0:i.assistant_id)));m&&n(m.id),n(u.id)},onError:e=>{console.error(e),o({message:r("com_ui_assistant_delete_error"),status:"error"})}});return t?0===(null==e?void 0:e.length)||void 0===e?null:c.jsxs(Yy,{children:[c.jsx(Jy,{asChild:!0,children:c.jsx("button",{className:rm("btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",mm),type:"button",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2 text-red-500",children:c.jsx(uy,{})})})}),c.jsx(LT,{title:r("com_ui_delete")+" "+r("com_ui_assistant"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(g_,{htmlFor:"delete-assistant",className:"text-left text-sm font-medium",children:r("com_ui_delete_assistant_confirm")})})})}),selection:{selectHandler:()=>d.mutate({assistant_id:t,model:e,endpoint:s}),selectClasses:"bg-red-600 hover:bg-red-700 dark:hover:bg-red-800 text-white",selectText:r("com_ui_delete")}})]}):null}function AT({tool:e,allTools:t,assistant_id:a=""}){const[s,r]=n.useState(!1),o=kg(),{showToast:i}=Ng(),l=xh(),{getValues:d,setValue:u}=Ut(),m=t.find((t=>t.pluginKey===e));return m?c.jsxs(f_,{children:[c.jsxs("div",{className:rm("flex w-full items-center rounded-lg text-sm",a?"":"opacity-40"),onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[c.jsxs("div",{className:"flex grow items-center",children:[m.icon&&c.jsx("div",{className:"flex h-9 w-9 items-center justify-center overflow-hidden rounded-full",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full bg-center bg-no-repeat dark:bg-white/20",style:{backgroundImage:`url(${m.icon})`,backgroundSize:"cover"}})}),c.jsx("div",{className:"h-9 grow px-3 py-2",style:{textOverflow:"ellipsis",wordBreak:"break-all",overflow:"hidden"},children:m.name})]}),s&&c.jsx(x_,{asChild:!0,children:c.jsx("button",{type:"button",className:"flex h-9 w-9 min-w-9 items-center justify-center rounded-lg transition-colors duration-200 hover:bg-gray-200 dark:hover:bg-gray-700",children:c.jsx(uy,{})})})]}),c.jsx(ij,{showCloseButton:!1,title:o("com_ui_delete_tool"),className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:o("com_ui_delete_tool_confirm")}),selection:{selectHandler:()=>{var e;(e=m.pluginKey)&&l.mutate({pluginKey:e,action:"uninstall",auth:null,isEntityTool:!0},{onError:e=>{i({message:`Error while deleting the tool: ${e}`,status:"error"})},onSuccess:()=>{const t=d("functions").filter((t=>t!==e));u("functions",t),i({message:"Tool deleted successfully",status:"success"})}})},selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 transition-colors duration-200 text-white",selectText:o("com_ui_delete")}})]}):null}const OT=({children:e})=>{const t=kg();return c.jsxs("div",{children:[c.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:t("com_assistants_code_interpreter_files")}),c.jsx("div",{className:"flex flex-wrap gap-2",children:e})]})};function DT({endpoint:e,assistant_id:t,files:a}){const s=kg(),{setFilesLoading:r}=bh(),o=n.useRef(null),[i,l]=n.useState(new Map),{data:d=Gi}=Dp({select:e=>Zi(e)}),{handleFileChange:u}=Gv({overrideEndpoint:e,additionalMetadata:{assistant_id:t},fileSetter:l});n.useEffect((()=>{a&&l(new Map(a))}),[a]);const m=d.endpoints[e];if((null==m?void 0:m.disabled)??!1)return null;return c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"mb-1.5 flex items-center",children:c.jsx("span",{children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:s(t?"com_assistants_knowledge":"com_assistants_knowledge_disabled")})})}),c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"text-token-text-tertiary rounded-lg",children:t?s("com_assistants_knowledge_info"):""}),c.jsx(GS,{files:i,setFiles:l,setFilesLoading:r,assistant_id:t,fileFilter:e=>Ui.some((t=>t.test(e.type??""))),Wrapper:({children:e})=>c.jsx("div",{className:"flex flex-wrap gap-2",children:e})}),c.jsx(GS,{files:i,setFiles:l,setFilesLoading:r,assistant_id:t,fileFilter:e=>!Ui.some((t=>t.test(e.type??""))),Wrapper:OT}),c.jsx("div",{children:c.jsx("button",{type:"button",disabled:!t,className:"btn btn-neutral border-token-border-light relative h-8 rounded-lg font-medium",onClick:()=>{var e;o.current&&(o.current.value=""),null==(e=o.current)||e.click()},children:c.jsxs("div",{className:"flex w-full items-center justify-center gap-2",children:[c.jsx("input",{multiple:!0,type:"file",style:{display:"none"},tabIndex:-1,ref:o,disabled:!t,onChange:u}),s("com_ui_upload_files")]})})})]})]})}const FT="mb-2 text-token-text-primary block font-medium",zT=rm(fm,"flex w-full px-3 py-2 dark:border-gray-800 dark:bg-gray-800 rounded-xl mb-2",mm);function UT({setAction:e,endpoint:t,actions:a=[],setActivePanel:s,documentsMap:r,assistant_id:o,setCurrentAssistantId:i,assistantsConfig:l,version:d}){const u=mh(),m=vv(),{data:p=[]}=Np(),{onSelect:g}=jh(t),{showToast:f}=Ng(),x=kg(),h=ne({defaultValues:Ho}),[v,b]=n.useState(!1),{control:y,handleSubmit:_,reset:j,setValue:w,getValues:N}=h,C=Mt({control:y,name:"assistant"}),k=Mt({control:y,name:"functions"}),S=Mt({control:y,name:"id"}),T=n.useMemo((()=>{var e,n;return null==(n=null==(e=null==m?void 0:m[t])?void 0:e[S])?void 0:n.model}),[m,t,S]),R=n.useMemo((()=>{var e;return null==(e=null==l?void 0:l.capabilities)?void 0:e.includes(xl.tools)}),[l]),I=n.useMemo((()=>{var e;return null==(e=null==l?void 0:l.capabilities)?void 0:e.includes(xl.actions)}),[l]),E=n.useMemo((()=>{var e;return null==(e=null==l?void 0:l.capabilities)?void 0:e.includes(xl.retrieval)}),[l]),P=n.useMemo((()=>{var e;return null==(e=null==l?void 0:l.capabilities)?void 0:e.includes(xl.code_interpreter)}),[l]),L=pg({onSuccess:e=>{f({message:`${x("com_assistants_update_success")} ${e.name??x("com_ui_assistant")}`})},onError:e=>{const t=e;f({message:`${x("com_assistants_update_error")}${t.message?` ${x("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),M=mg({onSuccess:e=>{i(e.id),f({message:`${x("com_assistants_create_success")} ${e.name??x("com_ui_assistant")}`})},onError:e=>{const t=e;f({message:`${x("com_assistants_create_error")}${t.message?` ${x("com_ui_error")}: ${t.message}`:""}`,status:"error"})}}),A=n.useMemo((()=>"string"==typeof C?[]:C.files),[C]);let O;return O=M.isLoading||L.isLoading?c.jsx(Hb,{className:"icon-md"}):x(S?"com_ui_save":"com_ui_create"),c.jsx(Kt,{...h,children:c.jsxs("form",{onSubmit:_((e=>{const n=[...k].map((e=>{var n,a;if(!e.includes(_o))return e;{const s=null==(n=null==m?void 0:m[t])?void 0:n[S],r=null==(a=null==s?void 0:s.tools)?void 0:a.find((t=>{var n;return(null==(n=t.function)?void 0:n.name)===e}));if(s&&r)return r}return e}));e.code_interpreter&&n.push({type:so.code_interpreter}),e.retrieval&&n.push({type:2==d?so.file_search:so.retrieval}),e.image_vision&&n.push(Ko);const{name:a,description:s,instructions:r,conversation_starters:o,model:i,append_current_datetime:l}=e;S?L.mutate({assistant_id:S,data:{name:a,description:s,instructions:r,conversation_starters:o.filter((e=>""!==e.trim())),model:i,tools:n,endpoint:t,append_current_datetime:l}}):M.mutate({name:a,description:s,instructions:r,conversation_starters:o.filter((e=>""!==e.trim())),model:i,tools:n,endpoint:t,version:d,append_current_datetime:l})})),className:"h-auto w-full flex-shrink-0 overflow-x-hidden",children:[c.jsxs("div",{className:"flex w-full flex-wrap",children:[c.jsx(tt,{name:"assistant",control:y,render:({field:e})=>c.jsx(PT,{reset:j,value:e.value,endpoint:t,documentsMap:r,allTools:p,setCurrentAssistantId:i,selectedAssistant:o??null,createMutation:M})}),S&&c.jsx("button",{className:"btn btn-primary focus:shadow-outline mx-2 mt-1 h-[40px] rounded bg-green-500 px-4 py-2 font-semibold text-white hover:bg-green-400 focus:border-green-500 focus:outline-none focus:ring-0",type:"button",disabled:!S,onClick:e=>{e.preventDefault(),g(S)},children:x("com_ui_select")})]}),c.jsxs("div",{className:"bg-surface-50 h-auto px-4 pb-8 pt-3 dark:bg-transparent",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx(IT,{createMutation:M,assistant_id:S,metadata:C.metadata??null,endpoint:t,version:d}),c.jsx("label",{className:FT,htmlFor:"name",children:x("com_ui_name")}),c.jsx(tt,{name:"name",control:y,render:({field:e})=>c.jsx("input",{...e,value:e.value??"",max:256,className:zT,id:"name",type:"text",placeholder:x("com_assistants_name_placeholder")})}),c.jsx(tt,{name:"id",control:y,render:({field:e})=>c.jsx("p",{className:"h-3 text-xs italic text-text-secondary",children:e.value})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:FT,htmlFor:"description",children:x("com_ui_description")}),c.jsx(tt,{name:"description",control:y,render:({field:e})=>c.jsx("input",{...e,value:e.value??"",max:512,className:zT,id:"description",type:"text",placeholder:x("com_assistants_description_placeholder")})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:FT,htmlFor:"instructions",children:x("com_ui_instructions")}),c.jsx(tt,{name:"instructions",control:y,render:({field:e})=>c.jsx("textarea",{...e,value:e.value??"",max:32768,className:rm(zT,"min-h-[100px] resize-y"),id:"instructions",placeholder:x("com_assistants_instructions_placeholder"),rows:3})})]}),c.jsx(yT,{control:y,setValue:w,getValues:N}),c.jsx("div",{className:"relative mb-6",children:c.jsx(tt,{name:"conversation_starters",control:y,defaultValue:[],render:({field:e})=>c.jsx(bT,{field:e,inputClass:zT,labelClass:FT})})}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:FT,htmlFor:"model",children:x("com_ui_model")}),c.jsx(tt,{name:"model",control:y,rules:{required:!0,minLength:1},render:({field:e,fieldState:{error:n}})=>{var a;return c.jsxs(c.Fragment,{children:[c.jsx(sj,{emptyTitle:!0,value:e.value,setValue:e.onChange,availableValues:(null==(a=u.data)?void 0:a[t])??[],showAbove:!1,showLabel:!1,className:rm(gm,"flex h-[40px] w-full flex-none items-center justify-center px-4 hover:cursor-pointer"),containerClassName:rm("rounded-md",n?"border-red-500 border-2":"")}),n&&c.jsx("span",{className:"text-sm text-red-500 transition duration-300 ease-in-out",children:x("com_ui_field_required")})]})}})]}),(!0===P||!0===E)&&1==d&&c.jsx(DT,{assistant_id:S,files:A,endpoint:t}),c.jsx(kT,{version:d,endpoint:t,codeEnabled:P,assistantsConfig:l,retrievalEnabled:E}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:FT,children:`${!0===R?x("com_ui_tools"):""}\n              ${!0===R&&!0===I?" + ":""}\n              ${!0===I?x("com_assistants_actions"):""}`}),c.jsxs("div",{className:"space-y-2",children:[k.map(((e,t)=>c.jsx(AT,{tool:e,allTools:p,assistant_id:S},`${e}-${t}-${S}`))),a.filter((e=>e.assistant_id===S)).map(((t,n)=>c.jsx(PS,{action:t,onClick:()=>e(t)},n))),c.jsxs("div",{className:"flex space-x-2",children:[!0===R&&c.jsx("button",{type:"button",onClick:()=>b(!0),className:"btn btn-neutral border-token-border-light relative h-8 w-full rounded-lg font-medium",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:x("com_assistants_add_tools")})}),!0===I&&c.jsx("button",{type:"button",disabled:!S,onClick:()=>{if(!S)return f({message:x("com_assistants_actions_disabled"),status:"warning"});s(Hr.actions)},className:"btn btn-neutral border-token-border-light relative h-8 w-full rounded-lg font-medium",children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:x("com_assistants_add_actions")})})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx(MT,{assistant_id:S,activeModel:T,setCurrentAssistantId:i,createMutation:M,endpoint:t}),c.jsx("button",{className:"btn btn-primary focus:shadow-outline flex w-full items-center justify-center px-4 py-2 font-semibold text-white hover:bg-green-600 focus:border-green-500",type:"submit",children:O})]})]}),c.jsx(MS,{isOpen:v,setIsOpen:b,toolsFormKey:"functions",endpoint:t})]})})}function VT({columns:e,data:t}){const n=or({columns:e,data:t,getCoreRowModel:lr()});return c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:n.getHeaderGroups().map(((e,t)=>c.jsx("tr",{className:"border-token-border-light text-token-text-tertiary border-b text-left text-xs",children:e.headers.map(((e,t)=>c.jsx("th",{className:"py-1 font-normal",children:e.isPlaceholder?null:ir(e.column.columnDef.header,e.getContext())},t)))},t)))}),c.jsx("tbody",{children:n.getRowModel().rows.map(((e,t)=>c.jsx("tr",{className:"border-token-border-light border-b",children:e.getVisibleCells().map(((e,t)=>c.jsx("td",{className:"py-2",children:ir(e.column.columnDef.cell,e.getContext())},t)))},t)))})]})}const BT=[{header:"Name",accessorKey:"name"},{header:"Method",accessorKey:"method"},{header:"Path",accessorKey:"path"}],$T=$(((e,t)=>{t(qd(e))}),800);function HT({action:e,assistant_id:t,endpoint:a,version:s,setAction:r}){var o;const i=e=>{e.status||(b(null),_(null)),f(e)},l=kg(),{showToast:d}=Ng(),u=vv(),{handleSubmit:m,reset:p}=Ut(),[g,f]=n.useState(null),[x,h]=n.useState(""),[v,b]=n.useState(null),[y,_]=n.useState(null);n.useEffect((()=>{var t;const n=(null==(t=null==e?void 0:e.metadata)?void 0:t.raw_spec)??"";n&&(h(n),$T(n,i))}),[null==(o=null==e?void 0:e.metadata)?void 0:o.raw_spec]),n.useEffect((()=>{if(!g||!g.status||!g.spec)return;const{functionSignatures:e,requestBuilders:t}=Qd(g.spec),n=Object.entries(t).map((([e,t])=>({name:e,method:t.method,path:t.path,domain:t.domain})));b(n),f(null),_(e.map((e=>e.toObjectTool())))}),[g]);const j=xg({onSuccess(e){d({message:l("com_assistants_update_actions_success"),status:"success"}),p(),r(e[2])},onError(e){d({message:(null==e?void 0:e.message)??l("com_assistants_update_actions_error"),status:"error"})}}),w=m((n=>{console.log("authFormData",n);const r=t??"";if(!r)return;if(!y)return;if(!v)return;let{metadata:o}=e??{};o||(o={});const i=null==e?void 0:e.action_id;o.raw_spec=x;const l=new URL(v[0].domain).hostname;if(!l)return;o.domain=l;const{type:c,saved_auth_fields:d}=n,m=e=>{delete e.auth,delete e.api_key,delete e.oauth_client_id,delete e.oauth_client_secret};d&&c===ho.ServiceHttp?o={...o,api_key:n.api_key,auth:{type:c,authorization_type:n.authorization_type,custom_auth_header:n.custom_auth_header}}:d&&c===ho.OAuth?o={...o,auth:{type:c,authorization_url:n.authorization_url,client_url:n.client_url,scope:n.scope,token_exchange_method:n.token_exchange_method},oauth_client_id:n.oauth_client_id,oauth_client_secret:n.oauth_client_secret}:d?(m(o),o.auth={type:c}):m(o),j.mutate({action_id:i,metadata:o,functions:y,assistant_id:r,endpoint:a,version:s,model:(null==u?void 0:u[a][r].model)??""})}));return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"",children:[c.jsxs("div",{className:"mb-1 flex flex-wrap items-center justify-between gap-4",children:[c.jsx("label",{htmlFor:"example-schema",className:"text-token-text-primary whitespace-nowrap font-medium",children:l("com_ui_schema")}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("select",{id:"example-schema",onChange:e=>console.log(e.target.value),className:"border-token-border-medium h-8 min-w-[100px] rounded-lg border bg-transparent px-2 py-0 text-sm",children:[c.jsx("option",{value:"label",children:l("com_ui_examples")}),c.jsx("option",{value:"0",children:"Weather (JSON)"}),c.jsx("option",{value:"1",children:"Pet Store (YAML)"}),c.jsx("option",{value:"2",children:"Blank Template"})]})})]}),c.jsxs("div",{className:"border-token-border-medium bg-token-surface-primary hover:border-token-border-hover mb-4 w-full overflow-hidden rounded-lg border ring-0",children:[c.jsx("div",{className:"relative",children:c.jsx("textarea",{id:"schemaInput",value:x,onChange:e=>{const t=e.target.value;if(h(t),!t)return b(null),_(null),f(null);$T(t,i)},spellCheck:"false",placeholder:l("com_ui_enter_openapi_schema"),className:"text-token-text-primary block h-96 w-full bg-transparent p-2 font-mono text-xs outline-none focus:ring-1 focus:ring-border-light"})}),g&&"OpenAPI spec is valid."!==g.message&&c.jsx("div",{className:"border-token-border-light border-t p-2 text-red-500",children:g.message.split("\n").map(((e,t)=>c.jsx("div",{children:e},t)))})]})]}),!!v&&c.jsxs("div",{className:"my-2",children:[c.jsx("div",{className:"flex items-center",children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:l("com_assistants_available_actions")})}),c.jsx(VT,{columns:BT,data:v})]}),c.jsxs("div",{className:"relative my-1",children:[c.jsx(CS,{action_id:null==e?void 0:e.action_id}),c.jsx("div",{className:"mb-1.5 flex items-center",children:c.jsx("label",{className:"text-token-text-primary block font-medium",children:l("com_ui_privacy_policy_url")})}),c.jsx("div",{className:"border-token-border-medium bg-token-surface-primary hover:border-token-border-hover flex h-9 w-full rounded-lg border",children:c.jsx("input",{type:"text",placeholder:"https://api.example-weather-app.com/privacy",className:"flex-1 rounded-lg bg-transparent px-3 py-1.5 text-sm outline-none placeholder:text-text-secondary-alt focus:ring-1 focus:ring-border-light"})})]}),c.jsx("div",{className:"flex items-center justify-end",children:c.jsx("button",{disabled:!y||!y.length,onClick:w,className:"focus:shadow-outline mt-1 flex min-w-[100px] items-center justify-center rounded bg-green-500 px-4 py-2 font-semibold text-white hover:bg-green-400 focus:border-green-500 focus:outline-none focus:ring-0 disabled:bg-green-400",type:"button",children:j.isLoading?c.jsx(Hb,{className:"icon-md"}):(null==e?void 0:e.action_id.length)?l("com_ui_update"):l("com_ui_create")})})]})}function GT({action:e,endpoint:t,version:a,setAction:s,assistant_id:r,setActivePanel:o}){const i=kg(),{showToast:l}=Ng(),d=vv(),u=hg({onSuccess:()=>{l({message:i("com_assistants_delete_actions_success"),status:"success"}),o(Hr.builder),s(void 0)},onError(e){l({message:(null==e?void 0:e.message)??i("com_assistants_delete_actions_error"),status:"error"})}}),m=ne({defaultValues:{type:ho.None,saved_auth_fields:!1,api_key:"",authorization_type:vo.Basic,custom_auth_header:"",oauth_client_id:"",oauth_client_secret:"",authorization_url:"",client_url:"",scope:"",token_exchange_method:bo.DefaultPost}}),{reset:p,watch:g}=m;return n.useEffect((()=>{var t;(null==(t=null==e?void 0:e.metadata)?void 0:t.auth)&&p({type:e.metadata.auth.type||ho.None,saved_auth_fields:!1,api_key:e.metadata.api_key??"",authorization_type:e.metadata.auth.authorization_type||vo.Basic,oauth_client_id:e.metadata.oauth_client_id??"",oauth_client_secret:e.metadata.oauth_client_secret??"",authorization_url:e.metadata.auth.authorization_url??"",client_url:e.metadata.auth.client_url??"",scope:e.metadata.auth.scope??"",token_exchange_method:e.metadata.auth.token_exchange_method??bo.DefaultPost})}),[e,p]),c.jsx(Kt,{...m,children:c.jsx("form",{className:"h-full grow overflow-hidden",children:c.jsxs("div",{className:"h-full overflow-auto px-2 pb-12 text-sm",children:[c.jsxs("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[c.jsx("div",{className:"absolute left-0 top-6",children:c.jsx("button",{type:"button",className:"btn btn-neutral relative",onClick:()=>{o(Hr.builder),s(void 0)},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:c.jsx(Cn,{})})})}),!!e&&c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx("div",{className:"absolute right-0 top-6",children:c.jsx("button",{type:"button",disabled:!r||!e.action_id,className:"btn btn-neutral border-token-border-light relative h-9 rounded-lg font-medium",children:c.jsx(uy,{className:"text-red-500"})})})}),c.jsx(ij,{showCloseButton:!1,title:i("com_ui_delete_action"),className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:i("com_ui_delete_action_confirm")}),selection:{selectHandler:()=>{const n=r??"";if(!n)return l({message:"No assistant_id found, is the assistant created?",status:"error"});u.mutate({model:(null==d?void 0:d[t][n].model)??"",action_id:e.action_id,assistant_id:n,endpoint:t})},selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 transition-color duration-200 text-white",selectText:i("com_ui_delete")}})]}),c.jsx("div",{className:"text-xl font-medium",children:(e?"Edit":"Add")+" actions"}),c.jsx("div",{className:"text-xs text-text-secondary",children:i("com_assistants_actions_info")})]}),c.jsx(_S,{disableOAuth:!0}),c.jsx(HT,{action:e,assistant_id:r,setAction:s,endpoint:t,version:a})]})})})}function KT(){const{conversation:e,index:t}=bh(),[a,s]=n.useState(Hr.builder),[r,o]=n.useState(void 0),[i,l]=n.useState(null==e?void 0:e.assistant_id),{data:d={}}=Mp(),{data:u=[]}=Zp(null==e?void 0:e.endpoint),{data:m=null}=Yp((null==e?void 0:e.endpoint)??"",{select:e=>new Map(e.map((e=>[e.assistant_id,e])))}),p=n.useMemo((()=>null==d?void 0:d[(null==e?void 0:e.endpoint)??""]),[null==e?void 0:e.endpoint,d]);if(n.useEffect((()=>{const t=(null==e?void 0:e.assistant_id)??"";t&&l(t)}),[null==e?void 0:e.assistant_id]),!(null==e?void 0:e.endpoint))return null;const g=(null==p?void 0:p.version)??wl[e.endpoint];return a===Hr.actions||r?c.jsx(GT,{index:t,action:r,actions:u,setAction:o,activePanel:a,documentsMap:m,setActivePanel:s,assistant_id:i,setCurrentAssistantId:l,endpoint:e.endpoint,version:g}):a===Hr.builder?c.jsx(UT,{index:t,activePanel:a,action:r,actions:u,setAction:o,documentsMap:m,setActivePanel:s,assistant_id:i,setCurrentAssistantId:l,endpoint:e.endpoint,assistantsConfig:p,version:g}):void 0}function WT({onCheckedChange:e,className:t=""}){const[n,a]=T(_p.autoSendPrompts),s=kg();return c.jsxs("div",{className:rm("flex select-none items-center justify-end gap-2 text-right text-sm",t),children:[c.jsxs("div",{children:[" ",s("com_nav_auto_send_prompts")," "]}),c.jsx(R_,{"aria-label":"toggle-auto-send-prompts",id:"autoSendPrompts",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},"data-testid":"autoSendPrompts"})]})}function QT({className:e}){const t=kg(),a=R(_p.promptsName),s=R(_p.promptsCategory),r=Vv("/d/prompts",n.useCallback((()=>{a(""),s("")}),[a,s]));return c.jsx(By,{variant:"outline",className:rm(e,"bg-transparent"),onClick:e=>{r(e)},"aria-label":"Manage Prompts",role:"button",children:t("com_ui_manage")})}function qT(){const e=Nb();return c.jsx("div",{className:"flex h-full w-full flex-col",children:c.jsxs(eC,{className:"lg:w-full xl:w-full",...e,children:[c.jsxs("div",{className:"flex w-full flex-row items-center justify-between pt-2",children:[c.jsx(QT,{className:"select-none"}),c.jsx(WT,{className:"text-xs dark:text-white"})]}),c.jsx(Dj,{setName:e.setName,className:"items-center justify-center"})]})})}function ZT(){const e=kg(),{conversation:t,setConversation:a}=bh(),{setOption:s}=Ev(),[r,o]=n.useState(!1),[i,l]=n.useState(null),{data:d}=Mp(),u=n.useMemo((()=>{var e;return(null==(e=null==d?void 0:d[(null==t?void 0:t.endpoint)??""])?void 0:e.availableRegions)??[]}),[d,null==t?void 0:t.endpoint]),m=n.useMemo((()=>Hu(d,null==t?void 0:t.endpoint,"type")),[null==t?void 0:t.endpoint,d]),p=n.useMemo((()=>{const[e,n]=Ao(m??(null==t?void 0:t.endpoint)??"",(null==t?void 0:t.model)??"");return tN[e]??tN[n]}),[t,m]);n.useEffect((()=>{if(!p)return;const e=new Set(p.map((e=>e.key)));a((t=>{if(!t)return t;const n={...t},a=Object.keys(n),s=[];return a.forEach((a=>{e.has(a)||gl.has(a)||null!=t[a]&&(s.push(a),delete n[a])})),om.log("parameters","parameters effect, updated keys:",s),n}))}),[p,a]);const g=n.useCallback((()=>{a((e=>{if(!e)return e;const t={...e},n=[];return Object.keys(t).forEach((e=>{gl.has(e)||void 0!==t[e]&&(n.push(e),delete t[e])})),om.log("parameters","parameters reset, affected keys:",n),t}))}),[a]),f=n.useCallback((()=>{const e=gi.parse({...t});l(e),o(!0)}),[t]);return p?c.jsxs("div",{className:"h-auto max-w-full overflow-x-hidden p-3",children:[c.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[" ",p.map((e=>{const n=ww[e.component];if(!n)return null;const{key:a,default:r,...o}=e;return"region"===a&&u.length&&(o.options=u),c.jsx(n,{settingKey:a,defaultValue:r,...o,setOption:s,conversation:t},a)}))]}),c.jsx("div",{className:"mt-4 flex justify-center",children:c.jsxs("button",{type:"button",onClick:g,className:"btn btn-neutral flex w-full items-center justify-center gap-2 px-4 py-2 text-sm",children:[c.jsx(Rn,{className:"h-4 w-4","aria-hidden":"true"}),e("com_ui_reset_var",{0:e("com_ui_model_parameters")})]})}),c.jsx("div",{className:"mt-2 flex justify-center",children:c.jsx("button",{onClick:f,className:"btn btn-primary focus:shadow-outline flex w-full items-center justify-center px-4 py-2 font-semibold text-white hover:bg-green-600 focus:border-green-500",type:"button",children:e("com_endpoint_save_as_preset")})}),i&&c.jsx(xN,{open:r,onOpenChange:o,preset:i})]}):null}function YT({row:e}){const t=e.original;return c.jsxs("div",{className:"flex w-full items-center gap-2",children:[!0===(null==t?void 0:t.type.startsWith("image"))?c.jsx($S,{url:t.filepath,className:"h-10 w-10 flex-shrink-0",source:t.source,alt:t.filename}):c.jsx(_N,{fileType:tu(null==t?void 0:t.type),file:t}),c.jsx("div",{className:"min-w-0 flex-1 overflow-hidden",children:c.jsx("span",{className:"block w-full overflow-hidden truncate text-ellipsis whitespace-nowrap text-xs",children:null==t?void 0:t.filename})})]})}const JT=[{accessorKey:"filename",header:({column:e})=>c.jsxs(By,{variant:"ghost",className:"hover:bg-surface-hover",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Name",c.jsx(Ln,{className:"ml-2 h-4 w-4"})]}),meta:{size:"150px"},cell:({row:e})=>c.jsx(YT,{row:e})},{accessorKey:"updatedAt",meta:{size:"10%"},header:({column:e})=>c.jsxs(By,{variant:"ghost",className:"hover:bg-surface-hover",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Date",c.jsx(Ln,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>{var t;return c.jsx("span",{className:"flex justify-end text-xs",children:nu((null==(t=e.original.updatedAt)?void 0:t.toString())??"")})}}];function XT({columns:e,data:t}){var a;const s=kg(),[r,o]=n.useState([]),[i,l]=n.useState([]),[d,u]=n.useState({}),[{pageIndex:m,pageSize:p},g]=n.useState({pageIndex:0,pageSize:10}),f=R(_p.showFiles),x=n.useMemo((()=>({pageIndex:m,pageSize:p})),[m,p]),h=or({data:t,columns:e,state:{sorting:r,columnFilters:i,columnVisibility:d,pagination:x},onSortingChange:o,onPaginationChange:g,getCoreRowModel:lr(),getSortedRowModel:ur(),onColumnFiltersChange:l,getFilteredRowModel:dr(),onColumnVisibilityChange:u,getPaginationRowModel:cr(),defaultColumn:{minSize:0,size:10,maxSize:10,enableResizing:!0}}),v=av(),{showToast:b}=Ng(),{setFiles:y,conversation:_}=bh(),{data:j=Gi}=Dp({select:e=>Zi(e)}),{addFile:w}=Hv(y),N=n.useCallback((e=>{if(!(null==v?void 0:v[e.file_id])||!(null==_?void 0:_.endpoint))return void b({message:s("com_ui_attach_error"),status:"error"});const t=v[e.file_id],n=_.endpoint;if(!t.source)return;const a=Ji(t.source),r=Oo(n);if(a&&!r)return void b({message:s("com_ui_attach_error_openai"),status:"error"});!a&&r&&b({message:s("com_ui_attach_warn_endpoint"),status:"warning"});const{fileSizeLimit:o,supportedMimeTypes:i}=j.endpoints[n]??j.endpoints.default;t.bytes>o?b({message:`${s("com_ui_attach_error_size")} ${o/Vi} MB (${n})`,status:"error"}):Gi.checkType(e.type,i)?w({progress:1,attached:!0,file_id:t.file_id,filepath:t.filepath,preview:t.filepath,type:t.type,height:t.height,width:t.width,filename:t.filename,source:t.source,size:t.bytes}):b({message:`${s("com_ui_attach_error_type")} ${e.type} (${n})`,status:"error"})}),[w,v,_,s,b,j.endpoints]),C=null==(a=h.getColumn("filename"))?void 0:a.getFilterValue();return c.jsxs("div",{role:"region","aria-label":s("com_files_table"),className:"mt-2 space-y-2",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsx(m_,{placeholder:s("com_files_filter"),value:C??"",onChange:e=>{var t;return null==(t=h.getColumn("filename"))?void 0:t.setFilterValue(e.target.value)},"aria-label":s("com_files_filter")})}),c.jsx("div",{className:"rounded-lg border border-border-light bg-transparent shadow-sm transition-colors",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(I_,{children:[c.jsx(E_,{children:h.getHeaderGroups().map((e=>c.jsx(L_,{className:"border-b border-border-light",children:e.headers.map(((e,t)=>c.jsx(M_,{style:{width:0===t?"75%":"25%"},className:"bg-surface-secondary py-3 text-left text-sm font-medium text-text-secondary",children:c.jsx("div",{className:"px-4",children:e.isPlaceholder?null:ir(e.column.columnDef.header,e.getContext())})},e.id)))},e.id)))}),c.jsx(P_,{children:h.getRowModel().rows.length?h.getRowModel().rows.map((e=>c.jsx(L_,{"data-state":e.getIsSelected()&&"selected",className:"border-b border-border-light transition-colors hover:bg-surface-secondary [&:last-child]:border-0",children:e.getVisibleCells().map((t=>{const n="filename"===t.column.id;return c.jsx(A_,{style:{width:"150px",maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},"data-skip-refocus":"true",role:n?"button":void 0,tabIndex:n?0:void 0,onClick:t=>{if(n){const n=t.target;n.closest("td")&&!n.closest("button, a")&&(t.preventDefault(),t.stopPropagation(),N(e.original))}},onKeyDown:t=>{if(n&&("Enter"===t.key||" "===t.key)){const n=t.target;n.closest("td")&&!n.closest("button, a")&&(t.preventDefault(),t.stopPropagation(),N(e.original))}},children:ir(t.column.columnDef.cell,t.getContext())},t.id)}))},e.id))):c.jsx(L_,{children:c.jsx(A_,{colSpan:e.length,className:"h-24 text-center text-sm text-text-secondary",children:s("com_files_no_results")})})})]})})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(By,{variant:"outline",size:"sm",onClick:()=>f(!0),"aria-label":s("com_sidepanel_manage_files"),children:[c.jsx(Mn,{className:"h-4 w-4","aria-hidden":"true"}),c.jsx("span",{className:"ml-2",children:s("com_sidepanel_manage_files")})]}),c.jsxs("div",{className:"flex items-center gap-2",role:"navigation","aria-label":"Pagination",children:[c.jsx(By,{variant:"outline",size:"sm",onClick:()=>h.previousPage(),disabled:!h.getCanPreviousPage(),"aria-label":s("com_ui_prev"),children:s("com_ui_prev")}),c.jsx("div",{"aria-live":"polite",className:"text-sm",children:`${m+1} / ${h.getPageCount()}`}),c.jsx(By,{variant:"outline",size:"sm",onClick:()=>h.nextPage(),disabled:!h.getCanNextPage(),"aria-label":s("com_ui_next"),children:s("com_ui_next")})]})]})]})}function eR(){const{data:e=[]}=Op();return c.jsx("div",{className:"h-auto max-w-full overflow-x-hidden",children:c.jsx(XT,{columns:JT,data:e})})}function tR({onToggle:e,navVisible:t,isHovering:n,setIsHovering:a,side:s="left",className:r="",translateX:o=!0}){const i=kg(),l={transition:"transform 0.3s ease, opacity 0.2s ease"},d=n||!t?"15deg":"0deg",u="right"===s?`-${d}`:d,m="right"===s?d:`-${d}`;return c.jsx("div",{className:rm(r,"-translate-y-1/2 transition-transform",t?"rotate-0":"rotate-180",t&&o?"translate-x-[260px]":"translate-x-0 "),onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:c.jsx(z_,{side:"right"===s?"left":"right","aria-label":i("left"===s?"com_ui_chat_history":"com_ui_controls"),"aria-expanded":t,"aria-controls":"left"===s?"chat-history-nav":"controls-nav",id:`toggle-${s}-nav`,onClick:e,role:"button",description:i(t?"com_nav_close_sidebar":"com_nav_open_sidebar"),className:"flex items-center justify-center",tabIndex:0,children:c.jsx("span",{className:"","data-state":"closed",children:c.jsx("div",{className:"flex h-[72px] w-8 items-center justify-center",style:{...l,opacity:n?1:.25},children:c.jsxs("div",{className:"flex h-6 w-6 flex-col items-center",children:[c.jsx("div",{className:"h-3 w-1 rounded-full bg-black dark:bg-white",style:{...l,transform:`translateY(0.15rem) rotate(${u}) translateZ(0px)`}}),c.jsx("div",{className:"h-3 w-1 rounded-full bg-black dark:bg-white",style:{...l,transform:`translateY(-0.15rem) rotate(${m}) translateZ(0px)`}})]})})})})})}function nR({isCollapsed:e}){var t,a,s;const r=kg(),{setOption:o}=Ev(),{index:i,conversation:l}=bh(),{assistant_id:d=null,endpoint:u}=l??{},m=_h((e=>e.data.map((({id:e,name:t,metadata:n})=>({id:e,name:t,metadata:n}))))),p=n.useMemo((()=>m[u??""]??[]),[u,m]),g=vv(),{onSelect:f}=jh(u);n.useEffect((()=>{var e;if(!d&&p&&p.length&&g){const t=localStorage.getItem(`${uc.ASST_ID_PREFIX}${i}${u}`)??(null==(e=p[0])?void 0:e.id)??"",n=g[u??""][t];if(!n)return;if(!Oo(u))return;o("model")(n.model),o("assistant_id")(t)}}),[i,p,d,g,u,o]);const x=null==(t=null==g?void 0:g[u??""])?void 0:t[d??""],h=n.useMemo((()=>p.map((e=>{var t;return{label:e.name??"",value:e.id,icon:c.jsx(rw,{isCreatedByUser:!1,endpoint:u,assistantName:e.name??"",iconURL:(null==(t=e.metadata)?void 0:t.avatar)??""})}}))),[p,u]);return c.jsx(_w,{selectedValue:(null==x?void 0:x.id)??"",displayValue:(null==(a=p.find((e=>e.id===d)))?void 0:a.name)??r("com_sidepanel_select_assistant"),selectPlaceholder:r("com_sidepanel_select_assistant"),searchPlaceholder:r("com_assistants_search_name"),isCollapsed:e,ariaLabel:"assistant",setValue:f,items:h,iconClassName:"assistant-item",SelectIcon:c.jsx(rw,{isCreatedByUser:!1,endpoint:u,assistantName:(null==x?void 0:x.name)??"",iconURL:(null==(s=null==x?void 0:x.metadata)?void 0:s.avatar)??""})})}function aR({isCollapsed:e}){var t,a;const s=kg(),{setOption:r}=Ev(),{index:o,conversation:i}=bh(),{agent_id:l=null,endpoint:d}=i??{},u=Nh(),m=n.useMemo((()=>u??{}),[u]),{onSelect:p}=Ch(),g=n.useMemo((()=>Object.values(m)),[m]);n.useEffect((()=>{if(null==l&&g.length>0){let e=localStorage.getItem(`${uc.AGENT_ID_PREFIX}${o}`);null==e&&(e=g[0].id);void 0!==m[e]&&!0===Do(d)&&(r("model")(""),r("agent_id")(e))}}),[o,g,l,m,d,r]);const f=m[l??""],x=n.useMemo((()=>g.map((e=>{var t;return{label:e.name??"",value:e.id,icon:c.jsx(rw,{isCreatedByUser:!1,endpoint:Ro.agents,agentName:e.name??"",iconURL:null==(t=e.avatar)?void 0:t.filepath})}}))),[g]);return c.jsx(_w,{selectedValue:(null==f?void 0:f.id)??"",displayValue:(null==(t=g.find((e=>e.id===l)))?void 0:t.name)??s("com_sidepanel_select_agent"),selectPlaceholder:s("com_sidepanel_select_agent"),searchPlaceholder:s("com_agents_search_name"),isCollapsed:e,ariaLabel:"agent",setValue:p,items:x,iconClassName:"assistant-item",SelectIcon:c.jsx(rw,{isCreatedByUser:!1,endpoint:d,agentName:(null==f?void 0:f.name)??"",iconURL:(null==(a=null==f?void 0:f.avatar)?void 0:a.filepath)??""})})}function sR({isCollapsed:e}){const t=kg(),a=mh(),{conversation:s}=bh(),{setOption:r}=Ev(),o=n.useRef(),{endpoint:i,model:l=null}=s??{},d=n.useMemo((()=>{var e;return((null==(e=a.data)?void 0:e[i??""])??[]).map((e=>({label:e,value:e})))}),[a,i]),u=n.useCallback((e=>{r("model")(e),clearTimeout(o.current),o.current=setTimeout((()=>{const e=document.getElementById(Vr);e&&e.focus()}),150)}),[r]);return c.jsx(_w,{displayValue:l??"",selectPlaceholder:t("com_ui_select_model"),searchPlaceholder:t("com_ui_select_search_model"),isCollapsed:e,ariaLabel:"model",selectedValue:l??"",setValue:u,items:d,SelectIcon:c.jsx(ow,{isCreatedByUser:!1,endpoint:i})})}function rR(e){return Oo(e.endpoint)&&e.endpointKeyProvided?c.jsx(nR,{...e}):Do(e.endpoint)&&e.endpointKeyProvided?c.jsx(aR,{...e}):Oo(e.endpoint)?null:c.jsx(sR,{...e})}const oR=qs,iR=n.forwardRef((({className:e="",...t},n)=>c.jsx(Gs,{ref:n,className:rm("border-b",e),...t})));iR.displayName="AccordionItem";n.forwardRef((({className:e="",children:t,...n},a)=>c.jsx(Ks,{className:"flex",children:c.jsxs(Ws,{ref:a,className:rm("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,c.jsx(Ns,{className:"text-muted-foreground h-4 w-4 shrink-0 transition-transform duration-200"})]})}))).displayName=Ws.displayName;const lR=n.forwardRef((({className:e="",children:t,...n},a)=>c.jsx(Qs,{ref:a,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:c.jsx("div",{className:rm("pb-4 pt-0",e),children:t})})));function cR({links:e,isCollapsed:t,resize:a,defaultActive:s}){const r=kg(),[o,i]=n.useState(s),l=e=>{localStorage.setItem("side:active-panel",e+""),i(e)};return c.jsx("div",{"data-collapsed":t,className:"bg-token-sidebar-surface-primary hide-scrollbar group flex-shrink-0 overflow-x-hidden",children:c.jsx("div",{className:"h-full",children:c.jsx("div",{className:"flex h-full min-h-0 flex-col",children:c.jsx("div",{className:"flex h-full min-h-0 flex-col opacity-100 transition-opacity",children:c.jsx("div",{className:"scrollbar-trigger relative h-full w-full flex-1 items-start border-white/20",children:c.jsx("div",{className:"flex h-full w-full flex-col gap-1 px-3 pb-3.5 group-[[data-collapsed=true]]:items-center group-[[data-collapsed=true]]:justify-center group-[[data-collapsed=true]]:px-2",children:e.map(((e,n)=>{const s=(e=>e.id===o?"default":"ghost")(e);return t?c.jsx(z_,{description:r(e.title),side:"left",render:c.jsxs(By,{variant:"ghost",size:"icon",onClick:t=>{if(e.onClick)return e.onClick(t),void l("");l(e.id),a&&a(25)},children:[c.jsx(e.icon,{className:"h-4 w-4 text-text-secondary"}),c.jsx("span",{className:"sr-only",children:r(e.title)})]})},`nav-link-${n}`):c.jsx(oR,{type:"single",value:o,onValueChange:l,collapsible:!0,children:c.jsxs(iR,{value:e.id,className:"w-full border-none",children:[c.jsx(Ks,{asChild:!0,children:c.jsx(Ws,{asChild:!0,children:c.jsxs(By,{variant:"outline",size:"sm",className:"w-full justify-start bg-transparent text-text-secondary data-[state=open]:bg-surface-secondary data-[state=open]:text-text-primary",onClick:t=>{e.onClick&&(e.onClick(t),l(""))},children:[c.jsx(e.icon,{className:"mr-2 h-4 w-4"}),r(e.title),null!=e.label&&e.label&&c.jsx("span",{className:rm("ml-auto opacity-100 transition-all duration-300 ease-in-out","default"===s?"text-text-primary":""),children:e.label})]})})}),c.jsx(lR,{className:"w-full text-text-primary",children:e.Component&&c.jsx(e.Component,{})})]})},n)}))})})})})})})}lR.displayName=Qs.displayName;const dR=n.memo((({defaultSize:e,panelRef:t,navCollapsedSize:a=3,hasArtifacts:s,minSize:r,setMinSize:o,collapsedSize:i,setCollapsedSize:l,isCollapsed:d,setIsCollapsed:u,fullCollapse:m,setFullCollapse:p,interfaceConfig:g})=>{var f;const x=kg(),[h,v]=n.useState(!1),[b,y]=Eb("newUser",!0),{data:_={}}=Mp(),j=Ib("(max-width: 767px)"),{conversation:w}=bh(),{endpoint:N}=w??{},{data:C={expiresAt:void 0}}=gh(N??""),k=n.useMemo((()=>{const e=localStorage.getItem("side:active-panel");return"string"==typeof e?e:void 0}),[]),S=n.useMemo((()=>Hu(_,N,"type")),[N,_]),T=n.useMemo((()=>null==_?void 0:_[N??""]),[N,_]),R=n.useMemo((()=>null==_?void 0:_[N??""]),[N,_]),I=n.useMemo((()=>{var e;return!!(null==(e=null==_?void 0:_[N??""])?void 0:e.userProvide)}),[_,N]),E=n.useMemo((()=>!I||!!C.expiresAt),[C.expiresAt,I]),P=n.useCallback((()=>{var e;u(!0),l(0),o(20),p(!0),localStorage.setItem("fullPanelCollapse","true"),null==(e=t.current)||e.collapse()}),[]),L=function({hidePanel:e,assistants:t,agents:a,keyProvided:s,endpoint:r,endpointType:o,interfaceConfig:i}){const l=Jv({permissionType:Zc.PROMPTS,permission:Yc.USE}),c=Jv({permissionType:Zc.BOOKMARKS,permission:Yc.USE}),d=Jv({permissionType:Zc.AGENTS,permission:Yc.USE}),u=Jv({permissionType:Zc.AGENTS,permission:Yc.CREATE});return n.useMemo((()=>{const n=[];return Oo(r)&&t&&!0!==t.disableBuilder&&s&&n.push({title:"com_sidepanel_assistant_builder",label:"",icon:zb,id:"assistants",Component:KT}),d&&u&&Do(r)&&a&&!0!==a.disableBuilder&&n.push({title:"com_sidepanel_agent_builder",label:"",icon:zb,id:"agents",Component:cT}),l&&n.push({title:"com_ui_prompts",label:"",icon:pt,id:"prompts",Component:qT}),!0===i.parameters&&!0===Fo(r??"",o??"")&&!Do(r)&&s&&n.push({title:"com_sidepanel_parameters",label:"",icon:An,id:"parameters",Component:ZT}),n.push({title:"com_sidepanel_attach_files",label:"",icon:Zb,id:"files",Component:eR}),c&&n.push({title:"com_sidepanel_conversation_tags",label:"",icon:On,id:"bookmarks",Component:vT}),n.push({title:"com_sidepanel_hide_panel",label:"",icon:Dn,onClick:e,id:"hide-panel"}),n}),[i.parameters,s,t,o,r,a,d,l,c,u,e])}({agents:R,endpoint:N,hidePanel:P,assistants:T,keyProvided:E,endpointType:S,interfaceConfig:g}),M=n.useCallback((()=>{var e,n;b&&y(!1),u((e=>(e&&(o(20),l(a),p(!1),localStorage.setItem("fullPanelCollapse","false")),!e))),d?null==(n=t.current)||n.expand():null==(e=t.current)||e.collapse()}),[d,b,y,a]);return c.jsxs(c.Fragment,{children:[c.jsx("div",{onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),className:"relative flex w-px items-center justify-center",children:c.jsx(tR,{navVisible:!d,isHovering:h,onToggle:M,setIsHovering:v,className:rm("fixed top-1/2",d&&(0===r||0===i)||m?"mr-9":"mr-16"),translateX:!1,side:"right"})}),(!d||r>0)&&!j&&!m&&c.jsx(yS,{withHandle:!0,className:"bg-transparent text-text-primary"}),c.jsxs(bS,{tagName:"nav",id:"controls-nav",order:null!=s?3:2,"aria-label":x("com_ui_controls"),role:"navigation",collapsedSize:i,defaultSize:e,collapsible:!0,minSize:r,maxSize:40,ref:t,style:{overflowY:"auto",transition:"width 0.2s ease, visibility 0s linear 0.2s"},onExpand:()=>{u(!1),localStorage.setItem("react-resizable-panels:collapsed","false")},onCollapse:()=>{u(!0),localStorage.setItem("react-resizable-panels:collapsed","true")},className:rm("sidenav hide-scrollbar border-l border-border-light bg-background transition-opacity",d?"min-w-[50px]":"min-w-[340px] sm:min-w-[352px]",j&&d&&(0===r||0===i)||m?"hidden min-w-0":"opacity-100"),children:[!0===g.modelSelect&&c.jsx("div",{className:rm("sticky left-0 right-0 top-0 z-[100] flex h-[52px] flex-wrap items-center justify-center bg-background",d?"h-[52px]":"px-2"),children:c.jsx(rR,{isCollapsed:d,endpointKeyProvided:E,endpoint:N})}),c.jsx(cR,{resize:null==(f=t.current)?void 0:f.resize,isCollapsed:d,defaultActive:k,links:L})]})]})})),uR=Gl().interface,mR=n.memo((({defaultLayout:e=[97,3],defaultCollapsed:t=!1,fullPanelCollapse:a=!1,navCollapsedSize:s=3,artifacts:r,children:o})=>{const{data:i}=Ap(),l=n.useMemo((()=>(null==i?void 0:i.interface)??uR),[i]),d=n.useRef(null),[u,m]=n.useState(20),[p,g]=n.useState(t),[f,x]=n.useState(a),[h,v]=n.useState(s),b=Ib("(max-width: 767px)"),y=I(_p.hideSidePanel),_=n.useCallback((()=>{if(null==r){const t=2===e.length?e[1]:e[2];return[100-t,t]}{const e=0,t=100-e,n=Math.floor(t/2);return[n,t-n,e]}}),[r,e]),j=n.useMemo((()=>bm(_())),[_]),w=n.useCallback(K((e=>{const t=bm(e);localStorage.setItem("react-resizable-panels:layout",JSON.stringify(t))}),350),[]);n.useEffect((()=>{var e;if(b)return g(!0),v(0),m(20),x(!0),localStorage.setItem("fullPanelCollapse","true"),void(null==(e=d.current)||e.collapse());g(t),v(s),m(20)}),[b,t,s,a]);const N=n.useMemo((()=>null!=r?15:30),[r]);return c.jsxs(c.Fragment,{children:[c.jsxs(vS,{direction:"horizontal",onLayout:e=>w(e),className:"transition-width relative h-full w-full flex-1 overflow-auto bg-presentation",children:[c.jsx(bS,{defaultSize:j[0],minSize:N,order:1,id:"messages-view",children:o}),null!=r&&c.jsxs(c.Fragment,{children:[c.jsx(yS,{withHandle:!0,className:"ml-3 bg-border-medium text-text-primary"}),c.jsx(bS,{defaultSize:j[1],minSize:N,order:2,id:"artifacts-panel",children:r})]}),!y&&!0===l.sidePanel&&c.jsx(dR,{panelRef:d,minSize:u,setMinSize:m,isCollapsed:p,setIsCollapsed:g,collapsedSize:h,setCollapsedSize:v,fullCollapse:f,setFullCollapse:x,defaultSize:j[j.length-1],hasArtifacts:null!=r,interfaceConfig:l})]}),c.jsx("button",{"aria-label":"Close right side panel",className:"nav-mask "+(p?"":"active"),onClick:()=>{var e;g((()=>(localStorage.setItem("fullPanelCollapse","true"),x(!0),v(0),m(0),!1))),null==(e=d.current)||e.collapse()}})]})}));function pR({children:e}){const t=I(_p.artifactsState),a=I(_p.artifactsVisible),s=kh(),{mutateAsync:r}=Fp({onSuccess:()=>{console.log("Temporary Files deleted"),s({})},onError:e=>{console.log("Error deleting temporary files:",e)}});n.useEffect((()=>{const e=localStorage.getItem(uc.FILES_TO_DELETE),t=JSON.parse(e??"{}"),n=Object.values(t).filter((e=>null!=e.filepath&&e.source&&!e.embedded&&e.temp_file_id)).map((e=>({file_id:e.file_id,filepath:e.filepath,source:e.source,embedded:!!e.embedded})));0!==n.length&&r({files:n})}),[r]);const o=n.useMemo((()=>{const e=localStorage.getItem("react-resizable-panels:layout");return"string"==typeof e?JSON.parse(e):void 0}),[]),i=n.useMemo((()=>{const e=localStorage.getItem("react-resizable-panels:collapsed");return"string"!=typeof e||JSON.parse(e)}),[]),l=n.useMemo((()=>"true"===localStorage.getItem("fullPanelCollapse")),[]);return c.jsx(sS,{className:"relative flex w-full grow overflow-hidden bg-presentation",children:c.jsx(mR,{defaultLayout:o,fullPanelCollapse:l,defaultCollapsed:i,artifacts:!0===a&&Object.keys(t??{}).length>0?c.jsx(iv,{children:c.jsx(hS,{})}):null,children:c.jsx("main",{className:"flex h-full flex-col overflow-y-auto",role:"main",children:e})})})}const gR=_.memo((({isRTL:e,disabled:t,handleFileChange:a})=>{const s=kg(),r=t??!1,o=n.useRef(null),[i,l]=n.useState(!1),[d,u]=n.useState(),{data:m}=Mp(),p=n.useMemo((()=>{var e;return(null==(e=null==m?void 0:m[Ro.agents])?void 0:e.capabilities)??[]}),[m]),g=e=>{o.current&&(o.current.value="",o.current.accept=!0===e?"image/*":"",o.current.click(),o.current.accept="")},f=n.useMemo((()=>{const e=[{label:s("com_ui_upload_image_input"),onClick:()=>{u(void 0),g(!0)},icon:c.jsx(mn,{className:"icon-md"})}];return p.includes(ro.file_search)&&e.push({label:s("com_ui_upload_file_search"),onClick:()=>{u(ro.file_search),g()},icon:c.jsx(pn,{className:"icon-md"})}),p.includes(ro.execute_code)&&e.push({label:s("com_ui_upload_code_files"),onClick:()=>{u(ro.execute_code),g()},icon:c.jsx(re,{className:"icon-md"})}),e}),[p,s,u]),x=c.jsx(z_,{render:c.jsx(dt,{disabled:r,id:"attach-file-menu-button","aria-label":"Attach File Options",className:rm("absolute flex size-[35px] items-center justify-center rounded-full p-1 transition-colors hover:bg-surface-hover focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",e?"bottom-2 right-2":"bottom-2 left-1 md:left-2"),children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:c.jsx(Zb,{})})}),id:"attach-file-menu-button",description:s("com_sidepanel_attach_files"),disabled:r});return c.jsx(Z_,{ref:o,handleFileChange:e=>{a(e,d)},children:c.jsx("div",{className:"relative select-none",children:c.jsx(Y_,{menuId:"attach-file-menu",isOpen:i,setIsOpen:l,modal:!0,trigger:x,items:f,iconClassName:"mr-0"})})})})),fR=_.memo((({isRTL:e,disabled:t,handleFileChange:a})=>{const s=kg(),r=n.useRef(null),o=t??!1;return c.jsx(Z_,{ref:r,handleFileChange:a,children:c.jsx(z_,{role:"button",id:"attach-file","aria-label":s("com_sidepanel_attach_files"),disabled:o,className:rm("absolute flex size-[35px] items-center justify-center rounded-full p-1 transition-colors hover:bg-surface-hover focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",e?"bottom-2 right-2":"bottom-2 left-2"),description:s("com_sidepanel_attach_files"),onKeyDownCapture:e=>{r.current&&("Enter"!==e.key&&" "!==e.key||(r.current.value="",r.current.click()))},onClick:()=>{r.current&&(r.current.value="",r.current.click())},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:c.jsx(Zb,{})})})})}));const xR=n.memo((function({children:e,disableInputs:t}){const a=I(_p.chatDirection).toLowerCase(),{files:s,setFiles:r,conversation:o,setFilesLoading:i}=bh(),{endpoint:l,endpointType:d}=o??{endpoint:null},u=n.useMemo((()=>Do(l)),[l]),{handleFileChange:m,abortUpload:p}=Gv(),{data:g=Gi}=Dp({select:e=>Zi(e)}),f="rtl"===a,x=g.endpoints[l??""],h=Mi[d??l??""]??!1,v=(t||(null==x?void 0:x.disabled))??!1;return c.jsxs(c.Fragment,{children:[c.jsx(GS,{files:s,setFiles:r,abortUpload:p,setFilesLoading:i,isRTL:f,Wrapper:({children:e})=>c.jsx("div",{className:"mx-2 mt-2 flex flex-wrap gap-2",children:e})}),e,u?c.jsx(gR,{isRTL:f,disabled:t,handleFileChange:m}):h&&!v?c.jsx(fR,{isRTL:f,disabled:t,handleFileChange:m}):null]})})),hR=({isTemporaryChat:e,setIsTemporaryChat:t})=>{const n=kg();return e?c.jsx("div",{className:"divide-token-border-light m-1.5 flex flex-col divide-y overflow-hidden rounded-b-lg rounded-t-2xl bg-surface-secondary-alt",children:c.jsxs("div",{className:"flex items-start gap-4 py-2.5 pl-3 pr-1.5 text-sm",children:[c.jsx("span",{className:"mt-0 flex h-6 w-6 flex-shrink-0 items-center justify-center",children:c.jsx("div",{className:"icon-md",children:c.jsx(Fn,{className:"icon-md","aria-hidden":"true"})})}),c.jsx("span",{className:"text-token-text-secondary line-clamp-3 flex-1 py-0.5 font-semibold",children:n("com_ui_temporary_chat")}),c.jsx("button",{className:"text-token-text-secondary flex-shrink-0",type:"button","aria-label":"Close temporary chat",onClick:()=>t(!1),children:c.jsx(ve,{className:"pr-1"})})]})}):null};function vR({addedConvo:e,setAddedConvo:t}){const a=Sh(),{data:s}=Mp(),r=n.useMemo((()=>`+ ${a(e)}: ${Su(e)}`),[e,a]);return e?c.jsxs("div",{className:"flex items-start gap-4 py-2.5 pl-3 pr-1.5 text-sm",children:[c.jsx("span",{className:"mt-0 flex h-6 w-6 flex-shrink-0 items-center justify-center",children:c.jsx("div",{className:"icon-md",children:c.jsx(fw,{conversation:e,endpointsConfig:s,containerClassName:"shadow-stroke overflow-hidden rounded-full",context:"menu-item",size:20})})}),c.jsx("span",{className:"text-token-text-secondary line-clamp-3 flex-1 py-0.5 font-semibold",children:r}),c.jsx("button",{className:"text-token-text-secondary flex-shrink-0",type:"button","aria-label":"Close added conversation",onClick:()=>t(null),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",className:"icon-lg","aria-hidden":"true",children:c.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.293 7.293a1 1 0 0 1 1.414 0L12 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414L13.414 12l3.293 3.293a1 1 0 0 1-1.414 1.414L12 13.414l-3.293 3.293a1 1 0 0 1-1.414-1.414L10.586 12 7.293 8.707a1 1 0 0 1 0-1.414",clipRule:"evenodd"})})})]}):null}function bR({addedConvo:e,setAddedConvo:t}){return e?c.jsx("div",{className:"divide-token-border-light m-1.5 flex flex-col divide-y overflow-hidden rounded-b-lg rounded-t-2xl bg-surface-secondary-alt",children:c.jsx(vR,{addedConvo:e,setAddedConvo:t})}):null}function yR({name:e,onClick:t,index:n,icon:a,isActive:s,description:r,style:o,type:i="mention"}){return c.jsx("button",{tabIndex:n,onClick:t,id:`${i}-item-${n}`,className:"w-full",style:o,children:c.jsxs("div",{className:rm("text-token-text-primary bg-token-main-surface-secondary group flex h-10 items-center gap-2 rounded-lg px-2 text-sm font-medium hover:bg-surface-secondary",!0===s?"bg-surface-active":"bg-transparent"),children:[c.jsx("div",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center",children:a}),c.jsxs("div",{className:"flex min-w-0 flex-grow items-center justify-between",children:[c.jsxs("div",{className:"truncate",children:[c.jsx("span",{className:"font-medium",children:e}),null!=r&&r?c.jsx("span",{className:"text-token-text-tertiary ml-2 text-sm font-light",children:r}):null]}),c.jsx(zn,{size:16,className:"ml-2 flex-shrink-0"})]})]})})}const _R=n.memo((({index:e,children:t,isVariableDialogOpen:n,variableGroup:a,setVariableDialogOpen:s})=>{const r=I(_p.showPromptsPopoverFamily(e));return c.jsxs(c.Fragment,{children:[r?t:null,c.jsx(VN,{open:n,onClose:()=>s(!1),group:a})]})}));const jR=n.memo((function({index:e,textAreaRef:t,submitPrompt:a}){const s=kg(),r=Jv({permissionType:Zc.PROMPTS,permission:Yc.USE}),{data:o,isLoading:i}=(l={enabled:r,select:e=>{const t=e.map((e=>{var t,n;return{id:e._id,value:e.command??e.name,label:`${null!=e.command&&e.command?`/${e.command} - `:""}${e.name}: ${((null==(t=e.oneliner)?void 0:t.length)??0)>0?e.oneliner:(null==(n=e.productionPrompt)?void 0:n.prompt)??""}`,icon:c.jsx(yb,{category:e.category??"",className:"h-5 w-5"})}}));return{promptsMap:e.reduce(((e,t)=>t._id?(e[t._id]=t,e):e),{}),promptGroups:t}}},nr([Xc.allPromptGroups],(()=>zd.getAllPromptGroups()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,...l}));var l;const[d,u]=n.useState(0),m=n.useRef(null),p=n.useRef(null),[g,f]=n.useState(!1),[x,h]=n.useState(null),v=R(_p.showPromptsPopoverFamily(e)),b=n.useMemo((()=>null==o?void 0:o.promptGroups),[o]),y=n.useMemo((()=>null==o?void 0:o.promptsMap),[o]),{open:_,setOpen:j,searchValue:w,setSearchValue:N,matches:C}=qv({value:"",options:b??[]}),k=n.useCallback(((e,n)=>{var s,r;if(!e)return;N(""),j(!1),v(!1),t.current&&Mu(t.current,"/");const o=null==y?void 0:y[e.id];if(!o)return;if(Iu((null==(s=o.productionPrompt)?void 0:s.prompt)??""))return n&&"Tab"===n.key&&n.preventDefault(),h(o),void f(!0);a((null==(r=o.productionPrompt)?void 0:r.prompt)??"")}),[N,j,v,t,y,a]);if(n.useEffect((()=>{_?h(null):u(0)}),[_]),n.useEffect((()=>()=>{m.current&&clearTimeout(m.current)}),[]),n.useEffect((()=>{const e=document.getElementById(`prompt-item-${d}`);null==e||e.scrollIntoView({behavior:"instant",block:"nearest"})}),[d]),!r)return null;const S=({index:e,key:t,style:n})=>{const a=C[e];return c.jsx(yR,{index:e,type:"prompt",style:n,onClick:()=>{m.current&&clearTimeout(m.current),m.current=null,k(a)},name:a.label??"",icon:a.icon,description:a.description,isActive:e===d},t)};return c.jsx(_R,{index:e,isVariableDialogOpen:g,variableGroup:x,setVariableDialogOpen:f,children:c.jsx("div",{className:"absolute bottom-14 z-10 w-full space-y-2",children:c.jsxs("div",{className:"popover border-token-border-light rounded-2xl border bg-surface-tertiary-alt p-2 shadow-lg",children:[c.jsx("input",{autoFocus:!0,ref:p,placeholder:s("com_ui_command_usage_placeholder"),className:"mb-1 w-full border-0 bg-surface-tertiary-alt p-2 text-sm focus:outline-none dark:text-gray-200",autoComplete:"off",value:w,onKeyDown:e=>{var n,a;"Escape"===e.key&&(j(!1),v(!1),null==(n=t.current)||n.focus()),"ArrowDown"===e.key?u((e=>(e+1)%C.length)):"ArrowUp"===e.key?u((e=>(e-1+C.length)%C.length)):"Enter"===e.key||"Tab"===e.key?("Enter"===e.key&&e.preventDefault(),k(C[d],e)):"Backspace"===e.key&&""===w&&(j(!1),v(!1),null==(a=t.current)||a.focus())},onChange:e=>N(e.target.value),onFocus:()=>j(!0),onBlur:()=>{m.current=setTimeout((()=>{j(!1),v(!1)}),150)}}),c.jsx("div",{className:"max-h-40 overflow-y-auto",children:i&&_?c.jsx("div",{className:"flex h-32 items-center justify-center text-text-primary",children:c.jsx(Hb,{})}):!i&&_?c.jsx("div",{className:"max-h-40",children:c.jsx(Un,{disableHeight:!0,children:({width:e})=>c.jsx(Vn,{width:e,overscanRowCount:5,rowHeight:40,rowCount:C.length,rowRenderer:S,scrollToIndex:d,height:Math.min(40*C.length,160)})})}):null})]})})})}));function wR({isRTL:e,disabled:t,ask:a,methods:s,textAreaRef:r,isSubmitting:o}){const{setValue:i,reset:l}=s,d=kg(),{showToast:u}=Ng(),m=n.useCallback((e=>{if(o)u({message:d("com_ui_speech_while_submitting"),status:"error"});else if(e){const t=document.getElementById(Br);t&&(console.log("Unmuting global audio"),t.muted=!1),a({text:e}),l({text:""})}}),[a,l,u,d,o]),p=n.useCallback((e=>{i("text",e,{shouldValidate:!0})}),[i]),{isListening:g,isLoading:f,startRecording:x,stopRecording:h}=ab(p,m);if(!r.current)return null;return c.jsx(z_,{description:d("com_ui_use_micrphone"),render:c.jsx("button",{id:"audio-recorder",type:"button","aria-label":d("com_ui_use_micrphone"),onClick:!0===g?async()=>h():async()=>x(),disabled:t,className:rm("absolute flex size-[35px] items-center justify-center rounded-full p-1 transition-colors hover:bg-surface-hover",e?"bottom-2 left-2":"bottom-2 right-2",t?"cursor-not-allowed opacity-50":"cursor-pointer"),title:d("com_ui_use_micrphone"),"aria-pressed":g,children:!0===g?c.jsx(by,{className:"stroke-red-500"}):!0===f?c.jsx(Hb,{className:"stroke-gray-700 dark:stroke-gray-300"}):c.jsx(by,{className:"stroke-gray-700 dark:stroke-gray-300"})})})}const NR=({isScrollable:e,isCollapsed:t,setIsCollapsed:n})=>{const a=kg();return e?t?null:c.jsx(z_,{role:"button",description:a("com_ui_collapse_chat"),"aria-label":a("com_ui_collapse_chat"),onClick:()=>n(!0),className:rm("absolute right-2 top-2 z-10 size-[35px] rounded-full p-2 transition-colors","hover:bg-surface-hover focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50"),children:c.jsx(Bn,{className:"h-full w-full"})}):null};function CR(e,t){return new Promise(((n,a)=>setTimeout((()=>a(new Error(t))),e)))}const kR="Reader promise timed out";function SR({index:e=0}){const{token:t}=Wh(),a=I(_p.cacheTTS),s=I(_p.playbackRate),r=I(_p.voice),o=I(_p.activeRunFamily(e)),i=I(_p.automaticPlayback),l=I(_p.isSubmittingFamily(e)),d=I(_p.latestMessageFamily(e)),u=R(_p.globalAudioPlayingFamily(e)),[m,p]=T(_p.audioRunFamily(e)),[g,f]=T(_p.globalAudioFetchingFamily(e)),[x,h]=T(_p.globalAudioURLFamily(e)),{audioRef:v}=function({setIsPlaying:e}){const t=n.useRef(null);return n.useEffect((()=>{let n=null,a=0;const s=()=>{e(!1),console.log("global audio ended"),t.current&&(t.current.customEnded=!0,URL.revokeObjectURL(t.current.src))},r=()=>{e(!0),console.log("global audio started"),t.current&&(t.current.customStarted=!0)},o=()=>{console.log("global audio paused"),t.current&&(t.current.customPaused=!0)},i=()=>{if(t.current){const e=t.current.currentTime;e===n?a+=1:a=0,n=e,a>=1&&(console.log("Detected end of audio based on time update"),t.current.pause(),s())}},l=t.current;return t.current&&(t.current.addEventListener("ended",s),t.current.addEventListener("play",r),t.current.addEventListener("pause",o),t.current.addEventListener("timeupdate",i),t.current.customProps={customStarted:!1,customEnded:!1,customPaused:!1}),()=>{l&&(l.removeEventListener("ended",s),l.removeEventListener("play",r),l.removeEventListener("pause",o),l.removeEventListener("timeupdate",i),URL.revokeObjectURL(l.src))}}),[e]),{audioRef:t}}({setIsPlaying:u}),{pauseGlobalAudio:b}=jp(),{conversationId:y}=B(),_="new"===y?y:(null==d?void 0:d.conversationId)??y??"",j=ar(),w=n.useCallback((()=>j.getQueryData([Xc.messages,_])),[_,j]);return n.useEffect((()=>{const e=Ou(d);!(null==t||!i||l||!d||d.isCreatedByUser||!e||!d.messageId||d.messageId.includes("_")||g||null==o||o===m)&&async function(){f(!0);try{v.current&&(v.current.pause(),URL.revokeObjectURL(v.current.src),h(null));let e=(null==d?void 0:d.text)??"";const n=await caches.open("tts-responses"),s=await n.match(e);if(p(o),s){om.log("Audio found in cache");const e=await s.blob(),t=URL.createObjectURL(e);return h(t),void f(!1)}om.log("Fetching audio...",navigator.userAgent);const i=await fetch("/api/files/speech/tts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({messageId:null==d?void 0:d.messageId,runId:o,voice:r})});if(!i.ok)throw new Error("Failed to fetch audio");if(!i.body)throw new Error("Null Response body");const l=i.body.getReader(),c="audio/mpeg",u="undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(c);let m;u&&(m=new Dr(c),h(m.mediaSourceUrl));let g=!1;const x=[];for(;!g;){const e=l.read(),{value:t,done:n}=await Promise.race([e,CR(15e3,kR)]);a&&t&&x.push(t),t&&m&&m.addData(t),g=n}if(x.length){om.log("Adding audio to cache");const t=(w()??[]).find((e=>e.messageId===(null==d?void 0:d.messageId)));if(e=(null==t?void 0:t.text)??"",!e)throw new Error("Cache key not found");const a=new Blob(x,{type:c}),s=new Response(a);if(await n.put(e,s),!u){const t=await n.match(e);if(!t)throw new Error("Failed to fetch audio from cache");const a=await t.blob(),s=URL.createObjectURL(a);h(s)}f(!1)}om.log("Audio stream reading ended")}catch(e){if((null==e?void 0:e.message)!==kR)return void om.log(kR);om.error("Error fetching audio:",e),f(!1),h(null)}finally{f(!1)}}()}),[i,h,p,f,d,l,o,w,g,m,a,v,r,t]),n.useEffect((()=>{null!=s&&null!=x&&s>0&&v.current&&v.current.playbackRate!==s&&(v.current.playbackRate=s)}),[v,x,s]),n.useEffect((()=>{b()}),[y]),om.log("StreamAudio.tsx - globalAudioURL:",x),c.jsx("audio",{ref:v,controls:!0,controlsList:"nodownload nofullscreen noremoteplayback",style:{position:"absolute",overflow:"hidden",display:"none",height:"0px",width:"0px"},src:x??void 0,id:Br,autoPlay:!0})}function TR({stop:e,setShowStopButton:t}){const n=kg();return c.jsx(z_,{description:n("com_nav_stop_generating"),render:c.jsx("button",{type:"button",className:rm("rounded-full bg-text-primary p-2 text-text-primary outline-offset-4 transition-all duration-200 disabled:cursor-not-allowed disabled:text-text-secondary disabled:opacity-10"),"aria-label":n("com_nav_stop_generating"),onClick:n=>{t(!1),e(n)},children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-lg text-surface-primary",children:c.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"1.25",fill:"currentColor"})})})})}const RR=_.memo(n.forwardRef(((e,t)=>{const n=kg();return c.jsx(z_,{description:n("com_nav_send_message"),render:c.jsx("button",{ref:t,"aria-label":n("com_nav_send_message"),id:"send-button",disabled:e.disabled,className:rm("rounded-full bg-text-primary p-2 text-text-primary outline-offset-4 transition-all duration-200 disabled:cursor-not-allowed disabled:text-text-secondary disabled:opacity-10"),"data-testid":"send-button",type:"submit",children:c.jsx("span",{className:"","data-state":"closed",children:c.jsx(iy,{size:24})})})})}))),IR=_.memo(n.forwardRef(((e,t)=>{const n=Mt({control:e.control});return c.jsx(RR,{ref:t,disabled:e.disabled||!n.text})})));const ER=Gl().interface,PR=({endpoint:e,assistantMap:t,endpointsConfig:n})=>({id:a,name:s,description:r})=>({type:e,label:s??"",value:a,description:r??"",icon:fw({conversation:{assistant_id:a,endpoint:e},endpointsConfig:n,context:"menu-item",assistantMap:t})});function LR({setShowMentionPopover:e,newConversation:t,textAreaRef:a,commandChar:s="@",placeholder:r="com_ui_mention",includeAssistants:o=!0}){const i=kg(),l=vv(),{options:d,presets:u,modelSpecs:m,agentsList:p,modelsConfig:g,endpointsConfig:f,assistantListMap:x}=function({assistantMap:e,includeAssistants:t}){const{data:a}=$p(),{data:s}=mh(),{data:r}=Ap(),{data:o}=Mp(),{data:i=[]}=Mp({select:Gu}),l=_h((e=>e.data.map((({id:e,name:t,description:n})=>({id:e,name:t,description:n}))))),{data:c=null}=Cp(void 0,{select:e=>{const{data:t}=e;return t.map((({id:e,name:t,avatar:n})=>({value:e,label:t??"",type:Ro.agents,icon:fw({conversation:{endpoint:Ro.agents,iconURL:null==n?void 0:n.filepath},endpointsConfig:o,context:"menu-item"})})))}}),d=n.useMemo((()=>{var t,n;return{[Ro.assistants]:null==(t=l[Ro.assistants])?void 0:t.map(PR({endpoint:Ro.assistants,assistantMap:e,endpointsConfig:o})).filter(Boolean),[Ro.azureAssistants]:null==(n=l[Ro.azureAssistants])?void 0:n.map(PR({endpoint:Ro.azureAssistants,assistantMap:e,endpointsConfig:o})).filter(Boolean)}}),[l,e,o]),u=n.useMemo((()=>{var e;return(null==(e=null==r?void 0:r.modelSpecs)?void 0:e.list)??[]}),[r]),m=n.useMemo((()=>(null==r?void 0:r.interface)??ER),[r]);return{options:n.useMemo((()=>{var n;let r=i;t||(r=i.filter((e=>!Oo(e))));const l=r.flatMap((e=>Oo(e)||Do(e)?[]:((null==s?void 0:s[e])??[]).map((t=>({value:e,label:t,type:"model",icon:fw({conversation:{endpoint:e,model:t},endpointsConfig:o,context:"menu-item"})})))));return[...(u.length>0?u:[]).map((e=>({value:e.name,label:e.label,description:e.description,icon:fw({conversation:{...e.preset,iconURL:e.iconURL},endpointsConfig:o,context:"menu-item"}),type:"modelSpec"}))),...(!0===m.endpointsMenu?r:[]).map((e=>({value:e,label:Ql[e]??e??"",type:"endpoint",icon:fw({conversation:{endpoint:e},endpointsConfig:o,context:"menu-item"})}))),...c??[],...(null==o?void 0:o[Ro.assistants])&&t&&d[Ro.assistants]||[],...(null==o?void 0:o[Ro.azureAssistants])&&t&&d[Ro.azureAssistants]||[],...(null==(n=!0===m.presets?a:[])?void 0:n.map(((t,n)=>({value:t.presetId??`preset-${n}`,label:t.title??t.modelLabel??t.chatGptLabel??"",description:Su(t,!0),icon:fw({conversation:t,endpointsConfig:o,context:"menu-item",assistantMap:e}),type:"preset"}))))??[],...l]}),[a,i,u,c,e,s,o,d,t,m.presets,m.endpointsMenu]),presets:a,modelSpecs:u,agentsList:c,modelsConfig:s,endpointsConfig:o,assistantListMap:d}}({assistantMap:l||{},includeAssistants:o}),{onSelectMention:h}=function({presets:e,modelSpecs:t,assistantMap:a,endpointsConfig:s,newConversation:r}){const{conversation:o}=bh(),i=hh(),l=I(_p.modularChat),c=I(_p.availableTools),d=n.useCallback((e=>{var t,n;if(!e)return;const{preset:c}=e;c.iconURL=qu(e),c.spec=e.name;const{endpoint:d}=c,u=d??"";if(!u)return;const{template:m,shouldSwitch:p,isNewModular:g,newEndpointType:f,isCurrentModular:x,isExistingConversation:h}=Wu({newEndpoint:u,modularChat:l,conversation:o,endpointsConfig:s});f&&(c.endpointType=f),Oo(u)&&null!=c.assistant_id&&!c.model&&(c.model=null==(n=null==(t=null==a?void 0:a[u])?void 0:t[c.assistant_id])?void 0:n.model);const v=x&&g&&p;if(h&&v){m.endpointType=f;const e=i({conversation:{...o??{},endpointType:m.endpointType},preset:m});r({template:e,preset:c,keepLatestMessage:!0,keepAddedConvos:!0})}else r({template:{...m},preset:c,keepAddedConvos:v})}),[o,i,l,r,s,a]),u=n.useCallback(((e,t={})=>{const n=e??"";if(!n)return;const{shouldSwitch:a,isNewModular:c,isCurrentModular:d,isExistingConversation:u,newEndpointType:m,template:p}=Wu({newEndpoint:n,modularChat:l,conversation:o,endpointsConfig:s}),g=t.model??"";g&&(p.model=g);const f=t.assistant_id??"";f&&(p.assistant_id=f);const x=t.agent_id??"";if(x&&(p.agent_id=x),u&&d&&c&&a){p.endpointType=m;const e=i({conversation:{...o??{},endpointType:p.endpointType},preset:p});r({template:e,preset:e,keepLatestMessage:!0})}else r({template:{...p},preset:{...t,endpoint:n}})}),[o,i,l,r,s]),m=n.useCallback((e=>{if(!e)return;const t=Tu(e,c),n=t.endpoint??"",{template:a,shouldSwitch:d,isNewModular:u,newEndpointType:m,isCurrentModular:p,isExistingConversation:g}=Wu({newEndpoint:n,modularChat:l,conversation:o,endpointsConfig:s});if(g&&p&&u&&d){a.endpointType=m;const e=i({conversation:{...o??{},endpointType:a.endpointType},preset:a});r({template:e,preset:t,keepLatestMessage:!0,keepAddedConvos:!0})}else r({preset:t,keepAddedConvos:!0})}),[l,o,c,r,s,i]);return{onSelectMention:n.useCallback((n=>{var s,r;const o=n.value;if("preset"===n.type){const t=null==e?void 0:e.find((e=>e.presetId===o));m(t)}else if("modelSpec"===n.type){const e=t.find((e=>e.name===o));d(e)}else"model"===n.type?u(o,{model:n.label}):"endpoint"===n.type?u(o):Oo(n.type)?u(n.type,{assistant_id:o,model:(null==(r=null==(s=null==a?void 0:a[n.type])?void 0:s[o])?void 0:r.model)??""}):Do(n.type)&&u(n.type,{agent_id:o})}),[t,u,m,d,e,a])}}({presets:u,modelSpecs:m,assistantMap:l,endpointsConfig:f,newConversation:t}),[v,b]=n.useState(0),y=n.useRef(null),_=n.useRef(null),[j,w]=n.useState(d),{open:N,setOpen:C,searchValue:k,setSearchValue:S,matches:T}=qv({value:"",options:j}),R=t=>{var n,r,o,i;if(!t)return;if("endpoint"===t.type&&t.value===Ro.agents)S(""),w(p??[]),b(0),null==(n=_.current)||n.focus();else if("endpoint"===t.type&&t.value===Ro.assistants)S(""),w(x[Ro.assistants]??[]),b(0),null==(r=_.current)||r.focus();else if("endpoint"===t.type&&t.value===Ro.azureAssistants)S(""),w(x[Ro.azureAssistants]??[]),b(0),null==(o=_.current)||o.focus();else if("endpoint"===t.type){const e=((null==g?void 0:g[t.value||""])??[]).map((e=>({value:t.value,label:e,type:"model"})));b(0),S(""),w(e),null==(i=_.current)||i.focus()}else S(""),C(!1),e(!1),h(t),a.current&&Mu(a.current,s)};n.useEffect((()=>{N||(w(d),b(0))}),[N,d]),n.useEffect((()=>()=>{y.current&&clearTimeout(y.current)}),[]);const E="@"!==s?"add-convo":"mention";n.useEffect((()=>{const e=document.getElementById(`${E}-item-${v}`);null==e||e.scrollIntoView({behavior:"instant",block:"nearest"})}),[E,v]);const P=({index:e,key:t,style:n})=>{const a=T[e];return c.jsx(yR,{type:E,index:e,style:n,onClick:e=>{e.preventDefault(),e.stopPropagation(),y.current&&clearTimeout(y.current),y.current=null,R(a)},name:a.label??"",icon:a.icon,description:a.description,isActive:e===v},t)};return c.jsx("div",{className:"absolute bottom-14 z-10 w-full space-y-2",children:c.jsxs("div",{className:"popover border-token-border-light rounded-2xl border bg-white p-2 shadow-lg dark:bg-gray-700",children:[c.jsx("input",{autoFocus:!0,ref:_,placeholder:i(r),className:"mb-1 w-full border-0 bg-white p-2 text-sm focus:outline-none dark:bg-gray-700 dark:text-gray-200",autoComplete:"off",value:k,onKeyDown:t=>{var n,s;if("Escape"===t.key&&(C(!1),e(!1),null==(n=a.current)||n.focus()),"ArrowDown"===t.key)b((e=>(e+1)%T.length));else if("ArrowUp"===t.key)b((e=>(e-1+T.length)%T.length));else if("Enter"===t.key||"Tab"===t.key){const e=T[v];("endpoint"===(null==e?void 0:e.type)||"Enter"===t.key)&&t.preventDefault(),R(T[v])}else"Backspace"===t.key&&""===k&&(C(!1),e(!1),null==(s=a.current)||s.focus())},onChange:e=>S(e.target.value),onFocus:()=>C(!0),onBlur:()=>{y.current=setTimeout((()=>{C(!1),e(!1)}),150)}}),N&&c.jsx("div",{className:"max-h-40",children:c.jsx(Un,{disableHeight:!0,children:({width:e})=>c.jsx(Vn,{width:e,overscanRowCount:5,rowHeight:40,rowCount:T.length,rowRenderer:P,scrollToIndex:v,height:Math.min(40*T.length,160)})})})]})})}const MR=n.memo((({index:e=0})=>{const t=n.useRef(null),a=n.useRef(null);Yv({textAreaRef:a});const[s,r]=n.useState(!1),[o,i]=n.useState(!1),l=I(_p.speechToText),d=I(_p.textToSpeech),u=I(_p.automaticPlayback),m=I(_p.maximizeChatSpace),[p,g]=T(_p.isTemporary),f=I(_p.isSearching),[x,h]=T(_p.showStopButtonByIndex(e)),[v,b]=T(_p.showPlusPopoverFamily(e)),[y,_]=T(_p.showMentionPopoverFamily(e)),j="rtl"===I(_p.chatDirection).toLowerCase(),{requiresKey:w}=function(){const{conversation:e}=bh(),{data:t}=Mp(),{endpoint:n}=e||{},a=Hu(t,n,"userProvide"),{getExpiry:s}=Vh(n??"");return{requiresKey:!s()&&a}}(),N=(({index:e,textAreaRef:t,setShowPlusPopover:a,setShowMentionPopover:s})=>{const r=Jv({permissionType:Zc.PROMPTS,permission:Yc.USE}),o=Jv({permissionType:Zc.MULTI_CONVO,permission:Yc.USE}),i=I(_p.latestMessageFamily(e)),l=R(_p.showPromptsPopoverFamily(e)),c=I(_p.atCommand),d=I(_p.plusCommand),u=I(_p.slashCommand),m=n.useCallback((()=>{c&&eb(t,"@")&&s(!0)}),[t,s,c]),p=n.useCallback((()=>{o&&d&&eb(t,"+")&&a(!0)}),[t,a,d,o]),g=n.useCallback((()=>{r&&u&&eb(t,"/")&&l(!0)}),[t,r,l,u]),f=n.useMemo((()=>({"@":m,"+":p,"/":g})),[m,p,g]),x=n.useCallback((e=>{if(!i)return;const t=document.getElementById(`edit-${i.parentMessageId}`);t&&(e.preventDefault(),t.click())}),[i]);return n.useCallback((e=>{var n;const a=null==(n=t.current)?void 0:n.value;if("ArrowUp"===e.key&&0===(null==a?void 0:a.length))return void x(e);if("string"!=typeof a||0===a.length)return;if(Xv[e.key])return;const s=a[0],r=f[s];"function"==typeof r&&r()}),[t,f,x])})({index:e,textAreaRef:a,setShowPlusPopover:b,setShowMentionPopover:_}),{handlePaste:C,handleKeyDown:k,handleCompositionStart:S,handleCompositionEnd:E}=Qv({textAreaRef:a,submitButtonRef:t,setIsScrollable:i,disabled:!!w}),{files:P,setFiles:L,conversation:M,isSubmitting:A,filesLoading:O,newConversation:D,handleStopGenerating:F}=bh(),z=dv(),{addedIndex:U,generateConversation:V,conversation:B,setConversation:$,isSubmitting:H}=rv(),G=I(_p.showStopButtonByIndex(U)),{clearDraft:K}=Wv({conversationId:n.useMemo((()=>null==M?void 0:M.conversationId),[M]),textAreaRef:a,files:P,setFiles:L}),W=vv(),{submitMessage:Q,submitPrompt:q}=lb({clearDraft:K}),{endpoint:Z,endpointType:Y}=M??{endpoint:null},J=Y??Z,{data:X=Gi}=Dp({select:e=>Zi(e)}),ee=X.endpoints[J??""],te=n.useMemo((()=>Oo(null==M?void 0:M.endpoint)&&(!(null==M?void 0:M.assistant_id)||!(null==W?void 0:W[(null==M?void 0:M.endpoint)??""][(null==M?void 0:M.assistant_id)??""]))),[null==M?void 0:M.assistant_id,null==M?void 0:M.endpoint,W]),ne=n.useMemo((()=>!(!w&&!te)),[w,te]),{ref:ae,...se}=z.register("text",{required:!0,onChange:e=>{z.setValue("text",e.target.value,{shouldValidate:!0})}});n.useEffect((()=>{f||!a.current||ne||a.current.focus()}),[f,ne]),n.useEffect((()=>{a.current&&Au(a.current)}),[]);const re=Mi[Y??J??""]??!1,oe=(null==ee?void 0:ee.disabled)??!1,ie=rm("md:py-3.5 m-0 w-full resize-none py-[13px] bg-surface-tertiary placeholder-black/50 dark:placeholder-white/50 [&:has(textarea:focus)]:shadow-[0_2px_6px_rgba(0,0,0,.05)]",s?"max-h-[52px]":"max-h-[65vh] md:max-h-[75vh]"),le=re&&!oe,ce=j?`pr-${le?"12":"4"} pl-12`:`pl-${le?"12":"4"} pr-12`;return c.jsx("form",{onSubmit:z.handleSubmit((e=>Q(e))),className:rm("mx-auto flex flex-row gap-3 pl-2 transition-all duration-200 last:mb-2",m?"w-full max-w-full":"md:max-w-2xl xl:max-w-3xl"),children:c.jsx("div",{className:"relative flex h-full flex-1 items-stretch md:flex-col",children:c.jsxs("div",{className:"flex w-full items-center",children:[v&&!Oo(J)&&c.jsx(LR,{setShowMentionPopover:b,newConversation:V,textAreaRef:a,commandChar:"+",placeholder:"com_ui_add_model_preset",includeAssistants:!1}),y&&c.jsx(LR,{setShowMentionPopover:_,newConversation:D,textAreaRef:a}),c.jsx(jR,{index:e,textAreaRef:a,submitPrompt:q}),c.jsxs("div",{className:"transitional-all relative flex w-full flex-grow flex-col overflow-hidden rounded-3xl bg-surface-tertiary text-text-primary duration-200",children:[c.jsx(hR,{isTemporaryChat:p,setIsTemporaryChat:g}),c.jsx(bR,{addedConvo:B,setAddedConvo:$}),c.jsx(xR,{disableInputs:ne,children:J&&c.jsxs(c.Fragment,{children:[c.jsx(NR,{isCollapsed:s,isScrollable:o,setIsCollapsed:r}),c.jsx(F_,{...se,ref:e=>{ae(e),a.current=e},disabled:ne,onPaste:C,onKeyDown:k,onKeyUp:N,onHeightChange:()=>{if(a.current){const e=Au(a.current);i(e)}},onCompositionStart:S,onCompositionEnd:E,id:Vr,tabIndex:0,"data-testid":"text-input",rows:1,onFocus:()=>s&&r(!1),onClick:()=>s&&r(!1),style:{height:44,overflowY:"auto"},className:rm(ie,ce,pm,"transition-[max-height] duration-200")})]})}),l&&c.jsx(wR,{isRTL:j,methods:z,ask:Q,textAreaRef:a,disabled:!!ne,isSubmitting:A}),d&&u&&c.jsx(SR,{index:e})]}),c.jsx("div",{className:rm("mb-[5px] ml-[8px] flex flex-col items-end justify-end",j&&"order-first mr-[8px]"),style:{alignSelf:"flex-end"},children:(A||H)&&(x||G)?c.jsx(TR,{stop:F,setShowStopButton:h}):J&&c.jsx(IR,{ref:t,control:z.control,disabled:!!(O||A||ne)})})]})})})}));function AR({text:e,onClick:t}){return c.jsx("button",{onClick:t,className:"relative flex w-40 cursor-pointer flex-col gap-2 rounded-2xl border border-border-medium px-3 pb-4 pt-3 text-start align-top text-[15px] shadow-[0_0_2px_0_rgba(0,0,0,0.05),0_4px_6px_0_rgba(0,0,0,0.02)] transition-colors duration-300 ease-in-out fade-in hover:bg-surface-tertiary",children:c.jsx("p",{className:"break-word line-clamp-3 overflow-hidden text-balance break-all text-text-secondary",children:e})})}function OR({Header:e}){var t,a,s,r;const{conversation:o}=bh(),i=Nh(),l=vv(),{data:d}=Ap(),{data:u}=Mp(),m=kg();let{endpoint:p=""}=o??{};p!==Ro.chatGPTBrowser&&p!==Ro.azureOpenAI&&p!==Ro.gptPlugins||(p=Ro.openAI);p=Zu({endpointsConfig:u,iconURL:null==o?void 0:o.iconURL,endpoint:p});const{data:g=new Map}=Yp(p,{select:e=>new Map(e.map((e=>[e.assistant_id,e])))}),{entity:f,isAgent:x,isAssistant:h}=Ju({endpoint:p,agentsMap:i,assistantMap:l,agent_id:null==o?void 0:o.agent_id,assistant_id:null==o?void 0:o.assistant_id}),v=(null==f?void 0:f.name)??"",b=(null==f?void 0:f.description)??"",y=x?(null==(t=null==f?void 0:f.avatar)?void 0:t.filepath)??"":(null==(a=null==f?void 0:f.metadata)?void 0:a.avatar)??"",_=n.useMemo((()=>{var e;if(f&&((null==(e=f.conversation_starters)?void 0:e.length)??0)>0)return f.conversation_starters;if(x)return(null==f?void 0:f.conversation_starters)??[];const t=g.get((null==f?void 0:f.id)??"");return(null==t?void 0:t.conversation_starters)??[]}),[g,x,f]),{submitMessage:j}=lb();return c.jsxs("div",{className:"relative h-full",children:[c.jsx("div",{className:"absolute left-0 right-0",children:null!=e?e:null}),c.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[c.jsxs("div",{className:rm("relative h-12 w-12",v&&y?"mb-0":"mb-3"),children:[c.jsx(gw,{agentsMap:i,assistantMap:l,conversation:o,endpointsConfig:u,containerClassName:"shadow-stroke relative flex h-full items-center justify-center rounded-full bg-white text-black",context:"landing",className:"h-2/3 w-2/3",size:41}),!0===(null==d?void 0:d.showBirthdayIcon)?c.jsx(z_,{className:"absolute bottom-8 right-2.5",description:m("com_ui_happy_birthday"),children:c.jsx(Cy,{})}):null]}),v?c.jsxs("div",{className:"flex flex-col items-center gap-0 p-2",children:[c.jsx("div",{className:"text-center text-2xl font-medium dark:text-white",children:v}),c.jsx("div",{className:"max-w-md text-center text-sm font-normal text-text-primary ",children:b||("string"==typeof(null==(s=null==d?void 0:d.interface)?void 0:s.customWelcome)?null==(r=null==d?void 0:d.interface)?void 0:r.customWelcome:m("com_nav_welcome_message"))})]}):c.jsx("h2",{className:"mb-5 max-w-[75vh] px-12 text-center text-lg font-medium dark:text-white md:px-0 md:text-2xl",children:(()=>{var e,t;const n=(null==o?void 0:o.greeting)??"";return n||(h?m("com_nav_welcome_assistant"):x?m("com_nav_welcome_agent"):"string"==typeof(null==(e=null==d?void 0:d.interface)?void 0:e.customWelcome)?null==(t=null==d?void 0:d.interface)?void 0:t.customWelcome:m("com_nav_welcome_message"))})()}),c.jsx("div",{className:"mt-8 flex flex-wrap justify-center gap-3 px-4",children:_.length>0&&_.slice(0,dc.MAX_CONVO_STARTERS).map(((e,t)=>c.jsx(AR,{text:e,onClick:()=>(e=>j({text:e}))(e)},t)))})]})]})}function DR({buttonClass:e,iconClass:t="",endpoint:n,endpointType:a,model:s}){const{conversation:r,optionSettings:o,setOptionSettings:i,showAgentSettings:l,setShowAgentSettings:d}=bh(),u=kg(),[m,p]=T(_p.currentSettingsView),{model:g,endpoint:f,endpointType:x}=r??{},h=a??n??x??f??"",v=s??g,b=(null==v?void 0:v.toLowerCase().includes("gemini"))??!1,y=(!b&&(null==v?void 0:v.toLowerCase().includes("chat")))??!1,_=!b&&!y&&/code|text/.test(v??""),{showExamples:j}=o,w=!b&&!_&&y,N={[Ro.google]:[{label:u(!0===j?"com_hide_examples":"com_show_examples"),buttonClass:!0===b||_?"disabled":"",handler:()=>{p(il.default),i((e=>({...e,showExamples:!e.showExamples})))},icon:c.jsx(Yb,{className:rm("mr-1 w-[14px]",t)})}],[Ro.gptPlugins]:[{label:u(l?"com_show_completion_settings":"com_show_agent_settings"),buttonClass:"",handler:()=>{p(il.default),d((e=>!e))},icon:c.jsx(Vb,{className:rm("mr-1 w-[14px]",t),size:24})}]};if(!h)return null;if(h===Ro.google&&!w)return null;il.default,rm("mr-1 h-6 w-[14px]",t),il.advanced,rm("mr-1 h-6 w-[14px]",t);const C=N[h]??[];return c.jsxs("div",{className:"flex w-full justify-between",children:[c.jsx("div",{className:"flex items-center justify-start",children:C.map(((t,n)=>c.jsxs(By,{type:"button",className:rm(t.buttonClass,"border border-gray-300/50 focus:ring-1 focus:ring-green-500/90 dark:border-gray-500/50 dark:focus:ring-green-500","ml-1 h-full bg-transparent px-2 py-1 text-xs font-normal text-black hover:bg-gray-100 hover:text-black dark:bg-transparent dark:text-white dark:hover:bg-gray-600 dark:hover:text-white",e??""),onClick:t.handler,children:[t.icon,t.label]},`button-${n}`)))}),null]})}const FR=({exportPreset:e,submitPreset:t})=>{const a=kg(),s=ar(),{preset:r,setPreset:o}=bh(),{setOption:i,setOptions:l,setAgentOption:d}=Ev(r),[u,m]=Rv({setOption:i,optionKey:"title",initialValue:null==r?void 0:r.title}),[p,g]=T(_p.presetModalVisible),{data:f=[]}=Mp({select:Gu}),x=n.useMemo((()=>f.filter((e=>!Do(e)))),[f]);n.useEffect((()=>{var e,t;if(!r)return;if(Do(r.endpoint))return;const n=r.endpoint??"";if(!n)return;const a=s.getQueryData([Xc.models]);if(!a)return;const o=a[n];o&&o.length&&r.model!==o[0]&&(o.includes(r.model??"")||(console.log("setting model",o[0]),i("model")(o[0])),(null==(e=r.agentOptions)?void 0:e.model)!==o[0]&&null!=(null==(t=r.agentOptions)?void 0:t.model)&&r.agentOptions.model&&!o.includes(r.agentOptions.model)&&(console.log("setting agent model",o[0]),d("model")(o[0])))}),[r,s,i,d]);const h=n.useCallback((e=>{if(!l)return console.warn("setOptions is not defined");const{newEndpointType:t}=Wu({newEndpoint:e,modularChat:!0,conversation:null,endpointsConfig:s.getQueryData([Xc.endpoints])??{}});l({endpoint:e,endpointType:t})}),[s,l]),{endpoint:v,endpointType:b,model:y}=r||{},_=v??"";return _?Do(_)?null:c.jsx(Yy,{open:p,onOpenChange:e=>{g(e),e||o(null)},children:c.jsx(LT,{title:`${a("com_ui_edit")+" "+a("com_endpoint_preset")} - ${null==r?void 0:r.title}`,className:"h-full max-w-full overflow-y-auto pb-4 sm:w-[680px] sm:pb-0 md:h-[720px] md:w-[750px] md:overflow-y-hidden lg:w-[950px] xl:h-[720px]",main:c.jsxs("div",{className:"flex w-full flex-col items-center gap-2 md:h-[550px] md:overflow-y-auto",children:[c.jsxs("div",{className:"grid w-full",children:[c.jsxs("div",{className:"col-span-4 flex flex-col items-start justify-start gap-6 pb-4 md:flex-row",children:[c.jsxs("div",{className:"flex w-full flex-col",children:[c.jsx(g_,{htmlFor:"preset-name",className:"mb-1 text-left text-sm font-medium",children:a("com_endpoint_preset_name")}),c.jsx(m_,{id:"preset-name",value:m??"",onChange:u,placeholder:a("com_endpoint_set_custom_name"),className:rm(fm,"flex h-10 max-h-10 w-full resize-none px-3 py-2",mm)})]}),c.jsxs("div",{className:"flex w-full flex-col",children:[c.jsx(g_,{htmlFor:"endpoint",className:"mb-1 text-left text-sm font-medium",children:a("com_endpoint")}),c.jsx(sj,{value:_||"",setValue:h,showLabel:!1,emptyTitle:!0,searchPlaceholder:a("com_endpoint_search"),availableValues:x})]})]}),c.jsx("div",{className:"col-span-2 flex items-start justify-between gap-4 sm:col-span-4",children:c.jsxs("div",{className:"flex w-full flex-col",children:[c.jsx(g_,{htmlFor:"endpoint",className:"mb-1 hidden text-left text-sm font-medium sm:block",children:"ㅤ"}),c.jsx(DR,{buttonClass:"ml-0 w-full border border-border-medium p-2 h-[40px] justify-center mt-0",iconClass:"hidden lg:block w-4 ",endpoint:_,endpointType:b,model:y})]})})]}),c.jsx("div",{className:"my-4 w-full border-t border-border-medium"}),c.jsx("div",{className:"w-full p-0",children:c.jsx(fN,{conversation:r,setOption:i,isPreset:!0,className:"h-full text-text-primary md:mb-4 md:h-[440px]"})})]}),buttons:c.jsxs("div",{className:"mb-6 md:mb-2",children:[c.jsx(i_,{onClick:e,className:"border-gray-100 hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-600",children:a("com_endpoint_export")}),c.jsx(o_,{onClick:t,className:"ml-2 bg-green-500 text-white hover:bg-green-600 dark:hover:bg-green-600",children:a("com_ui_save")})]}),footerClassName:"bg-white dark:bg-gray-700"})}):null},zR=({onFileSelected:e,className:t="",containerClassName:a="",successText:s=null,invalidText:r=null,validator:o=null,text:i=null,id:l="1"})=>{const[d,u]=n.useState("text-gray-600"),[m,p]=n.useState(null),g=kg();let f;return f=m?"success"===m?s??g("com_ui_upload_success"):r??g("com_ui_upload_invalid"):i??g("com_ui_import"),c.jsxs("label",{htmlFor:`file-upload-${l}`,className:rm("mr-1 flex h-auto cursor-pointer items-center rounded bg-transparent px-2 py-1 text-xs font-normal transition-colors hover:bg-gray-100 hover:text-green-600 dark:bg-transparent dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-green-500",d,a),children:[c.jsx($n,{className:"mr-1 flex w-[22px] items-center stroke-1"}),c.jsx("span",{className:"flex text-xs",children:f}),c.jsx("input",{id:`file-upload-${l}`,value:"",type:"file",className:rm("hidden",t),accept:".json",onChange:t=>{var n;const a=null==(n=t.target.files)?void 0:n[0];if(!a)return;const s=new FileReader;s.onload=t=>{var n;const a=JSON.parse(null==(n=t.target)?void 0:n.result);if(o&&!o(a))return p("invalid"),void u("text-red-600");o&&(p("success"),u("text-green-500 dark:text-green-500")),e(a)},s.readAsText(a)}})]})},UR=()=>c.jsx("div",{role:"separator","aria-orientation":"horizontal",className:"my-1.5 border-b bg-gray-200 dark:border-gray-700"});function VR({primaryText:e="",secondaryText:t=""}){const a=kg(),[s,r]=n.useState(!1);return c.jsx(As,{asChild:!0,children:c.jsxs("button",{className:"group flex cursor-pointer items-center gap-2 rounded-lg px-3 py-1.5 text-lg font-medium transition-colors duration-200 hover:bg-surface-hover radix-state-open:bg-surface-hover","aria-label":a("com_ui_endpoint_menu"),"aria-expanded":s,role:"combobox","aria-haspopup":"listbox","aria-controls":"llm-endpoint-menu",onClick:()=>r(!s),children:[c.jsxs("div",{children:[c.jsxs("span",{className:"text-text-primary",children:[" ",e," "]}),!!t&&c.jsx("span",{className:"text-token-text-secondary",children:t})]}),c.jsx(vt,{className:"text-token-text-secondary size-4"})]})})}const BR=({presets:e,onSetDefaultPreset:t,onSelectPreset:n,onChangePreset:a,onDeletePreset:s,clearAllPresets:r,onFileSelected:o})=>{const{data:i}=Mp(),l=I(_p.defaultPreset),d=kg();return c.jsxs(c.Fragment,{children:[c.jsx("div",{role:"menuitem",className:"pointer-none group m-1.5 flex h-8 min-w-[170px] gap-2 rounded px-5 py-2.5 !pr-3 text-sm !opacity-100 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50  md:min-w-[240px]",tabIndex:-1,children:c.jsxs("div",{className:"flex h-full grow items-center justify-end gap-2",children:[c.jsx("label",{htmlFor:"default-preset",className:"w-40 truncate rounded bg-transparent py-1 text-xs font-medium text-gray-600 transition-colors dark:bg-transparent dark:text-gray-300 sm:w-72",children:l?`${d("com_endpoint_preset_default_item")} ${l.title}`:d("com_endpoint_preset_default_none")}),c.jsxs(Yy,{children:[c.jsx(Jy,{asChild:!0,children:c.jsxs("label",{htmlFor:"file-upload",className:"mr-1 flex h-[32px] cursor-pointer items-center rounded bg-transparent px-2 py-1 text-xs font-medium text-gray-600 transition-colors hover:bg-gray-100 hover:text-red-700 dark:bg-transparent dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-red-700",children:[c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"mr-1 flex w-[22px] items-center",children:c.jsx("path",{d:"M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M6.854 7.146 8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 1 1 .708-.708"})}),d("com_ui_clear")," ",d("com_ui_all")]})}),c.jsx(LT,{showCloseButton:!1,title:`${d("com_ui_clear")} ${d("com_endpoint_presets")}`,className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsx(g_,{htmlFor:"preset-item-clear-all",className:"text-left text-sm font-medium",children:d("com_endpoint_presets_clear_warning")})})})}),selection:{selectHandler:r,selectClasses:"bg-red-600 hover:bg-red-700 dark:hover:bg-red-600 text-white",selectText:d("com_ui_clear")}}),c.jsx(zR,{onFileSelected:o})]})]})}),e&&0===e.length&&c.jsx("div",{role:"menuitem",className:"pointer-none group m-1.5 flex h-8 min-w-[170px] gap-2 rounded px-5 py-2.5 !pr-3 text-sm !opacity-100 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 md:min-w-[240px]",tabIndex:-1,children:c.jsx("div",{className:"flex h-full grow items-center justify-end gap-2 text-gray-600 dark:text-gray-300",children:d("com_endpoint_no_presets")})}),c.jsx(Hn,{flipKey:null==e?void 0:e.map((e=>null==e?void 0:e.presetId)).filter((e=>e)).join("."),children:e&&e.length>0&&e.map(((r,o)=>{const d=(null==r?void 0:r.presetId)??"";if(!r||!d)return null;const u=Yu({endpoint:r.endpoint,endpointsConfig:i}),m=lw[u];return c.jsx(Fs,{asChild:!0,children:c.jsxs("div",{children:[c.jsx(Gn,{flipId:d,children:c.jsx(rj,{textClassName:"text-xs max-w-[150px] sm:max-w-[200px] truncate md:max-w-full ",title:Su(r),onClick:()=>n(r),icon:null!=m&&c.jsx(m,{context:"menu-item",iconURL:Hu(i,r.endpoint,"iconURL"),className:"icon-md mr-1 dark:text-white",endpoint:r.endpoint}),selected:!1,"data-testid":`preset-item-${r}`,children:c.jsxs("div",{className:"flex h-full items-center justify-end gap-1",children:[c.jsx("button",{className:rm("m-0 h-full rounded-md bg-transparent p-2 text-gray-400 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",(null==l?void 0:l.presetId)===d?"":"sm:invisible sm:group-hover:visible"),onClick:e=>{e.preventDefault(),e.stopPropagation(),t(r,(null==l?void 0:l.presetId)===d)},children:c.jsx(dy,{unpin:(null==l?void 0:l.presetId)===d})}),c.jsx("button",{className:"m-0 h-full rounded-md p-2 text-gray-400 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 sm:invisible sm:group-hover:visible",onClick:e=>{e.preventDefault(),e.stopPropagation(),a(r)},children:c.jsx(Bb,{})}),c.jsx("button",{className:"m-0 h-full rounded-md p-2 text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-200 sm:invisible sm:group-hover:visible",onClick:e=>{e.preventDefault(),e.stopPropagation(),s(r)},children:c.jsx(uy,{})})]})},`preset-item-${d}`)}),o!==e.length-1&&c.jsx(UR,{})]},`preset-${d}`)},`preset-${d}`)}))})]})},$R=()=>{const e=kg(),{presetsQuery:t,onSetDefaultPreset:n,onFileSelected:a,onSelectPreset:s,onChangePreset:r,clearAllPresets:o,onDeletePreset:i,submitPreset:l,exportPreset:d}=Tv(),{preset:u}=bh();return c.jsxs(Ms,{children:[c.jsx(As,{asChild:!0,children:c.jsx(z_,{id:"presets-button","aria-label":e("com_endpoint_examples"),description:e("com_endpoint_examples"),tabIndex:0,role:"button","data-testid":"presets-button",className:"inline-flex size-10 items-center justify-center rounded-lg border border-border-light bg-transparent text-text-primary transition-all ease-in-out hover:bg-surface-tertiary disabled:pointer-events-none disabled:opacity-50 radix-state-open:bg-surface-tertiary",children:c.jsx(Kn,{size:16,"aria-label":"Preset Icon"})})}),c.jsx(Os,{children:c.jsx("div",{style:{position:"fixed",left:"0px",top:"0px",transform:"translate3d(268px, 50px, 0px)",minWidth:"max-content",zIndex:"auto"},children:c.jsx(Ds,{side:"bottom",align:"center",className:"mt-2 max-h-[495px] overflow-x-hidden rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-700 dark:text-white md:min-w-[400px]",children:c.jsx(BR,{presets:t.data,onSetDefaultPreset:n,onSelectPreset:s,onChangePreset:r,onDeletePreset:i,clearAllPresets:o,onFileSelected:a})})})}),u&&c.jsx(FR,{submitPreset:l,exportPreset:d})]})};function HR({open:e,onOpenChange:t,conversation:a,triggerRef:s,children:r}){const o=kg(),[i,l]=n.useState(""),[d,u]=n.useState("Select a file type"),[m,p]=n.useState(!0),[g,f]=n.useState(!1),[x,h]=n.useState(!0);n.useEffect((()=>{!e&&s&&s.current&&s.current.focus()}),[e,s]),n.useEffect((()=>{l(U(String((null==a?void 0:a.title)??"file"))),u("screenshot"),p(!0),f(!1),h(!0)}),[null==a?void 0:a.title,e]);const v="json"===d||"csv"===d||"webpage"===d,b="csv"!==d&&"screenshot"!==d,{exportConversation:y}=zv({conversation:a,filename:i,type:d,includeOptions:m,exportBranches:g,recursive:x});return c.jsxs(f_,{open:e,onOpenChange:t,triggerRef:s,children:[r,c.jsx(ij,{title:o("com_nav_export_conversation"),className:"max-w-full sm:max-w-2xl",main:c.jsxs("div",{className:"flex w-full flex-col items-center gap-6",children:[c.jsxs("div",{className:"grid w-full gap-6 sm:grid-cols-2",children:[c.jsxs("div",{className:"col-span-1 flex flex-col items-start justify-start gap-2",children:[c.jsx(g_,{htmlFor:"filename",className:"text-left text-sm font-medium",children:o("com_nav_export_filename")}),c.jsx(m_,{id:"filename",value:i,onChange:e=>l(U(e.target.value||"")),placeholder:o("com_nav_export_filename_placeholder")})]}),c.jsxs("div",{className:"col-span-1 flex w-full flex-col items-start justify-start gap-2",children:[c.jsx(g_,{htmlFor:"type",className:"text-left text-sm font-medium",children:o("com_nav_export_type")}),c.jsx(q_,{value:d,onChange:e=>{const t="csv"!==e&&"screenshot"!==e;f("json"===e||"csv"===e||"webpage"===e),p(t),u(e)},options:[{value:"screenshot",label:"screenshot (.png)"},{value:"text",label:"text (.txt)"},{value:"markdown",label:"markdown (.md)"},{value:"json",label:"json (.json)"},{value:"csv",label:"csv (.csv)"}],portal:!1})]})]}),c.jsxs("div",{className:"grid w-full gap-6 sm:grid-cols-2",children:[c.jsx("div",{className:"col-span-1 flex flex-col items-start justify-start gap-2",children:c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"includeOptions",className:"text-left text-sm font-medium",children:o("com_nav_export_include_endpoint_options")}),c.jsxs("div",{className:"flex h-[40px] w-full items-center space-x-3",children:[c.jsx($y,{id:"includeOptions",disabled:!b,checked:m,className:"focus:ring-opacity-20 dark:border-gray-500 dark:bg-gray-700 dark:text-gray-50 dark:focus:ring-gray-600 dark:focus:ring-opacity-50 dark:focus:ring-offset-0",onCheckedChange:p}),c.jsx("label",{htmlFor:"includeOptions",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:o(b?"com_nav_enabled":"com_nav_not_supported")})]})]})}),c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"exportBranches",className:"text-left text-sm font-medium",children:o("com_nav_export_all_message_branches")}),c.jsxs("div",{className:"flex h-[40px] w-full items-center space-x-3",children:[c.jsx($y,{id:"exportBranches",disabled:!v,checked:g,className:"focus:ring-opacity-20 dark:border-gray-500 dark:bg-gray-700 dark:text-gray-50 dark:focus:ring-gray-600 dark:focus:ring-opacity-50 dark:focus:ring-offset-0",onCheckedChange:f}),c.jsx("label",{htmlFor:"exportBranches",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:o(v?"com_nav_enabled":"com_nav_not_supported")})]})]}),"json"===d?c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx(g_,{htmlFor:"recursive",className:"text-left text-sm font-medium",children:o("com_nav_export_recursive_or_sequential")}),c.jsxs("div",{className:"flex h-[40px] w-full items-center space-x-3",children:[c.jsx($y,{id:"recursive",checked:x,className:"focus:ring-opacity-20 dark:border-gray-500 dark:bg-gray-700 dark:text-gray-50 dark:focus:ring-gray-600 dark:focus:ring-opacity-50 dark:focus:ring-offset-0",onCheckedChange:h}),c.jsx("label",{htmlFor:"recursive",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-50",children:o("com_nav_export_recursive")})]})]}):null]})]}),buttons:c.jsx(c.Fragment,{children:c.jsx(By,{onClick:y,variant:"submit",children:o("com_endpoint_export")})}),selection:void 0})]})}function GR({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.enableUserMsgMarkdown);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[" ",t("com_nav_user_msg_markdown")," "]}),c.jsx(R_,{id:"enableUserMsgMarkdown",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"enableUserMsgMarkdown"})]})}function KR({onCheckedChange:e}){const[t,n]=T(_p.hideSidePanel),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:a("com_nav_hide_panel")}),c.jsx(R_,{id:"hideSidePanel",checked:t,"aria-label":"Hide right-most side panel",onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"hideSidePanel"})]})}function WR({onCheckedChange:e}){const[t,n]=T(_p.autoScroll),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[" ",a("com_nav_auto_scroll")," "]}),c.jsx(R_,{id:"autoScroll",checked:t,"aria-label":"Auto-Scroll to latest message on chat open",onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"autoScroll"})]})}function QR(){const e=kg(),{isAuthenticated:t}=Wh(),a=Ib("(max-width: 768px)"),[s,r]=n.useState(!1),[o,i]=n.useState(1),[l,d]=n.useState(""),{data:u,isLoading:m,fetchNextPage:p,hasNextPage:g,isFetchingNextPage:f,refetch:x}=Gp({pageNumber:o.toString(),isArchived:!0},{enabled:t&&s}),h=ng(),v=n.useCallback((e=>{h.mutate({conversationId:e,isArchived:!1})}),[h]),b=n.useMemo((()=>{var e;return(null==(e=null==u?void 0:u.pages[o-1])?void 0:e.conversations)??[]}),[u,o]),y=n.useMemo((()=>Math.ceil(Number((null==u?void 0:u.pages[0].pages)??1))??1),[u]),_=n.useCallback((e=>{e&&window.open(`/c/${e}`,"_blank")}),[]),j=n.useCallback((e=>{i(e),g&&p({pageParam:e})}),[p,g]),w=n.useCallback((e=>{d(e),i(1)}),[]),N=Array.from({length:11},((e,t)=>{const n=Math.floor(231*Math.random())+170;return c.jsxs("div",{className:"flex h-10 w-full items-center",children:[c.jsx("div",{className:"flex w-[410px] items-center",children:c.jsx(T_,{className:"h-4",style:{width:`${n}px`}})}),c.jsx("div",{className:"flex flex-grow justify-center",children:c.jsx(T_,{className:"h-4 w-28"})}),c.jsx("div",{className:"mr-2 flex justify-end",children:c.jsx(T_,{className:"h-4 w-12"})})]},t)}));return m||f?c.jsx("div",{className:"text-text-secondary",children:N}):!u||0===b.length&&0===y?c.jsx("div",{className:"text-text-secondary",children:e("com_nav_archived_chats_empty")}):c.jsxs("div",{className:rm("grid w-full gap-2","flex-1 flex-col overflow-y-auto pr-2 transition-opacity duration-500","max-h-[629px]"),onMouseEnter:()=>r(!0),children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qe,{className:"size-4 text-text-secondary"}),c.jsx(m_,{type:"text",placeholder:e("com_nav_search_placeholder"),value:l,onChange:e=>w(e.target.value),className:"w-full border-none placeholder:text-text-secondary"})]}),c.jsx(k_,{}),0===b.length?c.jsx("div",{className:"mt-4 text-text-secondary",children:e("com_nav_no_search_results")}):c.jsxs(c.Fragment,{children:[c.jsxs(I_,{children:[c.jsx(E_,{children:c.jsxs(L_,{children:[c.jsx(M_,{className:rm("p-4",a?"w-[70%]":"w-[50%]"),children:e("com_nav_archive_name")}),!a&&c.jsx(M_,{className:"w-[35%] p-1",children:e("com_nav_archive_created_at")}),c.jsx(M_,{className:rm("p-1 text-right",a?"w-[30%]":"w-[15%]"),children:e("com_assistants_actions")})]})}),c.jsx(P_,{children:b.map((t=>c.jsxs(L_,{className:"hover:bg-transparent",children:[c.jsx(A_,{className:"py-3 text-text-primary",children:c.jsxs("button",{type:"button",className:"flex max-w-full","aria-label":"Open conversation in a new tab",onClick:()=>{const e=t.conversationId??"";e&&_(e)},children:[c.jsx(Wn,{className:"mr-1 h-5 min-w-[20px]"}),c.jsx("u",{className:"truncate",children:t.title})]})}),!a&&c.jsx(A_,{className:"p-1",children:c.jsx("div",{className:"flex justify-between",children:c.jsx("div",{className:"flex justify-start text-text-secondary",children:new Date(t.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})})}),c.jsxs(A_,{className:rm("flex items-center gap-1 p-1",a?"justify-end":"justify-end gap-2"),children:[c.jsx(z_,{description:e("com_ui_unarchive"),render:c.jsx(By,{type:"button","aria-label":"Unarchive conversation",variant:"ghost",size:"icon",className:rm("size-8",a&&"size-7"),onClick:()=>{const e=t.conversationId??"";e&&v(e)},children:c.jsx(Qn,{className:rm("size-4",a&&"size-3.5")})})}),c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(z_,{description:e("com_ui_delete"),render:c.jsx(By,{type:"button","aria-label":"Delete archived conversation",variant:"ghost",size:"icon",className:rm("size-8",a&&"size-7"),children:c.jsx(cn,{className:rm("size-4",a&&"size-3.5")})})})}),c.jsx(Mk,{conversationId:t.conversationId??"",retainView:x,title:t.title??""})]})]})]},t.conversationId)))})]}),c.jsxs("div",{className:"flex items-center justify-end gap-6 px-2 py-4",children:[c.jsxs("div",{className:"text-sm font-bold text-text-primary",children:[e("com_ui_page")," ",o," ",e("com_ui_of")," ",y]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx(By,{variant:"outline",size:"icon","aria-label":"Go to the previous page",onClick:()=>j(Math.max(o-1,1)),disabled:1===o,children:c.jsx(Cn,{className:"size-4"})}),c.jsx(By,{variant:"outline",size:"icon","aria-label":"Go to the next page",onClick:()=>j(Math.min(o+1,y)),disabled:o===y,children:c.jsx(ge,{className:"size-4"})})]})]})]})]})}function qR(){const e=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_archived_chats")}),c.jsxs(f_,{children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"outline","aria-label":"Archived chats",children:e("com_ui_manage")})}),c.jsx(ij,{title:e("com_nav_archived_chats"),className:"max-w-[1000px]",showCancelButton:!1,main:c.jsx(QR,{})})]})]})}const ZR=({theme:e,onChange:t})=>{const n=kg(),a=[{value:"system",label:n("com_nav_theme_system")},{value:"dark",label:n("com_nav_theme_dark")},{value:"light",label:n("com_nav_theme_light")}];return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:n("com_nav_theme")}),c.jsx(q_,{value:e,onChange:t,options:a,sizeClasses:"w-[180px]",testId:"theme-selector"})]})},YR=({langcode:e,onChange:t})=>{const n=kg(),a=[{value:"auto",label:n("com_nav_lang_auto")},{value:"en-US",label:n("com_nav_lang_english")},{value:"zh-Hans",label:n("com_nav_lang_chinese")},{value:"zh-Hant",label:n("com_nav_lang_traditional_chinese")},{value:"ar-EG",label:n("com_nav_lang_arabic")},{value:"de-DE",label:n("com_nav_lang_german")},{value:"es-ES",label:n("com_nav_lang_spanish")},{value:"et-EE",label:n("com_nav_lang_estonian")},{value:"fr-FR",label:n("com_nav_lang_french")},{value:"it-IT",label:n("com_nav_lang_italian")},{value:"pl-PL",label:n("com_nav_lang_polish")},{value:"pt-BR",label:n("com_nav_lang_brazilian_portuguese")},{value:"pt-PT",label:n("com_nav_lang_portuguese")},{value:"ru-RU",label:n("com_nav_lang_russian")},{value:"ja-JP",label:n("com_nav_lang_japanese")},{value:"ka-GE",label:n("com_nav_lang_georgian")},{value:"sv-SE",label:n("com_nav_lang_swedish")},{value:"ko-KR",label:n("com_nav_lang_korean")},{value:"vi-VN",label:n("com_nav_lang_vietnamese")},{value:"tr-TR",label:n("com_nav_lang_turkish")},{value:"nl-NL",label:n("com_nav_lang_dutch")},{value:"id-ID",label:n("com_nav_lang_indonesia")},{value:"he-HE",label:n("com_nav_lang_hebrew")},{value:"fi-FI",label:n("com_nav_lang_finnish")}];return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:n("com_nav_language")}),c.jsx(q_,{value:e,onChange:t,sizeClasses:"[--anchor-max-height:256px]",options:a})]})};const JR=_.memo((function(){const{theme:e,setTheme:t}=n.useContext(Mv),[a,s]=T(_p.lang),r=n.useCallback((e=>{t(e)}),[t]),o=n.useCallback((e=>{let t=e;"auto"===e&&(t=navigator.language||navigator.languages[0]),requestAnimationFrame((()=>{document.documentElement.lang=t})),s(t),E.set("lang",t,{expires:365})}),[s]);return c.jsxs("div",{className:"flex flex-col gap-3 p-1 text-sm text-text-primary",children:[c.jsx("div",{className:"pb-3",children:c.jsx(ZR,{theme:e,onChange:r})}),c.jsx("div",{className:"pb-3",children:c.jsx(YR,{langcode:a,onChange:o})}),c.jsx("div",{className:"pb-3",children:c.jsx(GR,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(WR,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(KR,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(qR,{})})]})}));function XR({onCheckedChange:e}){const[t,n]=T(_p.maximizeChatSpace),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-2",children:c.jsx("div",{children:a("com_nav_maximize_chat_space")})}),c.jsx(R_,{id:"maximizeChatSpace",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"maximizeChatSpace"})]})}function eI(){const[e,t]=T(_p.fontSize),n=kg(),a=[{value:"text-xs",label:n("com_nav_font_size_xs")},{value:"text-sm",label:n("com_nav_font_size_sm")},{value:"text-base",label:n("com_nav_font_size_base")},{value:"text-lg",label:n("com_nav_font_size_lg")},{value:"text-xl",label:n("com_nav_font_size_xl")}];return c.jsxs("div",{className:"flex w-full items-center justify-between",children:[c.jsx("div",{children:n("com_nav_font_size")}),c.jsx(q_,{value:e,options:a,onChange:e=>{t(e),ou(e)},testId:"font-size-selector",sizeClasses:"w-[150px]"})]})}const tI=({side:e,text:t})=>{const n=kg();return c.jsxs(l_,{openDelay:500,children:[c.jsxs(c_,{children:[c.jsx(Iy,{className:"h-5 w-5 text-text-tertiary"})," "]}),c.jsx(d_,{children:c.jsx(u_,{side:e,className:"z-[999] w-80",children:c.jsx("div",{className:"space-y-2",children:c.jsx("p",{className:"text-sm text-text-secondary",children:n(t)})})})})]})};function nI({onCheckedChange:e}){const[t,n]=T(_p.enterToSend),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:a("com_nav_enter_to_send")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_enter_to_send"})]}),c.jsx(R_,{id:"enterToSend",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"enterToSend"})]})}function aI({onCheckedChange:e}){const[t,n]=T(_p.showCode),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[" ",a("com_nav_show_code")," "]}),c.jsx(R_,{id:"showCode",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"showCode"})]})}const sI=()=>{const e=kg(),[t,n]=T(_p.forkSetting),[a,s]=T(_p.splitAtTarget),[r,o]=T(_p.rememberDefaultFork),i=[{value:mc.DIRECT_PATH,label:e("com_ui_fork_visible")},{value:mc.INCLUDE_BRANCHES,label:e("com_ui_fork_branches")},{value:mc.TARGET_LEVEL,label:e("com_ui_fork_all_target")}];return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"pb-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[" ",e("com_ui_fork_default")," "]}),c.jsx(R_,{id:"rememberDefaultFork",checked:r,onCheckedChange:o,className:"ml-4","data-testid":"rememberDefaultFork"})]})}),r&&c.jsx("div",{className:"pb-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:e("com_ui_fork_change_default")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_fork_change_default"})]}),c.jsx(q_,{value:t,onChange:n,options:i,sizeClasses:"w-[200px]",testId:"fork-setting-dropdown"})]})}),c.jsx("div",{className:"pb-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:e("com_ui_fork_split_target_setting")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_fork_split_target_setting"})]}),c.jsx(R_,{id:"splitAtTarget",checked:a,onCheckedChange:s,className:"ml-4","data-testid":"splitAtTarget"})]})})]})},rI=()=>{const[e,t]=T(_p.chatDirection),n=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-2",children:c.jsx("span",{id:"chat-direction-label",children:n("com_nav_chat_direction")})}),c.jsxs(By,{variant:"outline","aria-label":"Toggle chat direction",onClick:()=>{t((e=>"LTR"===e?"RTL":"LTR"))},"data-testid":"chatDirection",children:[c.jsx("span",{"aria-hidden":"true",children:e.toLowerCase()}),c.jsx("span",{id:"chat-direction-status",className:"sr-only",children:n("LTR"===e?"chat_direction_left_to_right":"chat_direction_right_to_left")})]})]})};function oI({onCheckedChange:e}){const[t,n]=T(_p.showThinking),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:a("com_nav_show_thinking")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_show_thinking"})]}),c.jsx(R_,{id:"showThinking",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"showThinking"})]})}function iI({onCheckedChange:e}){const[t,n]=T(_p.LaTeXParsing),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:a("com_nav_latex_parsing")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_latex_parsing"})]}),c.jsx(R_,{id:"LaTeXParsing",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"LaTeXParsing"})]})}function lI({onCheckedChange:e}){const[t,n]=T(_p.showScrollButton),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-2",children:c.jsx("div",{children:a("com_nav_scroll_button")})}),c.jsx(R_,{id:"scrollButton",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"scrollButton"})]})}function cI({onCheckedChange:e}){const[t,n]=T(_p.modularChat),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[" ",a("com_nav_modular_chat")," "]}),c.jsx(R_,{id:"modularChat",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"modularChat"})]})}function dI({onCheckedChange:e}){const[t,n]=T(_p.saveDrafts),a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{children:a("com_nav_save_drafts")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_save_draft"})]}),c.jsx(R_,{id:"saveDrafts",checked:t,onCheckedChange:t=>{n(t),e&&e(t)},className:"ml-4","data-testid":"saveDrafts"})]})}const uI=n.memo((function(){return c.jsxs("div",{className:"flex flex-col gap-3 p-1 text-sm text-text-primary",children:[c.jsx("div",{className:"pb-3",children:c.jsx(eI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(rI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(nI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(XR,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(aI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(dI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(lI,{})}),c.jsx(sI,{}),c.jsx("div",{className:"pb-3",children:c.jsx(cI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(iI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(oI,{})})]})}));function mI(){const e=kg(),t=n.useRef(null),{showToast:a}=Ng(),[,s]=n.useState([]),[r,o]=n.useState(!0),i=e=>s((t=>[...t,e])),l=dg({onSuccess:()=>{a({message:e("com_ui_import_conversation_success")}),o(!0)},onError:t=>{var n,s;console.error("Error: ",t),o(!0),i((null==(s=null==(n=t.response)?void 0:n.data)?void 0:s.message)??"An error occurred while uploading the file."),!0===(null==t?void 0:t.toString().includes("Unsupported import type"))?a({message:e("com_ui_import_conversation_file_type_error"),status:"error"}):a({message:e("com_ui_import_conversation_error"),status:"error"})},onMutate:()=>{o(!1)}}),d=async e=>{try{await(async e=>{const t=new FormData;t.append("file",e,encodeURIComponent(e.name||"File")),l.mutate(t)})(e)}catch(t){console.log("file handling error",t),i("An error occurred while processing the file.")}},u=()=>{var e;null==(e=t.current)||e.click()};return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_ui_import_conversation_info")}),c.jsxs("button",{onClick:u,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),u())},disabled:!r,"aria-label":e("com_ui_import"),className:"btn btn-neutral relative",children:[r?c.jsx(qn,{className:"mr-1 flex h-4 w-4 items-center stroke-1"}):c.jsx(Hb,{className:"mr-1 w-4"}),c.jsx("span",{children:e("com_ui_import")})]}),c.jsx("input",{ref:t,type:"file",className:rm("hidden"),accept:".json",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];n&&d(n)},"aria-hidden":"true"})]})}const pI=({endpoint:e="",all:t=!1,disabled:a=!1,setDialogOpen:s})=>{const r=kg(),[o,i]=n.useState(!1),l=dh(e),d=uh(),u=()=>{s&&s(!1)},m=t?r("com_ui_revoke_keys"):r("com_ui_revoke_key_endpoint",{0:e}),p=r(t?"com_ui_revoke_keys_confirm":"com_ui_revoke_key_confirm"),g=l.isLoading||d.isLoading;return c.jsxs(f_,{open:o,onOpenChange:i,children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"destructive",className:"flex items-center justify-center rounded-lg transition-colors duration-200",onClick:()=>i(!0),disabled:a,children:r("com_ui_revoke")})}),c.jsx(ij,{showCloseButton:!1,title:m,className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:p}),selection:{selectHandler:()=>{t?d.mutate({}):l.mutate({},{onSuccess:u})},selectClasses:"bg-destructive text-white transition-all duration-200 hover:bg-destructive/80",selectText:g?c.jsx(Hb,{}):r("com_ui_revoke")}})]})},gI=()=>{const e=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(g_,{className:"font-light",children:e("com_ui_revoke_info")}),c.jsx(pI,{all:!0})]})},fI=({disabled:e=!1})=>{const t=kg(),[a,s]=n.useState(!1),[r,o]=n.useState(!0),[i,l]=n.useState(!1),[d,u]=n.useState(!1);Pb(n.useRef(null),(()=>i&&l(!1)),[]);const m=n.useCallback((async()=>{const e=await caches.open("tts-responses"),t=await e.keys();o(0===t.length)}),[]);n.useEffect((()=>{m()}),[m]);const p=n.useCallback((async()=>{u(!0);const e=await caches.open("tts-responses");await e.keys().then((t=>Promise.all(t.map((t=>e.delete(t)))))),u(!1)}),[]);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(g_,{className:"font-light",children:t("com_nav_delete_cache_storage")}),c.jsxs(f_,{open:a,onOpenChange:s,children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"destructive",className:"flex items-center justify-center rounded-lg transition-colors duration-200",onClick:()=>s(!0),disabled:e||r,children:t("com_ui_delete")})}),c.jsx(ij,{showCloseButton:!1,title:t("com_nav_confirm_clear"),className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:t("com_nav_clear_cache_confirm_message")}),selection:{selectHandler:p,selectClasses:"bg-destructive text-white transition-all duration-200 hover:bg-destructive/80",selectText:d?c.jsx(Hb,{}):t("com_ui_delete")}})]})]})},xI=()=>{const e=kg(),[t,a]=n.useState(!1),{newConversation:s}=Qh(),r=ch();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(g_,{className:"font-light",children:e("com_nav_clear_all_chats")}),c.jsxs(f_,{open:t,onOpenChange:a,children:[c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"destructive",className:"flex items-center justify-center rounded-lg transition-colors duration-200",onClick:()=>a(!0),children:e("com_ui_delete")})}),c.jsx(ij,{showCloseButton:!1,title:e("com_nav_confirm_clear"),className:"max-w-[450px]",main:c.jsx(g_,{className:"text-left text-sm font-medium",children:e("com_nav_clear_conversation_confirm_message")}),selection:{selectHandler:()=>{r.mutate({},{onSuccess:()=>{s()}})},selectClasses:"bg-destructive text-white transition-all duration-200 hover:bg-destructive/80",selectText:r.isLoading?c.jsx(Hb,{}):e("com_ui_delete")}})]})]})},hI=n.memo((({checked:e,onChange:t,ariaLabel:n})=>c.jsx("div",{role:"button",tabIndex:0,onKeyDown:e=>e.stopPropagation(),className:"flex h-full w-[30px] items-center justify-center",onClick:e=>e.stopPropagation(),children:c.jsx($y,{checked:e,onCheckedChange:t,"aria-label":n})})));hI.displayName="SelectionCheckbox";const vI=n.memo((({row:e,isSmallScreen:t,onSelectionChange:a,index:s,isSearching:r})=>{const o=n.useCallback((t=>{e.toggleSelected(t),null==a||a(e.id,t)}),[e,a]);return c.jsx(L_,{"data-state":e.getIsSelected()?"selected":void 0,className:`\n        motion-safe:animate-fadeIn border-b\n        border-border-light transition-all duration-300\n        ease-out\n        hover:bg-surface-secondary\n        ${r?"opacity-50":"opacity-100"}\n        ${r?"scale-98":"scale-100"}\n      `,style:{animationDelay:20*s+"ms",transform:`translateY(${r?"4px":"0"})`},children:e.getVisibleCells().map((n=>"select"===n.column.id?c.jsx(A_,{className:"px-2 py-1 transition-all duration-300",children:c.jsx(hI,{checked:e.getIsSelected(),onChange:o,ariaLabel:"Select row"})},n.id):c.jsx(A_,{className:`\n              w-0 max-w-0 px-2 py-1 align-middle text-xs\n              transition-all duration-300 sm:px-4\n              sm:py-2 sm:text-sm\n              ${r?"blur-[0.3px]":"blur-0"}\n            `,style:bI(n.column.columnDef,t),children:c.jsx("div",{className:"overflow-hidden text-ellipsis",children:ir(n.column.columnDef.cell,n.getContext())})},n.id)))})}));function bI(e,t){var n,a,s,r;return{width:t?null==(n=e.meta)?void 0:n.mobileSize:null==(a=e.meta)?void 0:a.size,minWidth:null==(s=e.meta)?void 0:s.minWidth,maxWidth:null==(r=e.meta)?void 0:r.size}}const yI=n.memo((({onDelete:e,isDeleting:t,disabled:n,isSmallScreen:a,localize:s})=>e?c.jsx(By,{variant:"outline",onClick:e,disabled:n,className:rm("min-w-[40px] transition-all duration-200",a&&"px-2 py-1"),children:t?c.jsx(Hb,{className:"size-4"}):c.jsxs(c.Fragment,{children:[c.jsx(uy,{className:"size-3.5 text-red-400 sm:size-4"}),!a&&c.jsx("span",{className:"ml-2",children:s("com_ui_delete")})]})}):null));function _I({columns:e,data:t,onDelete:a,filterColumn:s,defaultSort:r=[],className:o="",isFetchingNextPage:i=!1,hasNextPage:l=!1,fetchNextPage:d,enableRowSelection:u=!0,showCheckboxes:m=!0,onFilterChange:p,filterValue:g}){const f=kg(),x=Ib("(max-width: 768px)"),h=n.useRef(null),[v,b]=n.useState(!1),[y,_]=n.useState({}),[j,w]=n.useState(r),[N,C]=n.useState([]),[k,S]=n.useState({}),[T,R]=n.useState(g??""),[I,E]=n.useState(!1),P=n.useMemo((()=>{if(!u||!m)return e;return[{id:"select",header:({table:e})=>c.jsx("div",{className:"flex h-full w-[30px] items-center justify-center",children:c.jsx($y,{checked:e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(Boolean(t)),"aria-label":"Select all"})}),cell:({row:e})=>c.jsx(hI,{checked:e.getIsSelected(),onChange:t=>e.toggleSelected(t),ariaLabel:"Select row"}),meta:{size:"50px"}},...e]}),[e,u,m]),L=or({data:t,columns:P,getCoreRowModel:lr(),getSortedRowModel:ur(),getFilteredRowModel:dr(),enableRowSelection:u,enableMultiRowSelection:!0,state:{sorting:j,columnFilters:N,columnVisibility:k,rowSelection:y},onSortingChange:w,onColumnFiltersChange:C,onColumnVisibilityChange:S,onRowSelectionChange:_}),{rows:M}=L.getRowModel(),A=mr({count:M.length,getScrollElement:()=>h.current,estimateSize:n.useCallback((()=>48),[]),overscan:10}),O=A.getVirtualItems(),D=A.getTotalSize(),F=O.length>0?O[0].start:0,z=O.length>0?D-O[O.length-1].end:0;n.useEffect((()=>{const e=h.current;if(!e)return;const t=async()=>{if(!l||i)return;const{scrollTop:t,scrollHeight:n,clientHeight:a}=e;if(n-t<=1.5*a)try{await(null==d?void 0:d())}catch(s){console.error("Unable to fetch next page:",s)}};return e.addEventListener("scroll",t,{passive:!0}),()=>e.removeEventListener("scroll",t)}),[l,i,d]),n.useEffect((()=>{E(!0);const e=setTimeout((()=>{null==p||p(T),E(!1)}),300);return()=>clearTimeout(e)}),[T,p]);const U=n.useCallback((async()=>{if(a){b(!0);try{const e=L.getFilteredSelectedRowModel().rows.map((e=>e.original));await a(e),_({})}finally{b(!1)}}}),[a,L]);return c.jsxs("div",{className:rm("flex h-full flex-col gap-4",o),children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2 sm:gap-4 sm:py-4",children:[u&&m&&c.jsx(yI,{onDelete:U,isDeleting:v,disabled:!L.getFilteredSelectedRowModel().rows.length||v,isSmallScreen:x,localize:f}),void 0!==s&&L.getColumn(s)&&c.jsx("div",{className:"relative flex-1",children:c.jsx(dj,{value:T,onChange:e=>R(e.target.value),isSearching:I,placeholder:`${f("com_ui_search")}...`})})]}),c.jsx("div",{ref:h,className:rm("relative h-[calc(100vh-20rem)] max-w-full overflow-x-auto overflow-y-auto rounded-md border border-black/10 dark:border-white/10","transition-all duration-300 ease-out",I&&"bg-surface-secondary/50",o),children:c.jsxs(I_,{className:"w-full min-w-[300px] table-fixed border-separate border-spacing-0",children:[c.jsx(E_,{className:"sticky top-0 z-50 bg-surface-secondary",children:L.getHeaderGroups().map((e=>c.jsx(L_,{className:"border-b border-border-light",children:e.headers.map((e=>c.jsx(M_,{className:"whitespace-nowrap bg-surface-secondary px-2 py-2 text-left text-sm font-medium text-text-secondary sm:px-4",style:bI(e.column.columnDef,x),onClick:e.column.getCanSort()?e.column.getToggleSortingHandler():void 0,children:e.isPlaceholder?null:ir(e.column.columnDef.header,e.getContext())},e.id)))},e.id)))}),c.jsxs(P_,{children:[F>0&&c.jsx("tr",{children:c.jsx("td",{style:{height:`${F}px`}})}),O.map((e=>{const t=M[e.index];return c.jsx(vI,{row:t,isSmallScreen:x,index:e.index,isSearching:I},t.id)})),!O.length&&c.jsx(L_,{className:"hover:bg-transparent",children:c.jsx(A_,{colSpan:e.length,className:"p-4 text-center",children:f("com_ui_no_data")})}),z>0&&c.jsx("tr",{children:c.jsx("td",{style:{height:`${z}px`}})}),(i||l)&&c.jsx(L_,{className:"hover:bg-transparent",children:c.jsx(A_,{colSpan:e.length,className:"p-4",children:c.jsx("div",{className:"flex h-full items-center justify-center",children:i?c.jsx(Hb,{className:"size-4"}):l&&c.jsx("div",{className:"h-6"})})})})]})]})})]})}const jI={pageSize:25,isPublic:!0,sortBy:"createdAt",sortDirection:"desc",search:""};function wI(){const e=kg(),{showToast:t}=Ng(),a=Ib("(max-width: 768px)"),[s,r]=n.useState(jI),[o,i]=n.useState(!1),[l,d]=n.useState(!1),{data:u,fetchNextPage:m,hasNextPage:p,isFetchingNextPage:g,refetch:f,isLoading:x}=Kp(s,{enabled:l,staleTime:0,cacheTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1}),h=n.useCallback(((e,t)=>{r((n=>({...n,sortBy:e,sortDirection:t})))}),[]),v=n.useCallback((e=>{const t=encodeURIComponent(e.trim());r((e=>({...e,search:t})))}),[]),b=n.useMemo((()=>$(v,300)),[v]);n.useEffect((()=>()=>{b.cancel()}),[b]);const y=n.useMemo((()=>(null==u?void 0:u.pages)?u.pages.flatMap((e=>e.links.filter(Boolean))):[]),[null==u?void 0:u.pages]),_=rg({onSuccess:async()=>{i(!1),C(null),await f()}}),j=n.useCallback((async n=>{const a=n.filter((e=>"string"==typeof e.shareId&&e.shareId.length>0));if(0!==a.length)try{for(const e of a)await _.mutateAsync({shareId:e.shareId});t({message:e(1===a.length?"com_ui_shared_link_delete_success":"com_ui_shared_link_bulk_delete_success"),severity:Wr.SUCCESS})}catch(s){console.error("Failed to delete shared links:",s),t({message:e("com_ui_bulk_delete_error"),severity:Wr.ERROR})}else t({message:e("com_ui_no_valid_items"),severity:Wr.WARNING})}),[_,t,e]),w=n.useCallback((async()=>{!0!==p||g||await m()}),[m,p,g]),[N,C]=n.useState(null),k=n.useCallback((()=>{N&&j([N]),i(!1)}),[N,j]),S=n.useMemo((()=>[{accessorKey:"title",header:({column:t})=>c.jsxs(By,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>h("title","asc"===t.getIsSorted()?"desc":"asc"),children:[e("com_ui_name"),c.jsx(Ln,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]}),cell:({row:e})=>{const{title:t,shareId:n}=e.original;return c.jsx("div",{className:"flex items-center gap-2",children:c.jsx(Zn,{to:`/share/${n}`,target:"_blank",rel:"noopener noreferrer",className:"block truncate text-blue-500 hover:underline",title:t,children:t})})},meta:{size:"35%",mobileSize:"50%"}},{accessorKey:"createdAt",header:({column:t})=>c.jsxs(By,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>h("createdAt","asc"===t.getIsSorted()?"desc":"asc"),children:[e("com_ui_date"),c.jsx(Ln,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]}),cell:({row:e})=>{var t;return nu((null==(t=e.original.createdAt)?void 0:t.toString())??"",a)},meta:{size:"10%",mobileSize:"20%"}},{accessorKey:"actions",header:()=>c.jsx(g_,{className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",children:e("com_assistants_actions")}),meta:{size:"7%",mobileSize:"25%"},cell:({row:t})=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(z_,{description:e("com_ui_view_source"),render:c.jsx(By,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-surface-hover",onClick:()=>{window.open(`/c/${t.original.conversationId}`,"_blank")},title:e("com_ui_view_source"),children:c.jsx(Yn,{className:"size-4"})})}),c.jsx(z_,{description:e("com_ui_delete"),render:c.jsx(By,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-surface-hover",onClick:()=>{C(t.original),i(!0)},title:e("com_ui_delete"),children:c.jsx(cn,{className:"size-4"})})})]})}]),[a,e]);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_shared_links")}),c.jsxs(f_,{open:l,onOpenChange:d,children:[c.jsx(x_,{asChild:!0,onClick:()=>d(!0),children:c.jsx(By,{variant:"outline",children:e("com_ui_manage")})}),c.jsxs(y_,{title:e("com_nav_my_files"),className:"w-11/12 max-w-5xl bg-background text-text-primary shadow-2xl",children:[c.jsx(__,{children:c.jsx(w_,{children:e("com_nav_shared_links")})}),c.jsx(_I,{columns:S,data:y,onDelete:j,filterColumn:"title",hasNextPage:p,isFetchingNextPage:g,fetchNextPage:w,showCheckboxes:!1,onFilterChange:b,filterValue:s.search})]})]}),c.jsx(f_,{open:o,onOpenChange:i,children:c.jsx(ij,{showCloseButton:!1,title:e("com_ui_delete_shared_link"),className:"max-w-[450px]",main:c.jsx(c.Fragment,{children:c.jsx("div",{className:"flex w-full flex-col items-center gap-2",children:c.jsx("div",{className:"grid w-full items-center gap-2",children:c.jsxs(g_,{htmlFor:"dialog-confirm-delete",className:"text-left text-sm font-medium",children:[e("com_ui_delete_confirm")," ",c.jsx("strong",{children:null==N?void 0:N.title})]})})})}),selection:{selectHandler:k,selectClasses:"bg-red-700 dark:bg-red-600 hover:bg-red-800 dark:hover:bg-red-800 text-white "+(_.isLoading?"cursor-not-allowed opacity-80":""),selectText:_.isLoading?c.jsx(Hb,{}):e("com_ui_delete")}})})]})}const NI=_.memo((function(){const e=n.useRef(null),[t,a]=n.useState(!1);return Pb(e,(()=>t&&a(!1)),[]),c.jsxs("div",{className:"flex flex-col gap-3 p-1 text-sm text-text-primary",children:[c.jsx("div",{className:"pb-3",children:c.jsx(mI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(wI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(gI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(fI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(xI,{})})]})}));function CI(){const[e,t]=T(_p.codeArtifacts),[n,a]=T(_p.includeShadcnui),[s,r]=T(_p.customPromptMode),o=kg();return c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-medium",children:o("com_ui_artifacts")}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(kI,{id:"codeArtifacts",label:o("com_ui_artifacts_toggle"),checked:e,onCheckedChange:e=>{t(e),e||(a(!1),r(!1))},hoverCardText:"com_nav_info_code_artifacts"}),c.jsx(kI,{id:"includeShadcnui",label:o("com_ui_include_shadcnui"),checked:n,onCheckedChange:e=>{a(e)},hoverCardText:"com_nav_info_include_shadcnui",disabled:!e||s}),c.jsx(kI,{id:"customPromptMode",label:o("com_ui_custom_prompt_mode"),checked:s,onCheckedChange:e=>{r(e),e&&a(!1)},hoverCardText:"com_nav_info_custom_prompt_mode",disabled:!e})]})]})}function kI({id:e,label:t,checked:n,onCheckedChange:a,hoverCardText:s,disabled:r=!1}){return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:r?"text-gray-400":"",children:t}),c.jsx(tI,{side:"bottom",text:s})]}),c.jsx(R_,{id:e,checked:n,onCheckedChange:a,className:"ml-4","data-testid":e,disabled:r})]})}const SI=n.memo((function(){return c.jsx("div",{className:"flex flex-col gap-3 p-1 text-sm text-text-primary",children:c.jsx("div",{className:"pb-3",children:c.jsx(CI,{})})})}));function TI(){const[e,t]=T(_p.slashCommand),n=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:n("com_nav_slash_command_description")}),c.jsx(R_,{id:"slashCommand",checked:e,onCheckedChange:e=>{t(e)},"data-testid":"slashCommand"})]})}function RI(){const[e,t]=T(_p.plusCommand),n=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:n("com_nav_plus_command_description")}),c.jsx(R_,{id:"plusCommand",checked:e,onCheckedChange:e=>{t(e)},className:"ml-4","data-testid":"plusCommand"})]})}function II(){const[e,t]=T(_p.atCommand),n=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:n("com_nav_at_command_description")}),c.jsx(R_,{id:"atCommand",checked:e,onCheckedChange:e=>{t(e)},className:"ml-4","data-testid":"atCommand"})]})}const EI=n.memo((function(){const e=kg(),t=Jv({permissionType:Zc.PROMPTS,permission:Yc.USE}),n=Jv({permissionType:Zc.MULTI_CONVO,permission:Yc.USE});return c.jsxs("div",{className:"space-y-4 p-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h3",{className:"text-lg font-medium text-text-primary",children:e("com_nav_chat_commands")}),c.jsx(tI,{side:"bottom",text:"com_nav_chat_commands_info"})]}),c.jsxs("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:[c.jsx("div",{className:"pb-3",children:c.jsx(II,{})}),!0===n&&c.jsx("div",{className:"pb-3",children:c.jsx(RI,{})}),!0===t&&c.jsx("div",{className:"pb-3",children:c.jsx(TI,{})})]})]})}));function PI(){const e=kg(),[t,n]=T(_p.UsernameDisplay);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(g_,{className:"font-light",children:e("com_nav_user_name_display")}),c.jsx(tI,{side:"bottom",text:"com_nav_info_user_name_display"})]}),c.jsx(R_,{id:"UsernameDisplay",checked:t,onCheckedChange:e=>{n(e)},className:"ml-4","data-testid":"UsernameDisplay"})]})}const LI=({disabled:e=!1})=>{const t=kg(),{user:a,logout:s}=Wh(),{mutate:r,isLoading:o}=(e=>{const t=ar(),n=wp(),a=P(_p.defaultPreset);return sr([ed.deleteUser],{mutationFn:()=>zd.deleteUser(),...e||{},onSuccess:(...s)=>{var r;a(),n(),t.removeQueries(),null==(r=null==e?void 0:e.onSuccess)||r.call(e,...s)}})})({onMutate:()=>s()}),[i,l]=n.useState(!1),[d,u]=n.useState(!0),m=n.useCallback((e=>{const t=e.trim().toLowerCase()===(null==a?void 0:a.email.trim().toLowerCase());u(!t)}),[null==a?void 0:a.email]);return c.jsx(c.Fragment,{children:c.jsxs(f_,{open:i,onOpenChange:l,children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:t("com_nav_delete_account")}),c.jsx(x_,{asChild:!0,children:c.jsx(By,{variant:"destructive",className:"flex items-center justify-center rounded-lg transition-colors duration-200",onClick:()=>l(!0),disabled:e,children:t("com_ui_delete")})})]}),c.jsxs(y_,{className:"w-11/12 max-w-md",children:[c.jsx(__,{children:c.jsx(w_,{className:"text-lg font-medium leading-6",children:t("com_nav_delete_account_confirm")})}),c.jsx("div",{className:"mb-8 text-sm text-black dark:text-white",children:c.jsxs("ul",{className:"font-semibold text-amber-600",children:[c.jsx("li",{children:t("com_nav_delete_warning")}),c.jsx("li",{children:t("com_nav_delete_data_info")})]})}),c.jsxs("div",{className:"flex-col items-center justify-center",children:[c.jsx("div",{className:"mb-4",children:MI(t("com_nav_delete_account_email_placeholder"),"email-confirm-input",(null==a?void 0:a.email)??"",(e=>m(e.target.value)))}),AI((()=>{d||r(void 0)}),o,d,t)]})]})]})})},MI=(e,t,n,a)=>c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"mb-1 block text-sm font-medium text-black dark:text-white",htmlFor:t,children:e}),c.jsx(m_,{id:t,onChange:a,placeholder:n})]}),AI=(e,t,n,a)=>c.jsx("button",{className:rm("mt-4 flex w-full items-center justify-center rounded-lg bg-surface-tertiary px-4 py-2 transition-all duration-200",n?"cursor-not-allowed opacity-30":"bg-destructive text-destructive-foreground"),onClick:e,disabled:t||n,children:t?c.jsx("div",{className:"flex h-6 justify-center",children:c.jsx(Hb,{className:"icon-sm m-auto"})}):c.jsx(c.Fragment,{children:n?c.jsxs(c.Fragment,{children:[c.jsx(Jn,{className:"size-5"}),c.jsx("span",{className:"ml-2",children:a("com_ui_locked")})]}):c.jsxs(c.Fragment,{children:[c.jsx(cn,{className:"size-5"}),c.jsx("span",{className:"ml-2",children:a("com_nav_delete_account_button")})]})})});function OI(){const e=R(_p.user),[t,a]=n.useState(1),[s,r]=n.useState(0),o=n.useRef(null),i=n.useRef(null),l=n.useRef(null),[d,u]=n.useState(null),[m,p]=n.useState(!1),{data:g=Gi}=Dp({select:e=>Zi(e)}),f=kg(),{showToast:x}=Ng(),{mutate:h,isLoading:v}=ug({onSuccess:t=>{var n;x({message:f("com_ui_upload_success")}),e((e=>({...e,avatar:t.url}))),null==(n=l.current)||n.click()},onError:e=>{console.error("Error:",e),x({message:f("com_ui_upload_error"),status:"error"})}}),b=e=>{if(null!=g.avatarSizeLimit&&e&&e.size<=g.avatarSizeLimit)u(e),a(1),r(0);else{const e=null!=g.avatarSizeLimit?su(g.avatarSizeLimit):2;x({message:f("com_ui_upload_invalid_var",{0:e+""}),status:"error"})}},y=n.useCallback((e=>{e.preventDefault();const t=e.dataTransfer.files[0];b(t)}),[]),_=n.useCallback((e=>{e.preventDefault()}),[]),j=n.useCallback((()=>{u(null),a(1),r(0)}),[]);return c.jsxs(f_,{open:m,onOpenChange:e=>{p(e),e||(j(),setTimeout((()=>{var e;null==(e=l.current)||e.focus()}),0))},children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:f("com_nav_profile_picture")}),c.jsx(x_,{ref:l,children:c.jsxs(By,{variant:"outline",children:[c.jsx(Xn,{className:"mr-2 flex w-[22px] items-center stroke-1"}),c.jsx("span",{children:f("com_nav_change_picture")})]})})]}),c.jsxs(y_,{className:"w-11/12 max-w-sm",style:{borderRadius:"12px"},children:[c.jsx(__,{children:c.jsx(w_,{className:"text-lg font-medium leading-6 text-text-primary",children:f(null!=d?"com_ui_preview":"com_ui_upload_image")})}),c.jsx("div",{className:"flex flex-col items-center justify-center",children:null!=d?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"relative overflow-hidden rounded-full",children:c.jsx(ea,{ref:o,image:d,width:250,height:250,border:0,borderRadius:125,color:[255,255,255,.6],scale:t,rotate:s})}),c.jsxs("div",{className:"mt-4 flex w-full flex-col items-center space-y-4",children:[c.jsxs("div",{className:"flex w-full items-center justify-center space-x-4",children:[c.jsx("span",{className:"text-sm",children:f("com_ui_zoom")}),c.jsx(C_,{value:[t],min:1,max:5,step:.001,onValueChange:e=>{a(e[0])},className:"w-2/3 max-w-xs"})]}),c.jsx("button",{onClick:()=>{r((e=>(e+90)%360))},className:"rounded-full bg-gray-200 p-2 transition-colors hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500",children:c.jsx(nn,{className:"h-5 w-5"})})]}),c.jsxs(By,{className:rm("btn btn-primary mt-4 flex w-full hover:bg-green-600",v?"cursor-not-allowed opacity-90":""),onClick:()=>{if(o.current){o.current.getImageScaledToCanvas().toBlob((e=>{if(e){const t=new FormData;t.append("file",e,"avatar.png"),t.append("manual","true"),h(t)}}),"image/png")}},disabled:v,children:[v?c.jsx(Hb,{className:"icon-sm mr-2"}):c.jsx(ta,{className:"mr-2 h-5 w-5"}),f("com_ui_upload")]})]}):c.jsxs("div",{className:"flex h-64 w-11/12 flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-transparent dark:border-gray-600",onDrop:y,onDragOver:_,children:[c.jsx(Xn,{className:"mb-4 size-12 text-gray-400"}),c.jsx("p",{className:"mb-2 text-center text-sm text-gray-500 dark:text-gray-400",children:f("com_ui_drag_drop")}),c.jsx(By,{variant:"secondary",onClick:()=>{var e;null==(e=i.current)||e.click()},children:f("com_ui_select_file")}),c.jsx("input",{ref:i,type:"file",className:"hidden",accept:".png, .jpg, .jpeg",onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];b(n)}})]})})]})]})}const DI={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2}},FI=({backupCodes:e,onDownload:t,downloaded:n,onNext:a})=>{const s=kg();return c.jsxs(vr.div,{...DI,className:"space-y-6",children:[c.jsx(g_,{className:"break-keep text-sm",children:s("com_ui_download_backup_tooltip")}),c.jsx("div",{className:"grid grid-cols-2 gap-4 rounded-xl bg-surface-secondary p-6",children:e.map(((e,t)=>c.jsx(vr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"rounded-lg bg-surface-tertiary p-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"hidden text-sm text-text-secondary sm:inline",children:["#",t+1]}),c.jsx("span",{className:"font-mono text-lg",children:e})]})},e)))}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs(By,{variant:"outline",onClick:t,className:"flex-1 gap-2",children:[c.jsx(gn,{className:"h-4 w-4"}),c.jsx("span",{className:"hidden sm:inline",children:s("com_ui_download_backup")})]}),c.jsx(By,{onClick:a,disabled:!n,className:"flex-1",children:s("com_ui_complete_setup")})]})]})},zI={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2}},UI=({secret:e,otpauthUrl:t,onNext:a})=>{const s=kg(),[r,o]=n.useState(!1);return c.jsxs(vr.div,{...zI,className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[c.jsx(vr.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"rounded-2xl bg-white p-4 shadow-lg",children:c.jsx(sn,{value:t,size:240})}),c.jsxs("div",{className:"w-full space-y-3",children:[c.jsx(g_,{className:"text-sm font-medium text-text-secondary",children:s("com_ui_secret_key")}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx(m_,{value:e,readOnly:!0,className:"font-mono text-lg tracking-wider"}),c.jsx(By,{size:"sm",variant:"outline",onClick:async()=>{await navigator.clipboard.writeText(e),o(!0),setTimeout((()=>o(!1)),2e3)},className:rm("h-auto shrink-0",r?"cursor-default":""),children:r?c.jsx(xe,{className:"size-4"}):c.jsx(on,{className:"size-4"})})]})]})]}),c.jsx(By,{onClick:a,className:"w-full",children:s("com_ui_continue")})]})},VI={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2}},BI=({token:e,onTokenChange:t,isVerifying:n,onNext:a})=>{const s=kg();return c.jsxs(vr.div,{...VI,className:"space-y-8",children:[c.jsx("div",{className:"flex justify-center",children:c.jsxs(V_,{value:e,onChange:t,maxLength:6,pattern:nt,className:"gap-2",children:[c.jsx(B_,{children:Array.from({length:3}).map(((e,t)=>c.jsx($_,{index:t},t)))}),c.jsx(H_,{}),c.jsx(B_,{children:Array.from({length:3}).map(((e,t)=>c.jsx($_,{index:t+3},t+3)))})]})}),c.jsx(By,{onClick:a,disabled:n||6!==e.length,className:"w-full",children:s("com_ui_verify")})]})},$I={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2}},HI=({isGenerating:e,onGenerate:t,onNext:n})=>{const a=kg();return c.jsx(vr.div,{...$I,className:"space-y-6",children:c.jsxs("div",{className:"rounded-xl bg-surface-secondary p-6",children:[c.jsx("h3",{className:"mb-4 flex justify-center text-lg font-medium",children:a("com_ui_2fa_account_security")}),c.jsxs(By,{variant:"default",onClick:t,className:"flex w-full",disabled:e,children:[e?c.jsx(Hb,{className:"size-5"}):c.jsx(an,{className:"size-5"}),a(e?"com_ui_generating":"com_ui_generate_qrcode")]})]})})},GI={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2}},KI=({onDisable:e,isDisabling:t})=>{const a=kg(),[s,r]=n.useState(""),[o,i]=n.useState(!1);return c.jsxs(vr.div,{...GI,className:"space-y-8",children:[c.jsx("div",{className:"flex justify-center",children:c.jsx(V_,{value:s,onChange:r,maxLength:o?8:6,pattern:o?at:nt,className:"gap-2",children:o?c.jsxs(B_,{children:[c.jsx($_,{index:0}),c.jsx($_,{index:1}),c.jsx($_,{index:2}),c.jsx($_,{index:3}),c.jsx($_,{index:4}),c.jsx($_,{index:5}),c.jsx($_,{index:6}),c.jsx($_,{index:7})]}):c.jsxs(c.Fragment,{children:[c.jsxs(B_,{children:[c.jsx($_,{index:0}),c.jsx($_,{index:1}),c.jsx($_,{index:2})]}),c.jsx(H_,{}),c.jsxs(B_,{children:[c.jsx($_,{index:3}),c.jsx($_,{index:4}),c.jsx($_,{index:5})]})]})})}),c.jsxs(By,{variant:"destructive",onClick:()=>e(s,o),disabled:t||s.length!==(o?8:6),className:"w-full rounded-xl px-6 py-3 transition-all disabled:opacity-50",children:[!0===t&&c.jsx(Hb,{className:"mr-2"}),a(t?"com_ui_disabling":"com_ui_2fa_disable")]}),c.jsx("button",{onClick:()=>i(!o),className:"text-sm text-primary hover:underline",children:a(o?"com_ui_use_2fa_code":"com_ui_use_backup_code")})]})},WI=({enabled:e,onChange:t,disabled:n})=>{const a=kg();return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs(g_,{className:"font-light",children:[" ",a("com_nav_2fa")]})}),c.jsx("div",{className:"flex items-center gap-3",children:c.jsx(By,{variant:e?"destructive":"outline",onClick:t,disabled:n,children:a(e?"com_ui_2fa_disable":"com_ui_2fa_enable")})})]})},QI={initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1,transition:{duration:.3,ease:"easeOut"}},exit:{opacity:0,scale:.95,transition:{duration:.3,ease:"easeIn"}}},qI=_.memo((()=>{const e=kg(),{user:t}=Wh(),a=R(_p.user),{showToast:s}=Ng(),[r,o]=n.useState(""),[i,l]=n.useState(""),[d,u]=n.useState(!1),[m,p]=n.useState(""),[g,f]=n.useState([]),[x,h]=n.useState(!1),[v,b]=n.useState(""),[y,_]=n.useState(Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0?"disable":"setup"),{mutate:j}=(()=>{const e=ar();return sr((e=>zd.confirmTwoFactor(e)),{onSuccess:t=>{e.setQueryData([Xc.user,"2fa"],t)}})})(),{mutate:w,isLoading:N}=(()=>{const e=ar();return sr((()=>zd.enableTwoFactor()),{onSuccess:t=>{e.setQueryData([Xc.user,"2fa"],t)}})})(),{mutate:C,isLoading:k}=(()=>{const e=ar();return sr((e=>zd.verifyTwoFactor(e)),{onSuccess:t=>{e.setQueryData([Xc.user,"2fa"],t)}})})(),{mutate:S,isLoading:T}=(()=>{const e=ar();return sr((()=>zd.disableTwoFactor()),{onSuccess:t=>{e.setQueryData([Xc.user,"2fa"],null)}})})(),I=["Setup","Scan QR","Verify","Backup"],E={setup:"Setup",qr:"Scan QR",verify:"Verify",backup:"Backup",disable:""},P=I.indexOf(E[y]),L=n.useCallback((()=>{Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0&&i&&S(void 0,{onError:()=>s({message:e("com_ui_2fa_disable_error"),status:"error"})}),l(""),o(""),f([]),b(""),p(""),_(Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0?"disable":"setup"),u(!1)}),[t,i,S,e,s]),M=n.useCallback((()=>{w(void 0,{onSuccess:({otpauthUrl:e,backupCodes:t})=>{l(e),o(e.split("secret=")[1].split("&")[0]),f(t),_("qr")},onError:()=>s({message:e("com_ui_2fa_generate_error"),status:"error"})})}),[w,e,s]),A=n.useCallback((()=>{v&&C({token:v},{onSuccess:()=>{s({message:e("com_ui_2fa_verified")}),j({token:v},{onSuccess:()=>_("backup"),onError:()=>s({message:e("com_ui_2fa_invalid"),status:"error"})})},onError:()=>s({message:e("com_ui_2fa_invalid"),status:"error"})})}),[v,C,j,e,s]),O=n.useCallback((()=>{if(!g.length)return;const e=new Blob([g.join("\n")],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="backup-codes.txt",n.click(),URL.revokeObjectURL(t),u(!0)}),[g]),D=n.useCallback((()=>{h(!1),_("disable"),s({message:e("com_ui_2fa_enabled")}),a((e=>({...e,backupCodes:g.map((e=>({code:e,codeHash:e,used:!1,usedAt:null})))})))}),[a,e,s,g]),F=n.useCallback(((t,n)=>{if(!n&&t.trim().length<6)return;if(n&&t.trim().length<8)return;const r={};n?r.backupCode=t.trim():r.token=t.trim(),C(r,{onSuccess:()=>{S(void 0,{onSuccess:()=>{s({message:e("com_ui_2fa_disabled")}),h(!1),a((e=>({...e,totpSecret:"",backupCodes:[]}))),_("setup"),l("")},onError:()=>s({message:e("com_ui_2fa_disable_error"),status:"error"})})},onError:()=>s({message:e("com_ui_2fa_invalid"),status:"error"})})}),[m,C,S,s,e,a]);return c.jsxs(f_,{open:x,onOpenChange:e=>{h(e),e||L()},children:[c.jsx(WI,{enabled:Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0,onChange:()=>h(!0),disabled:k||T||N}),c.jsx(y_,{className:"w-11/12 max-w-lg p-6",children:c.jsx(hr,{mode:"wait",children:c.jsxs(vr.div,{variants:QI,initial:"initial",animate:"animate",exit:"exit",className:"space-y-6",children:[c.jsxs(__,{children:[c.jsxs(w_,{className:"mb-2 flex items-center gap-3 text-2xl font-bold",children:[c.jsx(na,{className:"h-6 w-6 text-primary"}),Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0?e("com_ui_2fa_disable"):e("com_ui_2fa_setup")]}),Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0&&"disable"!==y&&c.jsxs("div",{className:"mt-4 space-y-3",children:[c.jsx(U_,{value:I.indexOf(E[y])/(I.length-1)*100,className:"h-2 rounded-full"}),c.jsx("div",{className:"flex justify-between text-sm",children:I.map(((e,t)=>c.jsx(vr.span,{animate:{color:P>=t?"var(--text-primary)":"var(--text-tertiary)"},className:"font-medium",children:e},e)))})]})]}),c.jsxs(hr,{mode:"wait",children:["setup"===y&&c.jsx(HI,{isGenerating:N,onGenerate:M,onNext:()=>_("qr"),onError:e=>s({message:e.message,status:"error"})}),"qr"===y&&c.jsx(UI,{secret:r,otpauthUrl:i,onNext:()=>_("verify"),onError:e=>s({message:e.message,status:"error"})}),"verify"===y&&c.jsx(BI,{token:v,onTokenChange:b,isVerifying:k,onNext:A,onError:e=>s({message:e.message,status:"error"})}),"backup"===y&&c.jsx(FI,{backupCodes:g,onDownload:O,downloaded:d,onNext:D,onError:e=>s({message:e.message,status:"error"})}),"disable"===y&&c.jsx(KI,{onDisable:F,isDisabling:T,onError:e=>s({message:e.message,status:"error"})})]})]},y)})})]})})),ZI=_.memo((()=>{const e=kg(),{user:t}=Wh(),{showToast:a}=Ng(),s=R(_p.user),[r,o]=n.useState(!1),{mutate:i,isLoading:l}=(()=>{const e=ar();return sr((()=>zd.regenerateBackupCodes()),{onSuccess:t=>{e.setQueryData([Xc.user,"2fa","backup"],t)}})})(),d=()=>{((t=!1)=>{i(void 0,{onSuccess:n=>{const r=n.backupCodesHash.map((e=>({codeHash:e,used:!1,usedAt:null})));if(s((e=>({...e,backupCodes:r}))),a({message:e("com_ui_backup_codes_regenerated"),status:"success"}),!t&&r.length){const e=n.backupCodes.join("\n"),t=new Blob([e],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="backup-codes.txt",s.click(),URL.revokeObjectURL(a)}},onError:()=>a({message:e("com_ui_backup_codes_regenerate_error"),status:"error"})})})(!1)};return c.jsxs(f_,{open:r,onOpenChange:o,children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx(g_,{className:"font-light",children:e("com_ui_backup_codes")})}),c.jsx(x_,{asChild:!0,children:c.jsx(By,{"aria-label":"Show Backup Codes",variant:"outline",children:e("com_ui_show")})})]}),c.jsxs(y_,{className:"w-11/12 max-w-lg",children:[c.jsx(w_,{className:"mb-6 text-2xl font-semibold",children:e("com_ui_backup_codes")}),c.jsx(hr,{children:c.jsx(vr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mt-4",children:Array.isArray(null==t?void 0:t.backupCodes)&&(null==t?void 0:t.backupCodes.length)>0?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-2 gap-4",children:null==t?void 0:t.backupCodes.map(((t,n)=>{const a=t.used,s=`Backup code number ${n+1}, ${a?`used on ${t.usedAt?new Date(t.usedAt).toLocaleDateString():"an unknown date"}`:"not used yet"}`;return c.jsx(vr.div,{role:"listitem",tabIndex:0,"aria-label":s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*n},onFocus:()=>{const e=new CustomEvent("announce",{detail:{message:s}});document.dispatchEvent(e)},className:`flex flex-col rounded-xl border p-4 backdrop-blur-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary ${a?"border-red-200 bg-red-50/80 dark:border-red-800 dark:bg-red-900/20":"border-green-200 bg-green-50/80 dark:border-green-800 dark:bg-green-900/20"} `,children:c.jsxs("div",{className:"flex items-center justify-between","aria-hidden":"true",children:[c.jsxs("span",{className:"text-sm font-medium text-text-secondary",children:["#",n+1]}),c.jsx(z_,{description:t.usedAt?new Date(t.usedAt).toLocaleDateString():"",disabled:!a,focusable:!1,className:a?"cursor-pointer":"cursor-default",render:c.jsx("span",{className:"rounded-full px-3 py-1 text-sm font-medium "+(a?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300":"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300"),children:e(a?"com_ui_used":"com_ui_not_used")})})]})},t.codeHash)}))}),c.jsx("div",{className:"mt-12 flex justify-center",children:c.jsxs(By,{onClick:d,disabled:l,variant:"default",className:"px-8 py-3 transition-all disabled:opacity-50",children:[l?c.jsx(Hb,{className:"mr-2"}):c.jsx(aa,{className:"mr-2 h-4 w-4"}),e(l?"com_ui_regenerating":"com_ui_regenerate_backup")]})})]}):c.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 text-center",children:[c.jsx(sa,{className:"h-12 w-12 text-text-primary"}),c.jsx("p",{className:"text-lg text-text-secondary",children:e("com_ui_no_backup_codes")}),c.jsxs(By,{onClick:d,disabled:l,variant:"default",className:"px-8 py-3 transition-all disabled:opacity-50",children:[l&&c.jsx(Hb,{className:"mr-2"}),e("com_ui_generate_backup")]})]})})})]})]})}));const YI=_.memo((function(){var e,t,n;const a=Wh();return c.jsxs("div",{className:"flex flex-col gap-3 p-1 text-sm text-text-primary",children:[c.jsx("div",{className:"pb-3",children:c.jsx(PI,{})}),c.jsx("div",{className:"pb-3",children:c.jsx(OI,{})}),"local"===(null==(e=null==a?void 0:a.user)?void 0:e.provider)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"pb-3",children:c.jsx(qI,{})}),Array.isArray(null==(t=a.user)?void 0:t.backupCodes)&&(null==(n=a.user)?void 0:n.backupCodes.length)>0&&c.jsx("div",{className:"pb-3",children:c.jsx(ZI,{})})]}),c.jsx("div",{className:"pb-3",children:c.jsx(LI,{})})]})}));function JI({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.cloudBrowserVoices),[s]=T(_p.textToSpeech);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_enable_cloud_browser_voice")}),c.jsx(R_,{id:"CloudBrowserVoices",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"CloudBrowserVoices",disabled:!s})]})}function XI({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.automaticPlayback);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_automatic_playback")}),c.jsx(R_,{id:"AutomaticPlayback",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"AutomaticPlayback"})]})}function eE({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.textToSpeech);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("strong",{children:t("com_nav_text_to_speech")})}),c.jsx(R_,{id:"TextToSpeech",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"TextToSpeech"})]})}const tE=({external:e})=>{const t=kg(),[n,a]=T(_p.engineTTS),s=e?[{value:"browser",label:t("com_nav_browser")},{value:"edge",label:t("com_nav_edge")},{value:"external",label:t("com_nav_external")}]:[{value:"browser",label:t("com_nav_browser")},{value:"edge",label:t("com_nav_edge")}];return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_engine")}),c.jsx(q_,{value:n,onChange:e=>{a(e)},options:s,sizeClasses:"w-[180px]",anchor:"bottom start",testId:"EngineTTSDropdown"})]})};function nE({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.cacheTTS),[s]=T(_p.textToSpeech);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_enable_cache_tts")}),c.jsx(R_,{id:"CacheTTS",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"CacheTTS",disabled:!s})]})}const aE={[Ur.edge]:function(){const e=kg(),{voices:t=[]}=Eg(),[n,a]=T(_p.voice);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_voice_select")}),c.jsx(q_,{value:n??"",options:t,onChange:e=>{om.log("Edge Voice changed:",e);const t="string"==typeof e?e:null==e?void 0:e.value;if(null!=t)return a(t.toString())},sizeClasses:"min-w-[200px] !max-w-[400px] [--anchor-max-width:400px]",testId:"EdgeVoiceDropdown"},`edge-voice-dropdown-${t.length}`)]})},[Ur.browser]:function(){const e=kg(),{voices:t=[]}=Ig(),[n,a]=T(_p.voice);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_voice_select")}),c.jsx(q_,{value:n??"",options:t,onChange:e=>{om.log("Browser Voice changed:",e);const t="string"==typeof e?e:null==e?void 0:e.value;if(null!=t)return a(t.toString())},sizeClasses:"min-w-[200px] !max-w-[400px] [--anchor-max-width:400px]",testId:"BrowserVoiceDropdown"},`browser-voice-dropdown-${t.length}`)]})},[Ur.external]:function(){const e=kg(),{voices:t=[]}=Rg(),[n,a]=T(_p.voice);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_voice_select")}),c.jsx(q_,{value:n??"",options:t,onChange:e=>{om.log("External Voice changed:",e);const t="string"==typeof e?e:null==e?void 0:e.value;if(null!=t)return a(t.toString())},sizeClasses:"min-w-[200px] !max-w-[400px] [--anchor-max-width:400px]",testId:"ExternalVoiceDropdown"},`external-voice-dropdown-${t.length}`)]})}};function sE(){const e=I(_p.engineTTS),t=aE[e];return c.jsx(t,{})}function rE(){const e=kg(),t=I(_p.textToSpeech),[n,a]=T(_p.playbackRate);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_playback_rate")}),c.jsx("div",{className:"w-2"}),c.jsxs("small",{className:"opacity-40",children:["(",e("com_endpoint_default_with_num",{0:"1"}),")"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(C_,{value:[n??1],onValueChange:e=>a(e[0]),onDoubleClick:()=>a(null),min:.1,max:2,step:.1,className:"ml-4 flex h-4 w-24",disabled:!t}),c.jsx("div",{className:"w-2"}),c.jsx(p_,{value:n??1,disabled:!t,onChange:e=>a(e?e[0]:0),min:.1,max:2,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]})]})}function oE(){const e=kg(),t=I(_p.speechToText),[n,a]=T(_p.autoSendText);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_auto_send_text")}),c.jsx("div",{className:"w-2"}),c.jsxs("small",{className:"opacity-40",children:["(",e("com_nav_auto_send_text_disabled"),")"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(C_,{value:[n??-1],onValueChange:e=>a(e[0]),onDoubleClick:()=>a(-1),min:-1,max:60,step:1,className:"ml-4 flex h-4 w-24",disabled:!t}),c.jsx("div",{className:"w-2"}),c.jsx(p_,{value:`${n} s`,disabled:!t,onChange:e=>a(e?e[0]:0),min:-1,max:60,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]})]})}function iE({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.speechToText);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("strong",{children:t("com_nav_speech_to_text")})}),c.jsx(R_,{id:"SpeechToText",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"SpeechToText"})]})}const lE=({external:e})=>{const t=kg(),[n,a]=T(_p.engineSTT),s=e?[{value:"browser",label:t("com_nav_browser")},{value:"external",label:t("com_nav_external")}]:[{value:"browser",label:t("com_nav_browser")}];return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_engine")}),c.jsx(q_,{value:n,onChange:e=>{a(e)},options:s,sizeClasses:"w-[180px]",testId:"EngineSTTDropdown"})]})};function cE(){const e=kg(),t=I(_p.speechToText),[n,a]=T(_p.decibelValue);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_db_sensitivity")}),c.jsx("div",{className:"w-2"}),c.jsxs("small",{className:"opacity-40",children:["(",e("com_endpoint_default_with_num",{0:"-45"}),")"]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(C_,{value:[n??-45],onValueChange:e=>a(e[0]),onDoubleClick:()=>a(-45),min:-100,max:-30,step:1,className:"ml-4 flex h-4 w-24",disabled:!t}),c.jsx("div",{className:"w-2"}),c.jsx(p_,{value:n,disabled:!t,onChange:e=>a(e?e[0]:0),min:-100,max:-30,className:rm(fm,rm(xm,"reset-rc-number-input reset-rc-number-input-text-right h-auto w-12 border-0 group-hover/temp:border-gray-200"))})]})]})}function dE({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.autoTranscribeAudio),s=I(_p.speechToText);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:t("com_nav_auto_transcribe_audio")}),c.jsx(R_,{id:"AutoTranscribeAudio",checked:n,onCheckedChange:t=>{a(t),e&&e(t)},className:"ml-4","data-testid":"AutoTranscribeAudio",disabled:!s})]})}function uE(){const e=kg(),[t,n]=T(_p.languageSTT);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:e("com_nav_language")}),c.jsx(q_,{value:t,onChange:e=>{n(e)},options:[{value:"af",label:"Afrikaans"},{value:"eu",label:"Basque"},{value:"bg",label:"Bulgarian"},{value:"ca",label:"Catalan"},{value:"ar-EG",label:"Arabic (Egypt)"},{value:"ar-JO",label:"Arabic (Jordan)"},{value:"ar-KW",label:"Arabic (Kuwait)"},{value:"ar-LB",label:"Arabic (Lebanon)"},{value:"ar-QA",label:"Arabic (Qatar)"},{value:"ar-AE",label:"Arabic (UAE)"},{value:"ar-MA",label:"Arabic (Morocco)"},{value:"ar-IQ",label:"Arabic (Iraq)"},{value:"ar-DZ",label:"Arabic (Algeria)"},{value:"ar-BH",label:"Arabic (Bahrain)"},{value:"ar-LY",label:"Arabic (Libya)"},{value:"ar-OM",label:"Arabic (Oman)"},{value:"ar-SA",label:"Arabic (Saudi Arabia)"},{value:"ar-TN",label:"Arabic (Tunisia)"},{value:"ar-YE",label:"Arabic (Yemen)"},{value:"cs",label:"Czech"},{value:"nl-NL",label:"Dutch"},{value:"en-AU",label:"English (Australia)"},{value:"en-CA",label:"English (Canada)"},{value:"en-IN",label:"English (India)"},{value:"en-NZ",label:"English (New Zealand)"},{value:"en-ZA",label:"English (South Africa)"},{value:"en-GB",label:"English (UK)"},{value:"en-US",label:"English (US)"},{value:"et-EE",label:"Estonian"},{value:"fi",label:"Finnish"},{value:"fr-FR",label:"French"},{value:"gl",label:"Galician"},{value:"de-DE",label:"German"},{value:"el-GR",label:"Greek"},{value:"he",label:"Hebrew"},{value:"hu",label:"Hungarian"},{value:"is",label:"Icelandic"},{value:"it-IT",label:"Italian"},{value:"id",label:"Indonesian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"la",label:"Latin"},{value:"lv-LV",label:"Latvian"},{value:"lt-LT",label:"Lithuanian"},{value:"zh-CN",label:"Mandarin Chinese"},{value:"zh-TW",label:"Taiwanese"},{value:"zh-HK",label:"Cantonese"},{value:"ms-MY",label:"Malaysian"},{value:"no-NO",label:"Norwegian"},{value:"pl",label:"Polish"},{value:"xx-piglatin",label:"Pig Latin"},{value:"pt-PT",label:"Portuguese"},{value:"pt-br",label:"Portuguese (Brasil)"},{value:"ro-RO",label:"Romanian"},{value:"ru",label:"Russian"},{value:"sr-SP",label:"Serbian"},{value:"sk",label:"Slovak"},{value:"es-AR",label:"Spanish (Argentina)"},{value:"es-BO",label:"Spanish (Bolivia)"},{value:"es-CL",label:"Spanish (Chile)"},{value:"es-CO",label:"Spanish (Colombia)"},{value:"es-CR",label:"Spanish (Costa Rica)"},{value:"es-DO",label:"Spanish (Dominican Republic)"},{value:"es-EC",label:"Spanish (Ecuador)"},{value:"es-SV",label:"Spanish (El Salvador)"},{value:"es-GT",label:"Spanish (Guatemala)"},{value:"es-HN",label:"Spanish (Honduras)"},{value:"es-MX",label:"Spanish (Mexico)"},{value:"es-NI",label:"Spanish (Nicaragua)"},{value:"es-PA",label:"Spanish (Panama)"},{value:"es-PY",label:"Spanish (Paraguay)"},{value:"es-PE",label:"Spanish (Peru)"},{value:"es-PR",label:"Spanish (Puerto Rico)"},{value:"es-ES",label:"Spanish (Spain)"},{value:"es-US",label:"Spanish (US)"},{value:"es-UY",label:"Spanish (Uruguay)"},{value:"es-VE",label:"Spanish (Venezuela)"},{value:"sv-SE",label:"Swedish"},{value:"tr",label:"Turkish"},{value:"zu",label:"Zulu"}],sizeClasses:"[--anchor-max-height:256px]",anchor:"bottom start",testId:"LanguageSTTDropdown"})]})}function mE({onCheckedChange:e}){const t=kg(),[n,a]=T(_p.conversationMode),s=I(_p.speechToText),r=I(_p.textToSpeech),[,o]=T(_p.autoSendText),[,i]=T(_p.decibelValue),[,l]=T(_p.autoTranscribeAudio);return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("strong",{children:t("com_nav_conversation_mode")})}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsx(R_,{id:"ConversationMode",checked:n,onCheckedChange:t=>{l(t),o(3),i(-45),a(t),e&&e(t)},className:"ml-4","data-testid":"ConversationMode",disabled:!r||!s})})]})}const pE=_.memo((function(){const[e,t]=n.useState(!1),{data:a}=function(e){return nr([ah.customConfigSpeech],(function(){return nh.get("".concat("".concat("/api/files","/speech"),"/config/get"))}),$g({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},e))}(),s=Ib("(max-width: 767px)"),[r,o]=n.useState(!1),[i,l]=n.useState(!1),[d,u]=T(_p.advancedMode),[m,p]=T(_p.autoTranscribeAudio),[g,f]=T(_p.conversationMode),[x,h]=T(_p.speechToText),[v,b]=T(_p.textToSpeech),[y,_]=T(_p.cacheTTS),[j,w]=T(_p.engineSTT),[N,C]=T(_p.languageSTT),[k,S]=T(_p.decibelValue),[R,I]=T(_p.autoSendText),[E,P]=T(_p.engineTTS),[L,M]=T(_p.voice),[A,O]=T(_p.cloudBrowserVoices),[D,F]=T(_p.languageTTS),[z,U]=T(_p.automaticPlayback),[V,B]=T(_p.playbackRate),$=n.useCallback(((e,t)=>{const n={sttExternal:{value:r,setFunc:o},ttsExternal:{value:i,setFunc:l},conversationMode:{value:g,setFunc:f},advancedMode:{value:d,setFunc:u},speechToText:{value:x,setFunc:h},textToSpeech:{value:v,setFunc:b},cacheTTS:{value:y,setFunc:_},engineSTT:{value:j,setFunc:w},languageSTT:{value:N,setFunc:C},autoTranscribeAudio:{value:m,setFunc:p},decibelValue:{value:k,setFunc:S},autoSendText:{value:R,setFunc:I},engineTTS:{value:E,setFunc:P},voice:{value:L,setFunc:M},cloudBrowserVoices:{value:A,setFunc:O},languageTTS:{value:D,setFunc:F},automaticPlayback:{value:z,setFunc:U},playbackRate:{value:V,setFunc:B}};if((n[e].value!==t||n[e].value===t||!n[e])&&"sttExternal"===n[e].value&&"ttsExternal"===n[e].value)return;n[e].setFunc(t)}),[r,i,g,d,x,v,y,j,N,m,k,R,E,L,A,D,z,V,o,l,f,u,h,b,_,w,C,p,S,I,P,M,O,F,U,B]);return n.useEffect((()=>{a&&"not_found"!==a.message&&Object.entries(a).forEach((([e,t])=>{$(e,t)}))}),[a]),om.log({sttExternal:r,ttsExternal:i}),Pb(n.useRef(null),(()=>e&&t(!1)),[]),c.jsxs(zs,{defaultValue:"simple",orientation:"horizontal",value:d?"advanced":"simple",children:[c.jsx("div",{className:"sticky -top-1 z-50 mb-4 bg-white dark:bg-gray-700",children:c.jsxs(ps,{className:"flex justify-center bg-background",children:[c.jsxs(gs,{onClick:()=>u(!1),className:rm("group m-1 flex items-center justify-center gap-2 bg-transparent px-4 py-2 text-sm text-text-secondary transition-all duration-200 ease-in-out radix-state-active:bg-secondary radix-state-active:text-foreground radix-state-active:shadow-lg",s?"flex-row rounded-lg":"rounded-xl","w-full"),value:"simple",style:{userSelect:"none"},children:[c.jsx(le,{}),"Simple"]}),c.jsxs(gs,{onClick:()=>u(!0),className:rm("group m-1 flex items-center justify-center gap-2 bg-transparent px-4 py-2 text-sm text-text-secondary transition-all duration-200 ease-in-out radix-state-active:bg-secondary radix-state-active:text-foreground radix-state-active:shadow-lg",s?"flex-row rounded-lg":"rounded-xl","w-full"),value:"advanced",style:{userSelect:"none"},children:[c.jsx(ra,{}),"Advanced"]})]})}),c.jsx(fs,{value:"simple",children:c.jsxs("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:[c.jsx(iE,{}),c.jsx(lE,{external:r}),c.jsx(uE,{}),c.jsx("div",{className:"h-px bg-border-medium",role:"none"}),c.jsx(eE,{}),c.jsx(tE,{external:i}),c.jsx(sE,{})]})}),c.jsx(fs,{value:"advanced",children:c.jsxs("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:[c.jsx(mE,{}),c.jsx("div",{className:"mt-2 h-px bg-border-medium",role:"none"}),c.jsx(iE,{}),c.jsx(lE,{external:r}),c.jsx(uE,{}),c.jsx("div",{className:"pb-2",children:c.jsx(dE,{})}),m&&c.jsx("div",{className:"pb-2",children:c.jsx(cE,{})}),c.jsx("div",{className:"pb-2",children:c.jsx(oE,{})}),c.jsx("div",{className:"h-px bg-border-medium",role:"none"}),c.jsx("div",{className:"pb-3",children:c.jsx(eE,{})}),c.jsx(XI,{}),c.jsx(tE,{external:i}),c.jsx(sE,{}),"browser"===E&&c.jsx("div",{className:"pb-2",children:c.jsx(JI,{})}),c.jsx("div",{className:"pb-2",children:c.jsx(rE,{})}),c.jsx(nE,{})]})})]})}));function gE({setNavVisible:e}){const t=kg(),n=ar(),{newConversation:a}=Qh(),s=I(_p.conversationByIndex(0)),{title:r="New Chat"}=s||{};return c.jsxs("div",{className:"bg-token-main-surface-primary sticky top-0 z-10 flex min-h-[40px] items-center justify-center bg-white pl-1 dark:bg-gray-800 dark:text-white md:hidden",children:[c.jsxs("button",{type:"button","data-testid":"mobile-header-new-chat-button","aria-label":t("com_nav_open_sidebar"),className:"m-1 inline-flex size-10 items-center justify-center rounded-full hover:bg-surface-hover",onClick:()=>e((e=>(localStorage.setItem("navVisible",JSON.stringify(!e)),!e))),children:[c.jsx("span",{className:"sr-only",children:t("com_nav_open_sidebar")}),c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 8C3 7.44772 3.44772 7 4 7H20C20.5523 7 21 7.44772 21 8C21 8.55228 20.5523 9 20 9H4C3.44772 9 3 8.55228 3 8ZM3 16C3 15.4477 3.44772 15 4 15H14C14.5523 15 15 15.4477 15 16C15 16.5523 14.5523 17 14 17H4C3.44772 17 3 16.5523 3 16Z",fill:"currentColor"})})]}),c.jsx("h1",{className:"flex-1 overflow-hidden text-ellipsis whitespace-nowrap text-center text-sm font-normal",children:r??t("com_ui_new_chat")}),c.jsx("button",{type:"button","aria-label":t("com_ui_new_chat"),className:"m-1 inline-flex size-10 items-center justify-center rounded-full hover:bg-surface-hover",onClick:()=>{n.setQueryData([Xc.messages,(null==s?void 0:s.conversationId)??dc.NEW_CONVO],[]),a()},children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7929 2.79289C18.0118 1.57394 19.9882 1.57394 21.2071 2.79289C22.4261 4.01184 22.4261 5.98815 21.2071 7.20711L12.7071 15.7071C12.5196 15.8946 12.2652 16 12 16H9C8.44772 16 8 15.5523 8 15V12C8 11.7348 8.10536 11.4804 8.29289 11.2929L16.7929 2.79289ZM19.7929 4.20711C19.355 3.7692 18.645 3.7692 18.2071 4.2071L10 12.4142V14H11.5858L19.7929 5.79289C20.2308 5.35499 20.2308 4.64501 19.7929 4.20711ZM6 5C5.44772 5 5 5.44771 5 6V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V14C19 13.4477 19.4477 13 20 13C20.5523 13 21 13.4477 21 14V18C21 19.6569 19.6569 21 18 21H6C4.34315 21 3 19.6569 3 18V6C3 4.34314 4.34315 3 6 3H10C10.5523 3 11 3.44771 11 4C11 4.55228 10.5523 5 10 5H6Z",fill:"currentColor"})})})]})}const fE=({conversation:e,tags:t=[],setTags:a})=>{const[s,r]=n.useState(),{bookmarks:o}=mv(),i=kg();n.useEffect((()=>{s||r(e)}),[e,s]);const l=()=>{a([])};return 0===o.length?c.jsxs("div",{className:"flex flex-col",children:[c.jsx(gT,{tag:i("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:l,selected:!1,icon:c.jsx(Zs,{className:"size-4"})}),c.jsx(gT,{tag:i("com_ui_no_bookmarks"),"data-testid":"bookmark-item-no-bookmarks",handleSubmit:()=>Promise.resolve(),selected:!1,icon:"🤔"})]}):c.jsx("div",{className:"flex flex-col",children:c.jsx(fT,{tags:t,handleSubmit:e=>{if(void 0===e)return;const n=(e=>t.some((t=>t===e))?t.filter((t=>t!==e)):[...t,e])(e);a(n)},header:c.jsx(gT,{tag:i("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:l,selected:!1,icon:c.jsx(Zs,{className:"size-4"})})})})},xE=({tags:e,setTags:t,isSmallScreen:n})=>{const a=kg(),{data:s}=nr([Xc.conversationTags],(()=>zd.getConversationTags()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...r});var r;const o=I(_p.conversationByIndex(0));return c.jsx(Lr,{as:"div",className:"group relative",children:({open:r})=>c.jsxs(c.Fragment,{children:[c.jsxs(Mr,{className:rm("mt-text-sm flex h-10 w-full items-center gap-2 rounded-lg p-2 text-sm transition-colors duration-200 hover:bg-surface-active-alt",r?"bg-surface-active-alt":"",n?"h-12":""),"data-testid":"bookmark-menu",children:[c.jsx("div",{className:"h-7 w-7 flex-shrink-0",children:c.jsx("div",{className:"relative flex h-full items-center justify-center rounded-full border border-border-medium bg-surface-primary-alt text-text-primary",children:e.length>0?c.jsx($s,{className:"h-4 w-4","aria-hidden":"true"}):c.jsx(Hs,{className:"h-4 w-4","aria-hidden":"true"})})}),c.jsx("div",{className:"grow overflow-hidden whitespace-nowrap text-left text-sm font-medium text-text-primary",children:e.length>0?e.join(", "):a("com_ui_bookmarks")})]}),c.jsx(Ar,{className:"absolute left-0 top-full z-[100] mt-1 w-full translate-y-0 overflow-hidden rounded-lg bg-surface-active-alt  p-1.5 shadow-lg outline-none",children:s&&o&&c.jsx(uv.Provider,{value:{bookmarks:s.filter((e=>e.count>0))},children:c.jsx(fE,{conversation:o,tags:e,setTags:t})})})]})})};function hE({column:e,title:t,className:n="",filters:a,valueMap:s}){const r=kg();return e.getCanSort()?c.jsx("div",{className:rm("flex items-center space-x-2",n),children:c.jsxs(Hy,{children:[c.jsx(Gy,{asChild:!0,children:c.jsxs(By,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover data-[state=open]:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",children:[c.jsx("span",{children:t}),e.getIsFiltered()?c.jsx(ot,{className:"icon-sm ml-2 text-muted-foreground/70"}):c.jsx(ot,{className:"icon-sm ml-2 opacity-30"}),(()=>{const t=e.getIsSorted();return"desc"===t?c.jsx(Ys,{className:"icon-sm ml-2"}):"asc"===t?c.jsx(Js,{className:"icon-sm ml-2"}):c.jsx(ys,{className:"icon-sm ml-2"})})()]})}),c.jsxs(Wy,{align:"start",className:"z-[1001] dark:border-gray-700 dark:bg-gray-850",children:[c.jsxs(Qy,{onClick:()=>e.toggleSorting(!1),className:"cursor-pointer text-text-primary",children:[c.jsx(Js,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),r("com_ui_ascending")]}),c.jsxs(Qy,{onClick:()=>e.toggleSorting(!0),className:"cursor-pointer text-text-primary",children:[c.jsx(Ys,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),r("com_ui_descending")]}),c.jsx(Zy,{className:"dark:bg-gray-500"}),a&&Object.entries(a).map((([t,n])=>n.map((n=>{const a=null==s?void 0:s[n??""],o=null!=a&&a.length?r(a):String(n);return o?c.jsxs(Qy,{className:"cursor-pointer text-text-primary",onClick:()=>{e.setFilterValue(n)},children:[c.jsx(ot,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),o]},`${t}-${n}`):null})))),a&&c.jsxs(Qy,{className:e.getIsFiltered()?"cursor-pointer dark:text-white dark:hover:bg-gray-800":"pointer-events-none opacity-30",onClick:()=>{e.setFilterValue(void 0)},children:[c.jsx(oa,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),r("com_ui_show_all")]})]})]})}):c.jsx("div",{className:rm(n),children:t})}const vE={[Yi.avatar]:"com_ui_avatar",[Yi.unknown]:"com_ui_unknown",[Yi.assistants]:"com_ui_assistants",[Yi.image_generation]:"com_ui_image_gen",[Yi.assistants_output]:"com_ui_assistants_output",[Yi.message_attachment]:"com_ui_attachment"},bE=[{id:"select",header:({table:e})=>c.jsx($y,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"flex"}),cell:({row:e})=>c.jsx($y,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),"aria-label":"Select row",className:"flex"}),enableSorting:!1,enableHiding:!1},{meta:{size:"150px"},accessorKey:"filename",header:({column:e})=>{const t=kg();return c.jsxs(By,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:[t("com_ui_name"),c.jsx(Ln,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:e})=>{const t=e.original;if(t.type.startsWith("image"))return c.jsxs("div",{className:"flex gap-2",children:[c.jsx($S,{url:t.filepath,className:"relative h-10 w-10 shrink-0 overflow-hidden rounded-md",source:t.source}),c.jsx("span",{className:"self-center truncate ",children:t.filename})]});const n=tu(t.type);return c.jsxs("div",{className:"flex gap-2",children:[n&&c.jsx(_N,{fileType:n,className:"relative",file:t}),c.jsx("span",{className:"self-center truncate",children:t.filename})]})}},{accessorKey:"updatedAt",header:({column:e})=>{const t=kg();return c.jsxs(By,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",children:[t("com_ui_date"),c.jsx(Ln,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:e})=>{var t;const n=Ib("(max-width: 768px)");return nu((null==(t=e.original.updatedAt)?void 0:t.toString())??"",n)}},{accessorKey:"filterSource",header:({column:e})=>{const t=kg();return c.jsx(hE,{column:e,title:t("com_ui_storage"),filters:{Storage:Object.values(ji).filter((e=>e===ji.local||e===ji.openai||e===ji.azure))},valueMap:{[ji.azure]:"com_ui_azure",[ji.openai]:"com_ui_openai",[ji.local]:"com_ui_host"}})},cell:({row:e})=>{const t=kg(),{source:n}=e.original;return n===ji.openai?c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(gy,{className:"icon-sm text-green-600/50"}),"OpenAI"]}):n===ji.azure?c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(py,{className:"icon-sm text-cyan-700"}),"Azure"]}):c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(ia,{className:"icon-sm text-cyan-700"}),t("com_ui_host")]})}},{accessorKey:"context",header:({column:e})=>{const t=kg();return c.jsx(hE,{column:e,title:t("com_ui_context"),filters:{Context:Object.values(Yi).filter((e=>e===Yi[e??""]))},valueMap:vE})},cell:({row:e})=>{const{context:t}=e.original,n=kg();return c.jsx("div",{className:"flex flex-wrap items-center gap-2",children:n(vE[t??Yi.unknown])})}},{accessorKey:"bytes",header:({column:e})=>{const t=kg();return c.jsxs(By,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:[t("com_ui_size"),c.jsx(Ln,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:e})=>{const t=Number((Number(e.original.bytes)/1024/1024).toFixed(2));return t<.01?"< 0.01 MB":`${t} MB`}}],yE={[Yi.filename]:"com_ui_name",[Yi.updatedAt]:"com_ui_date",[Yi.filterSource]:"com_ui_storage",[Yi.context]:"com_ui_context",[Yi.bytes]:"com_ui_size"};function _E({columns:e,data:t}){var a;const s=kg(),[r,o]=n.useState(!1),[i,l]=n.useState({}),[d,u]=n.useState([]),m=Ib("(max-width: 768px)"),[p,g]=n.useState([]),[f,x]=n.useState({}),{deleteFiles:h}=function(e){const t=ar(),n=Fp({onMutate:async e=>{const{files:t}=e;return t.length?{filesToDeleteMap:t.reduce(((e,t)=>(e.set(t.file_id,t),e)),new Map)}:new Map},onSuccess:(n,a,s)=>{console.log("Files deleted");const{filesToDeleteMap:r}=s;t.setQueryData([Xc.files],(e=>{const{files:t}=a;return t.length?null==e?void 0:e.filter((e=>!r.has(e.file_id))):e})),null==e||e()},onError:t=>{console.log("Error deleting files:",t),null==e||e()}});return Bv({mutateAsync:n.mutateAsync})}((()=>o(!1))),v=or({data:t,columns:e,onSortingChange:u,getCoreRowModel:lr(),getSortedRowModel:ur(),onColumnFiltersChange:g,getFilteredRowModel:dr(),onColumnVisibilityChange:x,getPaginationRowModel:cr(),onRowSelectionChange:l,state:{sorting:d,columnFilters:p,columnVisibility:f,rowSelection:i}});return c.jsxs("div",{className:"flex h-full flex-col gap-4",children:[c.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2 sm:gap-4 sm:py-4",children:[c.jsxs(By,{variant:"outline",onClick:()=>{o(!0);const e=v.getFilteredSelectedRowModel().rows.map((e=>e.original));h({files:e}),l({})},disabled:!v.getFilteredSelectedRowModel().rows.length||r,className:rm("min-w-[40px] transition-all duration-200",m&&"px-2 py-1"),children:[r?c.jsx(Hb,{className:"size-3.5 sm:size-4"}):c.jsx(uy,{className:"size-3.5 text-red-400 sm:size-4"}),!m&&c.jsx("span",{className:"ml-2",children:s("com_ui_delete")})]}),c.jsx(m_,{placeholder:s("com_files_filter"),value:(null==(a=v.getColumn("filename"))?void 0:a.getFilterValue())??"",onChange:e=>{var t;return null==(t=v.getColumn("filename"))?void 0:t.setFilterValue(e.target.value)},className:"flex-1 text-sm"}),c.jsxs(Hy,{children:[c.jsx(Gy,{asChild:!0,children:c.jsx(By,{variant:"outline",className:rm("min-w-[40px]",m&&"px-2 py-1"),children:c.jsx(ot,{className:"size-3.5 sm:size-4"})})}),c.jsx(Wy,{align:"end",className:"max-h-[300px] overflow-y-auto dark:border-gray-700 dark:bg-gray-850",children:v.getAllColumns().filter((e=>e.getCanHide())).map((e=>c.jsx(qy,{className:"cursor-pointer text-sm capitalize dark:text-white dark:hover:bg-gray-800",checked:e.getIsVisible(),onCheckedChange:t=>e.toggleVisibility(Boolean(t)),children:s(yE[e.id])},e.id)))})]})]}),c.jsx("div",{className:"relative grid h-full max-h-[calc(100vh-20rem)] w-full flex-1 overflow-hidden overflow-x-auto overflow-y-auto rounded-md border border-black/10 dark:border-white/10",children:c.jsxs(I_,{className:"w-full min-w-[300px] border-separate border-spacing-0",children:[c.jsx(E_,{className:"sticky top-0 z-50",children:v.getHeaderGroups().map((e=>c.jsx(L_,{className:"border-b border-border-light",children:e.headers.map(((e,t)=>{const n={};return 0===t&&"select"===e.id?(n.width="35px",n.minWidth="35px"):"filename"===e.id?n.width=m?"60%":"40%":n.width=m?"20%":"15%",c.jsx(M_,{className:"whitespace-nowrap bg-surface-secondary px-2 py-2 text-left text-sm font-medium text-text-secondary sm:px-4",style:{...n},children:e.isPlaceholder?null:ir(e.column.columnDef.header,e.getContext())},e.id)}))},e.id)))}),c.jsx(P_,{className:"w-full",children:v.getRowModel().rows.length?v.getRowModel().rows.map((e=>c.jsx(L_,{"data-state":e.getIsSelected()&&"selected",className:"border-b border-border-light transition-colors hover:bg-surface-secondary [tr:last-child_&]:border-b-0",children:e.getVisibleCells().map(((e,t)=>{var n;const a=(null==(n=e.column.columnDef.meta)?void 0:n.size)??"auto",s={};return"filename"===e.column.id?s.maxWidth=a:0===t&&(s.maxWidth="20px"),c.jsx(A_,{className:"align-start overflow-x-auto px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-sm [tr[data-disabled=true]_&]:opacity-50",style:s,children:ir(e.column.columnDef.cell,e.getContext())},e.id)}))},e.id))):c.jsx(L_,{children:c.jsx(A_,{colSpan:e.length,className:"h-24 text-center",children:s("com_files_no_results")})})})]})}),c.jsxs("div",{className:"flex items-center justify-end gap-2 py-4",children:[c.jsxs("div",{className:"ml-2 flex-1 truncate text-xs text-muted-foreground sm:ml-4 sm:text-sm",children:[c.jsx("span",{className:"hidden sm:inline",children:s("com_files_number_selected",{0:`${v.getFilteredSelectedRowModel().rows.length}`,1:`${v.getFilteredRowModel().rows.length}`})}),c.jsx("span",{className:"sm:hidden",children:`${v.getFilteredSelectedRowModel().rows.length}/${v.getFilteredRowModel().rows.length}`})]}),c.jsxs("div",{className:"flex items-center space-x-1 pr-2 text-xs font-bold text-text-primary sm:text-sm",children:[c.jsx("span",{className:"hidden sm:inline",children:s("com_ui_page")}),c.jsx("span",{children:v.getState().pagination.pageIndex+1}),c.jsx("span",{children:"/"}),c.jsx("span",{children:v.getPageCount()})]}),c.jsx(By,{className:"select-none",variant:"outline",size:"sm",onClick:()=>v.previousPage(),disabled:!v.getCanPreviousPage(),children:s("com_ui_prev")}),c.jsx(By,{className:"select-none",variant:"outline",size:"sm",onClick:()=>v.nextPage(),disabled:!v.getCanNextPage(),children:s("com_ui_next")})]})]})}function jE({open:e,onOpenChange:t}){const n=kg(),{data:a=[]}=Op({select:e=>e.map((e=>(e.context=e.context??Yi.unknown,e.filterSource=e.source===ji.firebase?ji.local:e.source,e)))});return c.jsx(f_,{open:e,onOpenChange:t,children:c.jsxs(y_,{title:n("com_nav_my_files"),className:"w-11/12 bg-background text-text-primary shadow-2xl",children:[c.jsx(__,{children:c.jsx(w_,{children:n("com_nav_my_files")})}),c.jsx(_E,{columns:bE,data:a})]})})}function wE({open:e,onOpenChange:t}){const a=Ib("(max-width: 767px)"),s=kg(),[r,o]=n.useState(ic.GENERAL),i=n.useRef({}),l=[{value:ic.GENERAL,icon:c.jsx(cy,{}),label:"com_nav_setting_general"},{value:ic.CHAT,icon:c.jsx(Yn,{className:"icon-sm"}),label:"com_nav_setting_chat"},{value:ic.BETA,icon:c.jsx(Ny,{}),label:"com_nav_setting_beta"},{value:ic.COMMANDS,icon:c.jsx(la,{className:"icon-sm"}),label:"com_nav_commands"},{value:ic.SPEECH,icon:c.jsx(Ty,{className:"icon-sm"}),label:"com_nav_setting_speech"},{value:ic.DATA,icon:c.jsx($b,{}),label:"com_nav_setting_data"},{value:ic.ACCOUNT,icon:c.jsx(jy,{}),label:"com_nav_setting_account"}];return c.jsx(jr,{appear:!0,show:e,children:c.jsxs(Cr,{as:"div",className:"relative z-50",onClose:t,children:[c.jsx(Or,{enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:c.jsx("div",{className:"fixed inset-0 bg-black opacity-50 dark:opacity-80","aria-hidden":"true"})}),c.jsx(Or,{enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:c.jsx("div",{className:rm("fixed inset-0 flex w-screen items-center justify-center p-4"),children:c.jsxs(kr,{className:rm("min-h-[600px] overflow-hidden rounded-xl rounded-b-lg bg-background pb-6 shadow-2xl backdrop-blur-2xl animate-in sm:rounded-2xl md:min-h-[373px] md:w-[680px]"),children:[c.jsxs(Sr,{className:"mb-1 flex items-center justify-between p-6 pb-5 text-left",as:"div",children:[c.jsx("h2",{className:"text-lg font-medium leading-6 text-text-primary",children:s("com_nav_settings")}),c.jsxs("button",{type:"button",className:"rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-border-xheavy focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-surface-primary dark:focus:ring-offset-surface-primary",onClick:()=>t(!1),children:[c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-text-primary",children:[c.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),c.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}),c.jsx("span",{className:"sr-only",children:"Close"})]})]}),c.jsx("div",{className:"max-h-[550px] overflow-auto px-6 md:max-h-[400px] md:min-h-[400px] md:w-[680px]",children:c.jsxs(zs,{value:r,onValueChange:e=>{o(e)},className:"flex flex-col gap-10 md:flex-row",orientation:"vertical",children:[c.jsx(ps,{"aria-label":"Settings",className:rm("min-w-auto max-w-auto relative -ml-[8px] flex flex-shrink-0 flex-col flex-nowrap overflow-auto sm:max-w-none",a?"flex-row rounded-xl bg-surface-secondary":"sticky top-0 h-full"),onKeyDown:e=>{const t=[ic.GENERAL,ic.CHAT,ic.BETA,ic.COMMANDS,ic.SPEECH,ic.DATA,ic.ACCOUNT],n=t.indexOf(r);switch(e.key){case"ArrowDown":e.preventDefault(),o(t[(n+1)%t.length]);break;case"ArrowUp":e.preventDefault(),o(t[(n-1+t.length)%t.length]);break;case"Home":e.preventDefault(),o(t[0]);break;case"End":e.preventDefault(),o(t[t.length-1])}},children:l.map((({value:e,icon:t,label:n})=>c.jsxs(gs,{className:rm("group relative z-10 m-1 flex items-center justify-start gap-2 px-2 py-1.5 transition-all duration-200 ease-in-out",a?"flex-1 justify-center text-nowrap rounded-xl p-1 px-3 text-sm text-text-secondary radix-state-active:bg-surface-hover radix-state-active:text-text-primary":"rounded-md bg-transparent text-text-primary radix-state-active:bg-surface-tertiary"),value:e,ref:t=>i.current[e]=t,children:[t,s(n)]},e)))}),c.jsxs("div",{className:"overflow-auto sm:w-full sm:max-w-none md:pr-0.5 md:pt-0.5",children:[c.jsx(fs,{value:ic.GENERAL,children:c.jsx(JR,{})}),c.jsx(fs,{value:ic.CHAT,children:c.jsx(uI,{})}),c.jsx(fs,{value:ic.BETA,children:c.jsx(SI,{})}),c.jsx(fs,{value:ic.COMMANDS,children:c.jsx(EI,{})}),c.jsx(fs,{value:ic.SPEECH,children:c.jsx(pE,{})}),c.jsx(fs,{value:ic.DATA,children:c.jsx(NI,{})}),c.jsx(fs,{value:ic.ACCOUNT,children:c.jsx(YI,{})})]})]})})]})})})]})})}ji.openai,ji.local,ji.local,ji.local;const NE=n.memo((function(){const e=kg(),{user:t,isAuthenticated:a,logout:s}=Wh(),{data:r}=Ap(),o=zp({enabled:!!a&&(null==r?void 0:r.checkBalance)}),[i,l]=n.useState(!1),[d,u]=T(_p.showFiles),m=rb(t),p=(null==t?void 0:t.avatar)??(null==t?void 0:t.username)??"";return c.jsxs(ca,{children:[c.jsxs(Oe,{"aria-label":e("com_nav_account_settings"),"data-testid":"nav-user",className:"mt-text-sm flex h-auto w-full items-center gap-2 rounded-xl p-2 text-sm transition-all duration-200 ease-in-out hover:bg-accent",children:[c.jsx("div",{className:"-ml-0.9 -mt-0.8 h-8 w-8 flex-shrink-0",children:c.jsx("div",{className:"relative flex",children:0===p.length?c.jsx("div",{style:{backgroundColor:"rgb(121, 137, 255)",width:"32px",height:"32px",boxShadow:"rgba(240, 246, 252, 0.1) 0px 0px 0px 1px"},className:"relative flex items-center justify-center rounded-full p-1 text-text-primary","aria-hidden":"true",children:c.jsx(jy,{})}):c.jsx("img",{className:"rounded-full",src:((null==t?void 0:t.avatar)??"")||m,alt:`${p}'s avatar`})})}),c.jsx("div",{className:"mt-2 grow overflow-hidden text-ellipsis whitespace-nowrap text-left text-text-primary",style:{marginTop:"0",marginLeft:"0"},children:(null==t?void 0:t.name)??(null==t?void 0:t.username)??e("com_nav_user")})]}),c.jsxs(Fe,{className:"popover-ui w-[235px]",style:{transformOrigin:"bottom",marginRight:"0px",translate:"0px"},children:[c.jsx("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:(null==t?void 0:t.email)??e("com_nav_user")}),c.jsx(Zy,{}),!0===(null==r?void 0:r.checkBalance)&&null!=o.data&&!isNaN(parseFloat(o.data))&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:[e("com_nav_balance"),": ",parseFloat(o.data).toFixed(2)]}),c.jsx(Zy,{})]}),c.jsxs(ze,{value:"",onClick:()=>u(!0),className:"select-item text-sm",children:[c.jsx(da,{className:"icon-md","aria-hidden":"true"}),e("com_nav_my_files")]}),"/"!==(null==r?void 0:r.helpAndFaqURL)&&c.jsxs(ze,{value:"",onClick:()=>window.open(null==r?void 0:r.helpAndFaqURL,"_blank"),className:"select-item text-sm",children:[c.jsx(ly,{"aria-hidden":"true"}),e("com_nav_help_faq")]}),c.jsxs(ze,{value:"",onClick:()=>l(!0),className:"select-item text-sm",children:[c.jsx(cy,{className:"icon-md","aria-hidden":"true"}),e("com_nav_settings")]}),c.jsx(Zy,{}),c.jsxs(ze,{"aria-selected":!0,onClick:()=>s(),value:"logout",className:"select-item text-sm",children:[c.jsx(ua,{className:"icon-md"}),e("com_nav_log_out")]})]}),d&&c.jsx(jE,{open:d,onOpenChange:u}),i&&c.jsx(wE,{open:i,onOpenChange:l})]})})),CE=n.forwardRef(((e,t)=>{const a=kg(),s=z(),r=ar(),{setPageNumber:o,isSmallScreen:i}=e,[l,d]=n.useState(""),[u,m]=n.useState(!1),{newConversation:p}=Qh(),g=_p.useClearConvoState(),f=R(_p.searchQuery),x=R(_p.isSearching),h=n.useCallback((()=>{o(1),s.pathname.includes("/search")&&p({disableFocus:!0})}),[p,o,s.pathname]),v=n.useCallback((()=>{m(!1),f(""),h(),d("")}),[f,h]),b=n.useCallback((e=>{f(e),e&&(r.invalidateQueries([Xc.messages]),g())}),[r,g,f]),y=n.useMemo((()=>$(b,350)),[b]);return c.jsxs("div",{ref:t,className:rm("group relative mt-1 flex h-10 cursor-pointer items-center gap-3 rounded-lg border-border-medium px-3 py-2 text-text-primary transition-colors duration-200 focus-within:bg-surface-hover hover:bg-surface-hover",!0===i?"mb-2 h-14 rounded-2xl":""),children:[c.jsx(Qe,{className:"absolute left-3 h-4 w-4 text-text-secondary group-focus-within:text-text-primary group-hover:text-text-primary"}),c.jsx("input",{type:"text",className:"m-0 mr-0 w-full border-none bg-transparent p-0 pl-7 text-sm leading-tight placeholder-text-secondary placeholder-opacity-100 focus-visible:outline-none group-focus-within:placeholder-text-primary group-hover:placeholder-text-primary",value:l,onChange:e=>{const{value:t}=e.target;m(t.length>0),d(t),y(t),x(!0)},onKeyDown:e=>{"Space"===e.code&&e.stopPropagation()},"aria-label":a("com_nav_search_placeholder"),placeholder:a("com_nav_search_placeholder"),onKeyUp:e=>{const{value:t}=e.target;"Backspace"===e.key&&""===t&&v()},onFocus:()=>x(!0),onBlur:()=>x(!0),autoComplete:"off",dir:"auto"}),c.jsx(ve,{className:rm("absolute right-[7px] h-5 w-5 cursor-pointer transition-opacity duration-200",u?"opacity-100":"opacity-0",!0===i?"right-[16px]":""),onClick:v})]})})),kE=({conversation:e})=>{const t=I(_p.searchQuery),{data:n}=Mp();if(t)return c.jsx("div",{className:"shadow-stroke relative flex h-7 w-7 items-center justify-center rounded-full bg-white text-black dark:bg-white",children:c.jsx(Qe,{className:"h-5 w-5"})});let{endpoint:a=""}=e??{};const s=(null==e?void 0:e.iconURL)??"";a=Zu({endpointsConfig:n,iconURL:s,endpoint:a});const r=Hu(n,a,"type"),o=Hu(n,a,"iconURL"),i=Yu({endpoint:a,endpointsConfig:n,endpointType:r,endpointIconURL:o}),l=lw[i];return c.jsx("div",{className:"h-7 w-7 flex-shrink-0",children:s&&s.includes("http")?c.jsx(pw,{iconURL:s,modelLabel:(null==e?void 0:e.chatGptLabel)??(null==e?void 0:e.modelLabel)??"",endpointIconURL:s,context:"nav"}):c.jsx("div",{className:"shadow-stroke relative flex h-full items-center justify-center rounded-full bg-white text-black",children:a&&null!=l&&c.jsx(l,{size:41,context:"nav",className:"h-2/3 w-2/3",endpoint:a,endpointType:r,iconURL:o})})})};function SE({index:e=0,toggleNav:t,subHeaders:n,isSmallScreen:a}){const s=ar(),{newConversation:r}=Qh(e),o=D(),i=kg(),{conversation:l}=_p.useCreateConversationAtom(e);return c.jsxs("div",{className:"sticky left-0 right-0 top-0 z-50 bg-surface-primary-alt pt-3.5",children:[c.jsx("div",{className:"pb-0.5 last:pb-0",style:{transform:"none"},children:c.jsxs("a",{href:"/",tabIndex:0,"data-testid":"nav-new-chat-button",onClick:e=>{0!==e.button||e.ctrlKey||e.metaKey||(e.preventDefault(),s.setQueryData([Xc.messages,(null==l?void 0:l.conversationId)??dc.NEW_CONVO],[]),r(),o("/c/new"),t())},className:rm("group flex h-10 items-center gap-2 rounded-lg px-2 font-medium transition-colors duration-200 hover:bg-surface-hover",a?"h-14":""),"aria-label":i("com_ui_new_chat"),children:[c.jsx(kE,{conversation:l}),c.jsx("div",{className:"grow overflow-hidden text-ellipsis whitespace-nowrap text-sm text-text-primary",children:i("com_ui_new_chat")}),c.jsx("div",{className:"flex gap-3",children:c.jsx("span",{className:"flex items-center","data-state":"closed",children:c.jsx(wy,{className:"size-5"})})})]})}),null!=n?n:null]})}const TE=n.memo((({navVisible:e,setNavVisible:t})=>{const a=kg(),{isAuthenticated:s}=Wh(),[r,o]=n.useState("260px"),[i,l]=n.useState(!1),d=Ib("(max-width: 768px)"),[u,m]=Eb("newUser",!0),[p,g]=n.useState(!1),f=Jv({permissionType:Zc.BOOKMARKS,permission:Yc.USE}),x=n.useCallback((()=>{l(!0)}),[]),h=n.useCallback((()=>{l(!1)}),[]);n.useEffect((()=>{if(d){null===localStorage.getItem("navVisible")&&O(),o("320px")}else o("260px")}),[d]);const[v,b]=n.useState(!1),y=I(_p.isSearchEnabled),{pageNumber:_,searchQuery:j,setPageNumber:w,searchQueryRes:N}=tv(),[C,k]=n.useState([]),{data:S,fetchNextPage:T,hasNextPage:R,isFetchingNextPage:E,refetch:P}=Gp({pageNumber:_.toString(),isArchived:!1,tags:0===C.length?void 0:C},{enabled:s});n.useEffect((()=>{P()}),[C]);const{containerRef:L,moveToTop:M}=Uv({setShowLoading:b,hasNextPage:j?null==N?void 0:N.hasNextPage:R,fetchNextPage:j?null==N?void 0:N.fetchNextPage:T,isFetchingNextPage:j?(null==N?void 0:N.isFetchingNextPage)??!1:E}),A=n.useMemo((()=>{var e;return(null==(e=j?null==N?void 0:N.data:S)?void 0:e.pages.flatMap((e=>e.conversations)))||[]}),[S,j,null==N?void 0:N.data]),O=()=>{t((e=>(localStorage.setItem("navVisible",JSON.stringify(!e)),!e))),u&&m(!1)},D=()=>{d&&O()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{"data-testid":"nav",className:"nav active max-w-[320px] flex-shrink-0 overflow-x-hidden bg-surface-primary-alt md:max-w-[260px]",style:{width:e?r:"0px",visibility:e?"visible":"hidden",transition:"width 0.2s, visibility 0.2s"},children:c.jsx("div",{className:"h-full w-[320px] md:w-[260px]",children:c.jsx("div",{className:"flex h-full min-h-0 flex-col",children:c.jsx("div",{className:rm("flex h-full min-h-0 flex-col transition-opacity",p&&!d?"opacity-50":"opacity-100"),children:c.jsx("div",{className:rm("scrollbar-trigger relative h-full w-full flex-1 items-start border-white/20"),children:c.jsxs("nav",{id:"chat-history-nav","aria-label":a("com_ui_chat_history"),className:"flex h-full w-full flex-col px-3 pb-3.5",children:[c.jsxs("div",{className:rm("-mr-2 flex-1 flex-col overflow-y-auto pr-2 transition-opacity duration-500",i?"":"scrollbar-transparent"),onMouseEnter:x,onMouseLeave:h,ref:L,children:[c.jsx(SE,{toggleNav:D,isSmallScreen:d,subHeaders:c.jsxs(c.Fragment,{children:[!0===y&&c.jsx(CE,{setPageNumber:w,isSmallScreen:d}),!0===f&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mt-1.5"}),c.jsx(xE,{tags:C,setTags:k,isSmallScreen:d})]})]})}),c.jsx(Uk,{conversations:A,moveToTop:M,toggleNav:D}),(E||v)&&c.jsx(Hb,{className:rm("m-1 mx-auto mb-4 h-4 w-4 text-text-primary")})]}),c.jsx(NE,{})]})})})})})}),c.jsx(tR,{isHovering:p,setIsHovering:g,onToggle:O,navVisible:e,className:"fixed left-0 top-1/2 z-40 hidden md:flex"}),d&&c.jsx("div",{id:"mobile-nav-mask-toggle",role:"button",tabIndex:0,className:"nav-mask "+(e?"active":""),onClick:O,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||O()},"aria-label":"Toggle navigation"})]})}));n.forwardRef(((e,t)=>{const{svg:n,text:a,clickHandler:s,disabled:r,className:o=""}=e,i={className:rm("w-full flex gap-2 rounded p-2.5 text-sm cursor-pointer group items-center transition-colors duration-200 text-text-primary",o,{"opacity-50 pointer-events-none":r})};return s&&(i.onClick=s),c.jsxs("button",{...i,ref:t,children:[n(),a]})}));const RE=n.forwardRef(((e,t)=>{const{id:n,value:a,label:s,subLabel:r,onChange:o,labelClassName:i="",inputClassName:l=""}=e,d=kg();return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:rm("mt-4 flex flex-row",i),children:[c.jsx(g_,{htmlFor:n,className:"text-left text-sm font-medium",children:s}),g_&&c.jsx(g_,{className:"mx-1 text-right text-sm text-text-secondary",children:r}),c.jsx("br",{})]}),c.jsx("div",{className:"h-1"}),c.jsx(m_,{id:n,"data-testid":`input-${n}`,value:a??"",onChange:o,ref:t,placeholder:`${d("com_endpoint_config_value")} ${s}`,className:rm("flex h-10 max-h-10 w-full resize-none px-3 py-2")})]})})),IE=ma({client_email:pa().email().min(3),project_id:pa().min(3),private_key:pa().min(601)}),EE=e=>IE.safeParse(e).success,PE=({endpoint:e,userProvideURL:t})=>{const{control:n}=Ut(),a=e===Ro.azureOpenAI;return c.jsxs("form",{className:"flex-wrap",children:[!a&&c.jsx(tt,{name:"apiKey",control:n,render:({field:e})=>c.jsx(RE,{id:"apiKey",...e,label:(a?"Azure q":"")+"OpenAI API Key",labelClassName:"mb-1",inputClassName:"mb-2"})}),a&&c.jsxs(c.Fragment,{children:[c.jsx(tt,{name:"azureOpenAIApiKey",control:n,render:({field:e})=>c.jsx(RE,{id:"azureOpenAIApiKey",...e,label:"Azure OpenAI API Key",labelClassName:"mb-1"})}),c.jsx("div",{className:"mt-3"}),c.jsx(tt,{name:"azureOpenAIApiInstanceName",control:n,render:({field:e})=>c.jsx(RE,{id:"azureOpenAIApiInstanceName",...e,label:"Azure OpenAI Instance Name",labelClassName:"mb-1"})}),c.jsx("div",{className:"mt-3"}),c.jsx(tt,{name:"azureOpenAIApiDeploymentName",control:n,render:({field:e})=>c.jsx(RE,{id:"azureOpenAIApiDeploymentName",...e,label:"Azure OpenAI Deployment Name",labelClassName:"mb-1"})}),c.jsx("div",{className:"mt-3"}),c.jsx(tt,{name:"azureOpenAIApiVersion",control:n,render:({field:e})=>c.jsx(RE,{id:"azureOpenAIApiVersion",...e,label:"Azure OpenAI API Version",labelClassName:"mb-1"})})]}),t&&c.jsx("div",{className:"mt-3",children:c.jsx(tt,{name:"baseURL",control:n,render:({field:e})=>c.jsx(RE,{id:"baseURL",...e,label:"API Base URL",subLabel:"(Optional)",labelClassName:"mb-1"})})})]})};const LE=n.memo((function({endpoint:e}){const t=kg();return{[Ro.google]:c.jsxs(c.Fragment,{children:[c.jsxs("small",{className:"mt-4 break-all text-text-secondary",children:[t("com_endpoint_config_google_service_key"),": ",t("com_endpoint_config_key_google_need_to")," ",c.jsx("a",{target:"_blank",href:"https://console.cloud.google.com/vertex-ai",rel:"noreferrer",className:"text-blue-700 underline dark:text-blue-400",children:t("com_endpoint_config_key_google_vertex_ai")})," ",t("com_endpoint_config_key_google_vertex_api")," ",c.jsx("a",{target:"_blank",href:"https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?walkthrough_id=iam--create-service-account#step_index=1",rel:"noreferrer",className:"text-blue-700 underline dark:text-blue-400",children:t("com_endpoint_config_key_google_service_account")}),". ",t("com_endpoint_config_key_google_vertex_api_role")]}),c.jsxs("small",{className:"break-all text-text-secondary",children:[t("com_endpoint_config_google_api_key"),": ",t("com_endpoint_config_google_api_info")," ",c.jsx("a",{target:"_blank",href:"https://makersuite.google.com/app/apikey",rel:"noreferrer",className:"text-blue-700 underline dark:text-blue-400",children:t("com_endpoint_config_click_here")})," "]})]})}[e]||null})),ME={[Ro.google]:({userKey:e,setUserKey:t})=>{const n=kg(),{getMultiKey:a,setMultiKey:s}=function(e){return{getMultiKey:function(e,t){return Xr(t)?JSON.parse(t)[e]:""},setMultiKey:function(t,n,a){let s={};Xr(a)&&(s=JSON.parse(a)),s[t]=n,e(JSON.stringify(s))}}}(t);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-row",children:[c.jsx(g_,{htmlFor:rc.GOOGLE_SERVICE_KEY,className:"text-left text-sm font-medium",children:n("com_endpoint_config_google_service_key")}),c.jsx(g_,{className:"mx-1 text-right text-sm text-text-secondary",children:n("com_endpoint_config_google_cloud_platform")}),c.jsx("br",{})]}),c.jsx(zR,{id:rc.GOOGLE_SERVICE_KEY,className:"w-full",containerClassName:"dark:bg-gray-700 h-10 max-h-10 w-full resize-none py-2 dark:ring-1 dark:ring-gray-600",text:n("com_endpoint_config_key_import_json_key"),successText:n("com_endpoint_config_key_import_json_key_success"),invalidText:n("com_endpoint_config_key_import_json_key_invalid"),validator:EE,onFileSelected:t=>{s(rc.GOOGLE_SERVICE_KEY,JSON.stringify(t),e)}}),c.jsx(RE,{id:rc.GOOGLE_API_KEY,value:a(rc.GOOGLE_API_KEY,e)??"",onChange:t=>s(rc.GOOGLE_API_KEY,t.target.value??"",e),label:n("com_endpoint_config_google_api_key"),subLabel:n("com_endpoint_config_google_gemini_api")})]})},[Ro.openAI]:PE,[Ro.custom]:({endpoint:e,userProvideURL:t})=>{const{control:n}=Ut();return c.jsxs("form",{className:"flex-wrap",children:[c.jsx(tt,{name:"apiKey",control:n,render:({field:t})=>c.jsx(RE,{id:"apiKey",...t,label:`${e} API Key`,labelClassName:"mb-1",inputClassName:"mb-2"})}),t&&c.jsx(tt,{name:"baseURL",control:n,render:({field:t})=>c.jsx(RE,{id:"baseURL",...t,label:`${e} API URL`,labelClassName:"mb-1"})})]})},[Ro.azureOpenAI]:PE,[Ro.gptPlugins]:PE,[Ro.assistants]:PE,[Ro.azureAssistants]:PE,default:({userKey:e,setUserKey:t,endpoint:n})=>{const a=kg();return c.jsx(RE,{id:n,value:e??"",onChange:e=>t(e.target.value??""),label:a("com_endpoint_config_key_name")})}},AE=new Set([Ro.openAI,Ro.custom,Ro.azureOpenAI,Ro.gptPlugins,Ro.assistants,Ro.azureAssistants]),OE={THIRTY_MINUTES:{label:"in 30 minutes",value:18e5},TWO_HOURS:{label:"in 2 hours",value:72e5},TWELVE_HOURS:{label:"in 12 hours",value:432e5},ONE_DAY:{label:"in 1 day",value:864e5},ONE_WEEK:{label:"in 7 days",value:6048e5},ONE_MONTH:{label:"in 30 days",value:2592e6},NEVER:{label:"never",value:0}},DE=({open:e,onOpenChange:t,endpoint:a,endpointType:s,userProvideURL:r})=>{const o=ne({defaultValues:{apiKey:"",baseURL:"",azureOpenAIApiKey:"",azureOpenAIApiInstanceName:"",azureOpenAIApiDeploymentName:"",azureOpenAIApiVersion:""}}),[i,l]=n.useState(""),{data:d}=Mp(),[u,m]=n.useState(OE.TWELVE_HOURS.label),{getExpiry:p,saveUserKey:g}=Vh(a),{showToast:f}=Ng(),x=kg(),h=Object.values(OE),v=ME[s??a]??ME.default,b=p(),y=null==d?void 0:d[a];return c.jsx(f_,{open:e,onOpenChange:t,children:c.jsx(ij,{title:`${x("com_endpoint_config_key_for")} ${Ql[a]??a}`,className:"w-11/12 max-w-2xl",showCancelButton:!1,main:c.jsxs("div",{className:"grid w-full items-center gap-2",children:[c.jsx("small",{className:"text-red-600",children:"never"===b?x("com_endpoint_config_key_never_expires"):`${x("com_endpoint_config_key_encryption")} ${new Date(b??0).toLocaleString()}`}),c.jsx(q_,{label:"Expires ",value:u,onChange:e=>{m(e)},options:h.map((e=>e.label)),sizeClasses:"w-[185px]",portal:!1}),c.jsx("div",{className:"mt-2"}),c.jsx(Kt,{...o,children:c.jsx(v,{userKey:i,setUserKey:l,endpoint:a===Ro.gptPlugins&&(null==y?void 0:y.azure)?Ro.azureOpenAI:a,userProvideURL:r})}),c.jsx(LE,{endpoint:a})]}),selection:{selectHandler:()=>{const e=h.find((e=>e.label===u));let n;n=0===(null==e?void 0:e.value)?null:Date.now()+(e?e.value:0);const c=e=>{g(e,n),t(!1)};AE.has(a)||AE.has(s??"")?o.handleSubmit((e=>{const n=a===Ro.azureOpenAI,s=n||a===Ro.openAI||a===Ro.gptPlugins||Oo(a);n&&(e.apiKey="n/a");const i=Object.keys(e).filter((t=>!(!n&&t.startsWith("azure"))&&((!s||"baseURL"!==t)&&(!("baseURL"===t&&!r)&&""===e[t]))));if(i.length>0)return f({message:"The following fields are required: "+i.join(", "),status:"error"}),void t(!0);const{apiKey:l,baseURL:d,...u}=e,m={apiKey:l,baseURL:d};n&&(m.apiKey=JSON.stringify({azureOpenAIApiKey:u.azureOpenAIApiKey,azureOpenAIApiInstanceName:u.azureOpenAIApiInstanceName,azureOpenAIApiDeploymentName:u.azureOpenAIApiDeploymentName,azureOpenAIApiVersion:u.azureOpenAIApiVersion})),c(JSON.stringify(m)),o.reset()}))():(c(i),l(""))},selectClasses:"btn btn-primary",selectText:x("com_ui_submit")},leftButtons:c.jsx(pI,{endpoint:a,disabled:!b,setDialogOpen:t})})})},FE=({title:e,value:t,description:a,selected:s,userProvidesKey:r,...o})=>{const i=I(_p.modularChat),[l,d]=n.useState(!1),{data:u}=Mp(),{conversation:m,newConversation:p}=bh(),g=hh(),{getExpiry:f}=Vh(t),x=kg(),h=f()??"",v=e=>{if(!e)return;h||d(!0);const{template:t,shouldSwitch:n,isNewModular:a,newEndpointType:s,isCurrentModular:r,isExistingConversation:o}=Wu({newEndpoint:e,modularChat:i,conversation:m,endpointsConfig:u}),l=r&&a&&n;if(o&&l){t.endpointType=s;const e=g({conversation:{...m??{},endpointType:t.endpointType},preset:t});p({template:e,preset:e,keepLatestMessage:!0,keepAddedConvos:!0})}else p({template:{...t},keepAddedConvos:l})},b=Hu(u,t,"type"),y=Yu({endpoint:t,endpointsConfig:u,endpointType:b}),_=lw[y];return c.jsxs(c.Fragment,{children:[c.jsx("div",{role:"option","aria-selected":s,className:rm("group m-1.5 flex max-h-[40px] cursor-pointer gap-2 rounded px-5 py-2.5 !pr-3 text-sm !opacity-100 hover:bg-surface-hover","radix-disabled:pointer-events-none radix-disabled:opacity-50"),tabIndex:0,...o,onClick:()=>v(t),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),v(t))},children:c.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[c.jsx("div",{children:c.jsxs("div",{className:"flex items-center gap-2",children:[null!=_&&c.jsx(_,{size:18,endpoint:t,context:"menu-item",className:"icon-md shrink-0 dark:text-white",iconURL:Hu(u,t,"iconURL")}),c.jsxs("div",{children:[e,c.jsx("div",{className:"text-token-text-tertiary",children:a})]})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[r?c.jsx("div",{className:"text-token-text-primary",children:c.jsxs("button",{tabIndex:0,"aria-label":`${x("com_endpoint_config_key")} for ${e}`,className:rm("invisible flex gap-x-1 group-focus-within:visible group-hover:visible",s?"visible":"",h?"text-token-text-primary w-full rounded-lg p-2":""),onClick:e=>{e.preventDefault(),e.stopPropagation(),d(!0)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),d(!0))},children:[c.jsx("div",{className:rm("invisible group-focus-within:visible group-hover:visible",h?"text-xs":""),children:x("com_endpoint_config_key")}),c.jsx(ga,{className:rm(h?"icon-sm":"icon-md stroke-1")})]})},`set-key-${t}`):null,s&&c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md block group-hover:hidden",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM16.0755 7.93219C16.5272 8.25003 16.6356 8.87383 16.3178 9.32549L11.5678 16.0755C11.3931 16.3237 11.1152 16.4792 10.8123 16.4981C10.5093 16.517 10.2142 16.3973 10.0101 16.1727L7.51006 13.4227C7.13855 13.014 7.16867 12.3816 7.57733 12.0101C7.98598 11.6386 8.61843 11.6687 8.98994 12.0773L10.6504 13.9039L14.6822 8.17451C15 7.72284 15.6238 7.61436 16.0755 7.93219Z",fill:"currentColor"})}),(!r||h)&&c.jsxs("div",{className:"text-token-text-primary hidden gap-x-1 group-hover:flex ",children:[!r&&c.jsx("div",{className:"",children:x("com_ui_new_chat")}),c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7929 2.79289C18.0118 1.57394 19.9882 1.57394 21.2071 2.79289C22.4261 4.01184 22.4261 5.98815 21.2071 7.20711L12.7071 15.7071C12.5196 15.8946 12.2652 16 12 16H9C8.44772 16 8 15.5523 8 15V12C8 11.7348 8.10536 11.4804 8.29289 11.2929L16.7929 2.79289ZM19.7929 4.20711C19.355 3.7692 18.645 3.7692 18.2071 4.2071L10 12.4142V14H11.5858L19.7929 5.79289C20.2308 5.35499 20.2308 4.64501 19.7929 4.20711ZM6 5C5.44772 5 5 5.44771 5 6V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V14C19 13.4477 19.4477 13 20 13C20.5523 13 21 13.4477 21 14V18C21 19.6569 19.6569 21 18 21H6C4.34315 21 3 19.6569 3 18V6C3 4.34314 4.34315 3 6 3H10C10.5523 3 11 3.44771 11 4C11 4.55228 10.5523 5 10 5H6Z",fill:"currentColor"})})]})]})]})}),r&&c.jsx(DE,{open:l,endpoint:t,endpointType:b,onOpenChange:d,userProvideURL:Hu(u,t,"userProvideURL")})]})},zE=({endpoints:e=[],selected:t})=>{const n=Jv({permissionType:Zc.AGENTS,permission:Yc.USE}),{data:a}=Mp();return c.jsx(c.Fragment,{children:e.map(((s,r)=>{if(!s)return null;if(!(null==a?void 0:a[s]))return null;if(s===Ro.agents&&!n)return null;const o=Hu(a,s,"userProvide")??!1;return c.jsx(Fs,{asChild:!0,children:c.jsxs("div",{children:[c.jsx(FE,{title:Ql[s]||s,value:s,selected:t===s,"data-testid":`endpoint-item-${s}`,userProvidesKey:!!o},`endpoint-item-${s}`),r!==e.length-1&&c.jsx(UR,{})]},`endpoint-${s}`)},`endpoint-${s}`)}))})},UE=()=>{const{data:e=[]}=Mp({select:Gu}),t=kg(),a=Nh(),s=vv(),{conversation:r}=bh(),{endpoint:o=""}=r??{},i=n.useRef(null),l=n.useCallback((e=>{var t;const n=null==(t=i.current)?void 0:t.querySelectorAll('[role="option"]');if(!n)return;if(!n.length)return;const a=Array.from(n).findIndex((e=>e===document.activeElement));switch(e.key){case"ArrowDown":e.preventDefault(),a<n.length-1?n[a+1].focus():n[0].focus();break;case"ArrowUp":e.preventDefault(),a>0?n[a-1].focus():n[n.length-1].focus()}}),[]);if(!o)return console.warn("No endpoint selected"),null;const{entity:d}=Ju({endpoint:o,agentsMap:a,assistantMap:s,agent_id:null==r?void 0:r.agent_id,assistant_id:null==r?void 0:r.assistant_id}),u=d?d.name:Ql[o]??o;return c.jsxs(Ms,{children:[c.jsx(VR,{primaryText:u+" "}),c.jsx(Os,{children:c.jsx("div",{style:{position:"fixed",left:"0px",top:"0px",transform:"translate3d(268px, 50px, 0px)",minWidth:"max-content",zIndex:"auto"},children:c.jsx(Ds,{side:"bottom",align:"start",role:"listbox",id:"llm-endpoint-menu",ref:i,onKeyDown:l,"aria-label":t("com_ui_endpoints_available"),className:"mt-2 max-h-[65vh] min-w-[340px] overflow-y-auto rounded-lg border border-border-light bg-header-primary text-text-primary shadow-lg lg:max-h-[75vh]",children:c.jsx(zE,{endpoints:e,selected:o})})})})]})};function VE(){const e=ar(),{conversation:t,newConversation:n}=bh(),a=Ib("(max-width: 768px)"),s=kg();return a?null:c.jsx("button",{"data-testid":"wide-header-new-chat-button","aria-label":s("com_ui_new_chat"),type:"button",className:"btn btn-neutral btn-small border-token-border-medium focus:border-black-500 dark:focus:border-white-500 relative ml-2 flex h-9 w-9 items-center justify-center whitespace-nowrap rounded-lg border md:flex",onClick:()=>{e.setQueryData([Xc.messages,(null==t?void 0:t.conversationId)??dc.NEW_CONVO],[]),n()},children:c.jsx("div",{className:"flex w-full items-center justify-center gap-2",children:c.jsx(wy,{})})})}const BE=n.memo((({currentSpec:e,endpointsConfig:t})=>{const n=qu(e),{endpoint:a}=e.preset,s=Hu(t,a,"iconURL"),r=Yu({endpoint:a,endpointsConfig:t,endpointIconURL:s});let o;if(n.includes("http")){if(n)return c.jsx(cw,{iconURL:n,altName:e.name});o=lw[a??""]??lw.unknown}else o=lw[r]??lw.unknown;return c.jsx(o,{size:20,endpoint:a,context:"menu-item",iconURL:s,className:"icon-lg mr-1 shrink-0 text-text-primary"})}));function $E({selected:e,className:t="",textClassName:a="",primaryText:s="",secondaryText:r="",endpointsConfig:o}){const i=kg(),[l,d]=n.useState(!1);return c.jsx(As,{asChild:!0,children:c.jsxs("button",{className:rm("group flex cursor-pointer items-center gap-1 rounded-xl px-3 py-2 text-lg font-medium hover:bg-gray-50 radix-state-open:bg-gray-50 dark:hover:bg-gray-700 dark:radix-state-open:bg-gray-700",t),type:"button","aria-label":i("com_ui_llm_menu"),role:"combobox","aria-haspopup":"listbox","aria-expanded":l,"aria-controls":"llm-menu",onClick:()=>d(!l),children:[e&&!0===e.showIconInHeader&&c.jsx(BE,{currentSpec:e,endpointsConfig:o}),c.jsxs("div",{className:a,children:[e?s:i("com_ui_none_selected")," ",!!r&&c.jsx("span",{className:"text-token-text-secondary",children:r})]}),c.jsx("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",className:"text-token-text-tertiary",children:c.jsx("path",{d:"M11.3346 7.83203L8.00131 11.1654L4.66797 7.83203",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})})}const HE=({title:e,spec:t,selected:a,description:s,userProvidesKey:r,endpointsConfig:o,onClick:i,...l})=>{const{endpoint:d}=t.preset,[u,m]=n.useState(!1),{getExpiry:p}=Vh(d??""),g=kg(),f=p()??"",x=()=>{f&&m(!0),i&&i()},h=n.useMemo((()=>t.preset.endpointType??Hu(o,d,"type")),[t,o,d]),{showIconInMenu:v=!0}=t;return c.jsxs(c.Fragment,{children:[c.jsx("div",{id:a?"selected-llm":void 0,role:"option","aria-selected":a,className:"group m-1.5 flex cursor-pointer gap-2 rounded px-1 py-2.5 !pr-3 text-sm !opacity-100 hover:bg-black/5 focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 dark:hover:bg-white/5",tabIndex:0,...l,onClick:x,"aria-label":e,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),x())},children:c.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[c.jsx("div",{children:c.jsxs("div",{className:"flex items-center gap-2",children:[v&&c.jsx(BE,{currentSpec:t,endpointsConfig:o}),c.jsxs("div",{children:[e,c.jsx("div",{className:"text-token-text-tertiary",children:s})]})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[r?c.jsx("div",{className:"text-token-text-primary",children:c.jsxs("button",{tabIndex:0,"aria-label":`${g("com_endpoint_config_key")} for ${e}`,className:rm("invisible flex gap-x-1 group-focus-within:visible group-hover:visible",a?"visible":"",f?"w-full rounded-lg p-2 hover:bg-gray-200 dark:hover:bg-gray-900":""),onClick:e=>{e.preventDefault(),e.stopPropagation(),m(!0)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),m(!0))},children:[c.jsx("div",{className:rm("invisible group-focus-within:visible group-hover:visible",f?"text-xs":""),children:g("com_endpoint_config_key")}),c.jsx(ga,{className:rm(f?"icon-sm":"icon-md stroke-1")})]})},`set-key-${d}`):null,a&&c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md block",children:c.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM16.0755 7.93219C16.5272 8.25003 16.6356 8.87383 16.3178 9.32549L11.5678 16.0755C11.3931 16.3237 11.1152 16.4792 10.8123 16.4981C10.5093 16.517 10.2142 16.3973 10.0101 16.1727L7.51006 13.4227C7.13855 13.014 7.16867 12.3816 7.57733 12.0101C7.98598 11.6386 8.61843 11.6687 8.98994 12.0773L10.6504 13.9039L14.6822 8.17451C15 7.72284 15.6238 7.61436 16.0755 7.93219Z",fill:"currentColor"})})]})]})}),r&&c.jsx(DE,{open:u,onOpenChange:m,endpoint:d??"",endpointType:h})]})},GE=({specs:e=[],selected:t,setSelected:n=(()=>({})),endpointsConfig:a})=>c.jsx(c.Fragment,{children:e.length&&e.map(((s,r)=>s?c.jsx(Fs,{asChild:!0,children:c.jsxs("div",{children:[c.jsx(HE,{spec:s,title:s.label,description:s.description,onClick:()=>n(s),"data-testid":`spec-item-${s.name}`,selected:(null==t?void 0:t.name)===s.name,userProvidesKey:s.authType===So.USER_PROVIDED,endpointsConfig:a},`spec-item-${s.name}`),r!==e.length-1&&c.jsx(UR,{})]},`spec-${s.name}`)},`spec-${s.name}`):null))});function KE({modelSpecs:e}){const{conversation:t}=bh(),{newConversation:a}=Qh(),s=kg(),{data:r={}}=Mp(),o=I(_p.modularChat),i=hh(),l=vv(),d=n.useMemo((()=>{const n=null==e?void 0:e.find((e=>e.name===(null==t?void 0:t.spec)));if(n)return n}),[e,null==t?void 0:t.spec]),u=n.useRef(null),m=n.useCallback((e=>{var t;const n=null==(t=u.current)?void 0:t.querySelectorAll('[role="option"]');if(!n)return;if(!n.length)return;const a=Array.from(n).findIndex((e=>e===document.activeElement));switch(e.key){case"ArrowDown":e.preventDefault(),a<n.length-1?n[a+1].focus():n[0].focus();break;case"ArrowUp":e.preventDefault(),a>0?n[a-1].focus():n[n.length-1].focus()}}),[]);return c.jsxs(Ms,{children:[c.jsx($E,{selected:d,className:"min-h-11",textClassName:"block items-center justify-start text-xs md:text-base whitespace-nowrap max-w-64 overflow-hidden shrink-0 text-ellipsis",primaryText:(null==d?void 0:d.label)??"",endpointsConfig:r}),c.jsx(Os,{children:e&&e.length&&c.jsx("div",{style:{position:"fixed",left:"0px",top:"0px",transform:"translate3d(268px, 50px, 0px)",minWidth:"max-content",zIndex:"auto"},children:c.jsx(Ds,{side:"bottom",align:"start",id:"llm-menu",role:"listbox",ref:u,onKeyDown:m,"aria-label":s("com_ui_llms_available"),className:"models-scrollbar mt-2 max-h-[65vh] min-w-[340px] max-w-xs overflow-y-auto rounded-lg border border-gray-100 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-700 dark:text-white lg:max-h-[75vh]",children:c.jsx(GE,{specs:e,selected:d,setSelected:e=>{var n,s;const{preset:c}=e;c.iconURL=qu(e),c.spec=e.name;const{endpoint:d}=c,u=d??"";if(!u)return;const{template:m,shouldSwitch:p,isNewModular:g,newEndpointType:f,isCurrentModular:x,isExistingConversation:h}=Wu({newEndpoint:u,modularChat:o,conversation:t,endpointsConfig:r});f&&(c.endpointType=f),Oo(u)&&null!=c.assistant_id&&!c.model&&(c.model=null==(s=null==(n=null==l?void 0:l[u])?void 0:n[c.assistant_id])?void 0:s.model);const v=x&&g&&p;if(h&&v){m.endpointType=f;const e=i({conversation:{...t??{},endpointType:m.endpointType},preset:m});a({template:e,preset:c,keepLatestMessage:!0,keepAddedConvos:!0})}else a({template:{...m},preset:c,keepAddedConvos:v})},endpointsConfig:r})})})})]})}function WE({isSharedButtonEnabled:e}){const t=kg(),[a,s]=n.useState(!1),[r,o]=n.useState(!1),[i,l]=n.useState(!1),d=n.useId(),u=n.useRef(null),m=n.useRef(null),p=Ib("(max-width: 768px)"),g=I(_p.conversationByIndex(0));if(!1===(g&&null!=g.conversationId&&"new"!==g.conversationId&&"search"!==g.conversationId))return null;const f=[{label:t("com_endpoint_export"),onClick:()=>{s(!0)},icon:c.jsx(ta,{className:"icon-md mr-2 text-text-secondary"}),hideOnClick:!1,ref:m,render:e=>c.jsx("button",{...e})},{label:t("com_ui_share"),onClick:()=>{l(!0)},icon:c.jsx(lt,{className:"icon-md mr-2 text-text-secondary"}),show:e,hideOnClick:!1,ref:u,render:e=>c.jsx("button",{...e})}];return c.jsxs(c.Fragment,{children:[c.jsx(Y_,{menuId:d,focusLoop:!0,isOpen:r,setIsOpen:o,trigger:c.jsx(z_,{description:t("com_endpoint_export_share"),render:c.jsx(dt,{id:"export-menu-button","aria-label":"Export options",className:"inline-flex size-10 items-center justify-center rounded-lg border border-border-light bg-transparent text-text-primary transition-all ease-in-out hover:bg-surface-tertiary disabled:pointer-events-none disabled:opacity-50 radix-state-open:bg-surface-tertiary",children:c.jsx(ta,{className:"icon-md text-text-secondary","aria-hidden":"true",focusable:"false"})})}),items:f,className:p?"":"absolute right-0 top-0 mt-2"}),c.jsx(HR,{open:a,onOpenChange:s,conversation:g,triggerRef:m,"aria-label":t("com_ui_export_convo_modal")}),c.jsx(Dk,{triggerRef:u,conversationId:g.conversationId??"",title:g.title??"",open:i,onOpenChange:l})]})}const QE=()=>{const e=kg(),{data:t}=Ap(),a=Gl().interface,[s,r]=T(_p.isTemporary),o=I(_p.conversationByIndex(0))||void 0,i=(null==o?void 0:o.conversationId)??"";if(!1===n.useMemo((()=>(null==t?void 0:t.interface)??a),[t]).temporaryChat)return null;const l=Boolean(o&&i&&i!==dc.NEW_CONVO&&"search"!==i);return c.jsx("div",{className:"sticky bottom-0 mt-auto w-full border-none bg-surface-tertiary px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:rm("flex items-center gap-2",l&&"opacity-40"),children:[c.jsx(Fn,{className:"icon-sm","aria-hidden":"true"}),c.jsx("span",{className:"truncate text-sm text-text-primary",children:e("com_ui_temporary_chat")})]}),c.jsx("div",{className:"flex flex-shrink-0 items-center",children:c.jsx(R_,{id:"temporary-chat-switch",checked:s,onCheckedChange:()=>{l||r(!s)},disabled:l,className:"ml-4","aria-label":"Toggle temporary chat","data-testid":"temporary-chat-switch"})})]})})};function qE({conversation:e,setOption:t,models:n,showAbove:a=!0,popover:s=!1}){const r=s?cj:sj;return c.jsx(r,{value:(null==e?void 0:e.model)??"",setValue:t("model"),availableValues:n,showAbove:a,showLabel:!1,className:rm(gm,"z-50 flex h-[40px] w-48 min-w-48 flex-none items-center justify-center px-4 hover:cursor-pointer"),footer:c.jsx(QE,{})})}const ZE={...{[Ro.openAI]:qE,[Ro.custom]:qE,[Ro.bedrock]:qE,[Ro.azureOpenAI]:qE,[Ro.google]:function({conversation:e,setOption:t,models:n,showAbove:a,popover:s=!1}){const r=s?cj:sj;return c.jsx(r,{value:(null==e?void 0:e.model)??"",setValue:t("model"),availableValues:n,showAbove:a,showLabel:!1,className:rm(gm,"z-50 flex h-[40px] w-48 min-w-48 flex-none items-center justify-center px-4 ring-0 hover:cursor-pointer"),footer:c.jsx(QE,{})})},[Ro.anthropic]:function({conversation:e,setOption:t,models:n,showAbove:a,popover:s=!1}){const r=s?cj:sj;return c.jsx(r,{value:(null==e?void 0:e.model)??"",setValue:t("model"),availableValues:n,showAbove:a,showLabel:!1,className:rm(gm,"z-50 flex h-[40px] w-48 min-w-48 flex-none items-center justify-center px-4 ring-0 hover:cursor-pointer"),footer:c.jsx(QE,{})})},[Ro.chatGPTBrowser]:function({conversation:e,setOption:t,models:n,showAbove:a,popover:s=!1}){if(!e)return null;const{conversationId:r,model:o}=e;if("new"!==r)return null;const i=s?cj:sj;return c.jsx(i,{value:o??"",setValue:t("model"),availableValues:n,showAbove:a,showLabel:!1,className:rm(gm,"z-50 flex h-[40px] w-60 min-w-48 flex-none items-center justify-center px-4 ring-0 hover:cursor-pointer"),footer:c.jsx(QE,{})})}},[Ro.gptPlugins]:function({conversation:e,setOption:t,models:a,showAbove:s,popover:r=!1}){const o=kg(),{user:i}=Wh(),[l,d]=n.useState(!0),u=Ib("(max-width: 640px)"),m=I(_p.availableTools),{checkPluginSelection:p,setTools:g}=Ev(),{data:f}=fh({enabled:!!(null==i?void 0:i.plugins),select:Yr});n.useEffect((()=>{u&&d(!1)}),[u]);const x=n.useMemo((()=>(null==e?void 0:e.tools)?Jr(e.tools,null==f?void 0:f.map):[]),[e,f]),h=n.useMemo((()=>m?Object.values(m):[]),[m]);if(!e)return null;const v=r?cj:sj,b=r?oj:uj;return c.jsxs(c.Fragment,{children:[c.jsx(By,{type:"button",className:rm(gm,"z-40 flex h-[40px] min-w-4 flex-none items-center justify-center px-3 hover:bg-white focus:ring-0 focus:ring-offset-0 dark:hover:bg-gray-700"),onClick:()=>d((e=>!e)),children:c.jsx(vt,{className:rm(l?"rotate-180 transform":"","w-4 text-gray-600 dark:text-white")})}),l&&c.jsxs(c.Fragment,{children:[c.jsx(v,{value:e.model??"",setValue:t("model"),availableValues:a,showAbove:s,showLabel:!1,className:rm(gm,"z-50 flex h-[40px] w-48 min-w-48 flex-none items-center justify-center px-4 hover:cursor-pointer")}),c.jsx(b,{showAbove:!1,showLabel:!1,setSelected:g,value:x,optionValueKey:"pluginKey",availableValues:h,isSelected:p,searchPlaceholder:o("com_ui_select_search_plugin")})]})]})}};function YE({conversation:e,setOption:t,popover:n=!1,showAbove:a=!0}){var s;const r=mh();if(!(null==e?void 0:e.endpoint))return null;const{endpoint:o,endpointType:i}=e,l=(null==(s=r.data)?void 0:s[o])??[],d=ZE[i??o];return d?c.jsx(d,{conversation:e,setOption:t,models:l,showAbove:a,popover:n}):null}function JE({children:e,visible:t,saveAsPreset:a,closePopover:s,PopoverButtons:r,presetsDisabled:o}){const i=n.useRef(null);Pb(i,(()=>s()),["dialog-template-content","shadcn-button","advanced-settings"],(e=>{const t=e;if("presets-button"===t.id||t.parentNode instanceof Element&&"presets-button"===t.parentNode.id)return!1;const n=t.tagName;return"path"===n||"svg"===n||"circle"===n}));const l=kg();return t?c.jsx(Os,{children:c.jsx(Ds,{sideOffset:8,align:"start",ref:i,asChild:!0,children:c.jsx("div",{className:"z-[70] flex w-screen flex-col items-center md:w-full md:px-4",children:c.jsxs("div",{className:rm("shadow-xl rounded-md min-w-[75px] font-normal bg-white border-black/10 border dark:bg-gray-700 text-black dark:text-white","dark:bg-gray-700","border-d-0 flex w-full flex-col overflow-hidden rounded-none border-s-0 border-t bg-white px-0 pb-[10px] dark:border-white/10 md:rounded-md md:border lg:w-[736px]"),children:[c.jsxs("div",{className:"flex w-full items-center bg-gray-50 px-2 py-2 dark:bg-gray-700",children:[o?null:c.jsxs(By,{type:"button",className:"h-auto w-[150px] justify-start rounded-md border border-gray-300/50 bg-transparent px-2 py-1 text-xs font-normal text-black hover:bg-gray-100 hover:text-black focus-visible:ring-1 focus-visible:ring-ring-primary dark:border-gray-600 dark:bg-transparent dark:text-white dark:hover:bg-gray-600 dark:focus-visible:ring-white",onClick:a,children:[c.jsx(et,{className:"mr-1 w-[14px]"}),l("com_endpoint_save_as_preset")]}),r,c.jsx(By,{type:"button",className:rm("ml-auto h-auto bg-transparent px-3 py-2 text-xs font-normal text-black hover:bg-gray-100 hover:text-black dark:bg-transparent dark:text-white dark:hover:bg-gray-700 dark:hover:text-white",mm),onClick:s,children:c.jsx(Wb,{})})]}),c.jsx("div",{children:e})]})})})}):null}function XE({interfaceConfig:e}){const{data:t}=Mp(),[a,s]=n.useState(!1),[r,o]=T(_p.showPluginStoreDialog),i=kg(),{showPopover:l,conversation:d,setShowPopover:u}=bh(),{setOption:m}=Ev(),{endpoint:p,conversationId:g}=d??{},f=n.useMemo((()=>({[Ro.chatGPTBrowser]:!0})),[g]);n.useEffect((()=>{p&&f[p]&&u(!1)}),[p,f]);if(!p)return null;const x=Hu(t,p,"type"),h=Fo(p,x);return c.jsx(Ms,{open:l,children:c.jsx(Xs,{children:c.jsx("div",{className:"my-auto lg:max-w-2xl xl:max-w-3xl",children:c.jsxs("span",{className:"flex w-full flex-col items-center justify-center gap-0 md:order-none md:m-auto md:gap-2",children:[c.jsxs("div",{className:"z-[61] flex w-full items-center justify-center gap-2",children:[!0===(null==e?void 0:e.modelSelect)&&!Do(p)&&c.jsx(YE,{conversation:d,setOption:m,showAbove:!1,popover:!0}),!f[p]&&!0===(null==e?void 0:e.parameters)&&!1===h&&c.jsx(z_,{id:"parameters-button","aria-label":i("com_ui_model_parameters"),description:i("com_ui_model_parameters"),tabIndex:0,role:"button",onClick:()=>u((e=>!e)),"data-testid":"parameters-button",className:"inline-flex size-10 items-center justify-center rounded-lg border border-border-light bg-transparent text-text-primary transition-all ease-in-out hover:bg-surface-tertiary disabled:pointer-events-none disabled:opacity-50 radix-state-open:bg-surface-tertiary",children:c.jsx(An,{size:16,"aria-label":"Settings/Parameters Icon"})})]}),!0===(null==e?void 0:e.parameters)&&!1===h&&c.jsx(JE,{visible:l,saveAsPreset:()=>{s(!0)},presetsDisabled:!e.presets,PopoverButtons:c.jsx(DR,{}),closePopover:()=>u(!1),children:c.jsxs("div",{className:"px-4 py-4",children:[c.jsx(fN,{className:"[&::-webkit-scrollbar]:w-2",conversation:d,setOption:m}),c.jsx(hN,{conversation:d,setOption:m})]})}),!0===(null==e?void 0:e.presets)&&c.jsx(xN,{open:a,onOpenChange:s,preset:gi.parse({...d})}),!0===(null==e?void 0:e.parameters)&&c.jsx(_j,{isOpen:r,setIsOpen:o})]})})})})}const eP=()=>{const e=kg(),t=ar(),{showToast:a}=Ng(),s=I(_p.conversationByIndex(0))||void 0,r=(null==s?void 0:s.conversationId)??"",o=(e=>{const t=R(_p.updateConversationSelector(e)),{updateTagsInConversation:n}=Xp();return a=>{e&&(n(e,a),t({tags:a}))}})(r),i=null==s?void 0:s.tags,l=null!=(null==s?void 0:s.expiredAt),d=n.useId(),[u,m]=n.useState(!1),[p,g]=n.useState(!1),f=((e,t)=>{const n=Wp(),{updateTagsInConversation:a}=Xp();return sr((t=>zd.addTagToConversation(e,t)),{onSuccess:(s,...r)=>{var o;n.refetch(),a(e,s),null==(o=null==t?void 0:t.onSuccess)||o.call(t,s,...r)},onError:null==t?void 0:t.onError,onMutate:null==t?void 0:t.onMutate})})(r,{onSuccess:(e,t)=>{o(e);const n=document.getElementById(t.tag);console.log("tagElement",n),n&&setTimeout((()=>n.focus()),2)},onError:()=>{a({message:"Error adding bookmark",severity:Wr.ERROR})},onMutate:e=>{const t=document.getElementById(e.tag);console.log("tagElement",t),t&&setTimeout((()=>t.focus()),2)}}),{data:x}=Wp(),h=Boolean(s&&r&&r!==dc.NEW_CONVO&&"search"!==r),v=n.useCallback((e=>{if(void 0===e||""===e||!r)return void a({message:"Invalid tag or conversationId",severity:Wr.ERROR});om.log("tag_mutation","BookmarkMenu - handleSubmit: tags before setting",i);const n=(t.getQueryData([Xc.conversationTags])??[]).map((e=>e.tag)),s=null==i?void 0:i.filter((e=>n.includes(e)));om.log("tag_mutation","BookmarkMenu - handleSubmit: tags after filtering",s);const o=!0===(null==s?void 0:s.includes(e))?s.filter((t=>t!==e)):[...s??[],e];om.log("tag_mutation","BookmarkMenu - handleSubmit: tags after",o),f.mutate({tags:o,tag:e})}),[i,r,f,t,a]),b=n.useRef(null),y=n.useMemo((()=>{const t=[{id:"%___new___bookmark___%",label:e("com_ui_bookmarks_new"),icon:c.jsx(En,{className:"size-4"}),hideOnClick:!1,ref:b,render:e=>c.jsx("button",{...e}),onClick:()=>g(!0)}];if(x)for(const e of x){const n=null==i?void 0:i.includes(e.tag);t.push({id:e.tag,label:e.tag,hideOnClick:!1,icon:!0===n?c.jsx($s,{className:"size-4"}):c.jsx(Hs,{className:"size-4"}),onClick:()=>v(e.tag),disabled:f.isLoading})}return t}),[i,x,v,f.isLoading,e]);if(!h)return null;if(l)return null;return c.jsxs(uv.Provider,{value:{bookmarks:x||[]},children:[c.jsx(Y_,{focusLoop:!0,menuId:d,isOpen:u,setIsOpen:m,keyPrefix:`${r}-bookmark-`,trigger:c.jsx(z_,{description:e("com_ui_bookmarks_add"),render:c.jsx(dt,{id:"bookmark-menu-button","aria-label":e("com_ui_bookmarks_add"),className:rm("mt-text-sm flex size-10 items-center justify-center gap-2 rounded-lg border border-border-light text-sm transition-colors duration-200 hover:bg-surface-hover",u?"bg-surface-hover":""),"data-testid":"bookmark-menu",children:f.isLoading?c.jsx(Hb,{"aria-label":"Spinner"}):((null==i?void 0:i.length)??0)>0?c.jsx($s,{className:"icon-sm","aria-label":"Filled Bookmark"}):c.jsx(Hs,{className:"icon-sm","aria-label":"Bookmark"})})}),items:y}),c.jsx(mT,{tags:i,open:p,setTags:o,setOpen:g,triggerRef:b,conversationId:r,context:"BookmarkMenu - BookmarkEditDialog"})]})};function tP(){const{conversation:e}=bh(),{setConversation:t}=rv(),n=kg();return e?Oo(e.endpoint)?null:c.jsx(z_,{id:"add-multi-conversation-button","aria-label":n("com_ui_add_multi_conversation"),description:n("com_ui_add_multi_conversation"),tabIndex:0,role:"button",onClick:()=>{const{title:n,...a}=e??{};t({...a,title:""});const s=document.getElementById(Vr);s&&s.focus()},"data-testid":"parameters-button",className:"inline-flex size-10 items-center justify-center rounded-lg border border-border-light bg-transparent text-text-primary transition-all ease-in-out hover:bg-surface-tertiary disabled:pointer-events-none disabled:opacity-50 radix-state-open:bg-surface-tertiary",children:c.jsx(kn,{size:16,"aria-label":"Plus Icon"})}):null}const nP=Gl().interface;function aP(){const{data:e}=Ap(),{navVisible:t}=pe(),a=n.useMemo((()=>{var t;return(null==(t=null==e?void 0:e.modelSpecs)?void 0:t.list)??[]}),[e]),s=n.useMemo((()=>(null==e?void 0:e.interface)??nP),[e]),r=Jv({permissionType:Zc.BOOKMARKS,permission:Yc.USE}),o=Jv({permissionType:Zc.MULTI_CONVO,permission:Yc.USE}),i=Ib("(max-width: 768px)");return c.jsxs("div",{className:"sticky top-0 z-10 flex h-14 w-full items-center justify-between bg-white p-2 font-semibold dark:bg-gray-800 dark:text-white",children:[c.jsxs("div",{className:"hide-scrollbar flex w-full items-center justify-between gap-2 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[!t&&c.jsx(VE,{}),!0===s.endpointsMenu&&c.jsx(UE,{}),a.length>0&&c.jsx(KE,{modelSpecs:a}),c.jsx(XE,{interfaceConfig:s}),!0===s.presets&&c.jsx($R,{}),!0===r&&c.jsx(eP,{}),!0===o&&c.jsx(tP,{}),i&&c.jsx(WE,{isSharedButtonEnabled:(null==e?void 0:e.sharedLinksEnabled)??!1})]}),!i&&c.jsx(WE,{isSharedButtonEnabled:(null==e?void 0:e.sharedLinksEnabled)??!1})]}),c.jsx("div",{})]})}const sP=n.memo((function({index:e=0}){const{conversationId:t}=B(),a=I(_p.submissionByIndex(e)),s=I(_p.submissionByIndex(e+1)),r=av(),{data:o=null,isLoading:i}=rh(t??"",{select:n.useCallback((e=>{const t=im({messages:e,fileMap:r});return 0===(null==t?void 0:t.length)?null:t??null}),[r]),enabled:!!r}),l=qh(e,t),d=function({rootIndex:e}){const t=n.useMemo((()=>e+1),[e]),{ask:a,regenerate:s,setMessages:r,getMessages:o,conversation:i,isSubmitting:l,setConversation:c,setIsSubmitting:d}=Zh({rootIndex:e,currentIndex:t}),{generateConversation:u}=Yh({index:t,rootIndex:e,setConversation:c});return{ask:a,regenerate:s,getMessages:o,setMessages:r,conversation:i,isSubmitting:l,setConversation:c,setIsSubmitting:d,generateConversation:u,addedIndex:t}}({rootIndex:e});kb(a,l,!1),kb(s,d,!0);const u=ne({defaultValues:{text:""}});let m;return m=i&&"new"!==t?c.jsx("div",{className:"flex h-screen items-center justify-center",children:c.jsx(Hb,{className:"opacity-0"})}):o&&0!==o.length?c.jsx(tS,{messagesTree:o,Header:c.jsx(aP,{})}):c.jsx(OR,{Header:c.jsx(aP,{})}),c.jsx(cv,{...u,children:c.jsx(vh.Provider,{value:l,children:c.jsx(sv.Provider,{value:d,children:c.jsxs(pR,{children:[m,c.jsxs("div",{className:"w-full border-t-0 pl-0 pt-2 dark:border-white/20 md:w-[calc(100%-.5rem)] md:border-t-0 md:border-transparent md:pl-0 md:pt-0 md:dark:border-transparent",children:[c.jsx(MR,{index:e}),c.jsx(Nk,{})]})]})})})})}));function rP(){nr([Xc.health],(()=>zd.healthCheck()),{refetchInterval:tc.TEN_MINUTES,retry:!1,onError:e=>{console.error("Health check failed:",e)},cacheTime:0,staleTime:0,refetchOnWindowFocus:e=>{if(!e.state.dataUpdatedAt)return!0;const t=new Date(e.state.dataUpdatedAt),n=new Date(Date.now()-tc.TEN_MINUTES);return om.log(`Last health check: ${t.toISOString()}`),om.log(`Ten minutes ago: ${n.toISOString()}`),t<n}});const{data:e}=Ap(),{isAuthenticated:t,user:a}=function(){const{user:e,isAuthenticated:t}=Wh(),a=D();return n.useEffect((()=>{const e=setTimeout((()=>{t||a("/login",{replace:!0})}),300);return()=>{clearTimeout(e)}}),[t,a]),{user:e,isAuthenticated:t}}(),s=S((({set:e})=>t=>{e(yp.isTemporary,t)}),[]);!function({startupConfig:e,user:t}){var a;const s=R(_p.availableTools),[r,o]=T(_p.defaultPreset),{data:i}=fh({enabled:!!(null==t?void 0:t.plugins),select:Yr});n.useEffect((()=>{const t=(null==e?void 0:e.appTitle)??"";t&&(document.title=t,localStorage.setItem(uc.APP_TITLE,t))}),[e]),n.useEffect((()=>{var t;if(r&&null!=r.spec)return;const n=null==(t=null==e?void 0:e.modelSpecs)?void 0:t.list;if(!n||!n.length)return;const a=n.find((e=>e.default));a&&o({...a.preset,iconURL:a.iconURL,spec:a.name})}),[r,o,null==(a=null==e?void 0:e.modelSpecs)?void 0:a.list]),n.useEffect((()=>{if(!t)return;if(!i)return;const e=t.plugins??[];if(0===e.length)return void s({pluginStore:Jh});const n=[...e].map((e=>i.map[e])).filter((e=>void 0!==e)),a=localStorage.getItem(uc.LAST_TOOLS)??"";if(!a)return s({pluginStore:Jh,...Zr(n)});const r=Jr(JSON.parse(a)??[],i.map).filter((e=>n.some((t=>t.pluginKey===e.pluginKey)))).filter((e=>!!e));localStorage.setItem(uc.LAST_TOOLS,JSON.stringify(r)),s({pluginStore:Jh,...Zr(n)})}),[i,t,s]),n.useEffect((()=>{if(null!=(null==e?void 0:e.analyticsGtmId)&&void 0===window.google_tag_manager){const t={gtmId:e.analyticsGtmId};F.initialize(t)}}),[null==e?void 0:e.analyticsGtmId])}({startupConfig:e,user:a});const{conversationId:r=""}=B(),{hasSetConversation:o,conversation:i}=_p.useCreateConversationAtom(0),{newConversation:l}=Qh(),d=mh({enabled:t,refetchOnMount:"always"}),u=((e,t)=>{const n=ar();return nr([Xc.conversation,e],(()=>{const t=()=>zd.getConversationById(e),a=n.getQueryData([Xc.allConversations]);if(!a)return t();const{pageIndex:s,index:r}=ju(a,{conversationId:e});return s>-1&&r>-1?a.pages[s].conversations[r]:t()}),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...t})})(r,{enabled:t&&r!==dc.NEW_CONVO}),m=Mp({enabled:t}),p=_h();if(n.useEffect((()=>{var t,n,a;if((e&&!o.current&&!(null==(t=d.data)?void 0:t.initial))??!1)if(r===dc.NEW_CONVO&&m.data&&d.data){const t=Qu(null==(n=null==e?void 0:e.modelSpecs)?void 0:n.list);l({modelsData:d.data,template:i||void 0,...t?{preset:{...t.preset,iconURL:qu(t),spec:t.name}}:{}}),o.current=!0}else if(u.data&&m.data&&d.data)l({template:u.data,preset:u.data,modelsData:d.data,keepLatestMessage:!0}),o.current=!0;else if(r===dc.NEW_CONVO&&p[Ro.assistants]&&p[Ro.azureAssistants]){const t=Qu(null==(a=null==e?void 0:e.modelSpecs)?void 0:a.list);l({modelsData:d.data,template:i||void 0,...t?{preset:{...t.preset,iconURL:qu(t),spec:t.name}}:{}}),o.current=!0}else p[Ro.assistants]&&p[Ro.azureAssistants]&&(l({template:u.data,preset:u.data,modelsData:d.data,keepLatestMessage:!0}),o.current=!0)}),[e,u.data,m.data,d.data,p]),m.isLoading||d.isLoading)return c.jsx("div",{"aria-live":"polite",role:"status",children:c.jsx(Hb,{className:"m-auto text-black dark:text-white"})});if(!t)return null;if((null==i?void 0:i.conversationId)===dc.SEARCH)return null;if((null==i?void 0:i.conversationId)!==r&&!i)return null;if(!r)return null;const g=!(!i||!i.expiredAt);return r===dc.NEW_CONVO||g?g&&s(g):s(!1),c.jsx(Sv,{conversationId:i.conversationId??"",children:c.jsx(sP,{index:0})})}const oP=_.forwardRef(((e,t)=>c.jsx("div",{className:rm("relative flex w-full grow overflow-hidden bg-white dark:bg-gray-800",e.className),children:c.jsx("div",{className:"transition-width relative h-full w-full flex-1 overflow-auto bg-white dark:bg-gray-800",children:c.jsx("div",{className:"flex h-full flex-col",role:"presentation",tabIndex:0,children:c.jsx("div",{className:"flex-1 overflow-hidden overflow-y-auto",children:c.jsx("div",{className:"dark:gpt-dark-gray relative h-full",children:c.jsx("div",{ref:t,style:{height:"100%",overflowY:"auto",width:"100%"},children:c.jsxs("div",{className:"flex flex-col pb-9 text-sm dark:bg-transparent",children:[e.children,c.jsx("div",{className:"dark:gpt-dark-gray group h-0 w-full flex-shrink-0 dark:border-gray-800/50"})]})})})})})})})));function iP({message:e}){const t=kg(),{searchQueryRes:n}=tv(),{navigateWithLastTools:a}=Iv(),s=e.conversationId??"";if(!s)return null;return c.jsx("div",{className:"visible mt-0 flex items-center justify-center gap-1 self-end text-text-secondary lg:justify-start",children:c.jsxs("button",{className:"ml-0 flex cursor-pointer items-center gap-1.5 rounded-md p-1 text-xs hover:text-text-primary hover:underline",onClick:t=>{t.preventDefault();const r=ku(null==n?void 0:n.data,s);r&&(document.title=e.title??"",a(r,!0,!0))},title:t("com_ui_go_to_conversation"),children:[c.jsx(fa,{className:"icon-sm"}),e.title]})})}function lP({message:e}){const t=I(_p.UsernameDisplay),a=I(_p.fontSize),{user:s}=Wh(),r=kg(),o=n.useMemo((()=>({endpoint:null==e?void 0:e.endpoint,model:null==e?void 0:e.model,iconURL:(null==e?void 0:e.iconURL)??"",isCreatedByUser:null==e?void 0:e.isCreatedByUser})),[null==e?void 0:e.model,null==e?void 0:e.iconURL,null==e?void 0:e.endpoint,null==e?void 0:e.isCreatedByUser]);if(!e)return null;const{isCreatedByUser:i}=e;let l="";return l=i?t?((null==s?void 0:s.name)??"")||((null==s?void 0:s.username)??""):r("com_user_message"):e.sender??"",c.jsx(c.Fragment,{children:c.jsx("div",{className:"text-token-text-primary w-full border-0 bg-transparent dark:border-0 dark:bg-transparent",children:c.jsx("div",{className:"m-auto justify-center p-4 py-2 md:gap-6 ",children:c.jsxs("div",{className:"final-completion group mx-auto flex flex-1 gap-3 md:max-w-3xl md:px-5 lg:max-w-[40rem] lg:px-1 xl:max-w-[48rem] xl:px-5",children:[c.jsx("div",{className:"relative flex flex-shrink-0 flex-col items-end",children:c.jsx("div",{children:c.jsx("div",{className:"pt-0.5",children:c.jsx("div",{className:"flex h-6 w-6 items-center justify-center overflow-hidden rounded-full",children:c.jsx(Kk,{iconData:o})})})})}),c.jsxs("div",{className:rm("relative flex w-11/12 flex-col",i?"":"agent-turn"),children:[c.jsx("div",{className:rm("select-none font-semibold",a),children:l}),c.jsx("div",{className:"flex-col gap-1 md:gap-3",children:c.jsx("div",{className:"flex max-w-full flex-grow flex-col gap-0",children:c.jsx(fk,{message:e})})}),c.jsxs(bk,{classes:"text-xs",children:[c.jsx(yC,{message:e}),c.jsx(iP,{message:e})]})]})]})})})})}function cP(){var e;const t=kg(),a=av(),{searchQuery:s,searchQueryRes:r}=tv(),{containerRef:o}=Uv({setShowLoading:()=>({}),hasNextPage:null==r?void 0:r.hasNextPage,fetchNextPage:null==r?void 0:r.fetchNextPage,isFetchingNextPage:(null==r?void 0:r.isFetchingNextPage)??!1}),i=n.useMemo((()=>{var e;const t=im({messages:(null==(e=null==r?void 0:r.data)?void 0:e.pages.flatMap((e=>e.messages)))||[],fileMap:a});return 0===(null==t?void 0:t.length)?null:t??null}),[a,null==(e=null==r?void 0:r.data)?void 0:e.pages]);return s&&(null==r?void 0:r.data)?c.jsxs(oP,{ref:o,className:"pt-4",children:[i&&0==i.length||null==i?c.jsx("div",{className:"my-auto flex h-full w-full items-center justify-center gap-1 bg-white p-3 text-lg text-gray-500 dark:border-gray-800/50 dark:bg-gray-800 dark:text-gray-300",children:t("com_ui_nothing_found")}):i.map((e=>c.jsx(lP,{message:e},e.messageId))),c.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[5%] bg-gradient-to-t from-gray-50 to-transparent dark:from-gray-800"})]}):null}const dP=({open:e,onOpenChange:t,onAccept:a,onDecline:s,title:r,modalContent:o})=>{const i=kg(),{showToast:l}=Ng(),d=(e=>{const t=ar();return sr((()=>zd.acceptTerms()),{onSuccess:(n,a,s)=>{var r;t.setQueryData([Xc.userTerms],{termsAccepted:!0}),null==(r=null==e?void 0:e.onSuccess)||r.call(e,n,a,s)},onError:null==e?void 0:e.onError,onMutate:null==e?void 0:e.onMutate})})({onSuccess:()=>{a(),t(!1)},onError:()=>{l({message:"Failed to accept terms"})}}),u=n.useMemo((()=>"string"==typeof o?o:Array.isArray(o)?o.join("\n"):""),[o]);return c.jsx(f_,{open:e,onOpenChange:n=>{e&&!n||t(n)},children:c.jsx(LT,{title:r??i("com_ui_terms_and_conditions"),className:"w-11/12 max-w-3xl sm:w-3/4 md:w-1/2 lg:w-2/5",showCloseButton:!1,showCancelButton:!1,main:c.jsx("section",{tabIndex:0,className:"max-h-[60vh] overflow-y-auto p-4","aria-label":i("com_ui_terms_and_conditions"),children:c.jsx("div",{className:"prose dark:prose-invert w-full max-w-none !text-text-primary",children:""!==u?c.jsx(LC,{content:u}):c.jsx("p",{children:i("com_ui_no_terms_content")})})}),buttons:c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>{s(),t(!1)},className:"inline-flex h-10 items-center justify-center rounded-lg border border-border-heavy bg-surface-secondary px-4 py-2 text-sm text-text-primary hover:bg-surface-active",children:i("com_ui_decline")}),c.jsx("button",{onClick:()=>{d.mutate()},className:"inline-flex h-10 items-center justify-center rounded-lg border border-border-heavy bg-surface-secondary px-4 py-2 text-sm text-text-primary hover:bg-green-500 hover:text-white focus:bg-green-500 focus:text-white dark:hover:bg-green-600 dark:focus:bg-green-600",children:i("com_ui_accept")})]})})})};function uP(){var e,t,a,s;const r=D(),[o,i]=n.useState(!1),[l,d]=n.useState(0),[u,m]=n.useState((()=>{const e=localStorage.getItem("navVisible");return null===e||JSON.parse(e)})),{isAuthenticated:p,logout:g}=Wh(),f=function({isAuthenticated:e}){const{data:t={}}=qp(Ro.assistants,void 0,{select:e=>qr(e.data),enabled:e}),{data:n={}}=qp(Ro.azureAssistants,void 0,{select:e=>qr(e.data),enabled:e});return{[Ro.assistants]:t,[Ro.azureAssistants]:n}}({isAuthenticated:p}),x=function({isAuthenticated:e}){const{data:t=null}=Cp(void 0,{select:e=>function(e){const t={};for(const n of e)t[n.id]=n;return t}(e.data),enabled:e});return n.useMemo((()=>null!==t?t:void 0),[t])}({isAuthenticated:p}),h=function({isAuthenticated:e}){const{data:t}=Op({select:Qr,enabled:e});return t}({isAuthenticated:p}),v=function({isAuthenticated:e}){const t=D(),a=z(),[s,r]=n.useState(1),{switchToConversation:o}=Qh(),i=n.useCallback((()=>{o({conversationId:"search",title:"Search",endpoint:null,createdAt:"",updatedAt:""})}),[o]),l=I(_p.searchQuery),c=R(_p.isSearchEnabled),d=Up({enabled:e}),u=Hp({pageNumber:s.toString(),searchQuery:l,isArchived:!1},{enabled:e&&!!l.length});n.useEffect((()=>{l&&l.length>0?t("/search",{replace:!0}):a.pathname&&a.pathname.includes("/c/")||t("/c/new",{replace:!0})}),[t,l]),n.useEffect((()=>{!0===d.data?c(d.data):d.isError&&console.error("Failed to get search enabled",d.error)}),[d.data,d.error,d.isError,c]);const m=n.useCallback((()=>i()),[i]);return n.useEffect((()=>{(null==u?void 0:u.data)&&m()}),[null==u?void 0:u.data,null==u?void 0:u.isInitialLoading,m]),{pageNumber:s,searchQuery:l,setPageNumber:r,searchQueryRes:u}}({isAuthenticated:p}),{data:b}=Ap(),{data:y}=(e=>nr([Xc.userTerms],(()=>zd.getUserTerms()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...e}))({enabled:p&&!0===(null==(t=null==(e=null==b?void 0:b.interface)?void 0:e.termsOfService)?void 0:t.modalAcceptance)});n.useEffect((()=>{y&&i(!y.termsAccepted)}),[y]);return p?c.jsx(Cm,{children:c.jsx(ev.Provider,{value:v,children:c.jsx(nv.Provider,{value:h,children:c.jsxs(hv.Provider,{value:f,children:[c.jsxs(wh.Provider,{value:x,children:[c.jsx(Rj,{onHeightChange:d}),c.jsx("div",{className:"flex",style:{height:`calc(100dvh - ${l}px)`},children:c.jsxs("div",{className:"relative z-0 flex h-full w-full overflow-hidden",children:[c.jsx(TE,{navVisible:u,setNavVisible:m}),c.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col overflow-hidden",children:[c.jsx(gE,{setNavVisible:m}),c.jsx(rt,{context:{navVisible:u,setNavVisible:m}})]})]})})]}),!0===(null==(s=null==(a=null==b?void 0:b.interface)?void 0:a.termsOfService)?void 0:s.modalAcceptance)&&c.jsx(dP,{open:o,onOpenChange:i,onAccept:()=>{i(!1)},onDecline:()=>{i(!1),g(),r("/login")},title:b.interface.termsOfService.modalTitle,modalContent:b.interface.termsOfService.modalContent})]})})})}):null}const mP=()=>c.jsxs(Kh,{children:[c.jsx(rt,{}),c.jsx(pj,{})]}),pP=xa([{path:"share/:shareId",element:c.jsx(kk,{}),errorElement:c.jsx(Cj,{})},{path:"/",element:c.jsx(Mj,{}),errorElement:c.jsx(Cj,{}),children:[{path:"register",element:c.jsx(Py,{})},{path:"forgot-password",element:c.jsx(xj,{})},{path:"reset-password",element:c.jsx(Ly,{})}]},{path:"verify",element:c.jsx(mj,{}),errorElement:c.jsx(Cj,{})},{element:c.jsx(mP,{}),errorElement:c.jsx(Cj,{}),children:[{path:"/",element:c.jsx(Aj,{}),children:[{path:"login",element:c.jsx(Fb,{})},{path:"login/2fa",element:c.jsx(jj,{})}]},bC,{path:"/",element:c.jsx(uP,{}),children:[{index:!0,element:c.jsx(Qt,{to:"/c/new",replace:!0})},{path:"c/:conversationId?",element:c.jsx(rP,{})},{path:"search",element:c.jsx(cP,{})}]}]}]),gP=()=>{const{setError:e}=Rb(),t=new pr({queryCache:new gr({onError:t=>{var n;401===(null==(n=null==t?void 0:t.response)?void 0:n.status)&&e(t)}})});return c.jsx(fr,{client:t,children:c.jsx(ha,{children:c.jsx(Ab,{children:c.jsx(Av,{children:c.jsx(er,{children:c.jsx(Cg,{children:c.jsxs(va,{backend:ba,children:[c.jsx(ya,{router:pP}),c.jsx(xr,{initialIsOpen:!1,position:"top-right"}),c.jsx(Lb,{}),c.jsx(tr,{className:"pointer-events-none fixed inset-0 z-[1000] mx-auto my-2 flex max-w-[560px] flex-col items-stretch justify-start md:pb-5"})]})})})})})})})},fP=()=>c.jsxs(Fv,{children:[c.jsx(gP,{}),c.jsx("iframe",{src:"/assets/silence.mp3",allow:"autoplay",id:"audio",title:"audio-silence",style:{display:"none"}})]}),xP=document.getElementById("root");_a.createRoot(xP).render(c.jsx(Tb,{children:c.jsx(fP,{})}));
